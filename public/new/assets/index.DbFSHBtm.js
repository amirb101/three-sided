(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();var Iy={exports:{}},fd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P_;function pI(){if(P_)return fd;P_=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var h in a)h!=="key"&&(l[h]=a[h])}else l=a;return a=l.ref,{$$typeof:s,type:n,key:u,ref:a!==void 0?a:null,props:l}}return fd.Fragment=e,fd.jsx=t,fd.jsxs=t,fd}var M_;function yI(){return M_||(M_=1,Iy.exports=pI()),Iy.exports}var i=yI(),Cy={exports:{}},We={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O_;function xI(){if(O_)return We;O_=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),w=Symbol.iterator;function b(C){return C===null||typeof C!="object"?null:(C=w&&C[w]||C["@@iterator"],typeof C=="function"?C:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,k={};function U(C,ne,ve){this.props=C,this.context=ne,this.refs=k,this.updater=ve||E}U.prototype.isReactComponent={},U.prototype.setState=function(C,ne){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,ne,"setState")},U.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function z(){}z.prototype=U.prototype;function B(C,ne,ve){this.props=C,this.context=ne,this.refs=k,this.updater=ve||E}var q=B.prototype=new z;q.constructor=B,R(q,U.prototype),q.isPureReactComponent=!0;var G=Array.isArray,Y={H:null,A:null,T:null,S:null,V:null},L=Object.prototype.hasOwnProperty;function P(C,ne,ve,ue,Ie,ye){return ve=ye.ref,{$$typeof:s,type:C,key:ne,ref:ve!==void 0?ve:null,props:ye}}function T(C,ne){return P(C.type,ne,void 0,void 0,void 0,C.props)}function A(C){return typeof C=="object"&&C!==null&&C.$$typeof===s}function F(C){var ne={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(ve){return ne[ve]})}var j=/\/+/g;function V(C,ne){return typeof C=="object"&&C!==null&&C.key!=null?F(""+C.key):ne.toString(36)}function D(){}function De(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(D,D):(C.status="pending",C.then(function(ne){C.status==="pending"&&(C.status="fulfilled",C.value=ne)},function(ne){C.status==="pending"&&(C.status="rejected",C.reason=ne)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function Z(C,ne,ve,ue,Ie){var ye=typeof C;(ye==="undefined"||ye==="boolean")&&(C=null);var Se=!1;if(C===null)Se=!0;else switch(ye){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(C.$$typeof){case s:case e:Se=!0;break;case x:return Se=C._init,Z(Se(C._payload),ne,ve,ue,Ie)}}if(Se)return Ie=Ie(C),Se=ue===""?"."+V(C,0):ue,G(Ie)?(ve="",Se!=null&&(ve=Se.replace(j,"$&/")+"/"),Z(Ie,ne,ve,"",function(Ee){return Ee})):Ie!=null&&(A(Ie)&&(Ie=T(Ie,ve+(Ie.key==null||C&&C.key===Ie.key?"":(""+Ie.key).replace(j,"$&/")+"/")+Se)),ne.push(Ie)),1;Se=0;var ce=ue===""?".":ue+":";if(G(C))for(var we=0;we<C.length;we++)ue=C[we],ye=ce+V(ue,we),Se+=Z(ue,ne,ve,ye,Ie);else if(we=b(C),typeof we=="function")for(C=we.call(C),we=0;!(ue=C.next()).done;)ue=ue.value,ye=ce+V(ue,we++),Se+=Z(ue,ne,ve,ye,Ie);else if(ye==="object"){if(typeof C.then=="function")return Z(De(C),ne,ve,ue,Ie);throw ne=String(C),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Se}function O(C,ne,ve){if(C==null)return C;var ue=[],Ie=0;return Z(C,ue,"","",function(ye){return ne.call(ve,ye,Ie++)}),ue}function oe(C){if(C._status===-1){var ne=C._result;ne=ne(),ne.then(function(ve){(C._status===0||C._status===-1)&&(C._status=1,C._result=ve)},function(ve){(C._status===0||C._status===-1)&&(C._status=2,C._result=ve)}),C._status===-1&&(C._status=0,C._result=ne)}if(C._status===1)return C._result.default;throw C._result}var $=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)};function ge(){}return We.Children={map:O,forEach:function(C,ne,ve){O(C,function(){ne.apply(this,arguments)},ve)},count:function(C){var ne=0;return O(C,function(){ne++}),ne},toArray:function(C){return O(C,function(ne){return ne})||[]},only:function(C){if(!A(C))throw Error("React.Children.only expected to receive a single React element child.");return C}},We.Component=U,We.Fragment=t,We.Profiler=a,We.PureComponent=B,We.StrictMode=n,We.Suspense=m,We.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Y,We.__COMPILER_RUNTIME={__proto__:null,c:function(C){return Y.H.useMemoCache(C)}},We.cache=function(C){return function(){return C.apply(null,arguments)}},We.cloneElement=function(C,ne,ve){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var ue=R({},C.props),Ie=C.key,ye=void 0;if(ne!=null)for(Se in ne.ref!==void 0&&(ye=void 0),ne.key!==void 0&&(Ie=""+ne.key),ne)!L.call(ne,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&ne.ref===void 0||(ue[Se]=ne[Se]);var Se=arguments.length-2;if(Se===1)ue.children=ve;else if(1<Se){for(var ce=Array(Se),we=0;we<Se;we++)ce[we]=arguments[we+2];ue.children=ce}return P(C.type,Ie,void 0,void 0,ye,ue)},We.createContext=function(C){return C={$$typeof:u,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:l,_context:C},C},We.createElement=function(C,ne,ve){var ue,Ie={},ye=null;if(ne!=null)for(ue in ne.key!==void 0&&(ye=""+ne.key),ne)L.call(ne,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(Ie[ue]=ne[ue]);var Se=arguments.length-2;if(Se===1)Ie.children=ve;else if(1<Se){for(var ce=Array(Se),we=0;we<Se;we++)ce[we]=arguments[we+2];Ie.children=ce}if(C&&C.defaultProps)for(ue in Se=C.defaultProps,Se)Ie[ue]===void 0&&(Ie[ue]=Se[ue]);return P(C,ye,void 0,void 0,null,Ie)},We.createRef=function(){return{current:null}},We.forwardRef=function(C){return{$$typeof:h,render:C}},We.isValidElement=A,We.lazy=function(C){return{$$typeof:x,_payload:{_status:-1,_result:C},_init:oe}},We.memo=function(C,ne){return{$$typeof:p,type:C,compare:ne===void 0?null:ne}},We.startTransition=function(C){var ne=Y.T,ve={};Y.T=ve;try{var ue=C(),Ie=Y.S;Ie!==null&&Ie(ve,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(ge,$)}catch(ye){$(ye)}finally{Y.T=ne}},We.unstable_useCacheRefresh=function(){return Y.H.useCacheRefresh()},We.use=function(C){return Y.H.use(C)},We.useActionState=function(C,ne,ve){return Y.H.useActionState(C,ne,ve)},We.useCallback=function(C,ne){return Y.H.useCallback(C,ne)},We.useContext=function(C){return Y.H.useContext(C)},We.useDebugValue=function(){},We.useDeferredValue=function(C,ne){return Y.H.useDeferredValue(C,ne)},We.useEffect=function(C,ne,ve){var ue=Y.H;if(typeof ve=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(C,ne)},We.useId=function(){return Y.H.useId()},We.useImperativeHandle=function(C,ne,ve){return Y.H.useImperativeHandle(C,ne,ve)},We.useInsertionEffect=function(C,ne){return Y.H.useInsertionEffect(C,ne)},We.useLayoutEffect=function(C,ne){return Y.H.useLayoutEffect(C,ne)},We.useMemo=function(C,ne){return Y.H.useMemo(C,ne)},We.useOptimistic=function(C,ne){return Y.H.useOptimistic(C,ne)},We.useReducer=function(C,ne,ve){return Y.H.useReducer(C,ne,ve)},We.useRef=function(C){return Y.H.useRef(C)},We.useState=function(C){return Y.H.useState(C)},We.useSyncExternalStore=function(C,ne,ve){return Y.H.useSyncExternalStore(C,ne,ve)},We.useTransition=function(){return Y.H.useTransition()},We.version="19.1.1",We}var V_;function Xx(){return V_||(V_=1,Cy.exports=xI()),Cy.exports}var M=Xx(),Ry={exports:{}},md={},ky={exports:{}},Dy={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L_;function vI(){return L_||(L_=1,(function(s){function e(O,oe){var $=O.length;O.push(oe);e:for(;0<$;){var ge=$-1>>>1,C=O[ge];if(0<a(C,oe))O[ge]=oe,O[$]=C,$=ge;else break e}}function t(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var oe=O[0],$=O.pop();if($!==oe){O[0]=$;e:for(var ge=0,C=O.length,ne=C>>>1;ge<ne;){var ve=2*(ge+1)-1,ue=O[ve],Ie=ve+1,ye=O[Ie];if(0>a(ue,$))Ie<C&&0>a(ye,ue)?(O[ge]=ye,O[Ie]=$,ge=Ie):(O[ge]=ue,O[ve]=$,ge=ve);else if(Ie<C&&0>a(ye,$))O[ge]=ye,O[Ie]=$,ge=Ie;else break e}}return oe}function a(O,oe){var $=O.sortIndex-oe.sortIndex;return $!==0?$:O.id-oe.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var u=Date,h=u.now();s.unstable_now=function(){return u.now()-h}}var m=[],p=[],x=1,w=null,b=3,E=!1,R=!1,k=!1,U=!1,z=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function G(O){for(var oe=t(p);oe!==null;){if(oe.callback===null)n(p);else if(oe.startTime<=O)n(p),oe.sortIndex=oe.expirationTime,e(m,oe);else break;oe=t(p)}}function Y(O){if(k=!1,G(O),!R)if(t(m)!==null)R=!0,L||(L=!0,V());else{var oe=t(p);oe!==null&&Z(Y,oe.startTime-O)}}var L=!1,P=-1,T=5,A=-1;function F(){return U?!0:!(s.unstable_now()-A<T)}function j(){if(U=!1,L){var O=s.unstable_now();A=O;var oe=!0;try{e:{R=!1,k&&(k=!1,B(P),P=-1),E=!0;var $=b;try{t:{for(G(O),w=t(m);w!==null&&!(w.expirationTime>O&&F());){var ge=w.callback;if(typeof ge=="function"){w.callback=null,b=w.priorityLevel;var C=ge(w.expirationTime<=O);if(O=s.unstable_now(),typeof C=="function"){w.callback=C,G(O),oe=!0;break t}w===t(m)&&n(m),G(O)}else n(m);w=t(m)}if(w!==null)oe=!0;else{var ne=t(p);ne!==null&&Z(Y,ne.startTime-O),oe=!1}}break e}finally{w=null,b=$,E=!1}oe=void 0}}finally{oe?V():L=!1}}}var V;if(typeof q=="function")V=function(){q(j)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,De=D.port2;D.port1.onmessage=j,V=function(){De.postMessage(null)}}else V=function(){z(j,0)};function Z(O,oe){P=z(function(){O(s.unstable_now())},oe)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(O){O.callback=null},s.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<O?Math.floor(1e3/O):5},s.unstable_getCurrentPriorityLevel=function(){return b},s.unstable_next=function(O){switch(b){case 1:case 2:case 3:var oe=3;break;default:oe=b}var $=b;b=oe;try{return O()}finally{b=$}},s.unstable_requestPaint=function(){U=!0},s.unstable_runWithPriority=function(O,oe){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var $=b;b=O;try{return oe()}finally{b=$}},s.unstable_scheduleCallback=function(O,oe,$){var ge=s.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?ge+$:ge):$=ge,O){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=$+C,O={id:x++,callback:oe,priorityLevel:O,startTime:$,expirationTime:C,sortIndex:-1},$>ge?(O.sortIndex=$,e(p,O),t(m)===null&&O===t(p)&&(k?(B(P),P=-1):k=!0,Z(Y,$-ge))):(O.sortIndex=C,e(m,O),R||E||(R=!0,L||(L=!0,V()))),O},s.unstable_shouldYield=F,s.unstable_wrapCallback=function(O){var oe=b;return function(){var $=b;b=oe;try{return O.apply(this,arguments)}finally{b=$}}}})(Dy)),Dy}var F_;function bI(){return F_||(F_=1,ky.exports=vI()),ky.exports}var Py={exports:{}},ss={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U_;function wI(){if(U_)return ss;U_=1;var s=Xx();function e(m){var p="https://react.dev/errors/"+m;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)p+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+m+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(m,p,x){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:w==null?null:""+w,children:m,containerInfo:p,implementation:x}}var u=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(m,p){if(m==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return ss.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ss.createPortal=function(m,p){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(m,p,null,x)},ss.flushSync=function(m){var p=u.T,x=n.p;try{if(u.T=null,n.p=2,m)return m()}finally{u.T=p,n.p=x,n.d.f()}},ss.preconnect=function(m,p){typeof m=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,n.d.C(m,p))},ss.prefetchDNS=function(m){typeof m=="string"&&n.d.D(m)},ss.preinit=function(m,p){if(typeof m=="string"&&p&&typeof p.as=="string"){var x=p.as,w=h(x,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,E=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;x==="style"?n.d.S(m,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:w,integrity:b,fetchPriority:E}):x==="script"&&n.d.X(m,{crossOrigin:w,integrity:b,fetchPriority:E,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},ss.preinitModule=function(m,p){if(typeof m=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var x=h(p.as,p.crossOrigin);n.d.M(m,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&n.d.M(m)},ss.preload=function(m,p){if(typeof m=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var x=p.as,w=h(x,p.crossOrigin);n.d.L(m,x,{crossOrigin:w,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},ss.preloadModule=function(m,p){if(typeof m=="string")if(p){var x=h(p.as,p.crossOrigin);n.d.m(m,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else n.d.m(m)},ss.requestFormReset=function(m){n.d.r(m)},ss.unstable_batchedUpdates=function(m,p){return m(p)},ss.useFormState=function(m,p,x){return u.H.useFormState(m,p,x)},ss.useFormStatus=function(){return u.H.useHostTransitionStatus()},ss.version="19.1.1",ss}var B_;function _I(){if(B_)return Py.exports;B_=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Py.exports=wI(),Py.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q_;function NI(){if(q_)return md;q_=1;var s=bI(),e=Xx(),t=_I();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var o=r,c=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(c=o.return),r=o.return;while(r)}return o.tag===3?c:null}function u(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function h(r){if(l(r)!==r)throw Error(n(188))}function m(r){var o=r.alternate;if(!o){if(o=l(r),o===null)throw Error(n(188));return o!==r?null:r}for(var c=r,d=o;;){var g=c.return;if(g===null)break;var y=g.alternate;if(y===null){if(d=g.return,d!==null){c=d;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===c)return h(g),r;if(y===d)return h(g),o;y=y.sibling}throw Error(n(188))}if(c.return!==d.return)c=g,d=y;else{for(var N=!1,S=g.child;S;){if(S===c){N=!0,c=g,d=y;break}if(S===d){N=!0,d=g,c=y;break}S=S.sibling}if(!N){for(S=y.child;S;){if(S===c){N=!0,c=y,d=g;break}if(S===d){N=!0,d=y,c=g;break}S=S.sibling}if(!N)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?r:o}function p(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=p(r),o!==null)return o;r=r.sibling}return null}var x=Object.assign,w=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),z=Symbol.for("react.provider"),B=Symbol.for("react.consumer"),q=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function V(r){return r===null||typeof r!="object"?null:(r=j&&r[j]||r["@@iterator"],typeof r=="function"?r:null)}var D=Symbol.for("react.client.reference");function De(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===D?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case R:return"Fragment";case U:return"Profiler";case k:return"StrictMode";case Y:return"Suspense";case L:return"SuspenseList";case A:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case E:return"Portal";case q:return(r.displayName||"Context")+".Provider";case B:return(r._context.displayName||"Context")+".Consumer";case G:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case P:return o=r.displayName||null,o!==null?o:De(r.type)||"Memo";case T:o=r._payload,r=r._init;try{return De(r(o))}catch{}}return null}var Z=Array.isArray,O=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},ge=[],C=-1;function ne(r){return{current:r}}function ve(r){0>C||(r.current=ge[C],ge[C]=null,C--)}function ue(r,o){C++,ge[C]=r.current,r.current=o}var Ie=ne(null),ye=ne(null),Se=ne(null),ce=ne(null);function we(r,o){switch(ue(Se,o),ue(ye,r),ue(Ie,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?l_(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=l_(o),r=c_(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}ve(Ie),ue(Ie,r)}function Ee(){ve(Ie),ve(ye),ve(Se)}function Fe(r){r.memoizedState!==null&&ue(ce,r);var o=Ie.current,c=c_(o,r.type);o!==c&&(ue(ye,r),ue(Ie,c))}function Ze(r){ye.current===r&&(ve(Ie),ve(ye)),ce.current===r&&(ve(ce),ld._currentValue=$)}var Ge=Object.prototype.hasOwnProperty,lt=s.unstable_scheduleCallback,ze=s.unstable_cancelCallback,Qe=s.unstable_shouldYield,gt=s.unstable_requestPaint,ct=s.unstable_now,It=s.unstable_getCurrentPriorityLevel,Gn=s.unstable_ImmediatePriority,an=s.unstable_UserBlockingPriority,$n=s.unstable_NormalPriority,_r=s.unstable_LowPriority,Ds=s.unstable_IdlePriority,Ps=s.log,Ms=s.unstable_setDisableYieldValue,_t=null,pt=null;function es(r){if(typeof Ps=="function"&&Ms(r),pt&&typeof pt.setStrictMode=="function")try{pt.setStrictMode(_t,r)}catch{}}var _n=Math.clz32?Math.clz32:Zs,ri=Math.log,Nl=Math.LN2;function Zs(r){return r>>>=0,r===0?32:31-(ri(r)/Nl|0)|0}var er=256,Kn=4194304;function kn(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Br(r,o,c){var d=r.pendingLanes;if(d===0)return 0;var g=0,y=r.suspendedLanes,N=r.pingedLanes;r=r.warmLanes;var S=d&134217727;return S!==0?(d=S&~y,d!==0?g=kn(d):(N&=S,N!==0?g=kn(N):c||(c=S&~r,c!==0&&(g=kn(c))))):(S=d&~y,S!==0?g=kn(S):N!==0?g=kn(N):c||(c=d&~r,c!==0&&(g=kn(c)))),g===0?0:o!==0&&o!==g&&(o&y)===0&&(y=g&-g,c=o&-o,y>=c||y===32&&(c&4194048)!==0)?o:g}function Nr(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function fo(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qr(){var r=er;return er<<=1,(er&4194048)===0&&(er=256),r}function zr(){var r=Kn;return Kn<<=1,(Kn&62914560)===0&&(Kn=4194304),r}function Tr(r){for(var o=[],c=0;31>c;c++)o.push(r);return o}function us(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function mo(r,o,c,d,g,y){var N=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var S=r.entanglements,H=r.expirationTimes,se=r.hiddenUpdates;for(c=N&~c;0<c;){var de=31-_n(c),me=1<<de;S[de]=0,H[de]=-1;var ae=se[de];if(ae!==null)for(se[de]=null,de=0;de<ae.length;de++){var ie=ae[de];ie!==null&&(ie.lane&=-536870913)}c&=~me}d!==0&&tr(r,d,0),y!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=y&~(N&~o))}function tr(r,o,c){r.pendingLanes|=o,r.suspendedLanes&=~o;var d=31-_n(o);r.entangledLanes|=o,r.entanglements[d]=r.entanglements[d]|1073741824|c&4194090}function qt(r,o){var c=r.entangledLanes|=o;for(r=r.entanglements;c;){var d=31-_n(c),g=1<<d;g&o|r[d]&o&&(r[d]|=o),c&=~g}}function ds(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ai(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Er(){var r=oe.p;return r!==0?r:(r=window.event,r===void 0?32:j_(r.type))}function ii(r,o){var c=oe.p;try{return oe.p=r,o()}finally{oe.p=c}}var Mt=Math.random().toString(36).slice(2),tn="__reactFiber$"+Mt,nn="__reactProps$"+Mt,Yt="__reactContainer$"+Mt,nr="__reactEvents$"+Mt,Tl="__reactListeners$"+Mt,Sr="__reactHandles$"+Mt,oi="__reactResources$"+Mt,Hr="__reactMarker$"+Mt;function Dn(r){delete r[tn],delete r[nn],delete r[nr],delete r[Tl],delete r[Sr]}function sr(r){var o=r[tn];if(o)return o;for(var c=r.parentNode;c;){if(o=c[Yt]||c[tn]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(r=f_(r);r!==null;){if(c=r[tn])return c;r=f_(r)}return o}r=c,c=r.parentNode}return null}function Os(r){if(r=r[tn]||r[Yt]){var o=r.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return r}return null}function Vs(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function Pn(r){var o=r[oi];return o||(o=r[oi]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Xt(r){r[Hr]=!0}var Pe=new Set,Q={};function xe(r,o){je(r,o),je(r+"Capture",o)}function je(r,o){for(Q[r]=o,r=0;r<o.length;r++)Pe.add(o[r])}var Nt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),on={},Ot={};function Nn(r){return Ge.call(Ot,r)?!0:Ge.call(on,r)?!1:Nt.test(r)?Ot[r]=!0:(on[r]=!0,!1)}function Mn(r,o,c){if(Nn(o))if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var d=o.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+c)}}function ts(r,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+c)}}function ln(r,o,c,d){if(d===null)r.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(o,c,""+d)}}var zt,go;function rr(r){if(zt===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);zt=o&&o[1]||"",go=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zt+r+go}var El=!1;function Sl(r,o){if(!r||El)return"";El=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(o){var me=function(){throw Error()};if(Object.defineProperty(me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(me,[])}catch(ie){var ae=ie}Reflect.construct(r,[],me)}else{try{me.call()}catch(ie){ae=ie}r.call(me.prototype)}}else{try{throw Error()}catch(ie){ae=ie}(me=r())&&typeof me.catch=="function"&&me.catch(function(){})}}catch(ie){if(ie&&ae&&typeof ie.stack=="string")return[ie.stack,ae.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),N=y[0],S=y[1];if(N&&S){var H=N.split(`
`),se=S.split(`
`);for(g=d=0;d<H.length&&!H[d].includes("DetermineComponentFrameRoot");)d++;for(;g<se.length&&!se[g].includes("DetermineComponentFrameRoot");)g++;if(d===H.length||g===se.length)for(d=H.length-1,g=se.length-1;1<=d&&0<=g&&H[d]!==se[g];)g--;for(;1<=d&&0<=g;d--,g--)if(H[d]!==se[g]){if(d!==1||g!==1)do if(d--,g--,0>g||H[d]!==se[g]){var de=`
`+H[d].replace(" at new "," at ");return r.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",r.displayName)),de}while(1<=d&&0<=g);break}}}finally{El=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?rr(c):""}function gu(r){switch(r.tag){case 26:case 27:case 5:return rr(r.type);case 16:return rr("Lazy");case 13:return rr("Suspense");case 19:return rr("SuspenseList");case 0:case 15:return Sl(r.type,!1);case 11:return Sl(r.type.render,!1);case 1:return Sl(r.type,!0);case 31:return rr("Activity");default:return""}}function Al(r){try{var o="";do o+=gu(r),r=r.return;while(r);return o}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function hs(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function pu(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Dg(r){var o=pu(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),d=""+r[o];if(!r.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,y=c.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return g.call(this)},set:function(N){d=""+N,y.call(this,N)}}),Object.defineProperty(r,o,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(N){d=""+N},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function jl(r){r._valueTracker||(r._valueTracker=Dg(r))}function yu(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var c=o.getValue(),d="";return r&&(d=pu(r)?r.checked?"true":"false":r.value),r=d,r!==c?(o.setValue(r),!0):!1}function po(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Pg=/[\n"\\]/g;function fn(r){return r.replace(Pg,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Ls(r,o,c,d,g,y,N,S){r.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?r.type=N:r.removeAttribute("type"),o!=null?N==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+hs(o)):r.value!==""+hs(o)&&(r.value=""+hs(o)):N!=="submit"&&N!=="reset"||r.removeAttribute("value"),o!=null?li(r,N,hs(o)):c!=null?li(r,N,hs(c)):d!=null&&r.removeAttribute("value"),g==null&&y!=null&&(r.defaultChecked=!!y),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.name=""+hs(S):r.removeAttribute("name")}function yo(r,o,c,d,g,y,N,S){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),o!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||o!=null))return;c=c!=null?""+hs(c):"",o=o!=null?""+hs(o):c,S||o===r.value||(r.value=o),r.defaultValue=o}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=S?r.checked:!!d,r.defaultChecked=!!d,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(r.name=N)}function li(r,o,c){o==="number"&&po(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function ga(r,o,c,d){if(r=r.options,o){o={};for(var g=0;g<c.length;g++)o["$"+c[g]]=!0;for(c=0;c<r.length;c++)g=o.hasOwnProperty("$"+r[c].value),r[c].selected!==g&&(r[c].selected=g),g&&d&&(r[c].defaultSelected=!0)}else{for(c=""+hs(c),o=null,g=0;g<r.length;g++){if(r[g].value===c){r[g].selected=!0,d&&(r[g].defaultSelected=!0);return}o!==null||r[g].disabled||(o=r[g])}o!==null&&(o.selected=!0)}}function Ct(r,o,c){if(o!=null&&(o=""+hs(o),o!==r.value&&(r.value=o),c==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=c!=null?""+hs(c):""}function xo(r,o,c,d){if(o==null){if(d!=null){if(c!=null)throw Error(n(92));if(Z(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),o=c}c=hs(o),r.defaultValue=c,d=r.textContent,d===c&&d!==""&&d!==null&&(r.value=d)}function ar(r,o){if(o){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=o;return}}r.textContent=o}var vo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Eh(r,o,c){var d=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":d?r.setProperty(o,c):typeof c!="number"||c===0||vo.has(o)?o==="float"?r.cssFloat=c:r[o]=(""+c).trim():r[o]=c+"px"}function xu(r,o,c){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||o!=null&&o.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var g in o)d=o[g],o.hasOwnProperty(g)&&c[g]!==d&&Eh(r,g,d)}else for(var y in o)o.hasOwnProperty(y)&&Eh(r,y,o[y])}function vu(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Og=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Il(r){return Og.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var pa=null;function ir(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ya=null,xa=null;function bu(r){var o=Os(r);if(o&&(r=o.stateNode)){var c=r[nn]||null;e:switch(r=o.stateNode,o.type){case"input":if(Ls(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+fn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var d=c[o];if(d!==r&&d.form===r.form){var g=d[nn]||null;if(!g)throw Error(n(90));Ls(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<c.length;o++)d=c[o],d.form===r.form&&yu(d)}break e;case"textarea":Ct(r,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&ga(r,!!c.multiple,o,!1)}}}var Gr=!1;function Sh(r,o,c){if(Gr)return r(o,c);Gr=!0;try{var d=r(o);return d}finally{if(Gr=!1,(ya!==null||xa!==null)&&(bf(),ya&&(o=ya,r=xa,xa=ya=null,bu(o),r)))for(o=0;o<r.length;o++)bu(r[o])}}function bo(r,o){var c=r.stateNode;if(c===null)return null;var d=c[nn]||null;if(d===null)return null;c=d[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var Ar=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),or=!1;if(Ar)try{var wo={};Object.defineProperty(wo,"passive",{get:function(){or=!0}}),window.addEventListener("test",wo,wo),window.removeEventListener("test",wo,wo)}catch{or=!1}var $r=null,ci=null,va=null;function wu(){if(va)return va;var r,o=ci,c=o.length,d,g="value"in $r?$r.value:$r.textContent,y=g.length;for(r=0;r<c&&o[r]===g[r];r++);var N=c-r;for(d=1;d<=N&&o[c-d]===g[y-d];d++);return va=g.slice(r,1<d?1-d:void 0)}function Kr(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Qr(){return!0}function _u(){return!1}function On(r){function o(c,d,g,y,N){this._reactName=c,this._targetInst=g,this.type=d,this.nativeEvent=y,this.target=N,this.currentTarget=null;for(var S in r)r.hasOwnProperty(S)&&(c=r[S],this[S]=c?c(y):y[S]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Qr:_u,this.isPropagationStopped=_u,this}return x(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Qr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Qr)},persist:function(){},isPersistent:Qr}),o}var bt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cl=On(bt),_o=x({},bt,{view:0,detail:0}),Ah=On(_o),Rl,kl,Yr,No=x({},_o,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:So,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Yr&&(Yr&&r.type==="mousemove"?(Rl=r.screenX-Yr.screenX,kl=r.screenY-Yr.screenY):kl=Rl=0,Yr=r),Rl)},movementY:function(r){return"movementY"in r?r.movementY:kl}}),lr=On(No),jh=x({},No,{dataTransfer:0}),Vg=On(jh),To=x({},_o,{relatedTarget:0}),Dl=On(To),Nu=x({},bt,{animationName:0,elapsedTime:0,pseudoElement:0}),Pl=On(Nu),Ih=x({},bt,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ml=On(Ih),Lg=x({},bt,{data:0}),Tu=On(Lg),Eo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ch={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Eu(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=Rh[r])?!!o[r]:!1}function So(){return Eu}var kh=x({},_o,{key:function(r){if(r.key){var o=Eo[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Kr(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Ch[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:So,charCode:function(r){return r.type==="keypress"?Kr(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Kr(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Ol=On(kh),Dh=x({},No,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Su=On(Dh),ba=x({},_o,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:So}),Ph=On(ba),Mh=x({},bt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Oh=On(Mh),Vh=x({},No,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Vl=On(Vh),fs=x({},bt,{newState:0,oldState:0}),Lh=On(fs),Fh=[9,13,27,32],Xr=Ar&&"CompositionEvent"in window,f=null;Ar&&"documentMode"in document&&(f=document.documentMode);var v=Ar&&"TextEvent"in window&&!f,_=Ar&&(!Xr||f&&8<f&&11>=f),I=" ",J=!1;function le(r,o){switch(r){case"keyup":return Fh.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _e(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ut=!1;function Tn(r,o){switch(r){case"compositionend":return _e(o);case"keypress":return o.which!==32?null:(J=!0,I);case"textInput":return r=o.data,r===I&&J?null:r;default:return null}}function dt(r,o){if(ut)return r==="compositionend"||!Xr&&le(r,o)?(r=wu(),va=ci=$r=null,ut=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return _&&o.locale!=="ko"?null:o.data;default:return null}}var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function En(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!Vn[r.type]:o==="textarea"}function wa(r,o,c,d){ya?xa?xa.push(d):xa=[d]:ya=d,o=Sf(o,"onChange"),0<o.length&&(c=new Cl("onChange","change",null,c,d),r.push({event:c,listeners:o}))}var Qn=null,Wr=null;function Au(r){s_(r,0)}function Uh(r){var o=Vs(r);if(yu(o))return r}function Tb(r,o){if(r==="change")return o}var Eb=!1;if(Ar){var Fg;if(Ar){var Ug="oninput"in document;if(!Ug){var Sb=document.createElement("div");Sb.setAttribute("oninput","return;"),Ug=typeof Sb.oninput=="function"}Fg=Ug}else Fg=!1;Eb=Fg&&(!document.documentMode||9<document.documentMode)}function Ab(){Qn&&(Qn.detachEvent("onpropertychange",jb),Wr=Qn=null)}function jb(r){if(r.propertyName==="value"&&Uh(Wr)){var o=[];wa(o,Wr,r,ir(r)),Sh(Au,o)}}function $1(r,o,c){r==="focusin"?(Ab(),Qn=o,Wr=c,Qn.attachEvent("onpropertychange",jb)):r==="focusout"&&Ab()}function K1(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Uh(Wr)}function Q1(r,o){if(r==="click")return Uh(o)}function Y1(r,o){if(r==="input"||r==="change")return Uh(o)}function X1(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Fs=typeof Object.is=="function"?Object.is:X1;function ju(r,o){if(Fs(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var c=Object.keys(r),d=Object.keys(o);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var g=c[d];if(!Ge.call(o,g)||!Fs(r[g],o[g]))return!1}return!0}function Ib(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Cb(r,o){var c=Ib(r);r=0;for(var d;c;){if(c.nodeType===3){if(d=r+c.textContent.length,r<=o&&d>=o)return{node:c,offset:o-r};r=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Ib(c)}}function Rb(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Rb(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function kb(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=po(r.document);o instanceof r.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)r=o.contentWindow;else break;o=po(r.document)}return o}function Bg(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var W1=Ar&&"documentMode"in document&&11>=document.documentMode,Ll=null,qg=null,Iu=null,zg=!1;function Db(r,o,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;zg||Ll==null||Ll!==po(d)||(d=Ll,"selectionStart"in d&&Bg(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Iu&&ju(Iu,d)||(Iu=d,d=Sf(qg,"onSelect"),0<d.length&&(o=new Cl("onSelect","select",null,o,c),r.push({event:o,listeners:d}),o.target=Ll)))}function Ao(r,o){var c={};return c[r.toLowerCase()]=o.toLowerCase(),c["Webkit"+r]="webkit"+o,c["Moz"+r]="moz"+o,c}var Fl={animationend:Ao("Animation","AnimationEnd"),animationiteration:Ao("Animation","AnimationIteration"),animationstart:Ao("Animation","AnimationStart"),transitionrun:Ao("Transition","TransitionRun"),transitionstart:Ao("Transition","TransitionStart"),transitioncancel:Ao("Transition","TransitionCancel"),transitionend:Ao("Transition","TransitionEnd")},Hg={},Pb={};Ar&&(Pb=document.createElement("div").style,"AnimationEvent"in window||(delete Fl.animationend.animation,delete Fl.animationiteration.animation,delete Fl.animationstart.animation),"TransitionEvent"in window||delete Fl.transitionend.transition);function jo(r){if(Hg[r])return Hg[r];if(!Fl[r])return r;var o=Fl[r],c;for(c in o)if(o.hasOwnProperty(c)&&c in Pb)return Hg[r]=o[c];return r}var Mb=jo("animationend"),Ob=jo("animationiteration"),Vb=jo("animationstart"),J1=jo("transitionrun"),Z1=jo("transitionstart"),e2=jo("transitioncancel"),Lb=jo("transitionend"),Fb=new Map,Gg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Gg.push("scrollEnd");function jr(r,o){Fb.set(r,o),xe(o,[r])}var Ub=new WeakMap;function cr(r,o){if(typeof r=="object"&&r!==null){var c=Ub.get(r);return c!==void 0?c:(o={value:r,source:o,stack:Al(o)},Ub.set(r,o),o)}return{value:r,source:o,stack:Al(o)}}var ur=[],Ul=0,$g=0;function Bh(){for(var r=Ul,o=$g=Ul=0;o<r;){var c=ur[o];ur[o++]=null;var d=ur[o];ur[o++]=null;var g=ur[o];ur[o++]=null;var y=ur[o];if(ur[o++]=null,d!==null&&g!==null){var N=d.pending;N===null?g.next=g:(g.next=N.next,N.next=g),d.pending=g}y!==0&&Bb(c,g,y)}}function qh(r,o,c,d){ur[Ul++]=r,ur[Ul++]=o,ur[Ul++]=c,ur[Ul++]=d,$g|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function Kg(r,o,c,d){return qh(r,o,c,d),zh(r)}function Bl(r,o){return qh(r,null,null,o),zh(r)}function Bb(r,o,c){r.lanes|=c;var d=r.alternate;d!==null&&(d.lanes|=c);for(var g=!1,y=r.return;y!==null;)y.childLanes|=c,d=y.alternate,d!==null&&(d.childLanes|=c),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(g=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,g&&o!==null&&(g=31-_n(c),r=y.hiddenUpdates,d=r[g],d===null?r[g]=[o]:d.push(o),o.lane=c|536870912),y):null}function zh(r){if(50<ed)throw ed=0,Zp=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var ql={};function t2(r,o,c,d){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Us(r,o,c,d){return new t2(r,o,c,d)}function Qg(r){return r=r.prototype,!(!r||!r.isReactComponent)}function _a(r,o){var c=r.alternate;return c===null?(c=Us(r.tag,o,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=o,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,o=r.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function qb(r,o){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,o=c.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function Hh(r,o,c,d,g,y){var N=0;if(d=r,typeof r=="function")Qg(r)&&(N=1);else if(typeof r=="string")N=sI(r,c,Ie.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case A:return r=Us(31,c,o,g),r.elementType=A,r.lanes=y,r;case R:return Io(c.children,g,y,o);case k:N=8,g|=24;break;case U:return r=Us(12,c,o,g|2),r.elementType=U,r.lanes=y,r;case Y:return r=Us(13,c,o,g),r.elementType=Y,r.lanes=y,r;case L:return r=Us(19,c,o,g),r.elementType=L,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case z:case q:N=10;break e;case B:N=9;break e;case G:N=11;break e;case P:N=14;break e;case T:N=16,d=null;break e}N=29,c=Error(n(130,r===null?"null":typeof r,"")),d=null}return o=Us(N,c,o,g),o.elementType=r,o.type=d,o.lanes=y,o}function Io(r,o,c,d){return r=Us(7,r,d,o),r.lanes=c,r}function Yg(r,o,c){return r=Us(6,r,null,o),r.lanes=c,r}function Xg(r,o,c){return o=Us(4,r.children!==null?r.children:[],r.key,o),o.lanes=c,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var zl=[],Hl=0,Gh=null,$h=0,dr=[],hr=0,Co=null,Na=1,Ta="";function Ro(r,o){zl[Hl++]=$h,zl[Hl++]=Gh,Gh=r,$h=o}function zb(r,o,c){dr[hr++]=Na,dr[hr++]=Ta,dr[hr++]=Co,Co=r;var d=Na;r=Ta;var g=32-_n(d)-1;d&=~(1<<g),c+=1;var y=32-_n(o)+g;if(30<y){var N=g-g%5;y=(d&(1<<N)-1).toString(32),d>>=N,g-=N,Na=1<<32-_n(o)+g|c<<g|d,Ta=y+r}else Na=1<<y|c<<g|d,Ta=r}function Wg(r){r.return!==null&&(Ro(r,1),zb(r,1,0))}function Jg(r){for(;r===Gh;)Gh=zl[--Hl],zl[Hl]=null,$h=zl[--Hl],zl[Hl]=null;for(;r===Co;)Co=dr[--hr],dr[hr]=null,Ta=dr[--hr],dr[hr]=null,Na=dr[--hr],dr[hr]=null}var ms=null,sn=null,xt=!1,ko=null,Jr=!1,Zg=Error(n(519));function Do(r){var o=Error(n(418,""));throw ku(cr(o,r)),Zg}function Hb(r){var o=r.stateNode,c=r.type,d=r.memoizedProps;switch(o[tn]=r,o[nn]=d,c){case"dialog":rt("cancel",o),rt("close",o);break;case"iframe":case"object":case"embed":rt("load",o);break;case"video":case"audio":for(c=0;c<nd.length;c++)rt(nd[c],o);break;case"source":rt("error",o);break;case"img":case"image":case"link":rt("error",o),rt("load",o);break;case"details":rt("toggle",o);break;case"input":rt("invalid",o),yo(o,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),jl(o);break;case"select":rt("invalid",o);break;case"textarea":rt("invalid",o),xo(o,d.value,d.defaultValue,d.children),jl(o)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||d.suppressHydrationWarning===!0||o_(o.textContent,c)?(d.popover!=null&&(rt("beforetoggle",o),rt("toggle",o)),d.onScroll!=null&&rt("scroll",o),d.onScrollEnd!=null&&rt("scrollend",o),d.onClick!=null&&(o.onclick=Af),o=!0):o=!1,o||Do(r)}function Gb(r){for(ms=r.return;ms;)switch(ms.tag){case 5:case 13:Jr=!1;return;case 27:case 3:Jr=!0;return;default:ms=ms.return}}function Cu(r){if(r!==ms)return!1;if(!xt)return Gb(r),xt=!0,!1;var o=r.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||gy(r.type,r.memoizedProps)),c=!c),c&&sn&&Do(r),Gb(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8)if(c=r.data,c==="/$"){if(o===0){sn=Cr(r.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++;r=r.nextSibling}sn=null}}else o===27?(o=sn,Ei(r.type)?(r=vy,vy=null,sn=r):sn=o):sn=ms?Cr(r.stateNode.nextSibling):null;return!0}function Ru(){sn=ms=null,xt=!1}function $b(){var r=ko;return r!==null&&(bs===null?bs=r:bs.push.apply(bs,r),ko=null),r}function ku(r){ko===null?ko=[r]:ko.push(r)}var ep=ne(null),Po=null,Ea=null;function ui(r,o,c){ue(ep,o._currentValue),o._currentValue=c}function Sa(r){r._currentValue=ep.current,ve(ep)}function tp(r,o,c){for(;r!==null;){var d=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),r===c)break;r=r.return}}function np(r,o,c,d){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var y=g.dependencies;if(y!==null){var N=g.child;y=y.firstContext;e:for(;y!==null;){var S=y;y=g;for(var H=0;H<o.length;H++)if(S.context===o[H]){y.lanes|=c,S=y.alternate,S!==null&&(S.lanes|=c),tp(y.return,c,r),d||(N=null);break e}y=S.next}}else if(g.tag===18){if(N=g.return,N===null)throw Error(n(341));N.lanes|=c,y=N.alternate,y!==null&&(y.lanes|=c),tp(N,c,r),N=null}else N=g.child;if(N!==null)N.return=g;else for(N=g;N!==null;){if(N===r){N=null;break}if(g=N.sibling,g!==null){g.return=N.return,N=g;break}N=N.return}g=N}}function Du(r,o,c,d){r=null;for(var g=o,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var N=g.alternate;if(N===null)throw Error(n(387));if(N=N.memoizedProps,N!==null){var S=g.type;Fs(g.pendingProps.value,N.value)||(r!==null?r.push(S):r=[S])}}else if(g===ce.current){if(N=g.alternate,N===null)throw Error(n(387));N.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(ld):r=[ld])}g=g.return}r!==null&&np(o,r,c,d),o.flags|=262144}function Kh(r){for(r=r.firstContext;r!==null;){if(!Fs(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Mo(r){Po=r,Ea=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function ns(r){return Kb(Po,r)}function Qh(r,o){return Po===null&&Mo(r),Kb(r,o)}function Kb(r,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},Ea===null){if(r===null)throw Error(n(308));Ea=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Ea=Ea.next=o;return c}var n2=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(c,d){r.push(d)}};this.abort=function(){o.aborted=!0,r.forEach(function(c){return c()})}},s2=s.unstable_scheduleCallback,r2=s.unstable_NormalPriority,Sn={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sp(){return{controller:new n2,data:new Map,refCount:0}}function Pu(r){r.refCount--,r.refCount===0&&s2(r2,function(){r.controller.abort()})}var Mu=null,rp=0,Gl=0,$l=null;function a2(r,o){if(Mu===null){var c=Mu=[];rp=0,Gl=iy(),$l={status:"pending",value:void 0,then:function(d){c.push(d)}}}return rp++,o.then(Qb,Qb),o}function Qb(){if(--rp===0&&Mu!==null){$l!==null&&($l.status="fulfilled");var r=Mu;Mu=null,Gl=0,$l=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function i2(r,o){var c=[],d={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return r.then(function(){d.status="fulfilled",d.value=o;for(var g=0;g<c.length;g++)(0,c[g])(o)},function(g){for(d.status="rejected",d.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),d}var Yb=O.S;O.S=function(r,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&a2(r,o),Yb!==null&&Yb(r,o)};var Oo=ne(null);function ap(){var r=Oo.current;return r!==null?r:Lt.pooledCache}function Yh(r,o){o===null?ue(Oo,Oo.current):ue(Oo,o.pool)}function Xb(){var r=ap();return r===null?null:{parent:Sn._currentValue,pool:r}}var Ou=Error(n(460)),Wb=Error(n(474)),Xh=Error(n(542)),ip={then:function(){}};function Jb(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Wh(){}function Zb(r,o,c){switch(c=r[c],c===void 0?r.push(o):c!==o&&(o.then(Wh,Wh),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,t0(r),r;default:if(typeof o.status=="string")o.then(Wh,Wh);else{if(r=Lt,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(d){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=d}},function(d){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=d}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,t0(r),r}throw Vu=o,Ou}}var Vu=null;function e0(){if(Vu===null)throw Error(n(459));var r=Vu;return Vu=null,r}function t0(r){if(r===Ou||r===Xh)throw Error(n(483))}var di=!1;function op(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lp(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function hi(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function fi(r,o,c){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(Tt&2)!==0){var g=d.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),d.pending=o,o=zh(r),Bb(r,null,c),o}return qh(r,d,o,c),zh(r)}function Lu(r,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var d=o.lanes;d&=r.pendingLanes,c|=d,o.lanes=c,qt(r,c)}}function cp(r,o){var c=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var g=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var N={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?g=y=N:y=y.next=N,c=c.next}while(c!==null);y===null?g=y=o:y=y.next=o}else g=y=o;c={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=o:r.next=o,c.lastBaseUpdate=o}var up=!1;function Fu(){if(up){var r=$l;if(r!==null)throw r}}function Uu(r,o,c,d){up=!1;var g=r.updateQueue;di=!1;var y=g.firstBaseUpdate,N=g.lastBaseUpdate,S=g.shared.pending;if(S!==null){g.shared.pending=null;var H=S,se=H.next;H.next=null,N===null?y=se:N.next=se,N=H;var de=r.alternate;de!==null&&(de=de.updateQueue,S=de.lastBaseUpdate,S!==N&&(S===null?de.firstBaseUpdate=se:S.next=se,de.lastBaseUpdate=H))}if(y!==null){var me=g.baseState;N=0,de=se=H=null,S=y;do{var ae=S.lane&-536870913,ie=ae!==S.lane;if(ie?(ht&ae)===ae:(d&ae)===ae){ae!==0&&ae===Gl&&(up=!0),de!==null&&(de=de.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var He=r,Ue=S;ae=o;var Dt=c;switch(Ue.tag){case 1:if(He=Ue.payload,typeof He=="function"){me=He.call(Dt,me,ae);break e}me=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=Ue.payload,ae=typeof He=="function"?He.call(Dt,me,ae):He,ae==null)break e;me=x({},me,ae);break e;case 2:di=!0}}ae=S.callback,ae!==null&&(r.flags|=64,ie&&(r.flags|=8192),ie=g.callbacks,ie===null?g.callbacks=[ae]:ie.push(ae))}else ie={lane:ae,tag:S.tag,payload:S.payload,callback:S.callback,next:null},de===null?(se=de=ie,H=me):de=de.next=ie,N|=ae;if(S=S.next,S===null){if(S=g.shared.pending,S===null)break;ie=S,S=ie.next,ie.next=null,g.lastBaseUpdate=ie,g.shared.pending=null}}while(!0);de===null&&(H=me),g.baseState=H,g.firstBaseUpdate=se,g.lastBaseUpdate=de,y===null&&(g.shared.lanes=0),wi|=N,r.lanes=N,r.memoizedState=me}}function n0(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function s0(r,o){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)n0(c[r],o)}var Kl=ne(null),Jh=ne(0);function r0(r,o){r=Da,ue(Jh,r),ue(Kl,o),Da=r|o.baseLanes}function dp(){ue(Jh,Da),ue(Kl,Kl.current)}function hp(){Da=Jh.current,ve(Kl),ve(Jh)}var mi=0,Je=null,Rt=null,mn=null,Zh=!1,Ql=!1,Vo=!1,ef=0,Bu=0,Yl=null,o2=0;function cn(){throw Error(n(321))}function fp(r,o){if(o===null)return!1;for(var c=0;c<o.length&&c<r.length;c++)if(!Fs(r[c],o[c]))return!1;return!0}function mp(r,o,c,d,g,y){return mi=y,Je=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,O.H=r===null||r.memoizedState===null?B0:q0,Vo=!1,y=c(d,g),Vo=!1,Ql&&(y=i0(o,c,d,g)),a0(r),y}function a0(r){O.H=of;var o=Rt!==null&&Rt.next!==null;if(mi=0,mn=Rt=Je=null,Zh=!1,Bu=0,Yl=null,o)throw Error(n(300));r===null||Ln||(r=r.dependencies,r!==null&&Kh(r)&&(Ln=!0))}function i0(r,o,c,d){Je=r;var g=0;do{if(Ql&&(Yl=null),Bu=0,Ql=!1,25<=g)throw Error(n(301));if(g+=1,mn=Rt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}O.H=m2,y=o(c,d)}while(Ql);return y}function l2(){var r=O.H,o=r.useState()[0];return o=typeof o.then=="function"?qu(o):o,r=r.useState()[0],(Rt!==null?Rt.memoizedState:null)!==r&&(Je.flags|=1024),o}function gp(){var r=ef!==0;return ef=0,r}function pp(r,o,c){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~c}function yp(r){if(Zh){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Zh=!1}mi=0,mn=Rt=Je=null,Ql=!1,Bu=ef=0,Yl=null}function xs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mn===null?Je.memoizedState=mn=r:mn=mn.next=r,mn}function gn(){if(Rt===null){var r=Je.alternate;r=r!==null?r.memoizedState:null}else r=Rt.next;var o=mn===null?Je.memoizedState:mn.next;if(o!==null)mn=o,Rt=r;else{if(r===null)throw Je.alternate===null?Error(n(467)):Error(n(310));Rt=r,r={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},mn===null?Je.memoizedState=mn=r:mn=mn.next=r}return mn}function xp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function qu(r){var o=Bu;return Bu+=1,Yl===null&&(Yl=[]),r=Zb(Yl,r,o),o=Je,(mn===null?o.memoizedState:mn.next)===null&&(o=o.alternate,O.H=o===null||o.memoizedState===null?B0:q0),r}function tf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return qu(r);if(r.$$typeof===q)return ns(r)}throw Error(n(438,String(r)))}function vp(r){var o=null,c=Je.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var d=Je.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(o={data:d.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=xp(),Je.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(r),d=0;d<r;d++)c[d]=F;return o.index++,c}function Aa(r,o){return typeof o=="function"?o(r):o}function nf(r){var o=gn();return bp(o,Rt,r)}function bp(r,o,c){var d=r.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var g=r.baseQueue,y=d.pending;if(y!==null){if(g!==null){var N=g.next;g.next=y.next,y.next=N}o.baseQueue=g=y,d.pending=null}if(y=r.baseState,g===null)r.memoizedState=y;else{o=g.next;var S=N=null,H=null,se=o,de=!1;do{var me=se.lane&-536870913;if(me!==se.lane?(ht&me)===me:(mi&me)===me){var ae=se.revertLane;if(ae===0)H!==null&&(H=H.next={lane:0,revertLane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),me===Gl&&(de=!0);else if((mi&ae)===ae){se=se.next,ae===Gl&&(de=!0);continue}else me={lane:0,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},H===null?(S=H=me,N=y):H=H.next=me,Je.lanes|=ae,wi|=ae;me=se.action,Vo&&c(y,me),y=se.hasEagerState?se.eagerState:c(y,me)}else ae={lane:me,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},H===null?(S=H=ae,N=y):H=H.next=ae,Je.lanes|=me,wi|=me;se=se.next}while(se!==null&&se!==o);if(H===null?N=y:H.next=S,!Fs(y,r.memoizedState)&&(Ln=!0,de&&(c=$l,c!==null)))throw c;r.memoizedState=y,r.baseState=N,r.baseQueue=H,d.lastRenderedState=y}return g===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function wp(r){var o=gn(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=r;var d=c.dispatch,g=c.pending,y=o.memoizedState;if(g!==null){c.pending=null;var N=g=g.next;do y=r(y,N.action),N=N.next;while(N!==g);Fs(y,o.memoizedState)||(Ln=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),c.lastRenderedState=y}return[y,d]}function o0(r,o,c){var d=Je,g=gn(),y=xt;if(y){if(c===void 0)throw Error(n(407));c=c()}else c=o();var N=!Fs((Rt||g).memoizedState,c);N&&(g.memoizedState=c,Ln=!0),g=g.queue;var S=u0.bind(null,d,g,r);if(zu(2048,8,S,[r]),g.getSnapshot!==o||N||mn!==null&&mn.memoizedState.tag&1){if(d.flags|=2048,Xl(9,sf(),c0.bind(null,d,g,c,o),null),Lt===null)throw Error(n(349));y||(mi&124)!==0||l0(d,o,c)}return c}function l0(r,o,c){r.flags|=16384,r={getSnapshot:o,value:c},o=Je.updateQueue,o===null?(o=xp(),Je.updateQueue=o,o.stores=[r]):(c=o.stores,c===null?o.stores=[r]:c.push(r))}function c0(r,o,c,d){o.value=c,o.getSnapshot=d,d0(o)&&h0(r)}function u0(r,o,c){return c(function(){d0(o)&&h0(r)})}function d0(r){var o=r.getSnapshot;r=r.value;try{var c=o();return!Fs(r,c)}catch{return!0}}function h0(r){var o=Bl(r,2);o!==null&&Gs(o,r,2)}function _p(r){var o=xs();if(typeof r=="function"){var c=r;if(r=c(),Vo){es(!0);try{c()}finally{es(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:r},o}function f0(r,o,c,d){return r.baseState=c,bp(r,Rt,typeof d=="function"?d:Aa)}function c2(r,o,c,d,g){if(af(r))throw Error(n(485));if(r=o.action,r!==null){var y={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){y.listeners.push(N)}};O.T!==null?c(!0):y.isTransition=!1,d(y),c=o.pending,c===null?(y.next=o.pending=y,m0(o,y)):(y.next=c.next,o.pending=c.next=y)}}function m0(r,o){var c=o.action,d=o.payload,g=r.state;if(o.isTransition){var y=O.T,N={};O.T=N;try{var S=c(g,d),H=O.S;H!==null&&H(N,S),g0(r,o,S)}catch(se){Np(r,o,se)}finally{O.T=y}}else try{y=c(g,d),g0(r,o,y)}catch(se){Np(r,o,se)}}function g0(r,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){p0(r,o,d)},function(d){return Np(r,o,d)}):p0(r,o,c)}function p0(r,o,c){o.status="fulfilled",o.value=c,y0(o),r.state=c,o=r.pending,o!==null&&(c=o.next,c===o?r.pending=null:(c=c.next,o.next=c,m0(r,c)))}function Np(r,o,c){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do o.status="rejected",o.reason=c,y0(o),o=o.next;while(o!==d)}r.action=null}function y0(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function x0(r,o){return o}function v0(r,o){if(xt){var c=Lt.formState;if(c!==null){e:{var d=Je;if(xt){if(sn){t:{for(var g=sn,y=Jr;g.nodeType!==8;){if(!y){g=null;break t}if(g=Cr(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){sn=Cr(g.nextSibling),d=g.data==="F!";break e}}Do(d)}d=!1}d&&(o=c[0])}}return c=xs(),c.memoizedState=c.baseState=o,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x0,lastRenderedState:o},c.queue=d,c=L0.bind(null,Je,d),d.dispatch=c,d=_p(!1),y=jp.bind(null,Je,!1,d.queue),d=xs(),g={state:o,dispatch:null,action:r,pending:null},d.queue=g,c=c2.bind(null,Je,g,y,c),g.dispatch=c,d.memoizedState=r,[o,c,!1]}function b0(r){var o=gn();return w0(o,Rt,r)}function w0(r,o,c){if(o=bp(r,o,x0)[0],r=nf(Aa)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var d=qu(o)}catch(N){throw N===Ou?Xh:N}else d=o;o=gn();var g=o.queue,y=g.dispatch;return c!==o.memoizedState&&(Je.flags|=2048,Xl(9,sf(),u2.bind(null,g,c),null)),[d,y,r]}function u2(r,o){r.action=o}function _0(r){var o=gn(),c=Rt;if(c!==null)return w0(o,c,r);gn(),o=o.memoizedState,c=gn();var d=c.queue.dispatch;return c.memoizedState=r,[o,d,!1]}function Xl(r,o,c,d){return r={tag:r,create:c,deps:d,inst:o,next:null},o=Je.updateQueue,o===null&&(o=xp(),Je.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=r.next=r:(d=c.next,c.next=r,r.next=d,o.lastEffect=r),r}function sf(){return{destroy:void 0,resource:void 0}}function N0(){return gn().memoizedState}function rf(r,o,c,d){var g=xs();d=d===void 0?null:d,Je.flags|=r,g.memoizedState=Xl(1|o,sf(),c,d)}function zu(r,o,c,d){var g=gn();d=d===void 0?null:d;var y=g.memoizedState.inst;Rt!==null&&d!==null&&fp(d,Rt.memoizedState.deps)?g.memoizedState=Xl(o,y,c,d):(Je.flags|=r,g.memoizedState=Xl(1|o,y,c,d))}function T0(r,o){rf(8390656,8,r,o)}function E0(r,o){zu(2048,8,r,o)}function S0(r,o){return zu(4,2,r,o)}function A0(r,o){return zu(4,4,r,o)}function j0(r,o){if(typeof o=="function"){r=r();var c=o(r);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function I0(r,o,c){c=c!=null?c.concat([r]):null,zu(4,4,j0.bind(null,o,r),c)}function Tp(){}function C0(r,o){var c=gn();o=o===void 0?null:o;var d=c.memoizedState;return o!==null&&fp(o,d[1])?d[0]:(c.memoizedState=[r,o],r)}function R0(r,o){var c=gn();o=o===void 0?null:o;var d=c.memoizedState;if(o!==null&&fp(o,d[1]))return d[0];if(d=r(),Vo){es(!0);try{r()}finally{es(!1)}}return c.memoizedState=[d,o],d}function Ep(r,o,c){return c===void 0||(mi&1073741824)!==0?r.memoizedState=o:(r.memoizedState=c,r=Pw(),Je.lanes|=r,wi|=r,c)}function k0(r,o,c,d){return Fs(c,o)?c:Kl.current!==null?(r=Ep(r,c,d),Fs(r,o)||(Ln=!0),r):(mi&42)===0?(Ln=!0,r.memoizedState=c):(r=Pw(),Je.lanes|=r,wi|=r,o)}function D0(r,o,c,d,g){var y=oe.p;oe.p=y!==0&&8>y?y:8;var N=O.T,S={};O.T=S,jp(r,!1,o,c);try{var H=g(),se=O.S;if(se!==null&&se(S,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var de=i2(H,d);Hu(r,o,de,Hs(r))}else Hu(r,o,d,Hs(r))}catch(me){Hu(r,o,{then:function(){},status:"rejected",reason:me},Hs())}finally{oe.p=y,O.T=N}}function d2(){}function Sp(r,o,c,d){if(r.tag!==5)throw Error(n(476));var g=P0(r).queue;D0(r,g,o,$,c===null?d2:function(){return M0(r),c(d)})}function P0(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:$},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:c},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function M0(r){var o=P0(r).next.queue;Hu(r,o,{},Hs())}function Ap(){return ns(ld)}function O0(){return gn().memoizedState}function V0(){return gn().memoizedState}function h2(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var c=Hs();r=hi(c);var d=fi(o,r,c);d!==null&&(Gs(d,o,c),Lu(d,o,c)),o={cache:sp()},r.payload=o;return}o=o.return}}function f2(r,o,c){var d=Hs();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},af(r)?F0(o,c):(c=Kg(r,o,c,d),c!==null&&(Gs(c,r,d),U0(c,o,d)))}function L0(r,o,c){var d=Hs();Hu(r,o,c,d)}function Hu(r,o,c,d){var g={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(af(r))F0(o,g);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var N=o.lastRenderedState,S=y(N,c);if(g.hasEagerState=!0,g.eagerState=S,Fs(S,N))return qh(r,o,g,0),Lt===null&&Bh(),!1}catch{}finally{}if(c=Kg(r,o,g,d),c!==null)return Gs(c,r,d),U0(c,o,d),!0}return!1}function jp(r,o,c,d){if(d={lane:2,revertLane:iy(),action:d,hasEagerState:!1,eagerState:null,next:null},af(r)){if(o)throw Error(n(479))}else o=Kg(r,c,d,2),o!==null&&Gs(o,r,2)}function af(r){var o=r.alternate;return r===Je||o!==null&&o===Je}function F0(r,o){Ql=Zh=!0;var c=r.pending;c===null?o.next=o:(o.next=c.next,c.next=o),r.pending=o}function U0(r,o,c){if((c&4194048)!==0){var d=o.lanes;d&=r.pendingLanes,c|=d,o.lanes=c,qt(r,c)}}var of={readContext:ns,use:tf,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useLayoutEffect:cn,useInsertionEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useSyncExternalStore:cn,useId:cn,useHostTransitionStatus:cn,useFormState:cn,useActionState:cn,useOptimistic:cn,useMemoCache:cn,useCacheRefresh:cn},B0={readContext:ns,use:tf,useCallback:function(r,o){return xs().memoizedState=[r,o===void 0?null:o],r},useContext:ns,useEffect:T0,useImperativeHandle:function(r,o,c){c=c!=null?c.concat([r]):null,rf(4194308,4,j0.bind(null,o,r),c)},useLayoutEffect:function(r,o){return rf(4194308,4,r,o)},useInsertionEffect:function(r,o){rf(4,2,r,o)},useMemo:function(r,o){var c=xs();o=o===void 0?null:o;var d=r();if(Vo){es(!0);try{r()}finally{es(!1)}}return c.memoizedState=[d,o],d},useReducer:function(r,o,c){var d=xs();if(c!==void 0){var g=c(o);if(Vo){es(!0);try{c(o)}finally{es(!1)}}}else g=o;return d.memoizedState=d.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},d.queue=r,r=r.dispatch=f2.bind(null,Je,r),[d.memoizedState,r]},useRef:function(r){var o=xs();return r={current:r},o.memoizedState=r},useState:function(r){r=_p(r);var o=r.queue,c=L0.bind(null,Je,o);return o.dispatch=c,[r.memoizedState,c]},useDebugValue:Tp,useDeferredValue:function(r,o){var c=xs();return Ep(c,r,o)},useTransition:function(){var r=_p(!1);return r=D0.bind(null,Je,r.queue,!0,!1),xs().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,c){var d=Je,g=xs();if(xt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),Lt===null)throw Error(n(349));(ht&124)!==0||l0(d,o,c)}g.memoizedState=c;var y={value:c,getSnapshot:o};return g.queue=y,T0(u0.bind(null,d,y,r),[r]),d.flags|=2048,Xl(9,sf(),c0.bind(null,d,y,c,o),null),c},useId:function(){var r=xs(),o=Lt.identifierPrefix;if(xt){var c=Ta,d=Na;c=(d&~(1<<32-_n(d)-1)).toString(32)+c,o="«"+o+"R"+c,c=ef++,0<c&&(o+="H"+c.toString(32)),o+="»"}else c=o2++,o="«"+o+"r"+c.toString(32)+"»";return r.memoizedState=o},useHostTransitionStatus:Ap,useFormState:v0,useActionState:v0,useOptimistic:function(r){var o=xs();o.memoizedState=o.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=jp.bind(null,Je,!0,c),c.dispatch=o,[r,o]},useMemoCache:vp,useCacheRefresh:function(){return xs().memoizedState=h2.bind(null,Je)}},q0={readContext:ns,use:tf,useCallback:C0,useContext:ns,useEffect:E0,useImperativeHandle:I0,useInsertionEffect:S0,useLayoutEffect:A0,useMemo:R0,useReducer:nf,useRef:N0,useState:function(){return nf(Aa)},useDebugValue:Tp,useDeferredValue:function(r,o){var c=gn();return k0(c,Rt.memoizedState,r,o)},useTransition:function(){var r=nf(Aa)[0],o=gn().memoizedState;return[typeof r=="boolean"?r:qu(r),o]},useSyncExternalStore:o0,useId:O0,useHostTransitionStatus:Ap,useFormState:b0,useActionState:b0,useOptimistic:function(r,o){var c=gn();return f0(c,Rt,r,o)},useMemoCache:vp,useCacheRefresh:V0},m2={readContext:ns,use:tf,useCallback:C0,useContext:ns,useEffect:E0,useImperativeHandle:I0,useInsertionEffect:S0,useLayoutEffect:A0,useMemo:R0,useReducer:wp,useRef:N0,useState:function(){return wp(Aa)},useDebugValue:Tp,useDeferredValue:function(r,o){var c=gn();return Rt===null?Ep(c,r,o):k0(c,Rt.memoizedState,r,o)},useTransition:function(){var r=wp(Aa)[0],o=gn().memoizedState;return[typeof r=="boolean"?r:qu(r),o]},useSyncExternalStore:o0,useId:O0,useHostTransitionStatus:Ap,useFormState:_0,useActionState:_0,useOptimistic:function(r,o){var c=gn();return Rt!==null?f0(c,Rt,r,o):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:vp,useCacheRefresh:V0},Wl=null,Gu=0;function lf(r){var o=Gu;return Gu+=1,Wl===null&&(Wl=[]),Zb(Wl,r,o)}function $u(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function cf(r,o){throw o.$$typeof===w?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function z0(r){var o=r._init;return o(r._payload)}function H0(r){function o(X,K){if(r){var ee=X.deletions;ee===null?(X.deletions=[K],X.flags|=16):ee.push(K)}}function c(X,K){if(!r)return null;for(;K!==null;)o(X,K),K=K.sibling;return null}function d(X){for(var K=new Map;X!==null;)X.key!==null?K.set(X.key,X):K.set(X.index,X),X=X.sibling;return K}function g(X,K){return X=_a(X,K),X.index=0,X.sibling=null,X}function y(X,K,ee){return X.index=ee,r?(ee=X.alternate,ee!==null?(ee=ee.index,ee<K?(X.flags|=67108866,K):ee):(X.flags|=67108866,K)):(X.flags|=1048576,K)}function N(X){return r&&X.alternate===null&&(X.flags|=67108866),X}function S(X,K,ee,fe){return K===null||K.tag!==6?(K=Yg(ee,X.mode,fe),K.return=X,K):(K=g(K,ee),K.return=X,K)}function H(X,K,ee,fe){var Re=ee.type;return Re===R?de(X,K,ee.props.children,fe,ee.key):K!==null&&(K.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===T&&z0(Re)===K.type)?(K=g(K,ee.props),$u(K,ee),K.return=X,K):(K=Hh(ee.type,ee.key,ee.props,null,X.mode,fe),$u(K,ee),K.return=X,K)}function se(X,K,ee,fe){return K===null||K.tag!==4||K.stateNode.containerInfo!==ee.containerInfo||K.stateNode.implementation!==ee.implementation?(K=Xg(ee,X.mode,fe),K.return=X,K):(K=g(K,ee.children||[]),K.return=X,K)}function de(X,K,ee,fe,Re){return K===null||K.tag!==7?(K=Io(ee,X.mode,fe,Re),K.return=X,K):(K=g(K,ee),K.return=X,K)}function me(X,K,ee){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=Yg(""+K,X.mode,ee),K.return=X,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case b:return ee=Hh(K.type,K.key,K.props,null,X.mode,ee),$u(ee,K),ee.return=X,ee;case E:return K=Xg(K,X.mode,ee),K.return=X,K;case T:var fe=K._init;return K=fe(K._payload),me(X,K,ee)}if(Z(K)||V(K))return K=Io(K,X.mode,ee,null),K.return=X,K;if(typeof K.then=="function")return me(X,lf(K),ee);if(K.$$typeof===q)return me(X,Qh(X,K),ee);cf(X,K)}return null}function ae(X,K,ee,fe){var Re=K!==null?K.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return Re!==null?null:S(X,K,""+ee,fe);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case b:return ee.key===Re?H(X,K,ee,fe):null;case E:return ee.key===Re?se(X,K,ee,fe):null;case T:return Re=ee._init,ee=Re(ee._payload),ae(X,K,ee,fe)}if(Z(ee)||V(ee))return Re!==null?null:de(X,K,ee,fe,null);if(typeof ee.then=="function")return ae(X,K,lf(ee),fe);if(ee.$$typeof===q)return ae(X,K,Qh(X,ee),fe);cf(X,ee)}return null}function ie(X,K,ee,fe,Re){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return X=X.get(ee)||null,S(K,X,""+fe,Re);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case b:return X=X.get(fe.key===null?ee:fe.key)||null,H(K,X,fe,Re);case E:return X=X.get(fe.key===null?ee:fe.key)||null,se(K,X,fe,Re);case T:var et=fe._init;return fe=et(fe._payload),ie(X,K,ee,fe,Re)}if(Z(fe)||V(fe))return X=X.get(ee)||null,de(K,X,fe,Re,null);if(typeof fe.then=="function")return ie(X,K,ee,lf(fe),Re);if(fe.$$typeof===q)return ie(X,K,ee,Qh(K,fe),Re);cf(K,fe)}return null}function He(X,K,ee,fe){for(var Re=null,et=null,Ve=K,Be=K=0,Un=null;Ve!==null&&Be<ee.length;Be++){Ve.index>Be?(Un=Ve,Ve=null):Un=Ve.sibling;var yt=ae(X,Ve,ee[Be],fe);if(yt===null){Ve===null&&(Ve=Un);break}r&&Ve&&yt.alternate===null&&o(X,Ve),K=y(yt,K,Be),et===null?Re=yt:et.sibling=yt,et=yt,Ve=Un}if(Be===ee.length)return c(X,Ve),xt&&Ro(X,Be),Re;if(Ve===null){for(;Be<ee.length;Be++)Ve=me(X,ee[Be],fe),Ve!==null&&(K=y(Ve,K,Be),et===null?Re=Ve:et.sibling=Ve,et=Ve);return xt&&Ro(X,Be),Re}for(Ve=d(Ve);Be<ee.length;Be++)Un=ie(Ve,X,Be,ee[Be],fe),Un!==null&&(r&&Un.alternate!==null&&Ve.delete(Un.key===null?Be:Un.key),K=y(Un,K,Be),et===null?Re=Un:et.sibling=Un,et=Un);return r&&Ve.forEach(function(Ci){return o(X,Ci)}),xt&&Ro(X,Be),Re}function Ue(X,K,ee,fe){if(ee==null)throw Error(n(151));for(var Re=null,et=null,Ve=K,Be=K=0,Un=null,yt=ee.next();Ve!==null&&!yt.done;Be++,yt=ee.next()){Ve.index>Be?(Un=Ve,Ve=null):Un=Ve.sibling;var Ci=ae(X,Ve,yt.value,fe);if(Ci===null){Ve===null&&(Ve=Un);break}r&&Ve&&Ci.alternate===null&&o(X,Ve),K=y(Ci,K,Be),et===null?Re=Ci:et.sibling=Ci,et=Ci,Ve=Un}if(yt.done)return c(X,Ve),xt&&Ro(X,Be),Re;if(Ve===null){for(;!yt.done;Be++,yt=ee.next())yt=me(X,yt.value,fe),yt!==null&&(K=y(yt,K,Be),et===null?Re=yt:et.sibling=yt,et=yt);return xt&&Ro(X,Be),Re}for(Ve=d(Ve);!yt.done;Be++,yt=ee.next())yt=ie(Ve,X,Be,yt.value,fe),yt!==null&&(r&&yt.alternate!==null&&Ve.delete(yt.key===null?Be:yt.key),K=y(yt,K,Be),et===null?Re=yt:et.sibling=yt,et=yt);return r&&Ve.forEach(function(gI){return o(X,gI)}),xt&&Ro(X,Be),Re}function Dt(X,K,ee,fe){if(typeof ee=="object"&&ee!==null&&ee.type===R&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case b:e:{for(var Re=ee.key;K!==null;){if(K.key===Re){if(Re=ee.type,Re===R){if(K.tag===7){c(X,K.sibling),fe=g(K,ee.props.children),fe.return=X,X=fe;break e}}else if(K.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===T&&z0(Re)===K.type){c(X,K.sibling),fe=g(K,ee.props),$u(fe,ee),fe.return=X,X=fe;break e}c(X,K);break}else o(X,K);K=K.sibling}ee.type===R?(fe=Io(ee.props.children,X.mode,fe,ee.key),fe.return=X,X=fe):(fe=Hh(ee.type,ee.key,ee.props,null,X.mode,fe),$u(fe,ee),fe.return=X,X=fe)}return N(X);case E:e:{for(Re=ee.key;K!==null;){if(K.key===Re)if(K.tag===4&&K.stateNode.containerInfo===ee.containerInfo&&K.stateNode.implementation===ee.implementation){c(X,K.sibling),fe=g(K,ee.children||[]),fe.return=X,X=fe;break e}else{c(X,K);break}else o(X,K);K=K.sibling}fe=Xg(ee,X.mode,fe),fe.return=X,X=fe}return N(X);case T:return Re=ee._init,ee=Re(ee._payload),Dt(X,K,ee,fe)}if(Z(ee))return He(X,K,ee,fe);if(V(ee)){if(Re=V(ee),typeof Re!="function")throw Error(n(150));return ee=Re.call(ee),Ue(X,K,ee,fe)}if(typeof ee.then=="function")return Dt(X,K,lf(ee),fe);if(ee.$$typeof===q)return Dt(X,K,Qh(X,ee),fe);cf(X,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,K!==null&&K.tag===6?(c(X,K.sibling),fe=g(K,ee),fe.return=X,X=fe):(c(X,K),fe=Yg(ee,X.mode,fe),fe.return=X,X=fe),N(X)):c(X,K)}return function(X,K,ee,fe){try{Gu=0;var Re=Dt(X,K,ee,fe);return Wl=null,Re}catch(Ve){if(Ve===Ou||Ve===Xh)throw Ve;var et=Us(29,Ve,null,X.mode);return et.lanes=fe,et.return=X,et}finally{}}}var Jl=H0(!0),G0=H0(!1),fr=ne(null),Zr=null;function gi(r){var o=r.alternate;ue(An,An.current&1),ue(fr,r),Zr===null&&(o===null||Kl.current!==null||o.memoizedState!==null)&&(Zr=r)}function $0(r){if(r.tag===22){if(ue(An,An.current),ue(fr,r),Zr===null){var o=r.alternate;o!==null&&o.memoizedState!==null&&(Zr=r)}}else pi()}function pi(){ue(An,An.current),ue(fr,fr.current)}function ja(r){ve(fr),Zr===r&&(Zr=null),ve(An)}var An=ne(0);function uf(r){for(var o=r;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||xy(c)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Ip(r,o,c,d){o=r.memoizedState,c=c(d,o),c=c==null?o:x({},o,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Cp={enqueueSetState:function(r,o,c){r=r._reactInternals;var d=Hs(),g=hi(d);g.payload=o,c!=null&&(g.callback=c),o=fi(r,g,d),o!==null&&(Gs(o,r,d),Lu(o,r,d))},enqueueReplaceState:function(r,o,c){r=r._reactInternals;var d=Hs(),g=hi(d);g.tag=1,g.payload=o,c!=null&&(g.callback=c),o=fi(r,g,d),o!==null&&(Gs(o,r,d),Lu(o,r,d))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var c=Hs(),d=hi(c);d.tag=2,o!=null&&(d.callback=o),o=fi(r,d,c),o!==null&&(Gs(o,r,c),Lu(o,r,c))}};function K0(r,o,c,d,g,y,N){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,y,N):o.prototype&&o.prototype.isPureReactComponent?!ju(c,d)||!ju(g,y):!0}function Q0(r,o,c,d){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,d),o.state!==r&&Cp.enqueueReplaceState(o,o.state,null)}function Lo(r,o){var c=o;if("ref"in o){c={};for(var d in o)d!=="ref"&&(c[d]=o[d])}if(r=r.defaultProps){c===o&&(c=x({},c));for(var g in r)c[g]===void 0&&(c[g]=r[g])}return c}var df=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function Y0(r){df(r)}function X0(r){console.error(r)}function W0(r){df(r)}function hf(r,o){try{var c=r.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(d){setTimeout(function(){throw d})}}function J0(r,o,c){try{var d=r.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Rp(r,o,c){return c=hi(c),c.tag=3,c.payload={element:null},c.callback=function(){hf(r,o)},c}function Z0(r){return r=hi(r),r.tag=3,r}function ew(r,o,c,d){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var y=d.value;r.payload=function(){return g(y)},r.callback=function(){J0(o,c,d)}}var N=c.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(r.callback=function(){J0(o,c,d),typeof g!="function"&&(_i===null?_i=new Set([this]):_i.add(this));var S=d.stack;this.componentDidCatch(d.value,{componentStack:S!==null?S:""})})}function g2(r,o,c,d,g){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(o=c.alternate,o!==null&&Du(o,c,g,!0),c=fr.current,c!==null){switch(c.tag){case 13:return Zr===null?ty():c.alternate===null&&rn===0&&(rn=3),c.flags&=-257,c.flags|=65536,c.lanes=g,d===ip?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([d]):o.add(d),sy(r,d,g)),!1;case 22:return c.flags|=65536,d===ip?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([d]):c.add(d)),sy(r,d,g)),!1}throw Error(n(435,c.tag))}return sy(r,d,g),ty(),!1}if(xt)return o=fr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,d!==Zg&&(r=Error(n(422),{cause:d}),ku(cr(r,c)))):(d!==Zg&&(o=Error(n(423),{cause:d}),ku(cr(o,c))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,d=cr(d,c),g=Rp(r.stateNode,d,g),cp(r,g),rn!==4&&(rn=2)),!1;var y=Error(n(520),{cause:d});if(y=cr(y,c),Zu===null?Zu=[y]:Zu.push(y),rn!==4&&(rn=2),o===null)return!0;d=cr(d,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,r=g&-g,c.lanes|=r,r=Rp(c.stateNode,d,r),cp(c,r),!1;case 1:if(o=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(_i===null||!_i.has(y))))return c.flags|=65536,g&=-g,c.lanes|=g,g=Z0(g),ew(g,r,c,d),cp(c,g),!1}c=c.return}while(c!==null);return!1}var tw=Error(n(461)),Ln=!1;function Yn(r,o,c,d){o.child=r===null?G0(o,null,c,d):Jl(o,r.child,c,d)}function nw(r,o,c,d,g){c=c.render;var y=o.ref;if("ref"in d){var N={};for(var S in d)S!=="ref"&&(N[S]=d[S])}else N=d;return Mo(o),d=mp(r,o,c,N,y,g),S=gp(),r!==null&&!Ln?(pp(r,o,g),Ia(r,o,g)):(xt&&S&&Wg(o),o.flags|=1,Yn(r,o,d,g),o.child)}function sw(r,o,c,d,g){if(r===null){var y=c.type;return typeof y=="function"&&!Qg(y)&&y.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=y,rw(r,o,y,d,g)):(r=Hh(c.type,null,d,o,o.mode,g),r.ref=o.ref,r.return=o,o.child=r)}if(y=r.child,!Fp(r,g)){var N=y.memoizedProps;if(c=c.compare,c=c!==null?c:ju,c(N,d)&&r.ref===o.ref)return Ia(r,o,g)}return o.flags|=1,r=_a(y,d),r.ref=o.ref,r.return=o,o.child=r}function rw(r,o,c,d,g){if(r!==null){var y=r.memoizedProps;if(ju(y,d)&&r.ref===o.ref)if(Ln=!1,o.pendingProps=d=y,Fp(r,g))(r.flags&131072)!==0&&(Ln=!0);else return o.lanes=r.lanes,Ia(r,o,g)}return kp(r,o,c,d,g)}function aw(r,o,c){var d=o.pendingProps,g=d.children,y=r!==null?r.memoizedState:null;if(d.mode==="hidden"){if((o.flags&128)!==0){if(d=y!==null?y.baseLanes|c:c,r!==null){for(g=o.child=r.child,y=0;g!==null;)y=y|g.lanes|g.childLanes,g=g.sibling;o.childLanes=y&~d}else o.childLanes=0,o.child=null;return iw(r,o,d,c)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Yh(o,y!==null?y.cachePool:null),y!==null?r0(o,y):dp(),$0(o);else return o.lanes=o.childLanes=536870912,iw(r,o,y!==null?y.baseLanes|c:c,c)}else y!==null?(Yh(o,y.cachePool),r0(o,y),pi(),o.memoizedState=null):(r!==null&&Yh(o,null),dp(),pi());return Yn(r,o,g,c),o.child}function iw(r,o,c,d){var g=ap();return g=g===null?null:{parent:Sn._currentValue,pool:g},o.memoizedState={baseLanes:c,cachePool:g},r!==null&&Yh(o,null),dp(),$0(o),r!==null&&Du(r,o,d,!0),null}function ff(r,o){var c=o.ref;if(c===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(r===null||r.ref!==c)&&(o.flags|=4194816)}}function kp(r,o,c,d,g){return Mo(o),c=mp(r,o,c,d,void 0,g),d=gp(),r!==null&&!Ln?(pp(r,o,g),Ia(r,o,g)):(xt&&d&&Wg(o),o.flags|=1,Yn(r,o,c,g),o.child)}function ow(r,o,c,d,g,y){return Mo(o),o.updateQueue=null,c=i0(o,d,c,g),a0(r),d=gp(),r!==null&&!Ln?(pp(r,o,y),Ia(r,o,y)):(xt&&d&&Wg(o),o.flags|=1,Yn(r,o,c,y),o.child)}function lw(r,o,c,d,g){if(Mo(o),o.stateNode===null){var y=ql,N=c.contextType;typeof N=="object"&&N!==null&&(y=ns(N)),y=new c(d,y),o.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Cp,o.stateNode=y,y._reactInternals=o,y=o.stateNode,y.props=d,y.state=o.memoizedState,y.refs={},op(o),N=c.contextType,y.context=typeof N=="object"&&N!==null?ns(N):ql,y.state=o.memoizedState,N=c.getDerivedStateFromProps,typeof N=="function"&&(Ip(o,c,N,d),y.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(N=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),N!==y.state&&Cp.enqueueReplaceState(y,y.state,null),Uu(o,d,y,g),Fu(),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308),d=!0}else if(r===null){y=o.stateNode;var S=o.memoizedProps,H=Lo(c,S);y.props=H;var se=y.context,de=c.contextType;N=ql,typeof de=="object"&&de!==null&&(N=ns(de));var me=c.getDerivedStateFromProps;de=typeof me=="function"||typeof y.getSnapshotBeforeUpdate=="function",S=o.pendingProps!==S,de||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S||se!==N)&&Q0(o,y,d,N),di=!1;var ae=o.memoizedState;y.state=ae,Uu(o,d,y,g),Fu(),se=o.memoizedState,S||ae!==se||di?(typeof me=="function"&&(Ip(o,c,me,d),se=o.memoizedState),(H=di||K0(o,c,H,d,ae,se,N))?(de||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(o.flags|=4194308)):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=se),y.props=d,y.state=se,y.context=N,d=H):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{y=o.stateNode,lp(r,o),N=o.memoizedProps,de=Lo(c,N),y.props=de,me=o.pendingProps,ae=y.context,se=c.contextType,H=ql,typeof se=="object"&&se!==null&&(H=ns(se)),S=c.getDerivedStateFromProps,(se=typeof S=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(N!==me||ae!==H)&&Q0(o,y,d,H),di=!1,ae=o.memoizedState,y.state=ae,Uu(o,d,y,g),Fu();var ie=o.memoizedState;N!==me||ae!==ie||di||r!==null&&r.dependencies!==null&&Kh(r.dependencies)?(typeof S=="function"&&(Ip(o,c,S,d),ie=o.memoizedState),(de=di||K0(o,c,de,d,ae,ie,H)||r!==null&&r.dependencies!==null&&Kh(r.dependencies))?(se||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,ie,H),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,ie,H)),typeof y.componentDidUpdate=="function"&&(o.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof y.componentDidUpdate!="function"||N===r.memoizedProps&&ae===r.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||N===r.memoizedProps&&ae===r.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=ie),y.props=d,y.state=ie,y.context=H,d=de):(typeof y.componentDidUpdate!="function"||N===r.memoizedProps&&ae===r.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||N===r.memoizedProps&&ae===r.memoizedState||(o.flags|=1024),d=!1)}return y=d,ff(r,o),d=(o.flags&128)!==0,y||d?(y=o.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:y.render(),o.flags|=1,r!==null&&d?(o.child=Jl(o,r.child,null,g),o.child=Jl(o,null,c,g)):Yn(r,o,c,g),o.memoizedState=y.state,r=o.child):r=Ia(r,o,g),r}function cw(r,o,c,d){return Ru(),o.flags|=256,Yn(r,o,c,d),o.child}var Dp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pp(r){return{baseLanes:r,cachePool:Xb()}}function Mp(r,o,c){return r=r!==null?r.childLanes&~c:0,o&&(r|=mr),r}function uw(r,o,c){var d=o.pendingProps,g=!1,y=(o.flags&128)!==0,N;if((N=y)||(N=r!==null&&r.memoizedState===null?!1:(An.current&2)!==0),N&&(g=!0,o.flags&=-129),N=(o.flags&32)!==0,o.flags&=-33,r===null){if(xt){if(g?gi(o):pi(),xt){var S=sn,H;if(H=S){e:{for(H=S,S=Jr;H.nodeType!==8;){if(!S){S=null;break e}if(H=Cr(H.nextSibling),H===null){S=null;break e}}S=H}S!==null?(o.memoizedState={dehydrated:S,treeContext:Co!==null?{id:Na,overflow:Ta}:null,retryLane:536870912,hydrationErrors:null},H=Us(18,null,null,0),H.stateNode=S,H.return=o,o.child=H,ms=o,sn=null,H=!0):H=!1}H||Do(o)}if(S=o.memoizedState,S!==null&&(S=S.dehydrated,S!==null))return xy(S)?o.lanes=32:o.lanes=536870912,null;ja(o)}return S=d.children,d=d.fallback,g?(pi(),g=o.mode,S=mf({mode:"hidden",children:S},g),d=Io(d,g,c,null),S.return=o,d.return=o,S.sibling=d,o.child=S,g=o.child,g.memoizedState=Pp(c),g.childLanes=Mp(r,N,c),o.memoizedState=Dp,d):(gi(o),Op(o,S))}if(H=r.memoizedState,H!==null&&(S=H.dehydrated,S!==null)){if(y)o.flags&256?(gi(o),o.flags&=-257,o=Vp(r,o,c)):o.memoizedState!==null?(pi(),o.child=r.child,o.flags|=128,o=null):(pi(),g=d.fallback,S=o.mode,d=mf({mode:"visible",children:d.children},S),g=Io(g,S,c,null),g.flags|=2,d.return=o,g.return=o,d.sibling=g,o.child=d,Jl(o,r.child,null,c),d=o.child,d.memoizedState=Pp(c),d.childLanes=Mp(r,N,c),o.memoizedState=Dp,o=g);else if(gi(o),xy(S)){if(N=S.nextSibling&&S.nextSibling.dataset,N)var se=N.dgst;N=se,d=Error(n(419)),d.stack="",d.digest=N,ku({value:d,source:null,stack:null}),o=Vp(r,o,c)}else if(Ln||Du(r,o,c,!1),N=(c&r.childLanes)!==0,Ln||N){if(N=Lt,N!==null&&(d=c&-c,d=(d&42)!==0?1:ds(d),d=(d&(N.suspendedLanes|c))!==0?0:d,d!==0&&d!==H.retryLane))throw H.retryLane=d,Bl(r,d),Gs(N,r,d),tw;S.data==="$?"||ty(),o=Vp(r,o,c)}else S.data==="$?"?(o.flags|=192,o.child=r.child,o=null):(r=H.treeContext,sn=Cr(S.nextSibling),ms=o,xt=!0,ko=null,Jr=!1,r!==null&&(dr[hr++]=Na,dr[hr++]=Ta,dr[hr++]=Co,Na=r.id,Ta=r.overflow,Co=o),o=Op(o,d.children),o.flags|=4096);return o}return g?(pi(),g=d.fallback,S=o.mode,H=r.child,se=H.sibling,d=_a(H,{mode:"hidden",children:d.children}),d.subtreeFlags=H.subtreeFlags&65011712,se!==null?g=_a(se,g):(g=Io(g,S,c,null),g.flags|=2),g.return=o,d.return=o,d.sibling=g,o.child=d,d=g,g=o.child,S=r.child.memoizedState,S===null?S=Pp(c):(H=S.cachePool,H!==null?(se=Sn._currentValue,H=H.parent!==se?{parent:se,pool:se}:H):H=Xb(),S={baseLanes:S.baseLanes|c,cachePool:H}),g.memoizedState=S,g.childLanes=Mp(r,N,c),o.memoizedState=Dp,d):(gi(o),c=r.child,r=c.sibling,c=_a(c,{mode:"visible",children:d.children}),c.return=o,c.sibling=null,r!==null&&(N=o.deletions,N===null?(o.deletions=[r],o.flags|=16):N.push(r)),o.child=c,o.memoizedState=null,c)}function Op(r,o){return o=mf({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function mf(r,o){return r=Us(22,r,null,o),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Vp(r,o,c){return Jl(o,r.child,null,c),r=Op(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function dw(r,o,c){r.lanes|=o;var d=r.alternate;d!==null&&(d.lanes|=o),tp(r.return,o,c)}function Lp(r,o,c,d,g){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:g}:(y.isBackwards=o,y.rendering=null,y.renderingStartTime=0,y.last=d,y.tail=c,y.tailMode=g)}function hw(r,o,c){var d=o.pendingProps,g=d.revealOrder,y=d.tail;if(Yn(r,o,d.children,c),d=An.current,(d&2)!==0)d=d&1|2,o.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&dw(r,c,o);else if(r.tag===19)dw(r,c,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}d&=1}switch(ue(An,d),g){case"forwards":for(c=o.child,g=null;c!==null;)r=c.alternate,r!==null&&uf(r)===null&&(g=c),c=c.sibling;c=g,c===null?(g=o.child,o.child=null):(g=c.sibling,c.sibling=null),Lp(o,!1,g,c,y);break;case"backwards":for(c=null,g=o.child,o.child=null;g!==null;){if(r=g.alternate,r!==null&&uf(r)===null){o.child=g;break}r=g.sibling,g.sibling=c,c=g,g=r}Lp(o,!0,c,null,y);break;case"together":Lp(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ia(r,o,c){if(r!==null&&(o.dependencies=r.dependencies),wi|=o.lanes,(c&o.childLanes)===0)if(r!==null){if(Du(r,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,c=_a(r,r.pendingProps),o.child=c,c.return=o;r.sibling!==null;)r=r.sibling,c=c.sibling=_a(r,r.pendingProps),c.return=o;c.sibling=null}return o.child}function Fp(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&Kh(r)))}function p2(r,o,c){switch(o.tag){case 3:we(o,o.stateNode.containerInfo),ui(o,Sn,r.memoizedState.cache),Ru();break;case 27:case 5:Fe(o);break;case 4:we(o,o.stateNode.containerInfo);break;case 10:ui(o,o.type,o.memoizedProps.value);break;case 13:var d=o.memoizedState;if(d!==null)return d.dehydrated!==null?(gi(o),o.flags|=128,null):(c&o.child.childLanes)!==0?uw(r,o,c):(gi(o),r=Ia(r,o,c),r!==null?r.sibling:null);gi(o);break;case 19:var g=(r.flags&128)!==0;if(d=(c&o.childLanes)!==0,d||(Du(r,o,c,!1),d=(c&o.childLanes)!==0),g){if(d)return hw(r,o,c);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),ue(An,An.current),d)break;return null;case 22:case 23:return o.lanes=0,aw(r,o,c);case 24:ui(o,Sn,r.memoizedState.cache)}return Ia(r,o,c)}function fw(r,o,c){if(r!==null)if(r.memoizedProps!==o.pendingProps)Ln=!0;else{if(!Fp(r,c)&&(o.flags&128)===0)return Ln=!1,p2(r,o,c);Ln=(r.flags&131072)!==0}else Ln=!1,xt&&(o.flags&1048576)!==0&&zb(o,$h,o.index);switch(o.lanes=0,o.tag){case 16:e:{r=o.pendingProps;var d=o.elementType,g=d._init;if(d=g(d._payload),o.type=d,typeof d=="function")Qg(d)?(r=Lo(d,r),o.tag=1,o=lw(null,o,d,r,c)):(o.tag=0,o=kp(null,o,d,r,c));else{if(d!=null){if(g=d.$$typeof,g===G){o.tag=11,o=nw(null,o,d,r,c);break e}else if(g===P){o.tag=14,o=sw(null,o,d,r,c);break e}}throw o=De(d)||d,Error(n(306,o,""))}}return o;case 0:return kp(r,o,o.type,o.pendingProps,c);case 1:return d=o.type,g=Lo(d,o.pendingProps),lw(r,o,d,g,c);case 3:e:{if(we(o,o.stateNode.containerInfo),r===null)throw Error(n(387));d=o.pendingProps;var y=o.memoizedState;g=y.element,lp(r,o),Uu(o,d,null,c);var N=o.memoizedState;if(d=N.cache,ui(o,Sn,d),d!==y.cache&&np(o,[Sn],c,!0),Fu(),d=N.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:N.cache},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){o=cw(r,o,d,c);break e}else if(d!==g){g=cr(Error(n(424)),o),ku(g),o=cw(r,o,d,c);break e}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(sn=Cr(r.firstChild),ms=o,xt=!0,ko=null,Jr=!0,c=G0(o,null,d,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Ru(),d===g){o=Ia(r,o,c);break e}Yn(r,o,d,c)}o=o.child}return o;case 26:return ff(r,o),r===null?(c=y_(o.type,null,o.pendingProps,null))?o.memoizedState=c:xt||(c=o.type,r=o.pendingProps,d=jf(Se.current).createElement(c),d[tn]=o,d[nn]=r,Wn(d,c,r),Xt(d),o.stateNode=d):o.memoizedState=y_(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Fe(o),r===null&&xt&&(d=o.stateNode=m_(o.type,o.pendingProps,Se.current),ms=o,Jr=!0,g=sn,Ei(o.type)?(vy=g,sn=Cr(d.firstChild)):sn=g),Yn(r,o,o.pendingProps.children,c),ff(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&xt&&((g=d=sn)&&(d=H2(d,o.type,o.pendingProps,Jr),d!==null?(o.stateNode=d,ms=o,sn=Cr(d.firstChild),Jr=!1,g=!0):g=!1),g||Do(o)),Fe(o),g=o.type,y=o.pendingProps,N=r!==null?r.memoizedProps:null,d=y.children,gy(g,y)?d=null:N!==null&&gy(g,N)&&(o.flags|=32),o.memoizedState!==null&&(g=mp(r,o,l2,null,null,c),ld._currentValue=g),ff(r,o),Yn(r,o,d,c),o.child;case 6:return r===null&&xt&&((r=c=sn)&&(c=G2(c,o.pendingProps,Jr),c!==null?(o.stateNode=c,ms=o,sn=null,r=!0):r=!1),r||Do(o)),null;case 13:return uw(r,o,c);case 4:return we(o,o.stateNode.containerInfo),d=o.pendingProps,r===null?o.child=Jl(o,null,d,c):Yn(r,o,d,c),o.child;case 11:return nw(r,o,o.type,o.pendingProps,c);case 7:return Yn(r,o,o.pendingProps,c),o.child;case 8:return Yn(r,o,o.pendingProps.children,c),o.child;case 12:return Yn(r,o,o.pendingProps.children,c),o.child;case 10:return d=o.pendingProps,ui(o,o.type,d.value),Yn(r,o,d.children,c),o.child;case 9:return g=o.type._context,d=o.pendingProps.children,Mo(o),g=ns(g),d=d(g),o.flags|=1,Yn(r,o,d,c),o.child;case 14:return sw(r,o,o.type,o.pendingProps,c);case 15:return rw(r,o,o.type,o.pendingProps,c);case 19:return hw(r,o,c);case 31:return d=o.pendingProps,c=o.mode,d={mode:d.mode,children:d.children},r===null?(c=mf(d,c),c.ref=o.ref,o.child=c,c.return=o,o=c):(c=_a(r.child,d),c.ref=o.ref,o.child=c,c.return=o,o=c),o;case 22:return aw(r,o,c);case 24:return Mo(o),d=ns(Sn),r===null?(g=ap(),g===null&&(g=Lt,y=sp(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=c),g=y),o.memoizedState={parent:d,cache:g},op(o),ui(o,Sn,g)):((r.lanes&c)!==0&&(lp(r,o),Uu(o,null,null,c),Fu()),g=r.memoizedState,y=o.memoizedState,g.parent!==d?(g={parent:d,cache:d},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),ui(o,Sn,d)):(d=y.cache,ui(o,Sn,d),d!==g.cache&&np(o,[Sn],c,!0))),Yn(r,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Ca(r){r.flags|=4}function mw(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!__(o)){if(o=fr.current,o!==null&&((ht&4194048)===ht?Zr!==null:(ht&62914560)!==ht&&(ht&536870912)===0||o!==Zr))throw Vu=ip,Wb;r.flags|=8192}}function gf(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?zr():536870912,r.lanes|=o,nc|=o)}function Ku(r,o){if(!xt)switch(r.tailMode){case"hidden":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function Wt(r){var o=r.alternate!==null&&r.alternate.child===r.child,c=0,d=0;if(o)for(var g=r.child;g!==null;)c|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)c|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=d,r.childLanes=c,o}function y2(r,o,c){var d=o.pendingProps;switch(Jg(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(o),null;case 1:return Wt(o),null;case 3:return c=o.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),Sa(Sn),Ee(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(Cu(o)?Ca(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,$b())),Wt(o),null;case 26:return c=o.memoizedState,r===null?(Ca(o),c!==null?(Wt(o),mw(o,c)):(Wt(o),o.flags&=-16777217)):c?c!==r.memoizedState?(Ca(o),Wt(o),mw(o,c)):(Wt(o),o.flags&=-16777217):(r.memoizedProps!==d&&Ca(o),Wt(o),o.flags&=-16777217),null;case 27:Ze(o),c=Se.current;var g=o.type;if(r!==null&&o.stateNode!=null)r.memoizedProps!==d&&Ca(o);else{if(!d){if(o.stateNode===null)throw Error(n(166));return Wt(o),null}r=Ie.current,Cu(o)?Hb(o):(r=m_(g,d,c),o.stateNode=r,Ca(o))}return Wt(o),null;case 5:if(Ze(o),c=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==d&&Ca(o);else{if(!d){if(o.stateNode===null)throw Error(n(166));return Wt(o),null}if(r=Ie.current,Cu(o))Hb(o);else{switch(g=jf(Se.current),r){case 1:r=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:r=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":r=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":r=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":r=g.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof d.is=="string"?g.createElement("select",{is:d.is}):g.createElement("select"),d.multiple?r.multiple=!0:d.size&&(r.size=d.size);break;default:r=typeof d.is=="string"?g.createElement(c,{is:d.is}):g.createElement(c)}}r[tn]=o,r[nn]=d;e:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)r.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break e;for(;g.sibling===null;){if(g.return===null||g.return===o)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=r;e:switch(Wn(r,c,d),c){case"button":case"input":case"select":case"textarea":r=!!d.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Ca(o)}}return Wt(o),o.flags&=-16777217,null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==d&&Ca(o);else{if(typeof d!="string"&&o.stateNode===null)throw Error(n(166));if(r=Se.current,Cu(o)){if(r=o.stateNode,c=o.memoizedProps,d=null,g=ms,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}r[tn]=o,r=!!(r.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||o_(r.nodeValue,c)),r||Do(o)}else r=jf(r).createTextNode(d),r[tn]=o,o.stateNode=r}return Wt(o),null;case 13:if(d=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=Cu(o),d!==null&&d.dehydrated!==null){if(r===null){if(!g)throw Error(n(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[tn]=o}else Ru(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Wt(o),g=!1}else g=$b(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(ja(o),o):(ja(o),null)}if(ja(o),(o.flags&128)!==0)return o.lanes=c,o;if(c=d!==null,r=r!==null&&r.memoizedState!==null,c){d=o.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool);var y=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==g&&(d.flags|=2048)}return c!==r&&c&&(o.child.flags|=8192),gf(o,o.updateQueue),Wt(o),null;case 4:return Ee(),r===null&&uy(o.stateNode.containerInfo),Wt(o),null;case 10:return Sa(o.type),Wt(o),null;case 19:if(ve(An),g=o.memoizedState,g===null)return Wt(o),null;if(d=(o.flags&128)!==0,y=g.rendering,y===null)if(d)Ku(g,!1);else{if(rn!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(y=uf(r),y!==null){for(o.flags|=128,Ku(g,!1),r=y.updateQueue,o.updateQueue=r,gf(o,r),o.subtreeFlags=0,r=c,c=o.child;c!==null;)qb(c,r),c=c.sibling;return ue(An,An.current&1|2),o.child}r=r.sibling}g.tail!==null&&ct()>xf&&(o.flags|=128,d=!0,Ku(g,!1),o.lanes=4194304)}else{if(!d)if(r=uf(y),r!==null){if(o.flags|=128,d=!0,r=r.updateQueue,o.updateQueue=r,gf(o,r),Ku(g,!0),g.tail===null&&g.tailMode==="hidden"&&!y.alternate&&!xt)return Wt(o),null}else 2*ct()-g.renderingStartTime>xf&&c!==536870912&&(o.flags|=128,d=!0,Ku(g,!1),o.lanes=4194304);g.isBackwards?(y.sibling=o.child,o.child=y):(r=g.last,r!==null?r.sibling=y:o.child=y,g.last=y)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=ct(),o.sibling=null,r=An.current,ue(An,d?r&1|2:r&1),o):(Wt(o),null);case 22:case 23:return ja(o),hp(),d=o.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(o.flags|=8192):d&&(o.flags|=8192),d?(c&536870912)!==0&&(o.flags&128)===0&&(Wt(o),o.subtreeFlags&6&&(o.flags|=8192)):Wt(o),c=o.updateQueue,c!==null&&gf(o,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),d=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(d=o.memoizedState.cachePool.pool),d!==c&&(o.flags|=2048),r!==null&&ve(Oo),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),Sa(Sn),Wt(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function x2(r,o){switch(Jg(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Sa(Sn),Ee(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return Ze(o),null;case 13:if(ja(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Ru()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return ve(An),null;case 4:return Ee(),null;case 10:return Sa(o.type),null;case 22:case 23:return ja(o),hp(),r!==null&&ve(Oo),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Sa(Sn),null;case 25:return null;default:return null}}function gw(r,o){switch(Jg(o),o.tag){case 3:Sa(Sn),Ee();break;case 26:case 27:case 5:Ze(o);break;case 4:Ee();break;case 13:ja(o);break;case 19:ve(An);break;case 10:Sa(o.type);break;case 22:case 23:ja(o),hp(),r!==null&&ve(Oo);break;case 24:Sa(Sn)}}function Qu(r,o){try{var c=o.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var g=d.next;c=g;do{if((c.tag&r)===r){d=void 0;var y=c.create,N=c.inst;d=y(),N.destroy=d}c=c.next}while(c!==g)}}catch(S){Vt(o,o.return,S)}}function yi(r,o,c){try{var d=o.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var y=g.next;d=y;do{if((d.tag&r)===r){var N=d.inst,S=N.destroy;if(S!==void 0){N.destroy=void 0,g=o;var H=c,se=S;try{se()}catch(de){Vt(g,H,de)}}}d=d.next}while(d!==y)}}catch(de){Vt(o,o.return,de)}}function pw(r){var o=r.updateQueue;if(o!==null){var c=r.stateNode;try{s0(o,c)}catch(d){Vt(r,r.return,d)}}}function yw(r,o,c){c.props=Lo(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(d){Vt(r,o,d)}}function Yu(r,o){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof c=="function"?r.refCleanup=c(d):c.current=d}}catch(g){Vt(r,o,g)}}function ea(r,o){var c=r.ref,d=r.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(g){Vt(r,o,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Vt(r,o,g)}else c.current=null}function xw(r){var o=r.type,c=r.memoizedProps,d=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(g){Vt(r,r.return,g)}}function Up(r,o,c){try{var d=r.stateNode;F2(d,r.type,c,o),d[nn]=o}catch(g){Vt(r,r.return,g)}}function vw(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Ei(r.type)||r.tag===4}function Bp(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||vw(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Ei(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function qp(r,o,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(r),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Af));else if(d!==4&&(d===27&&Ei(r.type)&&(c=r.stateNode,o=null),r=r.child,r!==null))for(qp(r,o,c),r=r.sibling;r!==null;)qp(r,o,c),r=r.sibling}function pf(r,o,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?c.insertBefore(r,o):c.appendChild(r);else if(d!==4&&(d===27&&Ei(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(pf(r,o,c),r=r.sibling;r!==null;)pf(r,o,c),r=r.sibling}function bw(r){var o=r.stateNode,c=r.memoizedProps;try{for(var d=r.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);Wn(o,d,c),o[tn]=r,o[nn]=c}catch(y){Vt(r,r.return,y)}}var Ra=!1,un=!1,zp=!1,ww=typeof WeakSet=="function"?WeakSet:Set,Fn=null;function v2(r,o){if(r=r.containerInfo,fy=Pf,r=kb(r),Bg(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var g=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var N=0,S=-1,H=-1,se=0,de=0,me=r,ae=null;t:for(;;){for(var ie;me!==c||g!==0&&me.nodeType!==3||(S=N+g),me!==y||d!==0&&me.nodeType!==3||(H=N+d),me.nodeType===3&&(N+=me.nodeValue.length),(ie=me.firstChild)!==null;)ae=me,me=ie;for(;;){if(me===r)break t;if(ae===c&&++se===g&&(S=N),ae===y&&++de===d&&(H=N),(ie=me.nextSibling)!==null)break;me=ae,ae=me.parentNode}me=ie}c=S===-1||H===-1?null:{start:S,end:H}}else c=null}c=c||{start:0,end:0}}else c=null;for(my={focusedElem:r,selectionRange:c},Pf=!1,Fn=o;Fn!==null;)if(o=Fn,r=o.child,(o.subtreeFlags&1024)!==0&&r!==null)r.return=o,Fn=r;else for(;Fn!==null;){switch(o=Fn,y=o.alternate,r=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,c=o,g=y.memoizedProps,y=y.memoizedState,d=c.stateNode;try{var He=Lo(c.type,g,c.elementType===c.type);r=d.getSnapshotBeforeUpdate(He,y),d.__reactInternalSnapshotBeforeUpdate=r}catch(Ue){Vt(c,c.return,Ue)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,c=r.nodeType,c===9)yy(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":yy(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,Fn=r;break}Fn=o.return}}function _w(r,o,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:xi(r,c),d&4&&Qu(5,c);break;case 1:if(xi(r,c),d&4)if(r=c.stateNode,o===null)try{r.componentDidMount()}catch(N){Vt(c,c.return,N)}else{var g=Lo(c.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(g,o,r.__reactInternalSnapshotBeforeUpdate)}catch(N){Vt(c,c.return,N)}}d&64&&pw(c),d&512&&Yu(c,c.return);break;case 3:if(xi(r,c),d&64&&(r=c.updateQueue,r!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{s0(r,o)}catch(N){Vt(c,c.return,N)}}break;case 27:o===null&&d&4&&bw(c);case 26:case 5:xi(r,c),o===null&&d&4&&xw(c),d&512&&Yu(c,c.return);break;case 12:xi(r,c);break;case 13:xi(r,c),d&4&&Ew(r,c),d&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=j2.bind(null,c),$2(r,c))));break;case 22:if(d=c.memoizedState!==null||Ra,!d){o=o!==null&&o.memoizedState!==null||un,g=Ra;var y=un;Ra=d,(un=o)&&!y?vi(r,c,(c.subtreeFlags&8772)!==0):xi(r,c),Ra=g,un=y}break;case 30:break;default:xi(r,c)}}function Nw(r){var o=r.alternate;o!==null&&(r.alternate=null,Nw(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&Dn(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Ht=null,vs=!1;function ka(r,o,c){for(c=c.child;c!==null;)Tw(r,o,c),c=c.sibling}function Tw(r,o,c){if(pt&&typeof pt.onCommitFiberUnmount=="function")try{pt.onCommitFiberUnmount(_t,c)}catch{}switch(c.tag){case 26:un||ea(c,o),ka(r,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:un||ea(c,o);var d=Ht,g=vs;Ei(c.type)&&(Ht=c.stateNode,vs=!1),ka(r,o,c),rd(c.stateNode),Ht=d,vs=g;break;case 5:un||ea(c,o);case 6:if(d=Ht,g=vs,Ht=null,ka(r,o,c),Ht=d,vs=g,Ht!==null)if(vs)try{(Ht.nodeType===9?Ht.body:Ht.nodeName==="HTML"?Ht.ownerDocument.body:Ht).removeChild(c.stateNode)}catch(y){Vt(c,o,y)}else try{Ht.removeChild(c.stateNode)}catch(y){Vt(c,o,y)}break;case 18:Ht!==null&&(vs?(r=Ht,h_(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),hd(r)):h_(Ht,c.stateNode));break;case 4:d=Ht,g=vs,Ht=c.stateNode.containerInfo,vs=!0,ka(r,o,c),Ht=d,vs=g;break;case 0:case 11:case 14:case 15:un||yi(2,c,o),un||yi(4,c,o),ka(r,o,c);break;case 1:un||(ea(c,o),d=c.stateNode,typeof d.componentWillUnmount=="function"&&yw(c,o,d)),ka(r,o,c);break;case 21:ka(r,o,c);break;case 22:un=(d=un)||c.memoizedState!==null,ka(r,o,c),un=d;break;default:ka(r,o,c)}}function Ew(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{hd(r)}catch(c){Vt(o,o.return,c)}}function b2(r){switch(r.tag){case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new ww),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new ww),o;default:throw Error(n(435,r.tag))}}function Hp(r,o){var c=b2(r);o.forEach(function(d){var g=I2.bind(null,r,d);c.has(d)||(c.add(d),d.then(g,g))})}function Bs(r,o){var c=o.deletions;if(c!==null)for(var d=0;d<c.length;d++){var g=c[d],y=r,N=o,S=N;e:for(;S!==null;){switch(S.tag){case 27:if(Ei(S.type)){Ht=S.stateNode,vs=!1;break e}break;case 5:Ht=S.stateNode,vs=!1;break e;case 3:case 4:Ht=S.stateNode.containerInfo,vs=!0;break e}S=S.return}if(Ht===null)throw Error(n(160));Tw(y,N,g),Ht=null,vs=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Sw(o,r),o=o.sibling}var Ir=null;function Sw(r,o){var c=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Bs(o,r),qs(r),d&4&&(yi(3,r,r.return),Qu(3,r),yi(5,r,r.return));break;case 1:Bs(o,r),qs(r),d&512&&(un||c===null||ea(c,c.return)),d&64&&Ra&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var g=Ir;if(Bs(o,r),qs(r),d&512&&(un||c===null||ea(c,c.return)),d&4){var y=c!==null?c.memoizedState:null;if(d=r.memoizedState,c===null)if(d===null)if(r.stateNode===null){e:{d=r.type,c=r.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":y=g.getElementsByTagName("title")[0],(!y||y[Hr]||y[tn]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(d),g.head.insertBefore(y,g.querySelector("head > title"))),Wn(y,d,c),y[tn]=r,Xt(y),d=y;break e;case"link":var N=b_("link","href",g).get(d+(c.href||""));if(N){for(var S=0;S<N.length;S++)if(y=N[S],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){N.splice(S,1);break t}}y=g.createElement(d),Wn(y,d,c),g.head.appendChild(y);break;case"meta":if(N=b_("meta","content",g).get(d+(c.content||""))){for(S=0;S<N.length;S++)if(y=N[S],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){N.splice(S,1);break t}}y=g.createElement(d),Wn(y,d,c),g.head.appendChild(y);break;default:throw Error(n(468,d))}y[tn]=r,Xt(y),d=y}r.stateNode=d}else w_(g,r.type,r.stateNode);else r.stateNode=v_(g,d,r.memoizedProps);else y!==d?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,d===null?w_(g,r.type,r.stateNode):v_(g,d,r.memoizedProps)):d===null&&r.stateNode!==null&&Up(r,r.memoizedProps,c.memoizedProps)}break;case 27:Bs(o,r),qs(r),d&512&&(un||c===null||ea(c,c.return)),c!==null&&d&4&&Up(r,r.memoizedProps,c.memoizedProps);break;case 5:if(Bs(o,r),qs(r),d&512&&(un||c===null||ea(c,c.return)),r.flags&32){g=r.stateNode;try{ar(g,"")}catch(ie){Vt(r,r.return,ie)}}d&4&&r.stateNode!=null&&(g=r.memoizedProps,Up(r,g,c!==null?c.memoizedProps:g)),d&1024&&(zp=!0);break;case 6:if(Bs(o,r),qs(r),d&4){if(r.stateNode===null)throw Error(n(162));d=r.memoizedProps,c=r.stateNode;try{c.nodeValue=d}catch(ie){Vt(r,r.return,ie)}}break;case 3:if(Rf=null,g=Ir,Ir=If(o.containerInfo),Bs(o,r),Ir=g,qs(r),d&4&&c!==null&&c.memoizedState.isDehydrated)try{hd(o.containerInfo)}catch(ie){Vt(r,r.return,ie)}zp&&(zp=!1,Aw(r));break;case 4:d=Ir,Ir=If(r.stateNode.containerInfo),Bs(o,r),qs(r),Ir=d;break;case 12:Bs(o,r),qs(r);break;case 13:Bs(o,r),qs(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Xp=ct()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Hp(r,d)));break;case 22:g=r.memoizedState!==null;var H=c!==null&&c.memoizedState!==null,se=Ra,de=un;if(Ra=se||g,un=de||H,Bs(o,r),un=de,Ra=se,qs(r),d&8192)e:for(o=r.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(c===null||H||Ra||un||Fo(r)),c=null,o=r;;){if(o.tag===5||o.tag===26){if(c===null){H=c=o;try{if(y=H.stateNode,g)N=y.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{S=H.stateNode;var me=H.memoizedProps.style,ae=me!=null&&me.hasOwnProperty("display")?me.display:null;S.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(ie){Vt(H,H.return,ie)}}}else if(o.tag===6){if(c===null){H=o;try{H.stateNode.nodeValue=g?"":H.memoizedProps}catch(ie){Vt(H,H.return,ie)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}d&4&&(d=r.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Hp(r,c))));break;case 19:Bs(o,r),qs(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Hp(r,d)));break;case 30:break;case 21:break;default:Bs(o,r),qs(r)}}function qs(r){var o=r.flags;if(o&2){try{for(var c,d=r.return;d!==null;){if(vw(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,y=Bp(r);pf(r,y,g);break;case 5:var N=c.stateNode;c.flags&32&&(ar(N,""),c.flags&=-33);var S=Bp(r);pf(r,S,N);break;case 3:case 4:var H=c.stateNode.containerInfo,se=Bp(r);qp(r,se,H);break;default:throw Error(n(161))}}catch(de){Vt(r,r.return,de)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function Aw(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;Aw(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function xi(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)_w(r,o.alternate,o),o=o.sibling}function Fo(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:yi(4,o,o.return),Fo(o);break;case 1:ea(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&yw(o,o.return,c),Fo(o);break;case 27:rd(o.stateNode);case 26:case 5:ea(o,o.return),Fo(o);break;case 22:o.memoizedState===null&&Fo(o);break;case 30:Fo(o);break;default:Fo(o)}r=r.sibling}}function vi(r,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var d=o.alternate,g=r,y=o,N=y.flags;switch(y.tag){case 0:case 11:case 15:vi(g,y,c),Qu(4,y);break;case 1:if(vi(g,y,c),d=y,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(se){Vt(d,d.return,se)}if(d=y,g=d.updateQueue,g!==null){var S=d.stateNode;try{var H=g.shared.hiddenCallbacks;if(H!==null)for(g.shared.hiddenCallbacks=null,g=0;g<H.length;g++)n0(H[g],S)}catch(se){Vt(d,d.return,se)}}c&&N&64&&pw(y),Yu(y,y.return);break;case 27:bw(y);case 26:case 5:vi(g,y,c),c&&d===null&&N&4&&xw(y),Yu(y,y.return);break;case 12:vi(g,y,c);break;case 13:vi(g,y,c),c&&N&4&&Ew(g,y);break;case 22:y.memoizedState===null&&vi(g,y,c),Yu(y,y.return);break;case 30:break;default:vi(g,y,c)}o=o.sibling}}function Gp(r,o){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&Pu(c))}function $p(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Pu(r))}function ta(r,o,c,d){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)jw(r,o,c,d),o=o.sibling}function jw(r,o,c,d){var g=o.flags;switch(o.tag){case 0:case 11:case 15:ta(r,o,c,d),g&2048&&Qu(9,o);break;case 1:ta(r,o,c,d);break;case 3:ta(r,o,c,d),g&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Pu(r)));break;case 12:if(g&2048){ta(r,o,c,d),r=o.stateNode;try{var y=o.memoizedProps,N=y.id,S=y.onPostCommit;typeof S=="function"&&S(N,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(H){Vt(o,o.return,H)}}else ta(r,o,c,d);break;case 13:ta(r,o,c,d);break;case 23:break;case 22:y=o.stateNode,N=o.alternate,o.memoizedState!==null?y._visibility&2?ta(r,o,c,d):Xu(r,o):y._visibility&2?ta(r,o,c,d):(y._visibility|=2,Zl(r,o,c,d,(o.subtreeFlags&10256)!==0)),g&2048&&Gp(N,o);break;case 24:ta(r,o,c,d),g&2048&&$p(o.alternate,o);break;default:ta(r,o,c,d)}}function Zl(r,o,c,d,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var y=r,N=o,S=c,H=d,se=N.flags;switch(N.tag){case 0:case 11:case 15:Zl(y,N,S,H,g),Qu(8,N);break;case 23:break;case 22:var de=N.stateNode;N.memoizedState!==null?de._visibility&2?Zl(y,N,S,H,g):Xu(y,N):(de._visibility|=2,Zl(y,N,S,H,g)),g&&se&2048&&Gp(N.alternate,N);break;case 24:Zl(y,N,S,H,g),g&&se&2048&&$p(N.alternate,N);break;default:Zl(y,N,S,H,g)}o=o.sibling}}function Xu(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=r,d=o,g=d.flags;switch(d.tag){case 22:Xu(c,d),g&2048&&Gp(d.alternate,d);break;case 24:Xu(c,d),g&2048&&$p(d.alternate,d);break;default:Xu(c,d)}o=o.sibling}}var Wu=8192;function ec(r){if(r.subtreeFlags&Wu)for(r=r.child;r!==null;)Iw(r),r=r.sibling}function Iw(r){switch(r.tag){case 26:ec(r),r.flags&Wu&&r.memoizedState!==null&&aI(Ir,r.memoizedState,r.memoizedProps);break;case 5:ec(r);break;case 3:case 4:var o=Ir;Ir=If(r.stateNode.containerInfo),ec(r),Ir=o;break;case 22:r.memoizedState===null&&(o=r.alternate,o!==null&&o.memoizedState!==null?(o=Wu,Wu=16777216,ec(r),Wu=o):ec(r));break;default:ec(r)}}function Cw(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Ju(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];Fn=d,kw(d,r)}Cw(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Rw(r),r=r.sibling}function Rw(r){switch(r.tag){case 0:case 11:case 15:Ju(r),r.flags&2048&&yi(9,r,r.return);break;case 3:Ju(r);break;case 12:Ju(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,yf(r)):Ju(r);break;default:Ju(r)}}function yf(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];Fn=d,kw(d,r)}Cw(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:yi(8,o,o.return),yf(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,yf(o));break;default:yf(o)}r=r.sibling}}function kw(r,o){for(;Fn!==null;){var c=Fn;switch(c.tag){case 0:case 11:case 15:yi(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Pu(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,Fn=d;else e:for(c=r;Fn!==null;){d=Fn;var g=d.sibling,y=d.return;if(Nw(d),d===c){Fn=null;break e}if(g!==null){g.return=y,Fn=g;break e}Fn=y}}}var w2={getCacheForType:function(r){var o=ns(Sn),c=o.data.get(r);return c===void 0&&(c=r(),o.data.set(r,c)),c}},_2=typeof WeakMap=="function"?WeakMap:Map,Tt=0,Lt=null,st=null,ht=0,Et=0,zs=null,bi=!1,tc=!1,Kp=!1,Da=0,rn=0,wi=0,Uo=0,Qp=0,mr=0,nc=0,Zu=null,bs=null,Yp=!1,Xp=0,xf=1/0,vf=null,_i=null,Xn=0,Ni=null,sc=null,rc=0,Wp=0,Jp=null,Dw=null,ed=0,Zp=null;function Hs(){if((Tt&2)!==0&&ht!==0)return ht&-ht;if(O.T!==null){var r=Gl;return r!==0?r:iy()}return Er()}function Pw(){mr===0&&(mr=(ht&536870912)===0||xt?qr():536870912);var r=fr.current;return r!==null&&(r.flags|=32),mr}function Gs(r,o,c){(r===Lt&&(Et===2||Et===9)||r.cancelPendingCommit!==null)&&(ac(r,0),Ti(r,ht,mr,!1)),us(r,c),((Tt&2)===0||r!==Lt)&&(r===Lt&&((Tt&2)===0&&(Uo|=c),rn===4&&Ti(r,ht,mr,!1)),na(r))}function Mw(r,o,c){if((Tt&6)!==0)throw Error(n(327));var d=!c&&(o&124)===0&&(o&r.expiredLanes)===0||Nr(r,o),g=d?E2(r,o):ny(r,o,!0),y=d;do{if(g===0){tc&&!d&&Ti(r,o,0,!1);break}else{if(c=r.current.alternate,y&&!N2(c)){g=ny(r,o,!1),y=!1;continue}if(g===2){if(y=o,r.errorRecoveryDisabledLanes&y)var N=0;else N=r.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){o=N;e:{var S=r;g=Zu;var H=S.current.memoizedState.isDehydrated;if(H&&(ac(S,N).flags|=256),N=ny(S,N,!1),N!==2){if(Kp&&!H){S.errorRecoveryDisabledLanes|=y,Uo|=y,g=4;break e}y=bs,bs=g,y!==null&&(bs===null?bs=y:bs.push.apply(bs,y))}g=N}if(y=!1,g!==2)continue}}if(g===1){ac(r,0),Ti(r,o,0,!0);break}e:{switch(d=r,y=g,y){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Ti(d,o,mr,!bi);break e;case 2:bs=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(g=Xp+300-ct(),10<g)){if(Ti(d,o,mr,!bi),Br(d,0,!0)!==0)break e;d.timeoutHandle=u_(Ow.bind(null,d,c,bs,vf,Yp,o,mr,Uo,nc,bi,y,2,-0,0),g);break e}Ow(d,c,bs,vf,Yp,o,mr,Uo,nc,bi,y,0,-0,0)}}break}while(!0);na(r)}function Ow(r,o,c,d,g,y,N,S,H,se,de,me,ae,ie){if(r.timeoutHandle=-1,me=o.subtreeFlags,(me&8192||(me&16785408)===16785408)&&(od={stylesheets:null,count:0,unsuspend:rI},Iw(o),me=iI(),me!==null)){r.cancelPendingCommit=me(zw.bind(null,r,o,y,c,d,g,N,S,H,de,1,ae,ie)),Ti(r,y,N,!se);return}zw(r,o,y,c,d,g,N,S,H)}function N2(r){for(var o=r;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var g=c[d],y=g.getSnapshot;g=g.value;try{if(!Fs(y(),g))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ti(r,o,c,d){o&=~Qp,o&=~Uo,r.suspendedLanes|=o,r.pingedLanes&=~o,d&&(r.warmLanes|=o),d=r.expirationTimes;for(var g=o;0<g;){var y=31-_n(g),N=1<<y;d[y]=-1,g&=~N}c!==0&&tr(r,c,o)}function bf(){return(Tt&6)===0?(td(0),!1):!0}function ey(){if(st!==null){if(Et===0)var r=st.return;else r=st,Ea=Po=null,yp(r),Wl=null,Gu=0,r=st;for(;r!==null;)gw(r.alternate,r),r=r.return;st=null}}function ac(r,o){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,B2(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),ey(),Lt=r,st=c=_a(r.current,null),ht=o,Et=0,zs=null,bi=!1,tc=Nr(r,o),Kp=!1,nc=mr=Qp=Uo=wi=rn=0,bs=Zu=null,Yp=!1,(o&8)!==0&&(o|=o&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=o;0<d;){var g=31-_n(d),y=1<<g;o|=r[g],d&=~y}return Da=o,Bh(),c}function Vw(r,o){Je=null,O.H=of,o===Ou||o===Xh?(o=e0(),Et=3):o===Wb?(o=e0(),Et=4):Et=o===tw?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,zs=o,st===null&&(rn=1,hf(r,cr(o,r.current)))}function Lw(){var r=O.H;return O.H=of,r===null?of:r}function Fw(){var r=O.A;return O.A=w2,r}function ty(){rn=4,bi||(ht&4194048)!==ht&&fr.current!==null||(tc=!0),(wi&134217727)===0&&(Uo&134217727)===0||Lt===null||Ti(Lt,ht,mr,!1)}function ny(r,o,c){var d=Tt;Tt|=2;var g=Lw(),y=Fw();(Lt!==r||ht!==o)&&(vf=null,ac(r,o)),o=!1;var N=rn;e:do try{if(Et!==0&&st!==null){var S=st,H=zs;switch(Et){case 8:ey(),N=6;break e;case 3:case 2:case 9:case 6:fr.current===null&&(o=!0);var se=Et;if(Et=0,zs=null,ic(r,S,H,se),c&&tc){N=0;break e}break;default:se=Et,Et=0,zs=null,ic(r,S,H,se)}}T2(),N=rn;break}catch(de){Vw(r,de)}while(!0);return o&&r.shellSuspendCounter++,Ea=Po=null,Tt=d,O.H=g,O.A=y,st===null&&(Lt=null,ht=0,Bh()),N}function T2(){for(;st!==null;)Uw(st)}function E2(r,o){var c=Tt;Tt|=2;var d=Lw(),g=Fw();Lt!==r||ht!==o?(vf=null,xf=ct()+500,ac(r,o)):tc=Nr(r,o);e:do try{if(Et!==0&&st!==null){o=st;var y=zs;t:switch(Et){case 1:Et=0,zs=null,ic(r,o,y,1);break;case 2:case 9:if(Jb(y)){Et=0,zs=null,Bw(o);break}o=function(){Et!==2&&Et!==9||Lt!==r||(Et=7),na(r)},y.then(o,o);break e;case 3:Et=7;break e;case 4:Et=5;break e;case 7:Jb(y)?(Et=0,zs=null,Bw(o)):(Et=0,zs=null,ic(r,o,y,7));break;case 5:var N=null;switch(st.tag){case 26:N=st.memoizedState;case 5:case 27:var S=st;if(!N||__(N)){Et=0,zs=null;var H=S.sibling;if(H!==null)st=H;else{var se=S.return;se!==null?(st=se,wf(se)):st=null}break t}}Et=0,zs=null,ic(r,o,y,5);break;case 6:Et=0,zs=null,ic(r,o,y,6);break;case 8:ey(),rn=6;break e;default:throw Error(n(462))}}S2();break}catch(de){Vw(r,de)}while(!0);return Ea=Po=null,O.H=d,O.A=g,Tt=c,st!==null?0:(Lt=null,ht=0,Bh(),rn)}function S2(){for(;st!==null&&!Qe();)Uw(st)}function Uw(r){var o=fw(r.alternate,r,Da);r.memoizedProps=r.pendingProps,o===null?wf(r):st=o}function Bw(r){var o=r,c=o.alternate;switch(o.tag){case 15:case 0:o=ow(c,o,o.pendingProps,o.type,void 0,ht);break;case 11:o=ow(c,o,o.pendingProps,o.type.render,o.ref,ht);break;case 5:yp(o);default:gw(c,o),o=st=qb(o,Da),o=fw(c,o,Da)}r.memoizedProps=r.pendingProps,o===null?wf(r):st=o}function ic(r,o,c,d){Ea=Po=null,yp(o),Wl=null,Gu=0;var g=o.return;try{if(g2(r,g,o,c,ht)){rn=1,hf(r,cr(c,r.current)),st=null;return}}catch(y){if(g!==null)throw st=g,y;rn=1,hf(r,cr(c,r.current)),st=null;return}o.flags&32768?(xt||d===1?r=!0:tc||(ht&536870912)!==0?r=!1:(bi=r=!0,(d===2||d===9||d===3||d===6)&&(d=fr.current,d!==null&&d.tag===13&&(d.flags|=16384))),qw(o,r)):wf(o)}function wf(r){var o=r;do{if((o.flags&32768)!==0){qw(o,bi);return}r=o.return;var c=y2(o.alternate,o,Da);if(c!==null){st=c;return}if(o=o.sibling,o!==null){st=o;return}st=o=r}while(o!==null);rn===0&&(rn=5)}function qw(r,o){do{var c=x2(r.alternate,r);if(c!==null){c.flags&=32767,st=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(r=r.sibling,r!==null)){st=r;return}st=r=c}while(r!==null);rn=6,st=null}function zw(r,o,c,d,g,y,N,S,H){r.cancelPendingCommit=null;do _f();while(Xn!==0);if((Tt&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(y=o.lanes|o.childLanes,y|=$g,mo(r,c,y,N,S,H),r===Lt&&(st=Lt=null,ht=0),sc=o,Ni=r,rc=c,Wp=y,Jp=g,Dw=d,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,C2($n,function(){return Qw(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||d){d=O.T,O.T=null,g=oe.p,oe.p=2,N=Tt,Tt|=4;try{v2(r,o,c)}finally{Tt=N,oe.p=g,O.T=d}}Xn=1,Hw(),Gw(),$w()}}function Hw(){if(Xn===1){Xn=0;var r=Ni,o=sc,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=O.T,O.T=null;var d=oe.p;oe.p=2;var g=Tt;Tt|=4;try{Sw(o,r);var y=my,N=kb(r.containerInfo),S=y.focusedElem,H=y.selectionRange;if(N!==S&&S&&S.ownerDocument&&Rb(S.ownerDocument.documentElement,S)){if(H!==null&&Bg(S)){var se=H.start,de=H.end;if(de===void 0&&(de=se),"selectionStart"in S)S.selectionStart=se,S.selectionEnd=Math.min(de,S.value.length);else{var me=S.ownerDocument||document,ae=me&&me.defaultView||window;if(ae.getSelection){var ie=ae.getSelection(),He=S.textContent.length,Ue=Math.min(H.start,He),Dt=H.end===void 0?Ue:Math.min(H.end,He);!ie.extend&&Ue>Dt&&(N=Dt,Dt=Ue,Ue=N);var X=Cb(S,Ue),K=Cb(S,Dt);if(X&&K&&(ie.rangeCount!==1||ie.anchorNode!==X.node||ie.anchorOffset!==X.offset||ie.focusNode!==K.node||ie.focusOffset!==K.offset)){var ee=me.createRange();ee.setStart(X.node,X.offset),ie.removeAllRanges(),Ue>Dt?(ie.addRange(ee),ie.extend(K.node,K.offset)):(ee.setEnd(K.node,K.offset),ie.addRange(ee))}}}}for(me=[],ie=S;ie=ie.parentNode;)ie.nodeType===1&&me.push({element:ie,left:ie.scrollLeft,top:ie.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<me.length;S++){var fe=me[S];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}Pf=!!fy,my=fy=null}finally{Tt=g,oe.p=d,O.T=c}}r.current=o,Xn=2}}function Gw(){if(Xn===2){Xn=0;var r=Ni,o=sc,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=O.T,O.T=null;var d=oe.p;oe.p=2;var g=Tt;Tt|=4;try{_w(r,o.alternate,o)}finally{Tt=g,oe.p=d,O.T=c}}Xn=3}}function $w(){if(Xn===4||Xn===3){Xn=0,gt();var r=Ni,o=sc,c=rc,d=Dw;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Xn=5:(Xn=0,sc=Ni=null,Kw(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(_i=null),ai(c),o=o.stateNode,pt&&typeof pt.onCommitFiberRoot=="function")try{pt.onCommitFiberRoot(_t,o,void 0,(o.current.flags&128)===128)}catch{}if(d!==null){o=O.T,g=oe.p,oe.p=2,O.T=null;try{for(var y=r.onRecoverableError,N=0;N<d.length;N++){var S=d[N];y(S.value,{componentStack:S.stack})}}finally{O.T=o,oe.p=g}}(rc&3)!==0&&_f(),na(r),g=r.pendingLanes,(c&4194090)!==0&&(g&42)!==0?r===Zp?ed++:(ed=0,Zp=r):ed=0,td(0)}}function Kw(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,Pu(o)))}function _f(r){return Hw(),Gw(),$w(),Qw()}function Qw(){if(Xn!==5)return!1;var r=Ni,o=Wp;Wp=0;var c=ai(rc),d=O.T,g=oe.p;try{oe.p=32>c?32:c,O.T=null,c=Jp,Jp=null;var y=Ni,N=rc;if(Xn=0,sc=Ni=null,rc=0,(Tt&6)!==0)throw Error(n(331));var S=Tt;if(Tt|=4,Rw(y.current),jw(y,y.current,N,c),Tt=S,td(0,!1),pt&&typeof pt.onPostCommitFiberRoot=="function")try{pt.onPostCommitFiberRoot(_t,y)}catch{}return!0}finally{oe.p=g,O.T=d,Kw(r,o)}}function Yw(r,o,c){o=cr(c,o),o=Rp(r.stateNode,o,2),r=fi(r,o,2),r!==null&&(us(r,2),na(r))}function Vt(r,o,c){if(r.tag===3)Yw(r,r,c);else for(;o!==null;){if(o.tag===3){Yw(o,r,c);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(_i===null||!_i.has(d))){r=cr(c,r),c=Z0(2),d=fi(o,c,2),d!==null&&(ew(c,d,o,r),us(d,2),na(d));break}}o=o.return}}function sy(r,o,c){var d=r.pingCache;if(d===null){d=r.pingCache=new _2;var g=new Set;d.set(o,g)}else g=d.get(o),g===void 0&&(g=new Set,d.set(o,g));g.has(c)||(Kp=!0,g.add(c),r=A2.bind(null,r,o,c),o.then(r,r))}function A2(r,o,c){var d=r.pingCache;d!==null&&d.delete(o),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,Lt===r&&(ht&c)===c&&(rn===4||rn===3&&(ht&62914560)===ht&&300>ct()-Xp?(Tt&2)===0&&ac(r,0):Qp|=c,nc===ht&&(nc=0)),na(r)}function Xw(r,o){o===0&&(o=zr()),r=Bl(r,o),r!==null&&(us(r,o),na(r))}function j2(r){var o=r.memoizedState,c=0;o!==null&&(c=o.retryLane),Xw(r,c)}function I2(r,o){var c=0;switch(r.tag){case 13:var d=r.stateNode,g=r.memoizedState;g!==null&&(c=g.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(o),Xw(r,c)}function C2(r,o){return lt(r,o)}var Nf=null,oc=null,ry=!1,Tf=!1,ay=!1,Bo=0;function na(r){r!==oc&&r.next===null&&(oc===null?Nf=oc=r:oc=oc.next=r),Tf=!0,ry||(ry=!0,k2())}function td(r,o){if(!ay&&Tf){ay=!0;do for(var c=!1,d=Nf;d!==null;){if(r!==0){var g=d.pendingLanes;if(g===0)var y=0;else{var N=d.suspendedLanes,S=d.pingedLanes;y=(1<<31-_n(42|r)+1)-1,y&=g&~(N&~S),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,e_(d,y))}else y=ht,y=Br(d,d===Lt?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||Nr(d,y)||(c=!0,e_(d,y));d=d.next}while(c);ay=!1}}function R2(){Ww()}function Ww(){Tf=ry=!1;var r=0;Bo!==0&&(U2()&&(r=Bo),Bo=0);for(var o=ct(),c=null,d=Nf;d!==null;){var g=d.next,y=Jw(d,o);y===0?(d.next=null,c===null?Nf=g:c.next=g,g===null&&(oc=c)):(c=d,(r!==0||(y&3)!==0)&&(Tf=!0)),d=g}td(r)}function Jw(r,o){for(var c=r.suspendedLanes,d=r.pingedLanes,g=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var N=31-_n(y),S=1<<N,H=g[N];H===-1?((S&c)===0||(S&d)!==0)&&(g[N]=fo(S,o)):H<=o&&(r.expiredLanes|=S),y&=~S}if(o=Lt,c=ht,c=Br(r,r===o?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,c===0||r===o&&(Et===2||Et===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&ze(d),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||Nr(r,c)){if(o=c&-c,o===r.callbackPriority)return o;switch(d!==null&&ze(d),ai(c)){case 2:case 8:c=an;break;case 32:c=$n;break;case 268435456:c=Ds;break;default:c=$n}return d=Zw.bind(null,r),c=lt(c,d),r.callbackPriority=o,r.callbackNode=c,o}return d!==null&&d!==null&&ze(d),r.callbackPriority=2,r.callbackNode=null,2}function Zw(r,o){if(Xn!==0&&Xn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(_f()&&r.callbackNode!==c)return null;var d=ht;return d=Br(r,r===Lt?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(Mw(r,d,o),Jw(r,ct()),r.callbackNode!=null&&r.callbackNode===c?Zw.bind(null,r):null)}function e_(r,o){if(_f())return null;Mw(r,o,!0)}function k2(){q2(function(){(Tt&6)!==0?lt(Gn,R2):Ww()})}function iy(){return Bo===0&&(Bo=qr()),Bo}function t_(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Il(""+r)}function n_(r,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,r.id&&c.setAttribute("form",r.id),o.parentNode.insertBefore(c,o),r=new FormData(r),c.parentNode.removeChild(c),r}function D2(r,o,c,d,g){if(o==="submit"&&c&&c.stateNode===g){var y=t_((g[nn]||null).action),N=d.submitter;N&&(o=(o=N[nn]||null)?t_(o.formAction):N.getAttribute("formAction"),o!==null&&(y=o,N=null));var S=new Cl("action","action",null,d,g);r.push({event:S,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Bo!==0){var H=N?n_(g,N):new FormData(g);Sp(c,{pending:!0,data:H,method:g.method,action:y},null,H)}}else typeof y=="function"&&(S.preventDefault(),H=N?n_(g,N):new FormData(g),Sp(c,{pending:!0,data:H,method:g.method,action:y},y,H))},currentTarget:g}]})}}for(var oy=0;oy<Gg.length;oy++){var ly=Gg[oy],P2=ly.toLowerCase(),M2=ly[0].toUpperCase()+ly.slice(1);jr(P2,"on"+M2)}jr(Mb,"onAnimationEnd"),jr(Ob,"onAnimationIteration"),jr(Vb,"onAnimationStart"),jr("dblclick","onDoubleClick"),jr("focusin","onFocus"),jr("focusout","onBlur"),jr(J1,"onTransitionRun"),jr(Z1,"onTransitionStart"),jr(e2,"onTransitionCancel"),jr(Lb,"onTransitionEnd"),je("onMouseEnter",["mouseout","mouseover"]),je("onMouseLeave",["mouseout","mouseover"]),je("onPointerEnter",["pointerout","pointerover"]),je("onPointerLeave",["pointerout","pointerover"]),xe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xe("onBeforeInput",["compositionend","keypress","textInput","paste"]),xe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nd));function s_(r,o){o=(o&4)!==0;for(var c=0;c<r.length;c++){var d=r[c],g=d.event;d=d.listeners;e:{var y=void 0;if(o)for(var N=d.length-1;0<=N;N--){var S=d[N],H=S.instance,se=S.currentTarget;if(S=S.listener,H!==y&&g.isPropagationStopped())break e;y=S,g.currentTarget=se;try{y(g)}catch(de){df(de)}g.currentTarget=null,y=H}else for(N=0;N<d.length;N++){if(S=d[N],H=S.instance,se=S.currentTarget,S=S.listener,H!==y&&g.isPropagationStopped())break e;y=S,g.currentTarget=se;try{y(g)}catch(de){df(de)}g.currentTarget=null,y=H}}}}function rt(r,o){var c=o[nr];c===void 0&&(c=o[nr]=new Set);var d=r+"__bubble";c.has(d)||(r_(o,r,2,!1),c.add(d))}function cy(r,o,c){var d=0;o&&(d|=4),r_(c,r,d,o)}var Ef="_reactListening"+Math.random().toString(36).slice(2);function uy(r){if(!r[Ef]){r[Ef]=!0,Pe.forEach(function(c){c!=="selectionchange"&&(O2.has(c)||cy(c,!1,r),cy(c,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Ef]||(o[Ef]=!0,cy("selectionchange",!1,o))}}function r_(r,o,c,d){switch(j_(o)){case 2:var g=cI;break;case 8:g=uI;break;default:g=Ty}c=g.bind(null,o,c,r),g=void 0,!or||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),d?g!==void 0?r.addEventListener(o,c,{capture:!0,passive:g}):r.addEventListener(o,c,!0):g!==void 0?r.addEventListener(o,c,{passive:g}):r.addEventListener(o,c,!1)}function dy(r,o,c,d,g){var y=d;if((o&1)===0&&(o&2)===0&&d!==null)e:for(;;){if(d===null)return;var N=d.tag;if(N===3||N===4){var S=d.stateNode.containerInfo;if(S===g)break;if(N===4)for(N=d.return;N!==null;){var H=N.tag;if((H===3||H===4)&&N.stateNode.containerInfo===g)return;N=N.return}for(;S!==null;){if(N=sr(S),N===null)return;if(H=N.tag,H===5||H===6||H===26||H===27){d=y=N;continue e}S=S.parentNode}}d=d.return}Sh(function(){var se=y,de=ir(c),me=[];e:{var ae=Fb.get(r);if(ae!==void 0){var ie=Cl,He=r;switch(r){case"keypress":if(Kr(c)===0)break e;case"keydown":case"keyup":ie=Ol;break;case"focusin":He="focus",ie=Dl;break;case"focusout":He="blur",ie=Dl;break;case"beforeblur":case"afterblur":ie=Dl;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=lr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=Vg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=Ph;break;case Mb:case Ob:case Vb:ie=Pl;break;case Lb:ie=Oh;break;case"scroll":case"scrollend":ie=Ah;break;case"wheel":ie=Vl;break;case"copy":case"cut":case"paste":ie=Ml;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=Su;break;case"toggle":case"beforetoggle":ie=Lh}var Ue=(o&4)!==0,Dt=!Ue&&(r==="scroll"||r==="scrollend"),X=Ue?ae!==null?ae+"Capture":null:ae;Ue=[];for(var K=se,ee;K!==null;){var fe=K;if(ee=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||ee===null||X===null||(fe=bo(K,X),fe!=null&&Ue.push(sd(K,fe,ee))),Dt)break;K=K.return}0<Ue.length&&(ae=new ie(ae,He,null,c,de),me.push({event:ae,listeners:Ue}))}}if((o&7)===0){e:{if(ae=r==="mouseover"||r==="pointerover",ie=r==="mouseout"||r==="pointerout",ae&&c!==pa&&(He=c.relatedTarget||c.fromElement)&&(sr(He)||He[Yt]))break e;if((ie||ae)&&(ae=de.window===de?de:(ae=de.ownerDocument)?ae.defaultView||ae.parentWindow:window,ie?(He=c.relatedTarget||c.toElement,ie=se,He=He?sr(He):null,He!==null&&(Dt=l(He),Ue=He.tag,He!==Dt||Ue!==5&&Ue!==27&&Ue!==6)&&(He=null)):(ie=null,He=se),ie!==He)){if(Ue=lr,fe="onMouseLeave",X="onMouseEnter",K="mouse",(r==="pointerout"||r==="pointerover")&&(Ue=Su,fe="onPointerLeave",X="onPointerEnter",K="pointer"),Dt=ie==null?ae:Vs(ie),ee=He==null?ae:Vs(He),ae=new Ue(fe,K+"leave",ie,c,de),ae.target=Dt,ae.relatedTarget=ee,fe=null,sr(de)===se&&(Ue=new Ue(X,K+"enter",He,c,de),Ue.target=ee,Ue.relatedTarget=Dt,fe=Ue),Dt=fe,ie&&He)t:{for(Ue=ie,X=He,K=0,ee=Ue;ee;ee=lc(ee))K++;for(ee=0,fe=X;fe;fe=lc(fe))ee++;for(;0<K-ee;)Ue=lc(Ue),K--;for(;0<ee-K;)X=lc(X),ee--;for(;K--;){if(Ue===X||X!==null&&Ue===X.alternate)break t;Ue=lc(Ue),X=lc(X)}Ue=null}else Ue=null;ie!==null&&a_(me,ae,ie,Ue,!1),He!==null&&Dt!==null&&a_(me,Dt,He,Ue,!0)}}e:{if(ae=se?Vs(se):window,ie=ae.nodeName&&ae.nodeName.toLowerCase(),ie==="select"||ie==="input"&&ae.type==="file")var Re=Tb;else if(En(ae))if(Eb)Re=Y1;else{Re=K1;var et=$1}else ie=ae.nodeName,!ie||ie.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?se&&vu(se.elementType)&&(Re=Tb):Re=Q1;if(Re&&(Re=Re(r,se))){wa(me,Re,c,de);break e}et&&et(r,ae,se),r==="focusout"&&se&&ae.type==="number"&&se.memoizedProps.value!=null&&li(ae,"number",ae.value)}switch(et=se?Vs(se):window,r){case"focusin":(En(et)||et.contentEditable==="true")&&(Ll=et,qg=se,Iu=null);break;case"focusout":Iu=qg=Ll=null;break;case"mousedown":zg=!0;break;case"contextmenu":case"mouseup":case"dragend":zg=!1,Db(me,c,de);break;case"selectionchange":if(W1)break;case"keydown":case"keyup":Db(me,c,de)}var Ve;if(Xr)e:{switch(r){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else ut?le(r,c)&&(Be="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Be="onCompositionStart");Be&&(_&&c.locale!=="ko"&&(ut||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&ut&&(Ve=wu()):($r=de,ci="value"in $r?$r.value:$r.textContent,ut=!0)),et=Sf(se,Be),0<et.length&&(Be=new Tu(Be,r,null,c,de),me.push({event:Be,listeners:et}),Ve?Be.data=Ve:(Ve=_e(c),Ve!==null&&(Be.data=Ve)))),(Ve=v?Tn(r,c):dt(r,c))&&(Be=Sf(se,"onBeforeInput"),0<Be.length&&(et=new Tu("onBeforeInput","beforeinput",null,c,de),me.push({event:et,listeners:Be}),et.data=Ve)),D2(me,r,se,c,de)}s_(me,o)})}function sd(r,o,c){return{instance:r,listener:o,currentTarget:c}}function Sf(r,o){for(var c=o+"Capture",d=[];r!==null;){var g=r,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=bo(r,c),g!=null&&d.unshift(sd(r,g,y)),g=bo(r,o),g!=null&&d.push(sd(r,g,y))),r.tag===3)return d;r=r.return}return[]}function lc(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function a_(r,o,c,d,g){for(var y=o._reactName,N=[];c!==null&&c!==d;){var S=c,H=S.alternate,se=S.stateNode;if(S=S.tag,H!==null&&H===d)break;S!==5&&S!==26&&S!==27||se===null||(H=se,g?(se=bo(c,y),se!=null&&N.unshift(sd(c,se,H))):g||(se=bo(c,y),se!=null&&N.push(sd(c,se,H)))),c=c.return}N.length!==0&&r.push({event:o,listeners:N})}var V2=/\r\n?/g,L2=/\u0000|\uFFFD/g;function i_(r){return(typeof r=="string"?r:""+r).replace(V2,`
`).replace(L2,"")}function o_(r,o){return o=i_(o),i_(r)===o}function Af(){}function kt(r,o,c,d,g,y){switch(c){case"children":typeof d=="string"?o==="body"||o==="textarea"&&d===""||ar(r,d):(typeof d=="number"||typeof d=="bigint")&&o!=="body"&&ar(r,""+d);break;case"className":ts(r,"class",d);break;case"tabIndex":ts(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ts(r,c,d);break;case"style":xu(r,d,y);break;case"data":if(o!=="object"){ts(r,"data",d);break}case"src":case"href":if(d===""&&(o!=="a"||c!=="href")){r.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Il(""+d),r.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(o!=="input"&&kt(r,o,"name",g.name,g,null),kt(r,o,"formEncType",g.formEncType,g,null),kt(r,o,"formMethod",g.formMethod,g,null),kt(r,o,"formTarget",g.formTarget,g,null)):(kt(r,o,"encType",g.encType,g,null),kt(r,o,"method",g.method,g,null),kt(r,o,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Il(""+d),r.setAttribute(c,d);break;case"onClick":d!=null&&(r.onclick=Af);break;case"onScroll":d!=null&&rt("scroll",r);break;case"onScrollEnd":d!=null&&rt("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(g.children!=null)throw Error(n(60));r.innerHTML=c}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}c=Il(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""+d):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":d===!0?r.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,d):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(c,d):r.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(c):r.setAttribute(c,d);break;case"popover":rt("beforetoggle",r),rt("toggle",r),Mn(r,"popover",d);break;case"xlinkActuate":ln(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":ln(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":ln(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":ln(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":ln(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":ln(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":ln(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":ln(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":ln(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Mn(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Mg.get(c)||c,Mn(r,c,d))}}function hy(r,o,c,d,g,y){switch(c){case"style":xu(r,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(g.children!=null)throw Error(n(60));r.innerHTML=c}}break;case"children":typeof d=="string"?ar(r,d):(typeof d=="number"||typeof d=="bigint")&&ar(r,""+d);break;case"onScroll":d!=null&&rt("scroll",r);break;case"onScrollEnd":d!=null&&rt("scrollend",r);break;case"onClick":d!=null&&(r.onclick=Af);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Q.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),o=c.slice(2,g?c.length-7:void 0),y=r[nn]||null,y=y!=null?y[c]:null,typeof y=="function"&&r.removeEventListener(o,y,g),typeof d=="function")){typeof y!="function"&&y!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(o,d,g);break e}c in r?r[c]=d:d===!0?r.setAttribute(c,""):Mn(r,c,d)}}}function Wn(r,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":rt("error",r),rt("load",r);var d=!1,g=!1,y;for(y in c)if(c.hasOwnProperty(y)){var N=c[y];if(N!=null)switch(y){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:kt(r,o,y,N,c,null)}}g&&kt(r,o,"srcSet",c.srcSet,c,null),d&&kt(r,o,"src",c.src,c,null);return;case"input":rt("invalid",r);var S=y=N=g=null,H=null,se=null;for(d in c)if(c.hasOwnProperty(d)){var de=c[d];if(de!=null)switch(d){case"name":g=de;break;case"type":N=de;break;case"checked":H=de;break;case"defaultChecked":se=de;break;case"value":y=de;break;case"defaultValue":S=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(n(137,o));break;default:kt(r,o,d,de,c,null)}}yo(r,y,S,H,se,N,g,!1),jl(r);return;case"select":rt("invalid",r),d=N=y=null;for(g in c)if(c.hasOwnProperty(g)&&(S=c[g],S!=null))switch(g){case"value":y=S;break;case"defaultValue":N=S;break;case"multiple":d=S;default:kt(r,o,g,S,c,null)}o=y,c=N,r.multiple=!!d,o!=null?ga(r,!!d,o,!1):c!=null&&ga(r,!!d,c,!0);return;case"textarea":rt("invalid",r),y=g=d=null;for(N in c)if(c.hasOwnProperty(N)&&(S=c[N],S!=null))switch(N){case"value":d=S;break;case"defaultValue":g=S;break;case"children":y=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:kt(r,o,N,S,c,null)}xo(r,d,g,y),jl(r);return;case"option":for(H in c)if(c.hasOwnProperty(H)&&(d=c[H],d!=null))switch(H){case"selected":r.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:kt(r,o,H,d,c,null)}return;case"dialog":rt("beforetoggle",r),rt("toggle",r),rt("cancel",r),rt("close",r);break;case"iframe":case"object":rt("load",r);break;case"video":case"audio":for(d=0;d<nd.length;d++)rt(nd[d],r);break;case"image":rt("error",r),rt("load",r);break;case"details":rt("toggle",r);break;case"embed":case"source":case"link":rt("error",r),rt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in c)if(c.hasOwnProperty(se)&&(d=c[se],d!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:kt(r,o,se,d,c,null)}return;default:if(vu(o)){for(de in c)c.hasOwnProperty(de)&&(d=c[de],d!==void 0&&hy(r,o,de,d,c,void 0));return}}for(S in c)c.hasOwnProperty(S)&&(d=c[S],d!=null&&kt(r,o,S,d,c,null))}function F2(r,o,c,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,N=null,S=null,H=null,se=null,de=null;for(ie in c){var me=c[ie];if(c.hasOwnProperty(ie)&&me!=null)switch(ie){case"checked":break;case"value":break;case"defaultValue":H=me;default:d.hasOwnProperty(ie)||kt(r,o,ie,null,d,me)}}for(var ae in d){var ie=d[ae];if(me=c[ae],d.hasOwnProperty(ae)&&(ie!=null||me!=null))switch(ae){case"type":y=ie;break;case"name":g=ie;break;case"checked":se=ie;break;case"defaultChecked":de=ie;break;case"value":N=ie;break;case"defaultValue":S=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(n(137,o));break;default:ie!==me&&kt(r,o,ae,ie,d,me)}}Ls(r,N,S,H,se,de,y,g);return;case"select":ie=N=S=ae=null;for(y in c)if(H=c[y],c.hasOwnProperty(y)&&H!=null)switch(y){case"value":break;case"multiple":ie=H;default:d.hasOwnProperty(y)||kt(r,o,y,null,d,H)}for(g in d)if(y=d[g],H=c[g],d.hasOwnProperty(g)&&(y!=null||H!=null))switch(g){case"value":ae=y;break;case"defaultValue":S=y;break;case"multiple":N=y;default:y!==H&&kt(r,o,g,y,d,H)}o=S,c=N,d=ie,ae!=null?ga(r,!!c,ae,!1):!!d!=!!c&&(o!=null?ga(r,!!c,o,!0):ga(r,!!c,c?[]:"",!1));return;case"textarea":ie=ae=null;for(S in c)if(g=c[S],c.hasOwnProperty(S)&&g!=null&&!d.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:kt(r,o,S,null,d,g)}for(N in d)if(g=d[N],y=c[N],d.hasOwnProperty(N)&&(g!=null||y!=null))switch(N){case"value":ae=g;break;case"defaultValue":ie=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==y&&kt(r,o,N,g,d,y)}Ct(r,ae,ie);return;case"option":for(var He in c)if(ae=c[He],c.hasOwnProperty(He)&&ae!=null&&!d.hasOwnProperty(He))switch(He){case"selected":r.selected=!1;break;default:kt(r,o,He,null,d,ae)}for(H in d)if(ae=d[H],ie=c[H],d.hasOwnProperty(H)&&ae!==ie&&(ae!=null||ie!=null))switch(H){case"selected":r.selected=ae&&typeof ae!="function"&&typeof ae!="symbol";break;default:kt(r,o,H,ae,d,ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in c)ae=c[Ue],c.hasOwnProperty(Ue)&&ae!=null&&!d.hasOwnProperty(Ue)&&kt(r,o,Ue,null,d,ae);for(se in d)if(ae=d[se],ie=c[se],d.hasOwnProperty(se)&&ae!==ie&&(ae!=null||ie!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(n(137,o));break;default:kt(r,o,se,ae,d,ie)}return;default:if(vu(o)){for(var Dt in c)ae=c[Dt],c.hasOwnProperty(Dt)&&ae!==void 0&&!d.hasOwnProperty(Dt)&&hy(r,o,Dt,void 0,d,ae);for(de in d)ae=d[de],ie=c[de],!d.hasOwnProperty(de)||ae===ie||ae===void 0&&ie===void 0||hy(r,o,de,ae,d,ie);return}}for(var X in c)ae=c[X],c.hasOwnProperty(X)&&ae!=null&&!d.hasOwnProperty(X)&&kt(r,o,X,null,d,ae);for(me in d)ae=d[me],ie=c[me],!d.hasOwnProperty(me)||ae===ie||ae==null&&ie==null||kt(r,o,me,ae,d,ie)}var fy=null,my=null;function jf(r){return r.nodeType===9?r:r.ownerDocument}function l_(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function c_(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function gy(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var py=null;function U2(){var r=window.event;return r&&r.type==="popstate"?r===py?!1:(py=r,!0):(py=null,!1)}var u_=typeof setTimeout=="function"?setTimeout:void 0,B2=typeof clearTimeout=="function"?clearTimeout:void 0,d_=typeof Promise=="function"?Promise:void 0,q2=typeof queueMicrotask=="function"?queueMicrotask:typeof d_<"u"?function(r){return d_.resolve(null).then(r).catch(z2)}:u_;function z2(r){setTimeout(function(){throw r})}function Ei(r){return r==="head"}function h_(r,o){var c=o,d=0,g=0;do{var y=c.nextSibling;if(r.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"){if(0<d&&8>d){c=d;var N=r.ownerDocument;if(c&1&&rd(N.documentElement),c&2&&rd(N.body),c&4)for(c=N.head,rd(c),N=c.firstChild;N;){var S=N.nextSibling,H=N.nodeName;N[Hr]||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&N.rel.toLowerCase()==="stylesheet"||c.removeChild(N),N=S}}if(g===0){r.removeChild(y),hd(o);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:d=c.charCodeAt(0)-48;else d=0;c=y}while(c);hd(o)}function yy(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":yy(c),Dn(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function H2(r,o,c,d){for(;r.nodeType===1;){var g=c;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[Hr])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=Cr(r.nextSibling),r===null)break}return null}function G2(r,o,c){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=Cr(r.nextSibling),r===null))return null;return r}function xy(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function $2(r,o){var c=r.ownerDocument;if(r.data!=="$?"||c.readyState==="complete")o();else{var d=function(){o(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function Cr(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return r}var vy=null;function f_(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return r;o--}else c==="/$"&&o++}r=r.previousSibling}return null}function m_(r,o,c){switch(o=jf(c),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function rd(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);Dn(r)}var gr=new Map,g_=new Set;function If(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Pa=oe.d;oe.d={f:K2,r:Q2,D:Y2,C:X2,L:W2,m:J2,X:eI,S:Z2,M:tI};function K2(){var r=Pa.f(),o=bf();return r||o}function Q2(r){var o=Os(r);o!==null&&o.tag===5&&o.type==="form"?M0(o):Pa.r(r)}var cc=typeof document>"u"?null:document;function p_(r,o,c){var d=cc;if(d&&typeof o=="string"&&o){var g=fn(o);g='link[rel="'+r+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),g_.has(g)||(g_.add(g),r={rel:r,crossOrigin:c,href:o},d.querySelector(g)===null&&(o=d.createElement("link"),Wn(o,"link",r),Xt(o),d.head.appendChild(o)))}}function Y2(r){Pa.D(r),p_("dns-prefetch",r,null)}function X2(r,o){Pa.C(r,o),p_("preconnect",r,o)}function W2(r,o,c){Pa.L(r,o,c);var d=cc;if(d&&r&&o){var g='link[rel="preload"][as="'+fn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+fn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+fn(c.imageSizes)+'"]')):g+='[href="'+fn(r)+'"]';var y=g;switch(o){case"style":y=uc(r);break;case"script":y=dc(r)}gr.has(y)||(r=x({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:r,as:o},c),gr.set(y,r),d.querySelector(g)!==null||o==="style"&&d.querySelector(ad(y))||o==="script"&&d.querySelector(id(y))||(o=d.createElement("link"),Wn(o,"link",r),Xt(o),d.head.appendChild(o)))}}function J2(r,o){Pa.m(r,o);var c=cc;if(c&&r){var d=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+fn(d)+'"][href="'+fn(r)+'"]',y=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=dc(r)}if(!gr.has(y)&&(r=x({rel:"modulepreload",href:r},o),gr.set(y,r),c.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(id(y)))return}d=c.createElement("link"),Wn(d,"link",r),Xt(d),c.head.appendChild(d)}}}function Z2(r,o,c){Pa.S(r,o,c);var d=cc;if(d&&r){var g=Pn(d).hoistableStyles,y=uc(r);o=o||"default";var N=g.get(y);if(!N){var S={loading:0,preload:null};if(N=d.querySelector(ad(y)))S.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":o},c),(c=gr.get(y))&&by(r,c);var H=N=d.createElement("link");Xt(H),Wn(H,"link",r),H._p=new Promise(function(se,de){H.onload=se,H.onerror=de}),H.addEventListener("load",function(){S.loading|=1}),H.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Cf(N,o,d)}N={type:"stylesheet",instance:N,count:1,state:S},g.set(y,N)}}}function eI(r,o){Pa.X(r,o);var c=cc;if(c&&r){var d=Pn(c).hoistableScripts,g=dc(r),y=d.get(g);y||(y=c.querySelector(id(g)),y||(r=x({src:r,async:!0},o),(o=gr.get(g))&&wy(r,o),y=c.createElement("script"),Xt(y),Wn(y,"link",r),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function tI(r,o){Pa.M(r,o);var c=cc;if(c&&r){var d=Pn(c).hoistableScripts,g=dc(r),y=d.get(g);y||(y=c.querySelector(id(g)),y||(r=x({src:r,async:!0,type:"module"},o),(o=gr.get(g))&&wy(r,o),y=c.createElement("script"),Xt(y),Wn(y,"link",r),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function y_(r,o,c,d){var g=(g=Se.current)?If(g):null;if(!g)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=uc(c.href),c=Pn(g).hoistableStyles,d=c.get(o),d||(d={type:"style",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=uc(c.href);var y=Pn(g).hoistableStyles,N=y.get(r);if(N||(g=g.ownerDocument||g,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,N),(y=g.querySelector(ad(r)))&&!y._p&&(N.instance=y,N.state.loading=5),gr.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},gr.set(r,c),y||nI(g,r,c,N.state))),o&&d===null)throw Error(n(528,""));return N}if(o&&d!==null)throw Error(n(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=dc(c),c=Pn(g).hoistableScripts,d=c.get(o),d||(d={type:"script",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function uc(r){return'href="'+fn(r)+'"'}function ad(r){return'link[rel="stylesheet"]['+r+"]"}function x_(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function nI(r,o,c,d){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?d.loading=1:(o=r.createElement("link"),d.preload=o,o.addEventListener("load",function(){return d.loading|=1}),o.addEventListener("error",function(){return d.loading|=2}),Wn(o,"link",c),Xt(o),r.head.appendChild(o))}function dc(r){return'[src="'+fn(r)+'"]'}function id(r){return"script[async]"+r}function v_(r,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var d=r.querySelector('style[data-href~="'+fn(c.href)+'"]');if(d)return o.instance=d,Xt(d),d;var g=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),Xt(d),Wn(d,"style",g),Cf(d,c.precedence,r),o.instance=d;case"stylesheet":g=uc(c.href);var y=r.querySelector(ad(g));if(y)return o.state.loading|=4,o.instance=y,Xt(y),y;d=x_(c),(g=gr.get(g))&&by(d,g),y=(r.ownerDocument||r).createElement("link"),Xt(y);var N=y;return N._p=new Promise(function(S,H){N.onload=S,N.onerror=H}),Wn(y,"link",d),o.state.loading|=4,Cf(y,c.precedence,r),o.instance=y;case"script":return y=dc(c.src),(g=r.querySelector(id(y)))?(o.instance=g,Xt(g),g):(d=c,(g=gr.get(y))&&(d=x({},c),wy(d,g)),r=r.ownerDocument||r,g=r.createElement("script"),Xt(g),Wn(g,"link",d),r.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(d=o.instance,o.state.loading|=4,Cf(d,c.precedence,r));return o.instance}function Cf(r,o,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,y=g,N=0;N<d.length;N++){var S=d[N];if(S.dataset.precedence===o)y=S;else if(y!==g)break}y?y.parentNode.insertBefore(r,y.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(r,o.firstChild))}function by(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function wy(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var Rf=null;function b_(r,o,c){if(Rf===null){var d=new Map,g=Rf=new Map;g.set(c,d)}else g=Rf,d=g.get(c),d||(d=new Map,g.set(c,d));if(d.has(r))return d;for(d.set(r,null),c=c.getElementsByTagName(r),g=0;g<c.length;g++){var y=c[g];if(!(y[Hr]||y[tn]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var N=y.getAttribute(o)||"";N=r+N;var S=d.get(N);S?S.push(y):d.set(N,[y])}}return d}function w_(r,o,c){r=r.ownerDocument||r,r.head.insertBefore(c,o==="title"?r.querySelector("head > title"):null)}function sI(r,o,c){if(c===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function __(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var od=null;function rI(){}function aI(r,o,c){if(od===null)throw Error(n(475));var d=od;if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=uc(c.href),y=r.querySelector(ad(g));if(y){r=y._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(d.count++,d=kf.bind(d),r.then(d,d)),o.state.loading|=4,o.instance=y,Xt(y);return}y=r.ownerDocument||r,c=x_(c),(g=gr.get(g))&&by(c,g),y=y.createElement("link"),Xt(y);var N=y;N._p=new Promise(function(S,H){N.onload=S,N.onerror=H}),Wn(y,"link",c),o.instance=y}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(d.count++,o=kf.bind(d),r.addEventListener("load",o),r.addEventListener("error",o))}}function iI(){if(od===null)throw Error(n(475));var r=od;return r.stylesheets&&r.count===0&&_y(r,r.stylesheets),0<r.count?function(o){var c=setTimeout(function(){if(r.stylesheets&&_y(r,r.stylesheets),r.unsuspend){var d=r.unsuspend;r.unsuspend=null,d()}},6e4);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(c)}}:null}function kf(){if(this.count--,this.count===0){if(this.stylesheets)_y(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Df=null;function _y(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Df=new Map,o.forEach(oI,r),Df=null,kf.call(r))}function oI(r,o){if(!(o.state.loading&4)){var c=Df.get(r);if(c)var d=c.get(null);else{c=new Map,Df.set(r,c);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var N=g[y];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(c.set(N.dataset.precedence,N),d=N)}d&&c.set(null,d)}g=o.instance,N=g.getAttribute("data-precedence"),y=c.get(N)||d,y===d&&c.set(null,g),c.set(N,g),this.count++,d=kf.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),y?y.parentNode.insertBefore(g,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),o.state.loading|=4}}var ld={$$typeof:q,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function lI(r,o,c,d,g,y,N,S){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Tr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tr(0),this.hiddenUpdates=Tr(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function N_(r,o,c,d,g,y,N,S,H,se,de,me){return r=new lI(r,o,c,N,S,H,se,me),o=1,y===!0&&(o|=24),y=Us(3,null,null,o),r.current=y,y.stateNode=r,o=sp(),o.refCount++,r.pooledCache=o,o.refCount++,y.memoizedState={element:d,isDehydrated:c,cache:o},op(y),r}function T_(r){return r?(r=ql,r):ql}function E_(r,o,c,d,g,y){g=T_(g),d.context===null?d.context=g:d.pendingContext=g,d=hi(o),d.payload={element:c},y=y===void 0?null:y,y!==null&&(d.callback=y),c=fi(r,d,o),c!==null&&(Gs(c,r,o),Lu(c,r,o))}function S_(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<o?c:o}}function Ny(r,o){S_(r,o),(r=r.alternate)&&S_(r,o)}function A_(r){if(r.tag===13){var o=Bl(r,67108864);o!==null&&Gs(o,r,67108864),Ny(r,67108864)}}var Pf=!0;function cI(r,o,c,d){var g=O.T;O.T=null;var y=oe.p;try{oe.p=2,Ty(r,o,c,d)}finally{oe.p=y,O.T=g}}function uI(r,o,c,d){var g=O.T;O.T=null;var y=oe.p;try{oe.p=8,Ty(r,o,c,d)}finally{oe.p=y,O.T=g}}function Ty(r,o,c,d){if(Pf){var g=Ey(d);if(g===null)dy(r,o,d,Mf,c),I_(r,d);else if(hI(g,r,o,c,d))d.stopPropagation();else if(I_(r,d),o&4&&-1<dI.indexOf(r)){for(;g!==null;){var y=Os(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var N=kn(y.pendingLanes);if(N!==0){var S=y;for(S.pendingLanes|=2,S.entangledLanes|=2;N;){var H=1<<31-_n(N);S.entanglements[1]|=H,N&=~H}na(y),(Tt&6)===0&&(xf=ct()+500,td(0))}}break;case 13:S=Bl(y,2),S!==null&&Gs(S,y,2),bf(),Ny(y,2)}if(y=Ey(d),y===null&&dy(r,o,d,Mf,c),y===g)break;g=y}g!==null&&d.stopPropagation()}else dy(r,o,d,null,c)}}function Ey(r){return r=ir(r),Sy(r)}var Mf=null;function Sy(r){if(Mf=null,r=sr(r),r!==null){var o=l(r);if(o===null)r=null;else{var c=o.tag;if(c===13){if(r=u(o),r!==null)return r;r=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Mf=r,null}function j_(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(It()){case Gn:return 2;case an:return 8;case $n:case _r:return 32;case Ds:return 268435456;default:return 32}default:return 32}}var Ay=!1,Si=null,Ai=null,ji=null,cd=new Map,ud=new Map,Ii=[],dI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function I_(r,o){switch(r){case"focusin":case"focusout":Si=null;break;case"dragenter":case"dragleave":Ai=null;break;case"mouseover":case"mouseout":ji=null;break;case"pointerover":case"pointerout":cd.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ud.delete(o.pointerId)}}function dd(r,o,c,d,g,y){return r===null||r.nativeEvent!==y?(r={blockedOn:o,domEventName:c,eventSystemFlags:d,nativeEvent:y,targetContainers:[g]},o!==null&&(o=Os(o),o!==null&&A_(o)),r):(r.eventSystemFlags|=d,o=r.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),r)}function hI(r,o,c,d,g){switch(o){case"focusin":return Si=dd(Si,r,o,c,d,g),!0;case"dragenter":return Ai=dd(Ai,r,o,c,d,g),!0;case"mouseover":return ji=dd(ji,r,o,c,d,g),!0;case"pointerover":var y=g.pointerId;return cd.set(y,dd(cd.get(y)||null,r,o,c,d,g)),!0;case"gotpointercapture":return y=g.pointerId,ud.set(y,dd(ud.get(y)||null,r,o,c,d,g)),!0}return!1}function C_(r){var o=sr(r.target);if(o!==null){var c=l(o);if(c!==null){if(o=c.tag,o===13){if(o=u(c),o!==null){r.blockedOn=o,ii(r.priority,function(){if(c.tag===13){var d=Hs();d=ds(d);var g=Bl(c,d);g!==null&&Gs(g,c,d),Ny(c,d)}});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Of(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var c=Ey(r.nativeEvent);if(c===null){c=r.nativeEvent;var d=new c.constructor(c.type,c);pa=d,c.target.dispatchEvent(d),pa=null}else return o=Os(c),o!==null&&A_(o),r.blockedOn=c,!1;o.shift()}return!0}function R_(r,o,c){Of(r)&&c.delete(o)}function fI(){Ay=!1,Si!==null&&Of(Si)&&(Si=null),Ai!==null&&Of(Ai)&&(Ai=null),ji!==null&&Of(ji)&&(ji=null),cd.forEach(R_),ud.forEach(R_)}function Vf(r,o){r.blockedOn===o&&(r.blockedOn=null,Ay||(Ay=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,fI)))}var Lf=null;function k_(r){Lf!==r&&(Lf=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Lf===r&&(Lf=null);for(var o=0;o<r.length;o+=3){var c=r[o],d=r[o+1],g=r[o+2];if(typeof d!="function"){if(Sy(d||c)===null)continue;break}var y=Os(c);y!==null&&(r.splice(o,3),o-=3,Sp(y,{pending:!0,data:g,method:c.method,action:d},d,g))}}))}function hd(r){function o(H){return Vf(H,r)}Si!==null&&Vf(Si,r),Ai!==null&&Vf(Ai,r),ji!==null&&Vf(ji,r),cd.forEach(o),ud.forEach(o);for(var c=0;c<Ii.length;c++){var d=Ii[c];d.blockedOn===r&&(d.blockedOn=null)}for(;0<Ii.length&&(c=Ii[0],c.blockedOn===null);)C_(c),c.blockedOn===null&&Ii.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var g=c[d],y=c[d+1],N=g[nn]||null;if(typeof y=="function")N||k_(c);else if(N){var S=null;if(y&&y.hasAttribute("formAction")){if(g=y,N=y[nn]||null)S=N.formAction;else if(Sy(g)!==null)continue}else S=N.action;typeof S=="function"?c[d+1]=S:(c.splice(d,3),d-=3),k_(c)}}}function jy(r){this._internalRoot=r}Ff.prototype.render=jy.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var c=o.current,d=Hs();E_(c,d,r,o,null,null)},Ff.prototype.unmount=jy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;E_(r.current,2,null,r,null,null),bf(),o[Yt]=null}};function Ff(r){this._internalRoot=r}Ff.prototype.unstable_scheduleHydration=function(r){if(r){var o=Er();r={blockedOn:null,target:r,priority:o};for(var c=0;c<Ii.length&&o!==0&&o<Ii[c].priority;c++);Ii.splice(c,0,r),c===0&&C_(r)}};var D_=e.version;if(D_!=="19.1.1")throw Error(n(527,D_,"19.1.1"));oe.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=m(o),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var mI={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uf.isDisabled&&Uf.supportsFiber)try{_t=Uf.inject(mI),pt=Uf}catch{}}return md.createRoot=function(r,o){if(!a(r))throw Error(n(299));var c=!1,d="",g=Y0,y=X0,N=W0,S=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(y=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(S=o.unstable_transitionCallbacks)),o=N_(r,1,!1,null,null,c,d,g,y,N,S,null),r[Yt]=o.current,uy(r),new jy(o)},md.hydrateRoot=function(r,o,c){if(!a(r))throw Error(n(299));var d=!1,g="",y=Y0,N=X0,S=W0,H=null,se=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(N=c.onCaughtError),c.onRecoverableError!==void 0&&(S=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(H=c.unstable_transitionCallbacks),c.formState!==void 0&&(se=c.formState)),o=N_(r,1,!0,o,c??null,d,g,y,N,S,H,se),o.context=T_(null),c=o.current,d=Hs(),d=ds(d),g=hi(d),g.callback=null,fi(c,g,d),c=d,o.current.lanes=c,us(o,c),na(o),r[Yt]=o.current,uy(r),new Ff(o)},md.version="19.1.1",md}var z_;function TI(){if(z_)return Ry.exports;z_=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ry.exports=NI(),Ry.exports}var EI=TI();const SI=()=>{};var H_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE=function(s){const e=[];let t=0;for(let n=0;n<s.length;n++){let a=s.charCodeAt(n);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++n)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},AI=function(s){const e=[];let t=0,n=0;for(;t<s.length;){const a=s[t++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const l=s[t++];e[n++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=s[t++],u=s[t++],h=s[t++],m=((a&7)<<18|(l&63)<<12|(u&63)<<6|h&63)-65536;e[n++]=String.fromCharCode(55296+(m>>10)),e[n++]=String.fromCharCode(56320+(m&1023))}else{const l=s[t++],u=s[t++];e[n++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},pE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<s.length;a+=3){const l=s[a],u=a+1<s.length,h=u?s[a+1]:0,m=a+2<s.length,p=m?s[a+2]:0,x=l>>2,w=(l&3)<<4|h>>4;let b=(h&15)<<2|p>>6,E=p&63;m||(E=64,u||(b=64)),n.push(t[x],t[w],t[b],t[E])}return n.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(gE(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):AI(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<s.length;){const l=t[s.charAt(a++)],h=a<s.length?t[s.charAt(a)]:0;++a;const p=a<s.length?t[s.charAt(a)]:64;++a;const w=a<s.length?t[s.charAt(a)]:64;if(++a,l==null||h==null||p==null||w==null)throw new jI;const b=l<<2|h>>4;if(n.push(b),p!==64){const E=h<<4&240|p>>2;if(n.push(E),w!==64){const R=p<<6&192|w;n.push(R)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class jI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const II=function(s){const e=gE(s);return pE.encodeByteArray(e,!0)},xm=function(s){return II(s).replace(/\./g,"")},yE=function(s){try{return pE.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=()=>xE().__FIREBASE_DEFAULTS__,RI=()=>{if(typeof process>"u"||typeof H_>"u")return;const s=H_.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},kI=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&yE(s[1]);return e&&JSON.parse(e)},Ym=()=>{try{return SI()||CI()||RI()||kI()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},vE=s=>Ym()?.emulatorHosts?.[s],bE=s=>{const e=vE(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},wE=()=>Ym()?.config,_E=s=>Ym()?.[`_${s}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Xm(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",a=s.iat||0,l=s.sub||s.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...s};return[xm(JSON.stringify(t)),xm(JSON.stringify(u)),""].join(".")}const Cd={};function MI(){const s={prod:[],emulator:[]};for(const e of Object.keys(Cd))Cd[e]?s.emulator.push(e):s.prod.push(e);return s}function OI(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let G_=!1;function Wx(s,e){if(typeof window>"u"||typeof document>"u"||!Za(window.location.host)||Cd[s]===e||Cd[s]||G_)return;Cd[s]=e;function t(b){return`__firebase__banner__${b}`}const n="__firebase__banner",l=MI().prod.length>0;function u(){const b=document.getElementById(n);b&&b.remove()}function h(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function m(b,E){b.setAttribute("width","24"),b.setAttribute("id",E),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{G_=!0,u()},b}function x(b,E){b.setAttribute("id",E),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function w(){const b=OI(n),E=t("text"),R=document.getElementById(E)||document.createElement("span"),k=t("learnmore"),U=document.getElementById(k)||document.createElement("a"),z=t("preprendIcon"),B=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const q=b.element;h(q),x(U,k);const G=p();m(B,z),q.append(B,R,U,G),document.body.appendChild(q)}l?(R.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function VI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(In())}function NE(){const s=Ym()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function LI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function TE(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function FI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function UI(){const s=In();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function EE(){return!NE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SE(){return!NE()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Jx(){try{return typeof indexedDB=="object"}catch{return!1}}function AE(){return new Promise((s,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(n),s(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}function BI(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI="FirebaseError";class wr extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=qI,Object.setPrototypeOf(this,wr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yl.prototype.create)}}class yl{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?zI(l,n):"Error",h=`${this.serviceName}: ${u} (${a}).`;return new wr(a,h,n)}}function zI(s,e){return s.replace(HI,(t,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const HI=/\{\$([^}]+)}/g;function GI(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function xr(s,e){if(s===e)return!0;const t=Object.keys(s),n=Object.keys(e);for(const a of t){if(!n.includes(a))return!1;const l=s[a],u=e[a];if($_(l)&&$_(u)){if(!xr(l,u))return!1}else if(l!==u)return!1}for(const a of n)if(!t.includes(a))return!1;return!0}function $_(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ah(s){const e=[];for(const[t,n]of Object.entries(s))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function $I(s,e){const t=new KI(s,e);return t.subscribe.bind(t)}class KI{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let a;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");QI(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:n},a.next===void 0&&(a.next=My),a.error===void 0&&(a.error=My),a.complete===void 0&&(a.complete=My);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function QI(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function My(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=1e3,XI=2,WI=14400*1e3,JI=.5;function K_(s,e=YI,t=XI){const n=e*Math.pow(t,s),a=Math.round(JI*n*(Math.random()-.5)*2);return Math.min(WI,n+a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(s){return s&&s._delegate?s._delegate:s}class vr{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new DI;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tC(e))try{this.getOrInitializeService({instanceIdentifier:zo})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});n.resolve(l)}catch{}}}}clearInstance(e=zo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=zo){return this.instances.has(e)}getOptions(e=zo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[l,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(l);n===h&&u.resolve(a)}return a}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const l=this.instances.get(n);return l&&e(l,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:eC(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=zo){return this.component?this.component.multipleInstances?e:zo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eC(s){return s===zo?void 0:s}function tC(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ZI(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(it||(it={}));const sC={debug:it.DEBUG,verbose:it.VERBOSE,info:it.INFO,warn:it.WARN,error:it.ERROR,silent:it.SILENT},rC=it.INFO,aC={[it.DEBUG]:"log",[it.VERBOSE]:"log",[it.INFO]:"info",[it.WARN]:"warn",[it.ERROR]:"error"},iC=(s,e,...t)=>{if(e<s.logLevel)return;const n=new Date().toISOString(),a=aC[e];if(a)console[a](`[${n}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wm{constructor(e){this.name=e,this._logLevel=rC,this._logHandler=iC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in it))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?sC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,it.DEBUG,...e),this._logHandler(this,it.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,it.VERBOSE,...e),this._logHandler(this,it.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,it.INFO,...e),this._logHandler(this,it.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,it.WARN,...e),this._logHandler(this,it.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,it.ERROR,...e),this._logHandler(this,it.ERROR,...e)}}const oC=(s,e)=>e.some(t=>s instanceof t);let Q_,Y_;function lC(){return Q_||(Q_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cC(){return Y_||(Y_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jE=new WeakMap,ox=new WeakMap,IE=new WeakMap,Oy=new WeakMap,Zx=new WeakMap;function uC(s){const e=new Promise((t,n)=>{const a=()=>{s.removeEventListener("success",l),s.removeEventListener("error",u)},l=()=>{t(Hi(s.result)),a()},u=()=>{n(s.error),a()};s.addEventListener("success",l),s.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&jE.set(t,s)}).catch(()=>{}),Zx.set(e,s),e}function dC(s){if(ox.has(s))return;const e=new Promise((t,n)=>{const a=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",u),s.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{n(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",l),s.addEventListener("error",u),s.addEventListener("abort",u)});ox.set(s,e)}let lx={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return ox.get(s);if(e==="objectStoreNames")return s.objectStoreNames||IE.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Hi(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function hC(s){lx=s(lx)}function fC(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=s.call(Vy(this),e,...t);return IE.set(n,e.sort?e.sort():[e]),Hi(n)}:cC().includes(s)?function(...e){return s.apply(Vy(this),e),Hi(jE.get(this))}:function(...e){return Hi(s.apply(Vy(this),e))}}function mC(s){return typeof s=="function"?fC(s):(s instanceof IDBTransaction&&dC(s),oC(s,lC())?new Proxy(s,lx):s)}function Hi(s){if(s instanceof IDBRequest)return uC(s);if(Oy.has(s))return Oy.get(s);const e=mC(s);return e!==s&&(Oy.set(s,e),Zx.set(e,s)),e}const Vy=s=>Zx.get(s);function CE(s,e,{blocked:t,upgrade:n,blocking:a,terminated:l}={}){const u=indexedDB.open(s,e),h=Hi(u);return n&&u.addEventListener("upgradeneeded",m=>{n(Hi(u.result),m.oldVersion,m.newVersion,Hi(u.transaction),m)}),t&&u.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),h.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",p=>a(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const gC=["get","getKey","getAll","getAllKeys","count"],pC=["put","add","delete","clear"],Ly=new Map;function X_(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Ly.get(e))return Ly.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,a=pC.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(a||gC.includes(t)))return;const l=async function(u,...h){const m=this.transaction(u,a?"readwrite":"readonly");let p=m.store;return n&&(p=p.index(h.shift())),(await Promise.all([p[t](...h),a&&m.done]))[0]};return Ly.set(e,l),l}hC(s=>({...s,get:(e,t,n)=>X_(e,t)||s.get(e,t,n),has:(e,t)=>!!X_(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(xC(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function xC(s){return s.getComponent()?.type==="VERSION"}const cx="@firebase/app",W_="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa=new Wm("@firebase/app"),vC="@firebase/app-compat",bC="@firebase/analytics-compat",wC="@firebase/analytics",_C="@firebase/app-check-compat",NC="@firebase/app-check",TC="@firebase/auth",EC="@firebase/auth-compat",SC="@firebase/database",AC="@firebase/data-connect",jC="@firebase/database-compat",IC="@firebase/functions",CC="@firebase/functions-compat",RC="@firebase/installations",kC="@firebase/installations-compat",DC="@firebase/messaging",PC="@firebase/messaging-compat",MC="@firebase/performance",OC="@firebase/performance-compat",VC="@firebase/remote-config",LC="@firebase/remote-config-compat",FC="@firebase/storage",UC="@firebase/storage-compat",BC="@firebase/firestore",qC="@firebase/ai",zC="@firebase/firestore-compat",HC="firebase",GC="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm="[DEFAULT]",$C={[cx]:"fire-core",[vC]:"fire-core-compat",[wC]:"fire-analytics",[bC]:"fire-analytics-compat",[NC]:"fire-app-check",[_C]:"fire-app-check-compat",[TC]:"fire-auth",[EC]:"fire-auth-compat",[SC]:"fire-rtdb",[AC]:"fire-data-connect",[jC]:"fire-rtdb-compat",[IC]:"fire-fn",[CC]:"fire-fn-compat",[RC]:"fire-iid",[kC]:"fire-iid-compat",[DC]:"fire-fcm",[PC]:"fire-fcm-compat",[MC]:"fire-perf",[OC]:"fire-perf-compat",[VC]:"fire-rc",[LC]:"fire-rc-compat",[FC]:"fire-gcs",[UC]:"fire-gcs-compat",[BC]:"fire-fst",[zC]:"fire-fst-compat",[qC]:"fire-vertex","fire-js":"fire-js",[HC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bm=new Map,KC=new Map,ux=new Map;function J_(s,e){try{s.container.addComponent(e)}catch(t){Qa.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function Ur(s){const e=s.name;if(ux.has(e))return Qa.debug(`There were multiple attempts to register component ${e}.`),!1;ux.set(e,s);for(const t of bm.values())J_(t,s);for(const t of KC.values())J_(t,s);return!0}function ma(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function QC(s,e,t=vm){ma(s,e).clearInstance(t)}function Qs(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gi=new yl("app","Firebase",YC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new vr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tu=GC;function RE(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const n={name:vm,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw Gi.create("bad-app-name",{appName:String(a)});if(t||(t=wE()),!t)throw Gi.create("no-options");const l=bm.get(a);if(l){if(xr(t,l.options)&&xr(n,l.config))return l;throw Gi.create("duplicate-app",{appName:a})}const u=new nC(a);for(const m of ux.values())u.addComponent(m);const h=new XC(t,n,u);return bm.set(a,h),h}function Jm(s=vm){const e=bm.get(s);if(!e&&s===vm&&wE())return RE();if(!e)throw Gi.create("no-app",{appName:s});return e}function js(s,e,t){let n=$C[s]??s;t&&(n+=`-${t}`);const a=n.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${n}" with version "${e}":`];a&&u.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qa.warn(u.join(" "));return}Ur(new vr(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC="firebase-heartbeat-database",JC=1,zd="firebase-heartbeat-store";let Fy=null;function kE(){return Fy||(Fy=CE(WC,JC,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(zd)}catch(t){console.warn(t)}}}}).catch(s=>{throw Gi.create("idb-open",{originalErrorMessage:s.message})})),Fy}async function ZC(s){try{const t=(await kE()).transaction(zd),n=await t.objectStore(zd).get(DE(s));return await t.done,n}catch(e){if(e instanceof wr)Qa.warn(e.message);else{const t=Gi.create("idb-get",{originalErrorMessage:e?.message});Qa.warn(t.message)}}}async function Z_(s,e){try{const n=(await kE()).transaction(zd,"readwrite");await n.objectStore(zd).put(e,DE(s)),await n.done}catch(t){if(t instanceof wr)Qa.warn(t.message);else{const n=Gi.create("idb-set",{originalErrorMessage:t?.message});Qa.warn(n.message)}}}function DE(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR=1024,tR=30;class nR{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new rR(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=eN();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(a=>a.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>tR){const a=aR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Qa.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=eN(),{heartbeatsToSend:t,unsentEntries:n}=sR(this._heartbeatsCache.heartbeats),a=xm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Qa.warn(e),""}}}function eN(){return new Date().toISOString().substring(0,10)}function sR(s,e=eR){const t=[];let n=s.slice();for(const a of s){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),tN(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),tN(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class rR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Jx()?AE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ZC(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Z_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Z_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function tN(s){return xm(JSON.stringify({version:2,heartbeats:s})).length}function aR(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let n=1;n<s.length;n++)s[n].date<t&&(t=s[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iR(s){Ur(new vr("platform-logger",e=>new yC(e),"PRIVATE")),Ur(new vr("heartbeat",e=>new nR(e),"PRIVATE")),js(cx,W_,s),js(cx,W_,"esm2020"),js("fire-js","")}iR("");function PE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const oR=PE,ME=new yl("auth","Firebase",PE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wm=new Wm("@firebase/auth");function lR(s,...e){wm.logLevel<=it.WARN&&wm.warn(`Auth (${tu}): ${s}`,...e)}function em(s,...e){wm.logLevel<=it.ERROR&&wm.error(`Auth (${tu}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(s,...e){throw tv(s,...e)}function Vr(s,...e){return tv(s,...e)}function ev(s,e,t){const n={...oR(),[e]:t};return new yl("auth","Firebase",n).create(e,{appName:s.name})}function $i(s){return ev(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function OE(s,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&ha(s,"argument-error"),ev(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function tv(s,...e){if(typeof s!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=s.name),s._errorFactory.create(t,...n)}return ME.create(s,...e)}function $e(s,e,...t){if(!s)throw tv(e,...t)}function Ua(s){const e="INTERNAL ASSERTION FAILED: "+s;throw em(e),new Error(e)}function Ya(s,e){s||Ua(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(){return typeof self<"u"&&self.location?.href||""}function cR(){return nN()==="http:"||nN()==="https:"}function nN(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cR()||TE()||"connection"in navigator)?navigator.onLine:!0}function dR(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ya(t>e,"Short delay should be less than long delay!"),this.isMobile=VI()||FI()}get(){return uR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(s,e){Ya(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ua("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ua("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ua("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],mR=new ih(3e4,6e4);function sv(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function nu(s,e,t,n,a={}){return LE(s,a,async()=>{let l={},u={};n&&(e==="GET"?u=n:l={body:JSON.stringify(n)});const h=ah({key:s.config.apiKey,...u}).slice(1),m=await s._getAdditionalHeaders();m["Content-Type"]="application/json",s.languageCode&&(m["X-Firebase-Locale"]=s.languageCode);const p={method:e,headers:m,...l};return LI()||(p.referrerPolicy="no-referrer"),s.emulatorConfig&&Za(s.emulatorConfig.host)&&(p.credentials="include"),VE.fetch()(await FE(s,s.config.apiHost,t,h),p)})}async function LE(s,e,t){s._canInitEmulator=!1;const n={...hR,...e};try{const a=new pR(s),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw Bf(s,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const h=l.ok?u.errorMessage:u.error.message,[m,p]=h.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bf(s,"credential-already-in-use",u);if(m==="EMAIL_EXISTS")throw Bf(s,"email-already-in-use",u);if(m==="USER_DISABLED")throw Bf(s,"user-disabled",u);const x=n[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw ev(s,x,p);ha(s,x)}}catch(a){if(a instanceof wr)throw a;ha(s,"network-request-failed",{message:String(a)})}}async function gR(s,e,t,n,a={}){const l=await nu(s,e,t,n,a);return"mfaPendingCredential"in l&&ha(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function FE(s,e,t,n){const a=`${e}${t}?${n}`,l=s,u=l.config.emulator?nv(s.config,a):`${s.config.apiScheme}://${a}`;return fR.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}class pR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Vr(this.auth,"network-request-failed")),mR.get())})}}function Bf(s,e,t){const n={appName:s.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const a=Vr(s,e,n);return a.customData._tokenResponse=t,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yR(s,e){return nu(s,"POST","/v1/accounts:delete",e)}async function _m(s,e){return nu(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rd(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function xR(s,e=!1){const t=mt(s),n=await t.getIdToken(e),a=rv(n);$e(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:n,authTime:Rd(Uy(a.auth_time)),issuedAtTime:Rd(Uy(a.iat)),expirationTime:Rd(Uy(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Uy(s){return Number(s)*1e3}function rv(s){const[e,t,n]=s.split(".");if(e===void 0||t===void 0||n===void 0)return em("JWT malformed, contained fewer than 3 sections"),null;try{const a=yE(t);return a?JSON.parse(a):(em("Failed to decode base64 JWT payload"),null)}catch(a){return em("Caught error parsing JWT payload as JSON",a?.toString()),null}}function sN(s){const e=rv(s);return $e(e,"internal-error"),$e(typeof e.exp<"u","internal-error"),$e(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hd(s,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof wr&&vR(n)&&s.auth.currentUser===s&&await s.auth.signOut(),n}}function vR({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rd(this.lastLoginAt),this.creationTime=Rd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nm(s){const e=s.auth,t=await s.getIdToken(),n=await Hd(s,_m(e,{idToken:t}));$e(n?.users.length,e,"internal-error");const a=n.users[0];s._notifyReloadListener(a);const l=a.providerUserInfo?.length?UE(a.providerUserInfo):[],u=_R(s.providerData,l),h=s.isAnonymous,m=!(s.email&&a.passwordHash)&&!u?.length,p=h?m:!1,x={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new hx(a.createdAt,a.lastLoginAt),isAnonymous:p};Object.assign(s,x)}async function wR(s){const e=mt(s);await Nm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function _R(s,e){return[...s.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function UE(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NR(s,e){const t=await LE(s,{},async()=>{const n=ah({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=s.config,u=await FE(s,a,"/v1/token",`key=${l}`),h=await s._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:h,body:n};return s.emulatorConfig&&Za(s.emulatorConfig.host)&&(m.credentials="include"),VE.fetch()(u,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function TR(s,e){return nu(s,"POST","/v2/accounts:revokeToken",sv(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$e(e.idToken,"internal-error"),$e(typeof e.idToken<"u","internal-error"),$e(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$e(e.length!==0,"internal-error");const t=sN(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($e(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:a,expiresIn:l}=await NR(e,t);this.updateTokensAndExpiration(n,a,Number(l))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:a,expirationTime:l}=t,u=new Ec;return n&&($e(typeof n=="string","internal-error",{appName:e}),u.refreshToken=n),a&&($e(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&($e(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ec,this.toJSON())}_performRefresh(){return Ua("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(s,e){$e(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Mr{constructor({uid:e,auth:t,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new bR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new hx(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Hd(this,this.stsTokenManager.getToken(this.auth,e));return $e(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return xR(this,e)}reload(){return wR(this)}_assign(e){this!==e&&($e(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Mr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){$e(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Nm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qs(this.auth.app))return Promise.reject($i(this.auth));const e=await this.getIdToken();return await Hd(this,yR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,h=t.tenantId??void 0,m=t._redirectEventId??void 0,p=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:w,emailVerified:b,isAnonymous:E,providerData:R,stsTokenManager:k}=t;$e(w&&k,e,"internal-error");const U=Ec.fromJSON(this.name,k);$e(typeof w=="string",e,"internal-error"),Ri(n,e.name),Ri(a,e.name),$e(typeof b=="boolean",e,"internal-error"),$e(typeof E=="boolean",e,"internal-error"),Ri(l,e.name),Ri(u,e.name),Ri(h,e.name),Ri(m,e.name),Ri(p,e.name),Ri(x,e.name);const z=new Mr({uid:w,auth:e,email:a,emailVerified:b,displayName:n,isAnonymous:E,photoURL:u,phoneNumber:l,tenantId:h,stsTokenManager:U,createdAt:p,lastLoginAt:x});return R&&Array.isArray(R)&&(z.providerData=R.map(B=>({...B}))),m&&(z._redirectEventId=m),z}static async _fromIdTokenResponse(e,t,n=!1){const a=new Ec;a.updateFromServerResponse(t);const l=new Mr({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await Nm(l),l}static async _fromGetAccountInfoResponse(e,t,n){const a=t.users[0];$e(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?UE(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,h=new Ec;h.updateFromIdToken(n);const m=new Mr({uid:a.localId,auth:e,stsTokenManager:h,isAnonymous:u}),p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new hx(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(m,p),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN=new Map;function Ba(s){Ya(s instanceof Function,"Expected a class definition");let e=rN.get(s);return e?(Ya(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,rN.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}BE.type="NONE";const aN=BE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(s,e,t){return`firebase:${s}:${e}:${t}`}class Sc{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:a,name:l}=this.auth;this.fullUserKey=tm(this.userKey,a.apiKey,l),this.fullPersistenceKey=tm("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await _m(this.auth,{idToken:e}).catch(()=>{});return t?Mr._fromGetAccountInfoResponse(this.auth,t,e):null}return Mr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Sc(Ba(aN),e,n);const a=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let l=a[0]||Ba(aN);const u=tm(n,e.config.apiKey,e.name);let h=null;for(const p of t)try{const x=await p._get(u);if(x){let w;if(typeof x=="string"){const b=await _m(e,{idToken:x}).catch(()=>{});if(!b)break;w=await Mr._fromGetAccountInfoResponse(e,b,x)}else w=Mr._fromJSON(e,x);p!==l&&(h=w),l=p;break}}catch{}const m=a.filter(p=>p._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new Sc(l,e,n):(l=m[0],h&&await l._set(u,h.toJSON()),await Promise.all(t.map(async p=>{if(p!==l)try{await p._remove(u)}catch{}})),new Sc(l,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(GE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(KE(e))return"Blackberry";if(QE(e))return"Webos";if(zE(e))return"Safari";if((e.includes("chrome/")||HE(e))&&!e.includes("edge/"))return"Chrome";if($E(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=s.match(t);if(n?.length===2)return n[1]}return"Other"}function qE(s=In()){return/firefox\//i.test(s)}function zE(s=In()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function HE(s=In()){return/crios\//i.test(s)}function GE(s=In()){return/iemobile/i.test(s)}function $E(s=In()){return/android/i.test(s)}function KE(s=In()){return/blackberry/i.test(s)}function QE(s=In()){return/webos/i.test(s)}function av(s=In()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function ER(s=In()){return av(s)&&!!window.navigator?.standalone}function SR(){return UI()&&document.documentMode===10}function YE(s=In()){return av(s)||$E(s)||QE(s)||KE(s)||/windows phone/i.test(s)||GE(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XE(s,e=[]){let t;switch(s){case"Browser":t=iN(In());break;case"Worker":t=`${iN(In())}-${s}`;break;default:t=s}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${tu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=l=>new Promise((u,h)=>{try{const m=e(l);u(m)}catch(m){h(m)}});n.onAbort=t,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jR(s,e={}){return nu(s,"GET","/v2/passwordPolicy",sv(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IR=6;class CR{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??IR,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,t,n,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oN(this),this.idTokenSubscription=new oN(this),this.beforeStateQueue=new AR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ME,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ba(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Sc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await _m(this,{idToken:e}),n=await Mr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Qs(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=n?._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===u)&&h?.user&&(n=h.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(l){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return $e(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Nm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=dR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qs(this.app))return Promise.reject($i(this));const t=e?mt(e):null;return t&&$e(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&$e(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qs(this.app)?Promise.reject($i(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qs(this.app)?Promise.reject($i(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ba(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await jR(this),t=new CR(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new yl("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await TR(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ba(e)||this._popupRedirectResolver;$e(t,this,"argument-error"),this.redirectPersistenceManager=await Sc.create(this,[Ba(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if($e(h,this,"internal-error"),h.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,n,a);return()=>{u=!0,m()}}else{const m=e.addObserver(t);return()=>{u=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $e(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=XE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Qs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&lR(`Error while retrieving App Check token: ${e.error}`),e?.token}}function oh(s){return mt(s)}class oN{constructor(e){this.auth=e,this.observer=null,this.addObserver=$I(t=>this.observer=t)}get next(){return $e(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kR(s){iv=s}function DR(s){return iv.loadJS(s)}function PR(){return iv.gapiScript}function MR(s){return`__${s}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(s,e){const t=ma(s,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(xr(l,e??{}))return a;ha(a,"already-initialized")}return t.initialize({options:e})}function VR(s,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(Ba);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(n,e?.popupRedirectResolver)}function LR(s,e,t){const n=oh(s);$e(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,l=WE(e),{host:u,port:h}=FR(e),m=h===null?"":`:${h}`,p={url:`${l}//${u}${m}/`},x=Object.freeze({host:u,port:h,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){$e(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),$e(xr(p,n.config.emulator)&&xr(x,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=p,n.emulatorConfig=x,n.settings.appVerificationDisabledForTesting=!0,Za(u)?(Xm(`${l}//${u}${m}`),Wx("Auth",!0)):UR()}function WE(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function FR(s){const e=WE(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const l=a[1];return{host:l,port:lN(n.substr(l.length+1))}}else{const[l,u]=n.split(":");return{host:l,port:lN(u)}}}function lN(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function UR(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ua("not implemented")}_getIdTokenResponse(e){return Ua("not implemented")}_linkToIdToken(e,t){return Ua("not implemented")}_getReauthenticationResolver(e){return Ua("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ac(s,e){return gR(s,"POST","/v1/accounts:signInWithIdp",sv(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR="http://localhost";class al extends JE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new al(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ha("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...l}=t;if(!n||!a)return null;const u=new al(n,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Ac(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ac(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ac(e,t)}buildRequest(){const e={requestUri:BR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ah(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh extends Zm{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends lh{constructor(){super("facebook.com")}static credential(e){return al._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mi.credential(e.oauthAccessToken)}catch{return null}}}Mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Mi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va extends lh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return al._fromParams({providerId:Va.PROVIDER_ID,signInMethod:Va.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Va.credentialFromTaggedObject(e)}static credentialFromError(e){return Va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Va.credential(t,n)}catch{return null}}}Va.GOOGLE_SIGN_IN_METHOD="google.com";Va.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi extends lh{constructor(){super("github.com")}static credential(e){return al._fromParams({providerId:Oi.PROVIDER_ID,signInMethod:Oi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oi.credentialFromTaggedObject(e)}static credentialFromError(e){return Oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Oi.credential(e.oauthAccessToken)}catch{return null}}}Oi.GITHUB_SIGN_IN_METHOD="github.com";Oi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi extends lh{constructor(){super("twitter.com")}static credential(e,t){return al._fromParams({providerId:Vi.PROVIDER_ID,signInMethod:Vi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Vi.credentialFromTaggedObject(e)}static credentialFromError(e){return Vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Vi.credential(t,n)}catch{return null}}}Vi.TWITTER_SIGN_IN_METHOD="twitter.com";Vi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,a=!1){const l=await Mr._fromIdTokenResponse(e,n,a),u=cN(n);return new Rc({user:l,providerId:u,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const a=cN(n);return new Rc({user:e,providerId:a,_tokenResponse:n,operationType:t})}}function cN(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm extends wr{constructor(e,t,n,a){super(t.code,t.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Tm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,a){return new Tm(e,t,n,a)}}function ZE(s,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Tm._fromErrorAndOperation(s,l,e,n):l})}async function qR(s,e,t=!1){const n=await Hd(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Rc._forOperation(s,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zR(s,e,t=!1){const{auth:n}=s;if(Qs(n.app))return Promise.reject($i(n));const a="reauthenticate";try{const l=await Hd(s,ZE(n,a,e,s),t);$e(l.idToken,n,"internal-error");const u=rv(l.idToken);$e(u,n,"internal-error");const{sub:h}=u;return $e(s.uid===h,n,"user-mismatch"),Rc._forOperation(s,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&ha(n,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HR(s,e,t=!1){if(Qs(s.app))return Promise.reject($i(s));const n="signIn",a=await ZE(s,n,e),l=await Rc._fromIdTokenResponse(s,n,a);return t||await s._updateCurrentUser(l.user),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(s,e){return mt(s).setPersistence(e)}function eS(s,e,t,n){return mt(s).onIdTokenChanged(e,t,n)}function $R(s,e,t){return mt(s).beforeAuthStateChanged(e,t)}function KR(s,e,t,n){return mt(s).onAuthStateChanged(e,t,n)}function QR(s){return mt(s).signOut()}const Em="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Em,"1"),this.storage.removeItem(Em),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR=1e3,XR=10;class nS extends tS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=YE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),a=this.localCache[t];n!==a&&e(t,a,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,h,m)=>{this.notifyListeners(u,m)});return}const n=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(n);!t&&this.localCache[n]===u||this.notifyListeners(n,u)},l=this.storage.getItem(n);SR()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,XR):a()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},YR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}nS.type="LOCAL";const sS=nS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS extends tS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}rS.type="SESSION";const aS=rS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const n=new eg(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const h=Array.from(u).map(async p=>p(t.origin,l)),m=await WR(h);t.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}eg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ov(s="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((h,m)=>{const p=ov("",20);a.port1.start();const x=setTimeout(()=>{m(new Error("unsupported_event"))},n);u={messageChannel:a,onMessage(w){const b=w;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(x),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),h(b.data.response);break;default:clearTimeout(x),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(){return window}function ZR(s){ca().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(){return typeof ca().WorkerGlobalScope<"u"&&typeof ca().importScripts=="function"}async function ek(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tk(){return navigator?.serviceWorker?.controller||null}function nk(){return iS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS="firebaseLocalStorageDb",sk=1,Sm="firebaseLocalStorage",lS="fbase_key";class ch{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function tg(s,e){return s.transaction([Sm],e?"readwrite":"readonly").objectStore(Sm)}function rk(){const s=indexedDB.deleteDatabase(oS);return new ch(s).toPromise()}function fx(){const s=indexedDB.open(oS,sk);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const n=s.result;try{n.createObjectStore(Sm,{keyPath:lS})}catch(a){t(a)}}),s.addEventListener("success",async()=>{const n=s.result;n.objectStoreNames.contains(Sm)?e(n):(n.close(),await rk(),e(await fx()))})})}async function uN(s,e,t){const n=tg(s,!0).put({[lS]:e,value:t});return new ch(n).toPromise()}async function ak(s,e){const t=tg(s,!1).get(e),n=await new ch(t).toPromise();return n===void 0?null:n.value}function dN(s,e){const t=tg(s,!0).delete(e);return new ch(t).toPromise()}const ik=800,ok=3;class cS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>ok)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return iS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=eg._getInstance(nk()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await ek(),!this.activeServiceWorker)return;this.sender=new JR(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fx();return await uN(e,Em,"1"),await dN(e,Em),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>uN(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>ak(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>dN(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=tg(a,!1).getAll();return new ch(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ik)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}cS.type="LOCAL";const lk=cS;new ih(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(s,e){return e?Ba(e):($e(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv extends JE{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ac(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ac(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ac(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ck(s){return HR(s.auth,new cv(s),s.bypassAuthState)}function uk(s){const{auth:e,user:t}=s;return $e(t,e,"internal-error"),zR(t,new cv(s),s.bypassAuthState)}async function dk(s){const{auth:e,user:t}=s;return $e(t,e,"internal-error"),qR(t,new cv(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e,t,n,a,l=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:a,tenantId:l,error:u,type:h}=e;if(u){this.reject(u);return}const m={auth:this.auth,requestUri:t,sessionId:n,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(m))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ck;case"linkViaPopup":case"linkViaRedirect":return dk;case"reauthViaPopup":case"reauthViaRedirect":return uk;default:ha(this.auth,"internal-error")}}resolve(e){Ya(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ya(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hk=new ih(2e3,1e4);async function fk(s,e,t){if(Qs(s.app))return Promise.reject(Vr(s,"operation-not-supported-in-this-environment"));const n=oh(s);OE(s,e,Zm);const a=lv(n,t);return new Xo(n,"signInViaPopup",e,a).executeNotNull()}class Xo extends uS{constructor(e,t,n,a,l){super(e,t,a,l),this.provider=n,this.authWindow=null,this.pollId=null,Xo.currentPopupAction&&Xo.currentPopupAction.cancel(),Xo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return $e(e,this.auth,"internal-error"),e}async onExecution(){Ya(this.filter.length===1,"Popup operations only handle one event");const e=ov();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Vr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Vr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hk.get())};e()}}Xo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk="pendingRedirect",nm=new Map;class gk extends uS{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=nm.get(this.auth._key());if(!e){try{const n=await pk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}nm.set(this.auth._key(),e)}return this.bypassAuthState||nm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function pk(s,e){const t=hS(e),n=dS(s);if(!await n._isAvailable())return!1;const a=await n._get(t)==="true";return await n._remove(t),a}async function yk(s,e){return dS(s)._set(hS(e),"true")}function xk(s,e){nm.set(s._key(),e)}function dS(s){return Ba(s._redirectPersistence)}function hS(s){return tm(mk,s.config.apiKey,s.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(s,e,t){return bk(s,e,t)}async function bk(s,e,t){if(Qs(s.app))return Promise.reject($i(s));const n=oh(s);OE(s,e,Zm),await n._initializationPromise;const a=lv(n,t);return await yk(a,n),a._openRedirect(n,e,"signInViaRedirect")}async function wk(s,e,t=!1){if(Qs(s.app))return Promise.reject($i(s));const n=oh(s),a=lv(n,e),u=await new gk(n,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await n._persistUserIfCurrent(u.user),await n._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=600*1e3;class Nk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Tk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!fS(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Vr(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_k&&this.cachedEventUids.clear(),this.cachedEventUids.has(hN(e))}saveEventToCache(e){this.cachedEventUids.add(hN(e)),this.lastProcessedEventTime=Date.now()}}function hN(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function fS({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function Tk(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fS(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ek(s,e={}){return nu(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ak=/^https?/;async function jk(s){if(s.config.emulator)return;const{authorizedDomains:e}=await Ek(s);for(const t of e)try{if(Ik(t))return}catch{}ha(s,"unauthorized-domain")}function Ik(s){const e=dx(),{protocol:t,hostname:n}=new URL(e);if(s.startsWith("chrome-extension://")){const u=new URL(s);return u.hostname===""&&n===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===n}if(!Ak.test(t))return!1;if(Sk.test(s))return n===s;const a=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck=new ih(3e4,6e4);function fN(){const s=ca().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function Rk(s){return new Promise((e,t)=>{function n(){fN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fN(),t(Vr(s,"network-request-failed"))},timeout:Ck.get()})}if(ca().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ca().gapi?.load)n();else{const a=MR("iframefcb");return ca()[a]=()=>{gapi.load?n():t(Vr(s,"network-request-failed"))},DR(`${PR()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw sm=null,e})}let sm=null;function kk(s){return sm=sm||Rk(s),sm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk=new ih(5e3,15e3),Pk="__/auth/iframe",Mk="emulator/auth/iframe",Ok={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Vk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Lk(s){const e=s.config;$e(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?nv(e,Mk):`https://${s.config.authDomain}/${Pk}`,n={apiKey:e.apiKey,appName:s.name,v:tu},a=Vk.get(s.config.apiHost);a&&(n.eid=a);const l=s._getFrameworks();return l.length&&(n.fw=l.join(",")),`${t}?${ah(n).slice(1)}`}async function Fk(s){const e=await kk(s),t=ca().gapi;return $e(t,s,"internal-error"),e.open({where:document.body,url:Lk(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ok,dontclear:!0},n=>new Promise(async(a,l)=>{await n.restyle({setHideOnLeave:!1});const u=Vr(s,"network-request-failed"),h=ca().setTimeout(()=>{l(u)},Dk.get());function m(){ca().clearTimeout(h),a(n)}n.ping(m).then(m,()=>{l(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Bk=500,qk=600,zk="_blank",Hk="http://localhost";class mN{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Gk(s,e,t,n=Bk,a=qk){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-n)/2,0).toString();let h="";const m={...Uk,width:n.toString(),height:a.toString(),top:l,left:u},p=In().toLowerCase();t&&(h=HE(p)?zk:t),qE(p)&&(e=e||Hk,m.scrollbars="yes");const x=Object.entries(m).reduce((b,[E,R])=>`${b}${E}=${R},`,"");if(ER(p)&&h!=="_self")return $k(e||"",h),new mN(null);const w=window.open(e||"",h,x);$e(w,s,"popup-blocked");try{w.focus()}catch{}return new mN(w)}function $k(s,e){const t=document.createElement("a");t.href=s,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk="__/auth/handler",Qk="emulator/auth/handler",Yk=encodeURIComponent("fac");async function gN(s,e,t,n,a,l){$e(s.config.authDomain,s,"auth-domain-config-required"),$e(s.config.apiKey,s,"invalid-api-key");const u={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:n,v:tu,eventId:a};if(e instanceof Zm){e.setDefaultLanguage(s.languageCode),u.providerId=e.providerId||"",GI(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,w]of Object.entries({}))u[x]=w}if(e instanceof lh){const x=e.getScopes().filter(w=>w!=="");x.length>0&&(u.scopes=x.join(","))}s.tenantId&&(u.tid=s.tenantId);const h=u;for(const x of Object.keys(h))h[x]===void 0&&delete h[x];const m=await s._getAppCheckToken(),p=m?`#${Yk}=${encodeURIComponent(m)}`:"";return`${Xk(s)}?${ah(h).slice(1)}${p}`}function Xk({config:s}){return s.emulator?nv(s,Qk):`https://${s.authDomain}/${Kk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By="webStorageSupport";class Wk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=aS,this._completeRedirectFn=wk,this._overrideRedirectResult=xk}async _openPopup(e,t,n,a){Ya(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await gN(e,t,n,dx(),a);return Gk(e,l,ov())}async _openRedirect(e,t,n,a){await this._originValidation(e);const l=await gN(e,t,n,dx(),a);return ZR(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Ya(l,"If manager is not set, promise should be"),l)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Fk(e),n=new Nk(e);return t.register("authEvent",a=>($e(a?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(By,{type:By},a=>{const l=a?.[0]?.[By];l!==void 0&&t(!!l),ha(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=jk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return YE()||zE()||av()}}const Jk=Wk;var pN="@firebase/auth",yN="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$e(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eD(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function tD(s){Ur(new vr("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=n.options;$e(u&&!u.includes(":"),"invalid-api-key",{appName:n.name});const m={apiKey:u,authDomain:h,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:XE(s)},p=new RR(n,a,l,m);return VR(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Ur(new vr("auth-internal",e=>{const t=oh(e.getProvider("auth").getImmediate());return(n=>new Zk(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),js(pN,yN,eD(s)),js(pN,yN,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD=300,sD=_E("authIdTokenMaxAge")||nD;let xN=null;const rD=s=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>sD)return;const a=t?.token;xN!==a&&(xN=a,await fetch(s,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function aD(s=Jm()){const e=ma(s,"auth");if(e.isInitialized())return e.getImmediate();const t=OR(s,{popupRedirectResolver:Jk,persistence:[lk,sS,aS]}),n=_E("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(n,location.origin);if(location.origin===l.origin){const u=rD(l.toString());$R(t,u,()=>u(t.currentUser)),eS(t,h=>u(h))}}const a=vE("auth");return a&&LR(t,`http://${a}`),t}function iD(){return document.getElementsByTagName("head")?.[0]??document}kR({loadJS(s){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",s),n.onload=e,n.onerror=a=>{const l=Vr("internal-error");l.customData=a,t(l)},n.type="text/javascript",n.charset="UTF-8",iD().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});tD("Browser");var oD="firebase",lD="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */js(oD,lD,"app");var vN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ki,mS;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,T){function A(){}A.prototype=T.prototype,P.D=T.prototype,P.prototype=new A,P.prototype.constructor=P,P.C=function(F,j,V){for(var D=Array(arguments.length-2),De=2;De<arguments.length;De++)D[De-2]=arguments[De];return T.prototype[j].apply(F,D)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(P,T,A){A||(A=0);var F=Array(16);if(typeof T=="string")for(var j=0;16>j;++j)F[j]=T.charCodeAt(A++)|T.charCodeAt(A++)<<8|T.charCodeAt(A++)<<16|T.charCodeAt(A++)<<24;else for(j=0;16>j;++j)F[j]=T[A++]|T[A++]<<8|T[A++]<<16|T[A++]<<24;T=P.g[0],A=P.g[1],j=P.g[2];var V=P.g[3],D=T+(V^A&(j^V))+F[0]+3614090360&4294967295;T=A+(D<<7&4294967295|D>>>25),D=V+(j^T&(A^j))+F[1]+3905402710&4294967295,V=T+(D<<12&4294967295|D>>>20),D=j+(A^V&(T^A))+F[2]+606105819&4294967295,j=V+(D<<17&4294967295|D>>>15),D=A+(T^j&(V^T))+F[3]+3250441966&4294967295,A=j+(D<<22&4294967295|D>>>10),D=T+(V^A&(j^V))+F[4]+4118548399&4294967295,T=A+(D<<7&4294967295|D>>>25),D=V+(j^T&(A^j))+F[5]+1200080426&4294967295,V=T+(D<<12&4294967295|D>>>20),D=j+(A^V&(T^A))+F[6]+2821735955&4294967295,j=V+(D<<17&4294967295|D>>>15),D=A+(T^j&(V^T))+F[7]+4249261313&4294967295,A=j+(D<<22&4294967295|D>>>10),D=T+(V^A&(j^V))+F[8]+1770035416&4294967295,T=A+(D<<7&4294967295|D>>>25),D=V+(j^T&(A^j))+F[9]+2336552879&4294967295,V=T+(D<<12&4294967295|D>>>20),D=j+(A^V&(T^A))+F[10]+4294925233&4294967295,j=V+(D<<17&4294967295|D>>>15),D=A+(T^j&(V^T))+F[11]+2304563134&4294967295,A=j+(D<<22&4294967295|D>>>10),D=T+(V^A&(j^V))+F[12]+1804603682&4294967295,T=A+(D<<7&4294967295|D>>>25),D=V+(j^T&(A^j))+F[13]+4254626195&4294967295,V=T+(D<<12&4294967295|D>>>20),D=j+(A^V&(T^A))+F[14]+2792965006&4294967295,j=V+(D<<17&4294967295|D>>>15),D=A+(T^j&(V^T))+F[15]+1236535329&4294967295,A=j+(D<<22&4294967295|D>>>10),D=T+(j^V&(A^j))+F[1]+4129170786&4294967295,T=A+(D<<5&4294967295|D>>>27),D=V+(A^j&(T^A))+F[6]+3225465664&4294967295,V=T+(D<<9&4294967295|D>>>23),D=j+(T^A&(V^T))+F[11]+643717713&4294967295,j=V+(D<<14&4294967295|D>>>18),D=A+(V^T&(j^V))+F[0]+3921069994&4294967295,A=j+(D<<20&4294967295|D>>>12),D=T+(j^V&(A^j))+F[5]+3593408605&4294967295,T=A+(D<<5&4294967295|D>>>27),D=V+(A^j&(T^A))+F[10]+38016083&4294967295,V=T+(D<<9&4294967295|D>>>23),D=j+(T^A&(V^T))+F[15]+3634488961&4294967295,j=V+(D<<14&4294967295|D>>>18),D=A+(V^T&(j^V))+F[4]+3889429448&4294967295,A=j+(D<<20&4294967295|D>>>12),D=T+(j^V&(A^j))+F[9]+568446438&4294967295,T=A+(D<<5&4294967295|D>>>27),D=V+(A^j&(T^A))+F[14]+3275163606&4294967295,V=T+(D<<9&4294967295|D>>>23),D=j+(T^A&(V^T))+F[3]+4107603335&4294967295,j=V+(D<<14&4294967295|D>>>18),D=A+(V^T&(j^V))+F[8]+1163531501&4294967295,A=j+(D<<20&4294967295|D>>>12),D=T+(j^V&(A^j))+F[13]+2850285829&4294967295,T=A+(D<<5&4294967295|D>>>27),D=V+(A^j&(T^A))+F[2]+4243563512&4294967295,V=T+(D<<9&4294967295|D>>>23),D=j+(T^A&(V^T))+F[7]+1735328473&4294967295,j=V+(D<<14&4294967295|D>>>18),D=A+(V^T&(j^V))+F[12]+2368359562&4294967295,A=j+(D<<20&4294967295|D>>>12),D=T+(A^j^V)+F[5]+4294588738&4294967295,T=A+(D<<4&4294967295|D>>>28),D=V+(T^A^j)+F[8]+2272392833&4294967295,V=T+(D<<11&4294967295|D>>>21),D=j+(V^T^A)+F[11]+1839030562&4294967295,j=V+(D<<16&4294967295|D>>>16),D=A+(j^V^T)+F[14]+4259657740&4294967295,A=j+(D<<23&4294967295|D>>>9),D=T+(A^j^V)+F[1]+2763975236&4294967295,T=A+(D<<4&4294967295|D>>>28),D=V+(T^A^j)+F[4]+1272893353&4294967295,V=T+(D<<11&4294967295|D>>>21),D=j+(V^T^A)+F[7]+4139469664&4294967295,j=V+(D<<16&4294967295|D>>>16),D=A+(j^V^T)+F[10]+3200236656&4294967295,A=j+(D<<23&4294967295|D>>>9),D=T+(A^j^V)+F[13]+681279174&4294967295,T=A+(D<<4&4294967295|D>>>28),D=V+(T^A^j)+F[0]+3936430074&4294967295,V=T+(D<<11&4294967295|D>>>21),D=j+(V^T^A)+F[3]+3572445317&4294967295,j=V+(D<<16&4294967295|D>>>16),D=A+(j^V^T)+F[6]+76029189&4294967295,A=j+(D<<23&4294967295|D>>>9),D=T+(A^j^V)+F[9]+3654602809&4294967295,T=A+(D<<4&4294967295|D>>>28),D=V+(T^A^j)+F[12]+3873151461&4294967295,V=T+(D<<11&4294967295|D>>>21),D=j+(V^T^A)+F[15]+530742520&4294967295,j=V+(D<<16&4294967295|D>>>16),D=A+(j^V^T)+F[2]+3299628645&4294967295,A=j+(D<<23&4294967295|D>>>9),D=T+(j^(A|~V))+F[0]+4096336452&4294967295,T=A+(D<<6&4294967295|D>>>26),D=V+(A^(T|~j))+F[7]+1126891415&4294967295,V=T+(D<<10&4294967295|D>>>22),D=j+(T^(V|~A))+F[14]+2878612391&4294967295,j=V+(D<<15&4294967295|D>>>17),D=A+(V^(j|~T))+F[5]+4237533241&4294967295,A=j+(D<<21&4294967295|D>>>11),D=T+(j^(A|~V))+F[12]+1700485571&4294967295,T=A+(D<<6&4294967295|D>>>26),D=V+(A^(T|~j))+F[3]+2399980690&4294967295,V=T+(D<<10&4294967295|D>>>22),D=j+(T^(V|~A))+F[10]+4293915773&4294967295,j=V+(D<<15&4294967295|D>>>17),D=A+(V^(j|~T))+F[1]+2240044497&4294967295,A=j+(D<<21&4294967295|D>>>11),D=T+(j^(A|~V))+F[8]+1873313359&4294967295,T=A+(D<<6&4294967295|D>>>26),D=V+(A^(T|~j))+F[15]+4264355552&4294967295,V=T+(D<<10&4294967295|D>>>22),D=j+(T^(V|~A))+F[6]+2734768916&4294967295,j=V+(D<<15&4294967295|D>>>17),D=A+(V^(j|~T))+F[13]+1309151649&4294967295,A=j+(D<<21&4294967295|D>>>11),D=T+(j^(A|~V))+F[4]+4149444226&4294967295,T=A+(D<<6&4294967295|D>>>26),D=V+(A^(T|~j))+F[11]+3174756917&4294967295,V=T+(D<<10&4294967295|D>>>22),D=j+(T^(V|~A))+F[2]+718787259&4294967295,j=V+(D<<15&4294967295|D>>>17),D=A+(V^(j|~T))+F[9]+3951481745&4294967295,P.g[0]=P.g[0]+T&4294967295,P.g[1]=P.g[1]+(j+(D<<21&4294967295|D>>>11))&4294967295,P.g[2]=P.g[2]+j&4294967295,P.g[3]=P.g[3]+V&4294967295}n.prototype.u=function(P,T){T===void 0&&(T=P.length);for(var A=T-this.blockSize,F=this.B,j=this.h,V=0;V<T;){if(j==0)for(;V<=A;)a(this,P,V),V+=this.blockSize;if(typeof P=="string"){for(;V<T;)if(F[j++]=P.charCodeAt(V++),j==this.blockSize){a(this,F),j=0;break}}else for(;V<T;)if(F[j++]=P[V++],j==this.blockSize){a(this,F),j=0;break}}this.h=j,this.o+=T},n.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var T=1;T<P.length-8;++T)P[T]=0;var A=8*this.o;for(T=P.length-8;T<P.length;++T)P[T]=A&255,A/=256;for(this.u(P),P=Array(16),T=A=0;4>T;++T)for(var F=0;32>F;F+=8)P[A++]=this.g[T]>>>F&255;return P};function l(P,T){var A=h;return Object.prototype.hasOwnProperty.call(A,P)?A[P]:A[P]=T(P)}function u(P,T){this.h=T;for(var A=[],F=!0,j=P.length-1;0<=j;j--){var V=P[j]|0;F&&V==T||(A[j]=V,F=!1)}this.g=A}var h={};function m(P){return-128<=P&&128>P?l(P,function(T){return new u([T|0],0>T?-1:0)}):new u([P|0],0>P?-1:0)}function p(P){if(isNaN(P)||!isFinite(P))return w;if(0>P)return U(p(-P));for(var T=[],A=1,F=0;P>=A;F++)T[F]=P/A|0,A*=4294967296;return new u(T,0)}function x(P,T){if(P.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(P.charAt(0)=="-")return U(x(P.substring(1),T));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=p(Math.pow(T,8)),F=w,j=0;j<P.length;j+=8){var V=Math.min(8,P.length-j),D=parseInt(P.substring(j,j+V),T);8>V?(V=p(Math.pow(T,V)),F=F.j(V).add(p(D))):(F=F.j(A),F=F.add(p(D)))}return F}var w=m(0),b=m(1),E=m(16777216);s=u.prototype,s.m=function(){if(k(this))return-U(this).m();for(var P=0,T=1,A=0;A<this.g.length;A++){var F=this.i(A);P+=(0<=F?F:4294967296+F)*T,T*=4294967296}return P},s.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(R(this))return"0";if(k(this))return"-"+U(this).toString(P);for(var T=p(Math.pow(P,6)),A=this,F="";;){var j=G(A,T).g;A=z(A,j.j(T));var V=((0<A.g.length?A.g[0]:A.h)>>>0).toString(P);if(A=j,R(A))return V+F;for(;6>V.length;)V="0"+V;F=V+F}},s.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function R(P){if(P.h!=0)return!1;for(var T=0;T<P.g.length;T++)if(P.g[T]!=0)return!1;return!0}function k(P){return P.h==-1}s.l=function(P){return P=z(this,P),k(P)?-1:R(P)?0:1};function U(P){for(var T=P.g.length,A=[],F=0;F<T;F++)A[F]=~P.g[F];return new u(A,~P.h).add(b)}s.abs=function(){return k(this)?U(this):this},s.add=function(P){for(var T=Math.max(this.g.length,P.g.length),A=[],F=0,j=0;j<=T;j++){var V=F+(this.i(j)&65535)+(P.i(j)&65535),D=(V>>>16)+(this.i(j)>>>16)+(P.i(j)>>>16);F=D>>>16,V&=65535,D&=65535,A[j]=D<<16|V}return new u(A,A[A.length-1]&-2147483648?-1:0)};function z(P,T){return P.add(U(T))}s.j=function(P){if(R(this)||R(P))return w;if(k(this))return k(P)?U(this).j(U(P)):U(U(this).j(P));if(k(P))return U(this.j(U(P)));if(0>this.l(E)&&0>P.l(E))return p(this.m()*P.m());for(var T=this.g.length+P.g.length,A=[],F=0;F<2*T;F++)A[F]=0;for(F=0;F<this.g.length;F++)for(var j=0;j<P.g.length;j++){var V=this.i(F)>>>16,D=this.i(F)&65535,De=P.i(j)>>>16,Z=P.i(j)&65535;A[2*F+2*j]+=D*Z,B(A,2*F+2*j),A[2*F+2*j+1]+=V*Z,B(A,2*F+2*j+1),A[2*F+2*j+1]+=D*De,B(A,2*F+2*j+1),A[2*F+2*j+2]+=V*De,B(A,2*F+2*j+2)}for(F=0;F<T;F++)A[F]=A[2*F+1]<<16|A[2*F];for(F=T;F<2*T;F++)A[F]=0;return new u(A,0)};function B(P,T){for(;(P[T]&65535)!=P[T];)P[T+1]+=P[T]>>>16,P[T]&=65535,T++}function q(P,T){this.g=P,this.h=T}function G(P,T){if(R(T))throw Error("division by zero");if(R(P))return new q(w,w);if(k(P))return T=G(U(P),T),new q(U(T.g),U(T.h));if(k(T))return T=G(P,U(T)),new q(U(T.g),T.h);if(30<P.g.length){if(k(P)||k(T))throw Error("slowDivide_ only works with positive integers.");for(var A=b,F=T;0>=F.l(P);)A=Y(A),F=Y(F);var j=L(A,1),V=L(F,1);for(F=L(F,2),A=L(A,2);!R(F);){var D=V.add(F);0>=D.l(P)&&(j=j.add(A),V=D),F=L(F,1),A=L(A,1)}return T=z(P,j.j(T)),new q(j,T)}for(j=w;0<=P.l(T);){for(A=Math.max(1,Math.floor(P.m()/T.m())),F=Math.ceil(Math.log(A)/Math.LN2),F=48>=F?1:Math.pow(2,F-48),V=p(A),D=V.j(T);k(D)||0<D.l(P);)A-=F,V=p(A),D=V.j(T);R(V)&&(V=b),j=j.add(V),P=z(P,D)}return new q(j,P)}s.A=function(P){return G(this,P).h},s.and=function(P){for(var T=Math.max(this.g.length,P.g.length),A=[],F=0;F<T;F++)A[F]=this.i(F)&P.i(F);return new u(A,this.h&P.h)},s.or=function(P){for(var T=Math.max(this.g.length,P.g.length),A=[],F=0;F<T;F++)A[F]=this.i(F)|P.i(F);return new u(A,this.h|P.h)},s.xor=function(P){for(var T=Math.max(this.g.length,P.g.length),A=[],F=0;F<T;F++)A[F]=this.i(F)^P.i(F);return new u(A,this.h^P.h)};function Y(P){for(var T=P.g.length+1,A=[],F=0;F<T;F++)A[F]=P.i(F)<<1|P.i(F-1)>>>31;return new u(A,P.h)}function L(P,T){var A=T>>5;T%=32;for(var F=P.g.length-A,j=[],V=0;V<F;V++)j[V]=0<T?P.i(V+A)>>>T|P.i(V+A+1)<<32-T:P.i(V+A);return new u(j,P.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,mS=n,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=x,Ki=u}).apply(typeof vN<"u"?vN:typeof self<"u"?self:typeof window<"u"?window:{});var qf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gS,Ed,pS,rm,mx,yS,xS,vS;(function(){var s,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,v,_){return f==Array.prototype||f==Object.prototype||(f[v]=_.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof qf=="object"&&qf];for(var v=0;v<f.length;++v){var _=f[v];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var n=t(this);function a(f,v){if(v)e:{var _=n;f=f.split(".");for(var I=0;I<f.length-1;I++){var J=f[I];if(!(J in _))break e;_=_[J]}f=f[f.length-1],I=_[f],v=v(I),v!=I&&v!=null&&e(_,f,{configurable:!0,writable:!0,value:v})}}function l(f,v){f instanceof String&&(f+="");var _=0,I=!1,J={next:function(){if(!I&&_<f.length){var le=_++;return{value:v(le,f[le]),done:!1}}return I=!0,{done:!0,value:void 0}}};return J[Symbol.iterator]=function(){return J},J}a("Array.prototype.values",function(f){return f||function(){return l(this,function(v,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},h=this||self;function m(f){var v=typeof f;return v=v!="object"?v:f?Array.isArray(f)?"array":v:"null",v=="array"||v=="object"&&typeof f.length=="number"}function p(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function x(f,v,_){return f.call.apply(f.bind,arguments)}function w(f,v,_){if(!f)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var J=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(J,I),f.apply(v,J)}}return function(){return f.apply(v,arguments)}}function b(f,v,_){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?x:w,b.apply(null,arguments)}function E(f,v){var _=Array.prototype.slice.call(arguments,1);return function(){var I=_.slice();return I.push.apply(I,arguments),f.apply(this,I)}}function R(f,v){function _(){}_.prototype=v.prototype,f.aa=v.prototype,f.prototype=new _,f.prototype.constructor=f,f.Qb=function(I,J,le){for(var _e=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)_e[ut-2]=arguments[ut];return v.prototype[J].apply(I,_e)}}function k(f){const v=f.length;if(0<v){const _=Array(v);for(let I=0;I<v;I++)_[I]=f[I];return _}return[]}function U(f,v){for(let _=1;_<arguments.length;_++){const I=arguments[_];if(m(I)){const J=f.length||0,le=I.length||0;f.length=J+le;for(let _e=0;_e<le;_e++)f[J+_e]=I[_e]}else f.push(I)}}class z{constructor(v,_){this.i=v,this.j=_,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function B(f){return/^[\s\xa0]*$/.test(f)}function q(){var f=h.navigator;return f&&(f=f.userAgent)?f:""}function G(f){return G[" "](f),f}G[" "]=function(){};var Y=q().indexOf("Gecko")!=-1&&!(q().toLowerCase().indexOf("webkit")!=-1&&q().indexOf("Edge")==-1)&&!(q().indexOf("Trident")!=-1||q().indexOf("MSIE")!=-1)&&q().indexOf("Edge")==-1;function L(f,v,_){for(const I in f)v.call(_,f[I],I,f)}function P(f,v){for(const _ in f)v.call(void 0,f[_],_,f)}function T(f){const v={};for(const _ in f)v[_]=f[_];return v}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(f,v){let _,I;for(let J=1;J<arguments.length;J++){I=arguments[J];for(_ in I)f[_]=I[_];for(let le=0;le<A.length;le++)_=A[le],Object.prototype.hasOwnProperty.call(I,_)&&(f[_]=I[_])}}function j(f){var v=1;f=f.split(":");const _=[];for(;0<v&&f.length;)_.push(f.shift()),v--;return f.length&&_.push(f.join(":")),_}function V(f){h.setTimeout(()=>{throw f},0)}function D(){var f=ge;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class De{constructor(){this.h=this.g=null}add(v,_){const I=Z.get();I.set(v,_),this.h?this.h.next=I:this.g=I,this.h=I}}var Z=new z(()=>new O,f=>f.reset());class O{constructor(){this.next=this.g=this.h=null}set(v,_){this.h=v,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,$=!1,ge=new De,C=()=>{const f=h.Promise.resolve(void 0);oe=()=>{f.then(ne)}};var ne=()=>{for(var f;f=D();){try{f.h.call(f.g)}catch(_){V(_)}var v=Z;v.j(f),100>v.h&&(v.h++,f.next=v.g,v.g=f)}$=!1};function ve(){this.s=this.s,this.C=this.C}ve.prototype.s=!1,ve.prototype.ma=function(){this.s||(this.s=!0,this.N())},ve.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var Ie=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const _=()=>{};h.addEventListener("test",_,v),h.removeEventListener("test",_,v)}catch{}return f})();function ye(f,v){if(ue.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var _=this.type=f.type,I=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget){if(Y){e:{try{G(v.nodeName);var J=!0;break e}catch{}J=!1}J||(v=null)}}else _=="mouseover"?v=f.fromElement:_=="mouseout"&&(v=f.toElement);this.relatedTarget=v,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:Se[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&ye.aa.h.call(this)}}R(ye,ue);var Se={2:"touch",3:"pen",4:"mouse"};ye.prototype.h=function(){ye.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),we=0;function Ee(f,v,_,I,J){this.listener=f,this.proxy=null,this.src=v,this.type=_,this.capture=!!I,this.ha=J,this.key=++we,this.da=this.fa=!1}function Fe(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Ze(f){this.src=f,this.g={},this.h=0}Ze.prototype.add=function(f,v,_,I,J){var le=f.toString();f=this.g[le],f||(f=this.g[le]=[],this.h++);var _e=lt(f,v,I,J);return-1<_e?(v=f[_e],_||(v.fa=!1)):(v=new Ee(v,this.src,le,!!I,J),v.fa=_,f.push(v)),v};function Ge(f,v){var _=v.type;if(_ in f.g){var I=f.g[_],J=Array.prototype.indexOf.call(I,v,void 0),le;(le=0<=J)&&Array.prototype.splice.call(I,J,1),le&&(Fe(v),f.g[_].length==0&&(delete f.g[_],f.h--))}}function lt(f,v,_,I){for(var J=0;J<f.length;++J){var le=f[J];if(!le.da&&le.listener==v&&le.capture==!!_&&le.ha==I)return J}return-1}var ze="closure_lm_"+(1e6*Math.random()|0),Qe={};function gt(f,v,_,I,J){if(Array.isArray(v)){for(var le=0;le<v.length;le++)gt(f,v[le],_,I,J);return null}return _=Ms(_),f&&f[ce]?f.K(v,_,p(I)?!!I.capture:!1,J):ct(f,v,_,!1,I,J)}function ct(f,v,_,I,J,le){if(!v)throw Error("Invalid event type");var _e=p(J)?!!J.capture:!!J,ut=Ds(f);if(ut||(f[ze]=ut=new Ze(f)),_=ut.add(v,_,I,_e,le),_.proxy)return _;if(I=It(),_.proxy=I,I.src=f,I.listener=_,f.addEventListener)Ie||(J=_e),J===void 0&&(J=!1),f.addEventListener(v.toString(),I,J);else if(f.attachEvent)f.attachEvent($n(v.toString()),I);else if(f.addListener&&f.removeListener)f.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return _}function It(){function f(_){return v.call(f.src,f.listener,_)}const v=_r;return f}function Gn(f,v,_,I,J){if(Array.isArray(v))for(var le=0;le<v.length;le++)Gn(f,v[le],_,I,J);else I=p(I)?!!I.capture:!!I,_=Ms(_),f&&f[ce]?(f=f.i,v=String(v).toString(),v in f.g&&(le=f.g[v],_=lt(le,_,I,J),-1<_&&(Fe(le[_]),Array.prototype.splice.call(le,_,1),le.length==0&&(delete f.g[v],f.h--)))):f&&(f=Ds(f))&&(v=f.g[v.toString()],f=-1,v&&(f=lt(v,_,I,J)),(_=-1<f?v[f]:null)&&an(_))}function an(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[ce])Ge(v.i,f);else{var _=f.type,I=f.proxy;v.removeEventListener?v.removeEventListener(_,I,f.capture):v.detachEvent?v.detachEvent($n(_),I):v.addListener&&v.removeListener&&v.removeListener(I),(_=Ds(v))?(Ge(_,f),_.h==0&&(_.src=null,v[ze]=null)):Fe(f)}}}function $n(f){return f in Qe?Qe[f]:Qe[f]="on"+f}function _r(f,v){if(f.da)f=!0;else{v=new ye(v,this);var _=f.listener,I=f.ha||f.src;f.fa&&an(f),f=_.call(I,v)}return f}function Ds(f){return f=f[ze],f instanceof Ze?f:null}var Ps="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ms(f){return typeof f=="function"?f:(f[Ps]||(f[Ps]=function(v){return f.handleEvent(v)}),f[Ps])}function _t(){ve.call(this),this.i=new Ze(this),this.M=this,this.F=null}R(_t,ve),_t.prototype[ce]=!0,_t.prototype.removeEventListener=function(f,v,_,I){Gn(this,f,v,_,I)};function pt(f,v){var _,I=f.F;if(I)for(_=[];I;I=I.F)_.push(I);if(f=f.M,I=v.type||v,typeof v=="string")v=new ue(v,f);else if(v instanceof ue)v.target=v.target||f;else{var J=v;v=new ue(I,f),F(v,J)}if(J=!0,_)for(var le=_.length-1;0<=le;le--){var _e=v.g=_[le];J=es(_e,I,!0,v)&&J}if(_e=v.g=f,J=es(_e,I,!0,v)&&J,J=es(_e,I,!1,v)&&J,_)for(le=0;le<_.length;le++)_e=v.g=_[le],J=es(_e,I,!1,v)&&J}_t.prototype.N=function(){if(_t.aa.N.call(this),this.i){var f=this.i,v;for(v in f.g){for(var _=f.g[v],I=0;I<_.length;I++)Fe(_[I]);delete f.g[v],f.h--}}this.F=null},_t.prototype.K=function(f,v,_,I){return this.i.add(String(f),v,!1,_,I)},_t.prototype.L=function(f,v,_,I){return this.i.add(String(f),v,!0,_,I)};function es(f,v,_,I){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();for(var J=!0,le=0;le<v.length;++le){var _e=v[le];if(_e&&!_e.da&&_e.capture==_){var ut=_e.listener,Tn=_e.ha||_e.src;_e.fa&&Ge(f.i,_e),J=ut.call(Tn,I)!==!1&&J}}return J&&!I.defaultPrevented}function _n(f,v,_){if(typeof f=="function")_&&(f=b(f,_));else if(f&&typeof f.handleEvent=="function")f=b(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:h.setTimeout(f,v||0)}function ri(f){f.g=_n(()=>{f.g=null,f.i&&(f.i=!1,ri(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class Nl extends ve{constructor(v,_){super(),this.m=v,this.l=_,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ri(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zs(f){ve.call(this),this.h=f,this.g={}}R(Zs,ve);var er=[];function Kn(f){L(f.g,function(v,_){this.g.hasOwnProperty(_)&&an(v)},f),f.g={}}Zs.prototype.N=function(){Zs.aa.N.call(this),Kn(this)},Zs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var kn=h.JSON.stringify,Br=h.JSON.parse,Nr=class{stringify(f){return h.JSON.stringify(f,void 0)}parse(f){return h.JSON.parse(f,void 0)}};function fo(){}fo.prototype.h=null;function qr(f){return f.h||(f.h=f.i())}function zr(){}var Tr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function us(){ue.call(this,"d")}R(us,ue);function mo(){ue.call(this,"c")}R(mo,ue);var tr={},qt=null;function ds(){return qt=qt||new _t}tr.La="serverreachability";function ai(f){ue.call(this,tr.La,f)}R(ai,ue);function Er(f){const v=ds();pt(v,new ai(v))}tr.STAT_EVENT="statevent";function ii(f,v){ue.call(this,tr.STAT_EVENT,f),this.stat=v}R(ii,ue);function Mt(f){const v=ds();pt(v,new ii(v,f))}tr.Ma="timingevent";function tn(f,v){ue.call(this,tr.Ma,f),this.size=v}R(tn,ue);function nn(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){f()},v)}function Yt(){this.g=!0}Yt.prototype.xa=function(){this.g=!1};function nr(f,v,_,I,J,le){f.info(function(){if(f.g)if(le)for(var _e="",ut=le.split("&"),Tn=0;Tn<ut.length;Tn++){var dt=ut[Tn].split("=");if(1<dt.length){var Vn=dt[0];dt=dt[1];var En=Vn.split("_");_e=2<=En.length&&En[1]=="type"?_e+(Vn+"="+dt+"&"):_e+(Vn+"=redacted&")}}else _e=null;else _e=le;return"XMLHTTP REQ ("+I+") [attempt "+J+"]: "+v+`
`+_+`
`+_e})}function Tl(f,v,_,I,J,le,_e){f.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+J+"]: "+v+`
`+_+`
`+le+" "+_e})}function Sr(f,v,_,I){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+Hr(f,_)+(I?" "+I:"")})}function oi(f,v){f.info(function(){return"TIMEOUT: "+v})}Yt.prototype.info=function(){};function Hr(f,v){if(!f.g)return v;if(!v)return null;try{var _=JSON.parse(v);if(_){for(f=0;f<_.length;f++)if(Array.isArray(_[f])){var I=_[f];if(!(2>I.length)){var J=I[1];if(Array.isArray(J)&&!(1>J.length)){var le=J[0];if(le!="noop"&&le!="stop"&&le!="close")for(var _e=1;_e<J.length;_e++)J[_e]=""}}}}return kn(_)}catch{return v}}var Dn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},sr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Os;function Vs(){}R(Vs,fo),Vs.prototype.g=function(){return new XMLHttpRequest},Vs.prototype.i=function(){return{}},Os=new Vs;function Pn(f,v,_,I){this.j=f,this.i=v,this.l=_,this.R=I||1,this.U=new Zs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Xt}function Xt(){this.i=null,this.g="",this.h=!1}var Pe={},Q={};function xe(f,v,_){f.L=1,f.v=xo(Ls(v)),f.m=_,f.P=!0,je(f,null)}function je(f,v){f.F=Date.now(),Ot(f),f.A=Ls(f.v);var _=f.A,I=f.R;Array.isArray(I)||(I=[String(I)]),bu(_.i,"t",I),f.C=0,_=f.j.J,f.h=new Xt,f.g=Oh(f.j,_?v:null,!f.m),0<f.O&&(f.M=new Nl(b(f.Y,f,f.g),f.O)),v=f.U,_=f.g,I=f.ca;var J="readystatechange";Array.isArray(J)||(J&&(er[0]=J.toString()),J=er);for(var le=0;le<J.length;le++){var _e=gt(_,J[le],I||v.handleEvent,!1,v.h||v);if(!_e)break;v.g[_e.key]=_e}v=f.H?T(f.H):{},f.m?(f.u||(f.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,v)):(f.u="GET",f.g.ea(f.A,f.u,null,v)),Er(),nr(f.i,f.u,f.A,f.l,f.R,f.m)}Pn.prototype.ca=function(f){f=f.target;const v=this.M;v&&lr(f)==3?v.j():this.Y(f)},Pn.prototype.Y=function(f){try{if(f==this.g)e:{const En=lr(this.g);var v=this.g.Ba();const wa=this.g.Z();if(!(3>En)&&(En!=3||this.g&&(this.h.h||this.g.oa()||jh(this.g)))){this.J||En!=4||v==7||(v==8||0>=wa?Er(3):Er(2)),Mn(this);var _=this.g.Z();this.X=_;t:if(Nt(this)){var I=jh(this.g);f="";var J=I.length,le=lr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ln(this),ts(this);var _e="";break t}this.h.i=new h.TextDecoder}for(v=0;v<J;v++)this.h.h=!0,f+=this.h.i.decode(I[v],{stream:!(le&&v==J-1)});I.length=0,this.h.g+=f,this.C=0,_e=this.h.g}else _e=this.g.oa();if(this.o=_==200,Tl(this.i,this.u,this.A,this.l,this.R,En,_),this.o){if(this.T&&!this.K){t:{if(this.g){var ut,Tn=this.g;if((ut=Tn.g?Tn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(ut)){var dt=ut;break t}}dt=null}if(_=dt)Sr(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zt(this,_);else{this.o=!1,this.s=3,Mt(12),ln(this),ts(this);break e}}if(this.P){_=!0;let Qn;for(;!this.J&&this.C<_e.length;)if(Qn=on(this,_e),Qn==Q){En==4&&(this.s=4,Mt(14),_=!1),Sr(this.i,this.l,null,"[Incomplete Response]");break}else if(Qn==Pe){this.s=4,Mt(15),Sr(this.i,this.l,_e,"[Invalid Chunk]"),_=!1;break}else Sr(this.i,this.l,Qn,null),zt(this,Qn);if(Nt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),En!=4||_e.length!=0||this.h.h||(this.s=1,Mt(16),_=!1),this.o=this.o&&_,!_)Sr(this.i,this.l,_e,"[Invalid Chunked Response]"),ln(this),ts(this);else if(0<_e.length&&!this.W){this.W=!0;var Vn=this.j;Vn.g==this&&Vn.ba&&!Vn.M&&(Vn.j.info("Great, no buffering proxy detected. Bytes received: "+_e.length),So(Vn),Vn.M=!0,Mt(11))}}else Sr(this.i,this.l,_e,null),zt(this,_e);En==4&&ln(this),this.o&&!this.J&&(En==4?Dh(this.j,this):(this.o=!1,Ot(this)))}else Vg(this.g),_==400&&0<_e.indexOf("Unknown SID")?(this.s=3,Mt(12)):(this.s=0,Mt(13)),ln(this),ts(this)}}}catch{}finally{}};function Nt(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function on(f,v){var _=f.C,I=v.indexOf(`
`,_);return I==-1?Q:(_=Number(v.substring(_,I)),isNaN(_)?Pe:(I+=1,I+_>v.length?Q:(v=v.slice(I,I+_),f.C=I+_,v)))}Pn.prototype.cancel=function(){this.J=!0,ln(this)};function Ot(f){f.S=Date.now()+f.I,Nn(f,f.I)}function Nn(f,v){if(f.B!=null)throw Error("WatchDog timer not null");f.B=nn(b(f.ba,f),v)}function Mn(f){f.B&&(h.clearTimeout(f.B),f.B=null)}Pn.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(oi(this.i,this.A),this.L!=2&&(Er(),Mt(17)),ln(this),this.s=2,ts(this)):Nn(this,this.S-f)};function ts(f){f.j.G==0||f.J||Dh(f.j,f)}function ln(f){Mn(f);var v=f.M;v&&typeof v.ma=="function"&&v.ma(),f.M=null,Kn(f.U),f.g&&(v=f.g,f.g=null,v.abort(),v.ma())}function zt(f,v){try{var _=f.j;if(_.G!=0&&(_.g==f||gu(_.h,f))){if(!f.K&&gu(_.h,f)&&_.G==3){try{var I=_.Da.g.parse(v)}catch{I=null}if(Array.isArray(I)&&I.length==3){var J=I;if(J[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<f.F)Ol(_),Pl(_);else break e;Eu(_),Mt(18)}}else _.za=J[1],0<_.za-_.T&&37500>J[2]&&_.F&&_.v==0&&!_.C&&(_.C=nn(b(_.Za,_),6e3));if(1>=Sl(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else ba(_,11)}else if((f.K||_.g==f)&&Ol(_),!B(v))for(J=_.Da.g.parse(v),v=0;v<J.length;v++){let dt=J[v];if(_.T=dt[0],dt=dt[1],_.G==2)if(dt[0]=="c"){_.K=dt[1],_.ia=dt[2];const Vn=dt[3];Vn!=null&&(_.la=Vn,_.j.info("VER="+_.la));const En=dt[4];En!=null&&(_.Aa=En,_.j.info("SVER="+_.Aa));const wa=dt[5];wa!=null&&typeof wa=="number"&&0<wa&&(I=1.5*wa,_.L=I,_.j.info("backChannelRequestTimeoutMs_="+I)),I=_;const Qn=f.g;if(Qn){const Wr=Qn.g?Qn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wr){var le=I.h;le.g||Wr.indexOf("spdy")==-1&&Wr.indexOf("quic")==-1&&Wr.indexOf("h2")==-1||(le.j=le.l,le.g=new Set,le.h&&(Al(le,le.h),le.h=null))}if(I.D){const Au=Qn.g?Qn.g.getResponseHeader("X-HTTP-Session-Id"):null;Au&&(I.ya=Au,Ct(I.I,I.D,Au))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-f.F,_.j.info("Handshake RTT: "+_.R+"ms")),I=_;var _e=f;if(I.qa=Mh(I,I.J?I.ia:null,I.W),_e.K){hs(I.h,_e);var ut=_e,Tn=I.L;Tn&&(ut.I=Tn),ut.B&&(Mn(ut),Ot(ut)),I.g=_e}else Rh(I);0<_.i.length&&Ml(_)}else dt[0]!="stop"&&dt[0]!="close"||ba(_,7);else _.G==3&&(dt[0]=="stop"||dt[0]=="close"?dt[0]=="stop"?ba(_,7):Nu(_):dt[0]!="noop"&&_.l&&_.l.ta(dt),_.v=0)}}Er(4)}catch{}}var go=class{constructor(f,v){this.g=f,this.map=v}};function rr(f){this.l=f||10,h.PerformanceNavigationTiming?(f=h.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function El(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Sl(f){return f.h?1:f.g?f.g.size:0}function gu(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function Al(f,v){f.g?f.g.add(v):f.h=v}function hs(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}rr.prototype.cancel=function(){if(this.i=pu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function pu(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const _ of f.g.values())v=v.concat(_.D);return v}return k(f.i)}function Dg(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(m(f)){for(var v=[],_=f.length,I=0;I<_;I++)v.push(f[I]);return v}v=[],_=0;for(I in f)v[_++]=f[I];return v}function jl(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(m(f)||typeof f=="string"){var v=[];f=f.length;for(var _=0;_<f;_++)v.push(_);return v}v=[],_=0;for(const I in f)v[_++]=I;return v}}}function yu(f,v){if(f.forEach&&typeof f.forEach=="function")f.forEach(v,void 0);else if(m(f)||typeof f=="string")Array.prototype.forEach.call(f,v,void 0);else for(var _=jl(f),I=Dg(f),J=I.length,le=0;le<J;le++)v.call(void 0,I[le],_&&_[le],f)}var po=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pg(f,v){if(f){f=f.split("&");for(var _=0;_<f.length;_++){var I=f[_].indexOf("="),J=null;if(0<=I){var le=f[_].substring(0,I);J=f[_].substring(I+1)}else le=f[_];v(le,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function fn(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof fn){this.h=f.h,yo(this,f.j),this.o=f.o,this.g=f.g,li(this,f.s),this.l=f.l;var v=f.i,_=new pa;_.i=v.i,v.g&&(_.g=new Map(v.g),_.h=v.h),ga(this,_),this.m=f.m}else f&&(v=String(f).match(po))?(this.h=!1,yo(this,v[1]||"",!0),this.o=ar(v[2]||""),this.g=ar(v[3]||"",!0),li(this,v[4]),this.l=ar(v[5]||"",!0),ga(this,v[6]||"",!0),this.m=ar(v[7]||"")):(this.h=!1,this.i=new pa(null,this.h))}fn.prototype.toString=function(){var f=[],v=this.j;v&&f.push(vo(v,xu,!0),":");var _=this.g;return(_||v=="file")&&(f.push("//"),(v=this.o)&&f.push(vo(v,xu,!0),"@"),f.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&f.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&f.push("/"),f.push(vo(_,_.charAt(0)=="/"?Mg:vu,!0))),(_=this.i.toString())&&f.push("?",_),(_=this.m)&&f.push("#",vo(_,Il)),f.join("")};function Ls(f){return new fn(f)}function yo(f,v,_){f.j=_?ar(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function li(f,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);f.s=v}else f.s=null}function ga(f,v,_){v instanceof pa?(f.i=v,Sh(f.i,f.h)):(_||(v=vo(v,Og)),f.i=new pa(v,f.h))}function Ct(f,v,_){f.i.set(v,_)}function xo(f){return Ct(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function ar(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function vo(f,v,_){return typeof f=="string"?(f=encodeURI(f).replace(v,Eh),_&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Eh(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var xu=/[#\/\?@]/g,vu=/[#\?:]/g,Mg=/[#\?]/g,Og=/[#\?@]/g,Il=/#/g;function pa(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function ir(f){f.g||(f.g=new Map,f.h=0,f.i&&Pg(f.i,function(v,_){f.add(decodeURIComponent(v.replace(/\+/g," ")),_)}))}s=pa.prototype,s.add=function(f,v){ir(this),this.i=null,f=Gr(this,f);var _=this.g.get(f);return _||this.g.set(f,_=[]),_.push(v),this.h+=1,this};function ya(f,v){ir(f),v=Gr(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function xa(f,v){return ir(f),v=Gr(f,v),f.g.has(v)}s.forEach=function(f,v){ir(this),this.g.forEach(function(_,I){_.forEach(function(J){f.call(v,J,I,this)},this)},this)},s.na=function(){ir(this);const f=Array.from(this.g.values()),v=Array.from(this.g.keys()),_=[];for(let I=0;I<v.length;I++){const J=f[I];for(let le=0;le<J.length;le++)_.push(v[I])}return _},s.V=function(f){ir(this);let v=[];if(typeof f=="string")xa(this,f)&&(v=v.concat(this.g.get(Gr(this,f))));else{f=Array.from(this.g.values());for(let _=0;_<f.length;_++)v=v.concat(f[_])}return v},s.set=function(f,v){return ir(this),this.i=null,f=Gr(this,f),xa(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},s.get=function(f,v){return f?(f=this.V(f),0<f.length?String(f[0]):v):v};function bu(f,v,_){ya(f,v),0<_.length&&(f.i=null,f.g.set(Gr(f,v),k(_)),f.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(var _=0;_<v.length;_++){var I=v[_];const le=encodeURIComponent(String(I)),_e=this.V(I);for(I=0;I<_e.length;I++){var J=le;_e[I]!==""&&(J+="="+encodeURIComponent(String(_e[I]))),f.push(J)}}return this.i=f.join("&")};function Gr(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function Sh(f,v){v&&!f.j&&(ir(f),f.i=null,f.g.forEach(function(_,I){var J=I.toLowerCase();I!=J&&(ya(this,I),bu(this,J,_))},f)),f.j=v}function bo(f,v){const _=new Yt;if(h.Image){const I=new Image;I.onload=E(or,_,"TestLoadImage: loaded",!0,v,I),I.onerror=E(or,_,"TestLoadImage: error",!1,v,I),I.onabort=E(or,_,"TestLoadImage: abort",!1,v,I),I.ontimeout=E(or,_,"TestLoadImage: timeout",!1,v,I),h.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=f}else v(!1)}function Ar(f,v){const _=new Yt,I=new AbortController,J=setTimeout(()=>{I.abort(),or(_,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:I.signal}).then(le=>{clearTimeout(J),le.ok?or(_,"TestPingServer: ok",!0,v):or(_,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(J),or(_,"TestPingServer: error",!1,v)})}function or(f,v,_,I,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),I(_)}catch{}}function wo(){this.g=new Nr}function $r(f,v,_){const I=_||"";try{yu(f,function(J,le){let _e=J;p(J)&&(_e=kn(J)),v.push(I+le+"="+encodeURIComponent(_e))})}catch(J){throw v.push(I+"type="+encodeURIComponent("_badmap")),J}}function ci(f){this.l=f.Ub||null,this.j=f.eb||!1}R(ci,fo),ci.prototype.g=function(){return new va(this.l,this.j)},ci.prototype.i=(function(f){return function(){return f}})({});function va(f,v){_t.call(this),this.D=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(va,_t),s=va.prototype,s.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=v,this.readyState=1,Qr(this)},s.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(v.body=f),(this.D||h).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Kr(this)),this.readyState=0},s.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Qr(this)),this.g&&(this.readyState=3,Qr(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;wu(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function wu(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}s.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?Kr(this):Qr(this),this.readyState==3&&wu(this)}},s.Ra=function(f){this.g&&(this.response=this.responseText=f,Kr(this))},s.Qa=function(f){this.g&&(this.response=f,Kr(this))},s.ga=function(){this.g&&Kr(this)};function Kr(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Qr(f)}s.setRequestHeader=function(f,v){this.u.append(f,v)},s.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var _=v.next();!_.done;)_=_.value,f.push(_[0]+": "+_[1]),_=v.next();return f.join(`\r
`)};function Qr(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(va.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function _u(f){let v="";return L(f,function(_,I){v+=I,v+=":",v+=_,v+=`\r
`}),v}function On(f,v,_){e:{for(I in _){var I=!1;break e}I=!0}I||(_=_u(_),typeof f=="string"?_!=null&&encodeURIComponent(String(_)):Ct(f,v,_))}function bt(f){_t.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(bt,_t);var Cl=/^https?$/i,_o=["POST","PUT"];s=bt.prototype,s.Ha=function(f){this.J=f},s.ea=function(f,v,_,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Os.g(),this.v=this.o?qr(this.o):qr(Os),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(le){Ah(this,le);return}if(f=_||"",_=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var J in I)_.set(J,I[J]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const le of I.keys())_.set(le,I.get(le));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(_.keys()).find(le=>le.toLowerCase()=="content-type"),J=h.FormData&&f instanceof h.FormData,!(0<=Array.prototype.indexOf.call(_o,v,void 0))||I||J||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[le,_e]of _)this.g.setRequestHeader(le,_e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{No(this),this.u=!0,this.g.send(f),this.u=!1}catch(le){Ah(this,le)}};function Ah(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.m=5,Rl(f),Yr(f)}function Rl(f){f.A||(f.A=!0,pt(f,"complete"),pt(f,"error"))}s.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,pt(this,"complete"),pt(this,"abort"),Yr(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yr(this,!0)),bt.aa.N.call(this)},s.Ea=function(){this.s||(this.B||this.u||this.j?kl(this):this.bb())},s.bb=function(){kl(this)};function kl(f){if(f.h&&typeof u<"u"&&(!f.v[1]||lr(f)!=4||f.Z()!=2)){if(f.u&&lr(f)==4)_n(f.Ea,0,f);else if(pt(f,"readystatechange"),lr(f)==4){f.h=!1;try{const _e=f.Z();e:switch(_e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var _;if(!(_=v)){var I;if(I=_e===0){var J=String(f.D).match(po)[1]||null;!J&&h.self&&h.self.location&&(J=h.self.location.protocol.slice(0,-1)),I=!Cl.test(J?J.toLowerCase():"")}_=I}if(_)pt(f,"complete"),pt(f,"success");else{f.m=6;try{var le=2<lr(f)?f.g.statusText:""}catch{le=""}f.l=le+" ["+f.Z()+"]",Rl(f)}}finally{Yr(f)}}}}function Yr(f,v){if(f.g){No(f);const _=f.g,I=f.v[0]?()=>{}:null;f.g=null,f.v=null,v||pt(f,"ready");try{_.onreadystatechange=I}catch{}}}function No(f){f.I&&(h.clearTimeout(f.I),f.I=null)}s.isActive=function(){return!!this.g};function lr(f){return f.g?f.g.readyState:0}s.Z=function(){try{return 2<lr(this)?this.g.status:-1}catch{return-1}},s.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.Oa=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),Br(v)}};function jh(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Vg(f){const v={};f=(f.g&&2<=lr(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<f.length;I++){if(B(f[I]))continue;var _=j(f[I]);const J=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const le=v[J]||[];v[J]=le,le.push(_)}P(v,function(I){return I.join(", ")})}s.Ba=function(){return this.m},s.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function To(f,v,_){return _&&_.internalChannelParams&&_.internalChannelParams[f]||v}function Dl(f){this.Aa=0,this.i=[],this.j=new Yt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=To("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=To("baseRetryDelayMs",5e3,f),this.cb=To("retryDelaySeedMs",1e4,f),this.Wa=To("forwardChannelMaxRetries",2,f),this.wa=To("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new rr(f&&f.concurrentRequestLimit),this.Da=new wo,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}s=Dl.prototype,s.la=8,s.G=1,s.connect=function(f,v,_,I){Mt(0),this.W=f,this.H=v||{},_&&I!==void 0&&(this.H.OSID=_,this.H.OAID=I),this.F=this.X,this.I=Mh(this,null,this.W),Ml(this)};function Nu(f){if(Ih(f),f.G==3){var v=f.U++,_=Ls(f.I);if(Ct(_,"SID",f.K),Ct(_,"RID",v),Ct(_,"TYPE","terminate"),Eo(f,_),v=new Pn(f,f.j,v),v.L=2,v.v=xo(Ls(_)),_=!1,h.navigator&&h.navigator.sendBeacon)try{_=h.navigator.sendBeacon(v.v.toString(),"")}catch{}!_&&h.Image&&(new Image().src=v.v,_=!0),_||(v.g=Oh(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Ot(v)}Ph(f)}function Pl(f){f.g&&(So(f),f.g.cancel(),f.g=null)}function Ih(f){Pl(f),f.u&&(h.clearTimeout(f.u),f.u=null),Ol(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&h.clearTimeout(f.s),f.s=null)}function Ml(f){if(!El(f.h)&&!f.s){f.s=!0;var v=f.Ga;oe||C(),$||(oe(),$=!0),ge.add(v,f),f.B=0}}function Lg(f,v){return Sl(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=v.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=nn(b(f.Ga,f,v),Su(f,f.B)),f.B++,!0)}s.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const J=new Pn(this,this.j,f);let le=this.o;if(this.S&&(le?(le=T(le),F(le,this.S)):le=this.S),this.m!==null||this.O||(J.H=le,le=null),this.P)e:{for(var v=0,_=0;_<this.i.length;_++){t:{var I=this.i[_];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(v+=I,4096<v){v=_;break e}if(v===4096||_===this.i.length-1){v=_+1;break e}}v=1e3}else v=1e3;v=Ch(this,J,v),_=Ls(this.I),Ct(_,"RID",f),Ct(_,"CVER",22),this.D&&Ct(_,"X-HTTP-Session-Id",this.D),Eo(this,_),le&&(this.O?v="headers="+encodeURIComponent(String(_u(le)))+"&"+v:this.m&&On(_,this.m,le)),Al(this.h,J),this.Ua&&Ct(_,"TYPE","init"),this.P?(Ct(_,"$req",v),Ct(_,"SID","null"),J.T=!0,xe(J,_,null)):xe(J,_,v),this.G=2}}else this.G==3&&(f?Tu(this,f):this.i.length==0||El(this.h)||Tu(this))};function Tu(f,v){var _;v?_=v.l:_=f.U++;const I=Ls(f.I);Ct(I,"SID",f.K),Ct(I,"RID",_),Ct(I,"AID",f.T),Eo(f,I),f.m&&f.o&&On(I,f.m,f.o),_=new Pn(f,f.j,_,f.B+1),f.m===null&&(_.H=f.o),v&&(f.i=v.D.concat(f.i)),v=Ch(f,_,1e3),_.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Al(f.h,_),xe(_,I,v)}function Eo(f,v){f.H&&L(f.H,function(_,I){Ct(v,I,_)}),f.l&&yu({},function(_,I){Ct(v,I,_)})}function Ch(f,v,_){_=Math.min(f.i.length,_);var I=f.l?b(f.l.Na,f.l,f):null;e:{var J=f.i;let le=-1;for(;;){const _e=["count="+_];le==-1?0<_?(le=J[0].g,_e.push("ofs="+le)):le=0:_e.push("ofs="+le);let ut=!0;for(let Tn=0;Tn<_;Tn++){let dt=J[Tn].g;const Vn=J[Tn].map;if(dt-=le,0>dt)le=Math.max(0,J[Tn].g-100),ut=!1;else try{$r(Vn,_e,"req"+dt+"_")}catch{I&&I(Vn)}}if(ut){I=_e.join("&");break e}}}return f=f.i.splice(0,_),v.D=f,I}function Rh(f){if(!f.g&&!f.u){f.Y=1;var v=f.Fa;oe||C(),$||(oe(),$=!0),ge.add(v,f),f.v=0}}function Eu(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=nn(b(f.Fa,f),Su(f,f.v)),f.v++,!0)}s.Fa=function(){if(this.u=null,kh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=nn(b(this.ab,this),f)}},s.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Mt(10),Pl(this),kh(this))};function So(f){f.A!=null&&(h.clearTimeout(f.A),f.A=null)}function kh(f){f.g=new Pn(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var v=Ls(f.qa);Ct(v,"RID","rpc"),Ct(v,"SID",f.K),Ct(v,"AID",f.T),Ct(v,"CI",f.F?"0":"1"),!f.F&&f.ja&&Ct(v,"TO",f.ja),Ct(v,"TYPE","xmlhttp"),Eo(f,v),f.m&&f.o&&On(v,f.m,f.o),f.L&&(f.g.I=f.L);var _=f.g;f=f.ia,_.L=1,_.v=xo(Ls(v)),_.m=null,_.P=!0,je(_,f)}s.Za=function(){this.C!=null&&(this.C=null,Pl(this),Eu(this),Mt(19))};function Ol(f){f.C!=null&&(h.clearTimeout(f.C),f.C=null)}function Dh(f,v){var _=null;if(f.g==v){Ol(f),So(f),f.g=null;var I=2}else if(gu(f.h,v))_=v.D,hs(f.h,v),I=1;else return;if(f.G!=0){if(v.o)if(I==1){_=v.m?v.m.length:0,v=Date.now()-v.F;var J=f.B;I=ds(),pt(I,new tn(I,_)),Ml(f)}else Rh(f);else if(J=v.s,J==3||J==0&&0<v.X||!(I==1&&Lg(f,v)||I==2&&Eu(f)))switch(_&&0<_.length&&(v=f.h,v.i=v.i.concat(_)),J){case 1:ba(f,5);break;case 4:ba(f,10);break;case 3:ba(f,6);break;default:ba(f,2)}}}function Su(f,v){let _=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(_*=2),_*v}function ba(f,v){if(f.j.info("Error code "+v),v==2){var _=b(f.fb,f),I=f.Xa;const J=!I;I=new fn(I||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||yo(I,"https"),xo(I),J?bo(I.toString(),_):Ar(I.toString(),_)}else Mt(2);f.G=0,f.l&&f.l.sa(v),Ph(f),Ih(f)}s.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Mt(2)):(this.j.info("Failed to ping google.com"),Mt(1))};function Ph(f){if(f.G=0,f.ka=[],f.l){const v=pu(f.h);(v.length!=0||f.i.length!=0)&&(U(f.ka,v),U(f.ka,f.i),f.h.i.length=0,k(f.i),f.i.length=0),f.l.ra()}}function Mh(f,v,_){var I=_ instanceof fn?Ls(_):new fn(_);if(I.g!="")v&&(I.g=v+"."+I.g),li(I,I.s);else{var J=h.location;I=J.protocol,v=v?v+"."+J.hostname:J.hostname,J=+J.port;var le=new fn(null);I&&yo(le,I),v&&(le.g=v),J&&li(le,J),_&&(le.l=_),I=le}return _=f.D,v=f.ya,_&&v&&Ct(I,_,v),Ct(I,"VER",f.la),Eo(f,I),I}function Oh(f,v,_){if(v&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Ca&&!f.pa?new bt(new ci({eb:_})):new bt(f.pa),v.Ha(f.J),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vh(){}s=Vh.prototype,s.ua=function(){},s.ta=function(){},s.sa=function(){},s.ra=function(){},s.isActive=function(){return!0},s.Na=function(){};function Vl(){}Vl.prototype.g=function(f,v){return new fs(f,v)};function fs(f,v){_t.call(this),this.g=new Dl(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(f?f["X-WebChannel-Client-Profile"]=v.va:f={"X-WebChannel-Client-Profile":v.va}),this.g.S=f,(f=v&&v.Sb)&&!B(f)&&(this.g.m=f),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!B(v)&&(this.g.D=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new Xr(this)}R(fs,_t),fs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},fs.prototype.close=function(){Nu(this.g)},fs.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var _={};_.__data__=f,f=_}else this.u&&(_={},_.__data__=kn(f),f=_);v.i.push(new go(v.Ya++,f)),v.G==3&&Ml(v)},fs.prototype.N=function(){this.g.l=null,delete this.j,Nu(this.g),delete this.g,fs.aa.N.call(this)};function Lh(f){us.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const _ in v){f=_;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}R(Lh,us);function Fh(){mo.call(this),this.status=1}R(Fh,mo);function Xr(f){this.g=f}R(Xr,Vh),Xr.prototype.ua=function(){pt(this.g,"a")},Xr.prototype.ta=function(f){pt(this.g,new Lh(f))},Xr.prototype.sa=function(f){pt(this.g,new Fh)},Xr.prototype.ra=function(){pt(this.g,"b")},Vl.prototype.createWebChannel=Vl.prototype.g,fs.prototype.send=fs.prototype.o,fs.prototype.open=fs.prototype.m,fs.prototype.close=fs.prototype.close,vS=function(){return new Vl},xS=function(){return ds()},yS=tr,mx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Dn.NO_ERROR=0,Dn.TIMEOUT=8,Dn.HTTP_ERROR=6,rm=Dn,sr.COMPLETE="complete",pS=sr,zr.EventType=Tr,Tr.OPEN="a",Tr.CLOSE="b",Tr.ERROR="c",Tr.MESSAGE="d",_t.prototype.listen=_t.prototype.K,Ed=zr,bt.prototype.listenOnce=bt.prototype.L,bt.prototype.getLastError=bt.prototype.Ka,bt.prototype.getLastErrorCode=bt.prototype.Ba,bt.prototype.getStatus=bt.prototype.Z,bt.prototype.getResponseJson=bt.prototype.Oa,bt.prototype.getResponseText=bt.prototype.oa,bt.prototype.send=bt.prototype.ea,bt.prototype.setWithCredentials=bt.prototype.Ha,gS=bt}).apply(typeof qf<"u"?qf:typeof self<"u"?self:typeof window<"u"?window:{});const bN="@firebase/firestore",wN="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zn.UNAUTHENTICATED=new zn(null),zn.GOOGLE_CREDENTIALS=new zn("google-credentials-uid"),zn.FIRST_PARTY=new zn("first-party-uid"),zn.MOCK_USER=new zn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let su="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi=new Wm("@firebase/firestore");function bc(){return Xi.logLevel}function cD(s){Xi.setLogLevel(s)}function pe(s,...e){if(Xi.logLevel<=it.DEBUG){const t=e.map(uv);Xi.debug(`Firestore (${su}): ${s}`,...t)}}function dn(s,...e){if(Xi.logLevel<=it.ERROR){const t=e.map(uv);Xi.error(`Firestore (${su}): ${s}`,...t)}}function Ws(s,...e){if(Xi.logLevel<=it.WARN){const t=e.map(uv);Xi.warn(`Firestore (${su}): ${s}`,...t)}}function uv(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(s,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,bS(s,n,t)}function bS(s,e,t){let n=`FIRESTORE (${su}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw dn(n),new Error(n)}function ke(s,e,t,n){let a="Unexpected state";typeof t=="string"?a=t:n=t,s||bS(e,a,n)}function uD(s,e){s||Ae(57014,e)}function Te(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends wr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _S{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(zn.UNAUTHENTICATED)))}shutdown(){}}class dD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class hD{constructor(e){this.t=e,this.currentUser=zn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ke(this.o===void 0,42304);let n=this.i;const a=m=>this.i!==n?(n=this.i,t(m)):Promise.resolve();let l=new Hn;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Hn,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},h=m=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((m=>h(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?h(m):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Hn)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ke(typeof n.accessToken=="string",31837,{l:n}),new wS(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ke(e===null||typeof e=="string",2055,{h:e}),new zn(e)}}class fD{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=zn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class mD{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new fD(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(zn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class gD{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ke(this.o===void 0,3512);const n=l=>{l.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,pe("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>n(l)))};const a=l=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ke(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class pD{getToken(){return Promise.resolve(new gx(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yD(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<s;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=yD(40);for(let l=0;l<a.length;++l)n.length<20&&a[l]<t&&(n+=e.charAt(a[l]%62))}return n}}function qe(s,e){return s<e?-1:s>e?1:0}function px(s,e){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++){const a=s.charAt(n),l=e.charAt(n);if(a!==l)return qy(a)===qy(l)?qe(a,l):qy(a)?1:-1}return qe(s.length,e.length)}const xD=55296,vD=57343;function qy(s){const e=s.charCodeAt(0);return e>=xD&&e<=vD}function kc(s,e,t){return s.length===e.length&&s.every(((n,a)=>t(n,e[a])))}function NS(s){return s+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx="__name__";class sa{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ae(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Ae(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return sa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof sa?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let a=0;a<n;a++){const l=sa.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return qe(e.length,t.length)}static compareSegments(e,t){const n=sa.isNumericId(e),a=sa.isNumericId(t);return n&&!a?-1:!n&&a?1:n&&a?sa.extractNumericId(e).compare(sa.extractNumericId(t)):px(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ki.fromString(e.substring(4,e.length-2))}}class tt extends sa{construct(e,t,n){return new tt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new he(re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((a=>a.length>0)))}return new tt(t)}static emptyPath(){return new tt([])}}const bD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends sa{construct(e,t,n){return new Bt(e,t,n)}static isValidIdentifier(e){return bD.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yx}static keyField(){return new Bt([yx])}static fromServerFormat(e){const t=[];let n="",a=0;const l=()=>{if(n.length===0)throw new he(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let u=!1;for(;a<e.length;){const h=e[a];if(h==="\\"){if(a+1===e.length)throw new he(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new he(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=m,a+=2}else h==="`"?(u=!u,a++):h!=="."||u?(n+=h,a++):(l(),a++)}if(l(),u)throw new he(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.path=e}static fromPath(e){return new Ne(tt.fromString(e))}static fromName(e){return new Ne(tt.fromString(e).popFirst(5))}static empty(){return new Ne(tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return tt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ne(new tt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(s,e,t){if(!t)throw new he(re.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function TS(s,e,t,n){if(e===!0&&n===!0)throw new he(re.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function _N(s){if(!Ne.isDocumentKey(s))throw new he(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function NN(s){if(Ne.isDocumentKey(s))throw new he(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function ES(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function sg(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Ae(12329,{type:typeof s})}function nt(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new he(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=sg(s);throw new he(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function SS(s,e){if(e<=0)throw new he(re.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(s,e){const t={typeString:s};return e&&(t.value=e),t}function xl(s,e){if(!ES(s))throw new he(re.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const a=e[n].typeString,l="value"in e[n]?{value:e[n].value}:void 0;if(!(n in s)){t=`JSON missing required field: '${n}'`;break}const u=s[n];if(a&&typeof u!==a){t=`JSON field '${n}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${n}' field to equal '${l.value}'`;break}}if(t)throw new he(re.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN=-62135596800,EN=1e6;class wt{static now(){return wt.fromMillis(Date.now())}static fromDate(e){return wt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*EN);return new wt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new he(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new he(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<TN)throw new he(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/EN}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xl(e,wt._jsonSchema))return new wt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-TN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}wt._jsonSchemaVersion="firestore/timestamp/1.0",wt._jsonSchema={type:bn("string",wt._jsonSchemaVersion),seconds:bn("number"),nanoseconds:bn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{static fromTimestamp(e){return new Oe(e)}static min(){return new Oe(new wt(0,0))}static max(){return new Oe(new wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dc=-1;class Pc{constructor(e,t,n,a){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=a}}function xx(s){return s.fields.find((e=>e.kind===2))}function Ho(s){return s.fields.filter((e=>e.kind!==2))}function wD(s,e){let t=qe(s.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let n=0;n<Math.min(s.fields.length,e.fields.length);++n)if(t=_D(s.fields[n],e.fields[n]),t!==0)return t;return qe(s.fields.length,e.fields.length)}Pc.UNKNOWN_ID=-1;class Zo{constructor(e,t){this.fieldPath=e,this.kind=t}}function _D(s,e){const t=Bt.comparator(s.fieldPath,e.fieldPath);return t!==0?t:qe(s.kind,e.kind)}class Mc{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Mc(0,Js.min())}}function AS(s,e){const t=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,a=Oe.fromTimestamp(n===1e9?new wt(t+1,0):new wt(t,n));return new Js(a,Ne.empty(),e)}function jS(s){return new Js(s.readTime,s.key,Dc)}class Js{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Js(Oe.min(),Ne.empty(),Dc)}static max(){return new Js(Oe.max(),Ne.empty(),Dc)}}function hv(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=Ne.comparator(s.documentKey,e.documentKey),t!==0?t:qe(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ro(s){if(s.code!==re.FAILED_PRECONDITION||s.message!==IS)throw s;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new W(((n,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(n,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(n,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof W?t:W.resolve(t)}catch(t){return W.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):W.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):W.reject(t)}static resolve(e){return new W(((t,n)=>{t(e)}))}static reject(e){return new W(((t,n)=>{n(e)}))}static waitFor(e){return new W(((t,n)=>{let a=0,l=0,u=!1;e.forEach((h=>{++a,h.next((()=>{++l,u&&l===a&&t()}),(m=>n(m)))})),u=!0,l===a&&t()}))}static or(e){let t=W.resolve(!1);for(const n of e)t=t.next((a=>a?W.resolve(a):n()));return t}static forEach(e,t){const n=[];return e.forEach(((a,l)=>{n.push(t.call(this,a,l))})),this.waitFor(n)}static mapArray(e,t){return new W(((n,a)=>{const l=e.length,u=new Array(l);let h=0;for(let m=0;m<l;m++){const p=m;t(e[p]).next((x=>{u[p]=x,++h,h===l&&n(u)}),(x=>a(x)))}}))}static doWhile(e,t){return new W(((n,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):n()};l()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s="SimpleDb";class rg{static open(e,t,n,a){try{return new rg(t,e.transaction(a,n))}catch(l){throw new kd(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Hn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new kd(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const a=fv(n.target.error);this.S.reject(new kd(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(pe($s,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new TD(t)}}class ua{static delete(e){return pe($s,"Removing database:",e),$o(xE().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Jx())return!1;if(ua.F())return!0;const e=In(),t=ua.M(e),n=0<t&&t<10,a=RS(e),l=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||l)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,ua.M(In())===12.2&&dn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(pe($s,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=l=>{const u=l.target.result;t(u)},a.onblocked=()=>{n(new kd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const u=l.target.error;u.name==="VersionError"?n(new he(re.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?n(new he(re.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):n(new kd(e,u))},a.onupgradeneeded=l=>{pe($s,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const u=l.target.result;this.N.k(u,a.transaction,l.oldVersion,this.version).next((()=>{pe($s,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,a){const l=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const h=rg.open(this.db,e,l?"readonly":"readwrite",n),m=a(h).next((p=>(h.C(),p))).catch((p=>(h.abort(p),W.reject(p)))).toPromise();return m.catch((()=>{})),await h.D,m}catch(h){const m=h,p=m.name!=="FirebaseError"&&u<3;if(pe($s,"Transaction failed with error:",m.message,"Retrying:",p),this.close(),!p)return Promise.reject(m)}}}close(){this.db&&this.db.close(),this.db=void 0}}function RS(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class ND{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return $o(this.U.delete())}}class kd extends he{constructor(e,t){super(re.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ao(s){return s.name==="IndexedDbTransactionError"}class TD{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(pe($s,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(pe($s,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),$o(n)}add(e){return pe($s,"ADD",this.store.name,e,e),$o(this.store.add(e))}get(e){return $o(this.store.get(e)).next((t=>(t===void 0&&(t=null),pe($s,"GET",this.store.name,e,t),t)))}delete(e){return pe($s,"DELETE",this.store.name,e),$o(this.store.delete(e))}count(){return pe($s,"COUNT",this.store.name),$o(this.store.count())}J(e,t){const n=this.options(e,t),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const l=a.getAll(n.range);return new W(((u,h)=>{l.onerror=m=>{h(m.target.error)},l.onsuccess=m=>{u(m.target.result)}}))}{const l=this.cursor(n),u=[];return this.H(l,((h,m)=>{u.push(m)})).next((()=>u))}}Y(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new W(((a,l)=>{n.onerror=u=>{l(u.target.error)},n.onsuccess=u=>{a(u.target.result)}}))}Z(e,t){pe($s,"DELETE ALL",this.store.name);const n=this.options(e,t);n.X=!1;const a=this.cursor(n);return this.H(a,((l,u,h)=>h.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const a=this.cursor(n);return this.H(a,t)}te(e){const t=this.cursor({});return new W(((n,a)=>{t.onerror=l=>{const u=fv(l.target.error);a(u)},t.onsuccess=l=>{const u=l.target.result;u?e(u.primaryKey,u.value).next((h=>{h?u.continue():n()})):n()}}))}H(e,t){const n=[];return new W(((a,l)=>{e.onerror=u=>{l(u.target.error)},e.onsuccess=u=>{const h=u.target.result;if(!h)return void a();const m=new ND(h),p=t(h.primaryKey,h.value,m);if(p instanceof W){const x=p.catch((w=>(m.done(),W.reject(w))));n.push(x)}m.isDone?a():m.G===null?h.continue():h.continue(m.G)}})).next((()=>W.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function $o(s){return new W(((e,t)=>{s.onsuccess=n=>{const a=n.target.result;e(a)},s.onerror=n=>{const a=fv(n.target.error);t(a)}}))}let SN=!1;function fv(s){const e=ua.M(In());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(t)>=0){const n=new he("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return SN||(SN=!0,setTimeout((()=>{throw n}),0)),n}}return s}const Dd="IndexBackfiller";class ED{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){pe(Dd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();pe(Dd,`Documents written: ${t}`)}catch(t){ao(t)?pe(Dd,"Ignoring IndexedDB error during index backfill: ",t):await ro(t)}await this.re(6e4)}))}}class SD{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let a=t,l=!0;return W.doWhile((()=>l===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!n.has(u))return pe(Dd,`Processing collection: ${u}`),this.oe(e,u,a).next((h=>{a-=h,n.add(u)}));l=!1})))).next((()=>t-a))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,n).next((l=>{const u=l.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(a,l))).next((h=>(pe(Dd,`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h)))).next((()=>u.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((a,l)=>{const u=jS(l);hv(u,n)>0&&(n=u)})),new Js(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ns.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi=-1;function uh(s){return s==null}function Gd(s){return s===0&&1/s==-1/0}function kS(s){return typeof s=="number"&&Number.isInteger(s)&&!Gd(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am="";function ls(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=AN(e)),e=AD(s.get(t),e);return AN(e)}function AD(s,e){let t=e;const n=s.length;for(let a=0;a<n;a++){const l=s.charAt(a);switch(l){case"\0":t+="";break;case Am:t+="";break;default:t+=l}}return t}function AN(s){return s+Am+""}function oa(s){const e=s.length;if(ke(e>=2,64408,{path:s}),e===2)return ke(s.charAt(0)===Am&&s.charAt(1)==="",56145,{path:s}),tt.emptyPath();const t=e-2,n=[];let a="";for(let l=0;l<e;){const u=s.indexOf(Am,l);switch((u<0||u>t)&&Ae(50515,{path:s}),s.charAt(u+1)){case"":const h=s.substring(l,u);let m;a.length===0?m=h:(a+=h,m=a,a=""),n.push(m);break;case"":a+=s.substring(l,u),a+="\0";break;case"":a+=s.substring(l,u+1);break;default:Ae(61167,{path:s})}l=u+2}return new tt(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go="remoteDocuments",dh="owner",hc="owner",$d="mutationQueues",jD="userId",Dr="mutations",jN="batchId",Wo="userMutationsIndex",IN=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function am(s,e){return[s,ls(e)]}function DS(s,e,t){return[s,ls(e),t]}const ID={},Oc="documentMutations",jm="remoteDocumentsV14",CD=["prefixPath","collectionGroup","readTime","documentId"],im="documentKeyIndex",RD=["prefixPath","collectionGroup","documentId"],PS="collectionGroupIndex",kD=["collectionGroup","readTime","prefixPath","documentId"],Kd="remoteDocumentGlobal",vx="remoteDocumentGlobalKey",Vc="targets",MS="queryTargetsIndex",DD=["canonicalId","targetId"],Lc="targetDocuments",PD=["targetId","path"],mv="documentTargetsIndex",MD=["path","targetId"],Im="targetGlobalKey",el="targetGlobal",Qd="collectionParents",OD=["collectionId","parent"],Fc="clientMetadata",VD="clientId",ag="bundles",LD="bundleId",ig="namedQueries",FD="name",gv="indexConfiguration",UD="indexId",bx="collectionGroupIndex",BD="collectionGroup",Pd="indexState",qD=["indexId","uid"],OS="sequenceNumberIndex",zD=["uid","sequenceNumber"],Md="indexEntries",HD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],VS="documentKeyIndex",GD=["indexId","uid","orderedDocumentKey"],og="documentOverlays",$D=["userId","collectionPath","documentId"],wx="collectionPathOverlayIndex",KD=["userId","collectionPath","largestBatchId"],LS="collectionGroupOverlayIndex",QD=["userId","collectionGroup","largestBatchId"],pv="globals",YD="name",FS=[$d,Dr,Oc,Go,Vc,dh,el,Lc,Fc,Kd,Qd,ag,ig],XD=[...FS,og],US=[$d,Dr,Oc,jm,Vc,dh,el,Lc,Fc,Kd,Qd,ag,ig,og],BS=US,yv=[...BS,gv,Pd,Md],WD=yv,qS=[...yv,pv],JD=qS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x extends CS{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Rn(s,e){const t=Te(s);return ua.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CN(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function io(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function zS(s,e){const t=[];for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&t.push(e(s[n],n,s));return t}function HS(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e,t){this.comparator=e,this.root=t||Jn.EMPTY}insert(e,t){return new Ft(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Jn.BLACK,null,null))}remove(e){return new Ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return t+n.left.size;a<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zf(this.root,e,this.comparator,!1)}getReverseIterator(){return new zf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zf(this.root,e,this.comparator,!0)}}class zf{constructor(e,t,n,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?n(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Jn{constructor(e,t,n,a,l){this.key=e,this.value=t,this.color=n??Jn.RED,this.left=a??Jn.EMPTY,this.right=l??Jn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,a,l){return new Jn(e??this.key,t??this.value,n??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let a=this;const l=n(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,n),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Jn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Jn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Jn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Jn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ae(27949);return e+(this.isRed()?0:1)}}Jn.EMPTY=null,Jn.RED=!0,Jn.BLACK=!1;Jn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae(57766)}get value(){throw Ae(16141)}get color(){throw Ae(16727)}get left(){throw Ae(29726)}get right(){throw Ae(36894)}copy(e,t,n,a,l){return this}insert(e,t,n){return new Jn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.comparator=e,this.data=new Ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new RN(this.data.getIterator())}getIteratorFrom(e){return new RN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof jt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=n.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new jt(this.comparator);return t.data=e,t}}class RN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fc(s){return s.hasNext()?s.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new Ts([])}unionWith(e){let t=new jt(Bt.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ts(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return kc(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new GS("Invalid base64 string: "+l):l}})(e);return new en(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new en(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}en.EMPTY_BYTE_STRING=new en("");const e4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xa(s){if(ke(!!s,39018),typeof s=="string"){let e=0;const t=e4.exec(s);if(ke(!!t,46558,{timestamp:s}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Gt(s.seconds),nanos:Gt(s.nanos)}}function Gt(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Wa(s){return typeof s=="string"?en.fromBase64String(s):en.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S="server_timestamp",KS="__type__",QS="__previous_value__",YS="__local_write_time__";function lg(s){return(s?.mapValue?.fields||{})[KS]?.stringValue===$S}function cg(s){const e=s.mapValue.fields[QS];return lg(e)?cg(e):e}function Yd(s){const e=Xa(s.mapValue.fields[YS].timestampValue);return new wt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e,t,n,a,l,u,h,m,p,x){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=m,this.useFetchStreams=p,this.isUsingEmulator=x}}const Xd="(default)";class Wi{constructor(e,t){this.projectId=e,this.database=t||Xd}static empty(){return new Wi("","")}get isDefaultDatabase(){return this.database===Xd}isEqual(e){return e instanceof Wi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv="__type__",XS="__max__",Bi={mapValue:{fields:{__type__:{stringValue:XS}}}},vv="__vector__",Uc="value",om={nullValue:"NULL_VALUE"};function Ji(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?lg(s)?4:WS(s)?9007199254740991:ug(s)?10:11:Ae(28295,{value:s})}function fa(s,e){if(s===e)return!0;const t=Ji(s);if(t!==Ji(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Yd(s).isEqual(Yd(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=Xa(a.timestampValue),h=Xa(l.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(a,l){return Wa(a.bytesValue).isEqual(Wa(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(a,l){return Gt(a.geoPointValue.latitude)===Gt(l.geoPointValue.latitude)&&Gt(a.geoPointValue.longitude)===Gt(l.geoPointValue.longitude)})(s,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Gt(a.integerValue)===Gt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Gt(a.doubleValue),h=Gt(l.doubleValue);return u===h?Gd(u)===Gd(h):isNaN(u)&&isNaN(h)}return!1})(s,e);case 9:return kc(s.arrayValue.values||[],e.arrayValue.values||[],fa);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},h=l.mapValue.fields||{};if(CN(u)!==CN(h))return!1;for(const m in u)if(u.hasOwnProperty(m)&&(h[m]===void 0||!fa(u[m],h[m])))return!1;return!0})(s,e);default:return Ae(52216,{left:s})}}function Wd(s,e){return(s.values||[]).find((t=>fa(t,e)))!==void 0}function Zi(s,e){if(s===e)return 0;const t=Ji(s),n=Ji(e);if(t!==n)return qe(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return qe(s.booleanValue,e.booleanValue);case 2:return(function(l,u){const h=Gt(l.integerValue||l.doubleValue),m=Gt(u.integerValue||u.doubleValue);return h<m?-1:h>m?1:h===m?0:isNaN(h)?isNaN(m)?0:-1:1})(s,e);case 3:return kN(s.timestampValue,e.timestampValue);case 4:return kN(Yd(s),Yd(e));case 5:return px(s.stringValue,e.stringValue);case 6:return(function(l,u){const h=Wa(l),m=Wa(u);return h.compareTo(m)})(s.bytesValue,e.bytesValue);case 7:return(function(l,u){const h=l.split("/"),m=u.split("/");for(let p=0;p<h.length&&p<m.length;p++){const x=qe(h[p],m[p]);if(x!==0)return x}return qe(h.length,m.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,u){const h=qe(Gt(l.latitude),Gt(u.latitude));return h!==0?h:qe(Gt(l.longitude),Gt(u.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return DN(s.arrayValue,e.arrayValue);case 10:return(function(l,u){const h=l.fields||{},m=u.fields||{},p=h[Uc]?.arrayValue,x=m[Uc]?.arrayValue,w=qe(p?.values?.length||0,x?.values?.length||0);return w!==0?w:DN(p,x)})(s.mapValue,e.mapValue);case 11:return(function(l,u){if(l===Bi.mapValue&&u===Bi.mapValue)return 0;if(l===Bi.mapValue)return 1;if(u===Bi.mapValue)return-1;const h=l.fields||{},m=Object.keys(h),p=u.fields||{},x=Object.keys(p);m.sort(),x.sort();for(let w=0;w<m.length&&w<x.length;++w){const b=px(m[w],x[w]);if(b!==0)return b;const E=Zi(h[m[w]],p[x[w]]);if(E!==0)return E}return qe(m.length,x.length)})(s.mapValue,e.mapValue);default:throw Ae(23264,{he:t})}}function kN(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return qe(s,e);const t=Xa(s),n=Xa(e),a=qe(t.seconds,n.seconds);return a!==0?a:qe(t.nanos,n.nanos)}function DN(s,e){const t=s.values||[],n=e.values||[];for(let a=0;a<t.length&&a<n.length;++a){const l=Zi(t[a],n[a]);if(l)return l}return qe(t.length,n.length)}function Bc(s){return Nx(s)}function Nx(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const n=Xa(t);return`time(${n.seconds},${n.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Wa(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return Ne.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let n="[",a=!0;for(const l of t.values||[])a?a=!1:n+=",",n+=Nx(l);return n+"]"})(s.arrayValue):"mapValue"in s?(function(t){const n=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of n)l?l=!1:a+=",",a+=`${u}:${Nx(t.fields[u])}`;return a+"}"})(s.mapValue):Ae(61005,{value:s})}function lm(s){switch(Ji(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cg(s);return e?16+lm(e):16;case 5:return 2*s.stringValue.length;case 6:return Wa(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,l)=>a+lm(l)),0)})(s.arrayValue);case 10:case 11:return(function(n){let a=0;return io(n.fields,((l,u)=>{a+=l.length+lm(u)})),a})(s.mapValue);default:throw Ae(13486,{value:s})}}function il(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Tx(s){return!!s&&"integerValue"in s}function Jd(s){return!!s&&"arrayValue"in s}function PN(s){return!!s&&"nullValue"in s}function MN(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function cm(s){return!!s&&"mapValue"in s}function ug(s){return(s?.mapValue?.fields||{})[xv]?.stringValue===vv}function Od(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return io(s.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Od(n))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Od(s.arrayValue.values[t]);return e}return{...s}}function WS(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===XS}const JS={mapValue:{fields:{[xv]:{stringValue:vv},[Uc]:{arrayValue:{}}}}};function n4(s){return"nullValue"in s?om:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?il(Wi.empty(),Ne.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?ug(s)?JS:{mapValue:{}}:Ae(35942,{value:s})}function s4(s){return"nullValue"in s?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?il(Wi.empty(),Ne.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?JS:"mapValue"in s?ug(s)?{mapValue:{}}:Bi:Ae(61959,{value:s})}function ON(s,e){const t=Zi(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?-1:!s.inclusive&&e.inclusive?1:0}function VN(s,e){const t=Zi(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?1:!s.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.value=e}static empty(){return new Zn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!cm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Od(t)}setAll(e){let t=Bt.emptyPath(),n={},a=[];e.forEach(((u,h)=>{if(!t.isImmediateParentOf(h)){const m=this.getFieldsMap(t);this.applyChanges(m,n,a),n={},a=[],t=h.popLast()}u?n[h.lastSegment()]=Od(u):a.push(h.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,n,a)}delete(e){const t=this.field(e.popLast());cm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return fa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=t.mapValue.fields[e.get(n)];cm(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,n){io(t,((a,l)=>e[a]=l));for(const a of n)delete e[a]}clone(){return new Zn(Od(this.value))}}function ZS(s){const e=[];return io(s.fields,((t,n)=>{const a=new Bt([t]);if(cm(n)){const l=ZS(n.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new Ts(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e,t,n,a,l,u,h){this.key=e,this.documentType=t,this.version=n,this.readTime=a,this.createTime=l,this.data=u,this.documentState=h}static newInvalidDocument(e){return new Ut(e,0,Oe.min(),Oe.min(),Oe.min(),Zn.empty(),0)}static newFoundDocument(e,t,n,a){return new Ut(e,1,t,Oe.min(),n,a,0)}static newNoDocument(e,t){return new Ut(e,2,t,Oe.min(),Oe.min(),Zn.empty(),0)}static newUnknownDocument(e,t){return new Ut(e,3,t,Oe.min(),Oe.min(),Zn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ut&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ut(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,t){this.position=e,this.inclusive=t}}function LN(s,e,t){let n=0;for(let a=0;a<s.position.length;a++){const l=e[a],u=s.position[a];if(l.field.isKeyField()?n=Ne.comparator(Ne.fromName(u.referenceValue),t.key):n=Zi(u,t.data.field(l.field)),l.dir==="desc"&&(n*=-1),n!==0)break}return n}function FN(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!fa(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e,t="asc"){this.field=e,this.dir=t}}function r4(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{}class ot extends eA{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new a4(e,t,n):t==="array-contains"?new l4(e,n):t==="in"?new iA(e,n):t==="not-in"?new c4(e,n):t==="array-contains-any"?new u4(e,n):new ot(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new i4(e,n):new o4(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Zi(t,this.value)):t!==null&&Ji(this.value)===Ji(t)&&this.matchesComparison(Zi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class St extends eA{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new St(e,t)}matches(e){return qc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function qc(s){return s.op==="and"}function Ex(s){return s.op==="or"}function bv(s){return tA(s)&&qc(s)}function tA(s){for(const e of s.filters)if(e instanceof St)return!1;return!0}function Sx(s){if(s instanceof ot)return s.field.canonicalString()+s.op.toString()+Bc(s.value);if(bv(s))return s.filters.map((e=>Sx(e))).join(",");{const e=s.filters.map((t=>Sx(t))).join(",");return`${s.op}(${e})`}}function nA(s,e){return s instanceof ot?(function(n,a){return a instanceof ot&&n.op===a.op&&n.field.isEqual(a.field)&&fa(n.value,a.value)})(s,e):s instanceof St?(function(n,a){return a instanceof St&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((l,u,h)=>l&&nA(u,a.filters[h])),!0):!1})(s,e):void Ae(19439)}function sA(s,e){const t=s.filters.concat(e);return St.create(t,s.op)}function rA(s){return s instanceof ot?(function(t){return`${t.field.canonicalString()} ${t.op} ${Bc(t.value)}`})(s):s instanceof St?(function(t){return t.op.toString()+" {"+t.getFilters().map(rA).join(" ,")+"}"})(s):"Filter"}class a4 extends ot{constructor(e,t,n){super(e,t,n),this.key=Ne.fromName(n.referenceValue)}matches(e){const t=Ne.comparator(e.key,this.key);return this.matchesComparison(t)}}class i4 extends ot{constructor(e,t){super(e,"in",t),this.keys=aA("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class o4 extends ot{constructor(e,t){super(e,"not-in",t),this.keys=aA("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function aA(s,e){return(e.arrayValue?.values||[]).map((t=>Ne.fromName(t.referenceValue)))}class l4 extends ot{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jd(t)&&Wd(t.arrayValue,this.value)}}class iA extends ot{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Wd(this.value.arrayValue,t)}}class c4 extends ot{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Wd(this.value.arrayValue,t)}}class u4 extends ot{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>Wd(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e,t=null,n=[],a=[],l=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=a,this.limit=l,this.startAt=u,this.endAt=h,this.Te=null}}function Ax(s,e=null,t=[],n=[],a=null,l=null,u=null){return new d4(s,e,t,n,a,l,u)}function ol(s){const e=Te(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>Sx(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(l){return l.field.canonicalString()+l.dir})(n))).join(","),uh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>Bc(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>Bc(n))).join(",")),e.Te=t}return e.Te}function hh(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!r4(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!nA(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!FN(s.startAt,e.startAt)&&FN(s.endAt,e.endAt)}function Cm(s){return Ne.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function Rm(s,e){return s.filters.filter((t=>t instanceof ot&&t.field.isEqual(e)))}function UN(s,e,t){let n=om,a=!0;for(const l of Rm(s,e)){let u=om,h=!0;switch(l.op){case"<":case"<=":u=n4(l.value);break;case"==":case"in":case">=":u=l.value;break;case">":u=l.value,h=!1;break;case"!=":case"not-in":u=om}ON({value:n,inclusive:a},{value:u,inclusive:h})<0&&(n=u,a=h)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];ON({value:n,inclusive:a},{value:u,inclusive:t.inclusive})<0&&(n=u,a=t.inclusive);break}}return{value:n,inclusive:a}}function BN(s,e,t){let n=Bi,a=!0;for(const l of Rm(s,e)){let u=Bi,h=!0;switch(l.op){case">=":case">":u=s4(l.value),h=!1;break;case"==":case"in":case"<=":u=l.value;break;case"<":u=l.value,h=!1;break;case"!=":case"not-in":u=Bi}VN({value:n,inclusive:a},{value:u,inclusive:h})>0&&(n=u,a=h)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];VN({value:n,inclusive:a},{value:u,inclusive:t.inclusive})>0&&(n=u,a=t.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,t=null,n=[],a=[],l=null,u="F",h=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=a,this.limit=l,this.limitType=u,this.startAt=h,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function oA(s,e,t,n,a,l,u,h){return new ei(s,e,t,n,a,l,u,h)}function ru(s){return new ei(s)}function qN(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function wv(s){return s.collectionGroup!==null}function jc(s){const e=Te(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new jt(Bt.comparator);return u.filters.forEach((m=>{m.getFlattenedFilters().forEach((p=>{p.isInequality()&&(h=h.add(p.field))}))})),h})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Zd(l,n))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new Zd(Bt.keyField(),n))}return e.Ie}function cs(s){const e=Te(s);return e.Ee||(e.Ee=cA(e,jc(s))),e.Ee}function lA(s){const e=Te(s);return e.de||(e.de=cA(e,s.explicitOrderBy)),e.de}function cA(s,e){if(s.limitType==="F")return Ax(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Zd(a.field,l)}));const t=s.endAt?new eo(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new eo(s.startAt.position,s.startAt.inclusive):null;return Ax(s.path,s.collectionGroup,e,s.filters,s.limit,t,n)}}function jx(s,e){const t=s.filters.concat([e]);return new ei(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function km(s,e,t){return new ei(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function fh(s,e){return hh(cs(s),cs(e))&&s.limitType===e.limitType}function uA(s){return`${ol(cs(s))}|lt:${s.limitType}`}function wc(s){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((a=>rA(a))).join(", ")}]`),uh(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((a=>Bc(a))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((a=>Bc(a))).join(",")),`Target(${n})`})(cs(s))}; limitType=${s.limitType})`}function mh(s,e){return e.isFoundDocument()&&(function(n,a){const l=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(l):Ne.isDocumentKey(n.path)?n.path.isEqual(l):n.path.isImmediateParentOf(l)})(s,e)&&(function(n,a){for(const l of jc(n))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(n,a){for(const l of n.filters)if(!l.matches(a))return!1;return!0})(s,e)&&(function(n,a){return!(n.startAt&&!(function(u,h,m){const p=LN(u,h,m);return u.inclusive?p<=0:p<0})(n.startAt,jc(n),a)||n.endAt&&!(function(u,h,m){const p=LN(u,h,m);return u.inclusive?p>=0:p>0})(n.endAt,jc(n),a))})(s,e)}function dA(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function hA(s){return(e,t)=>{let n=!1;for(const a of jc(s)){const l=h4(a,e,t);if(l!==0)return l;n=n||a.field.isKeyField()}return 0}}function h4(s,e,t){const n=s.field.isKeyField()?Ne.comparator(e.key,t.key):(function(l,u,h){const m=u.data.field(l),p=h.data.field(l);return m!==null&&p!==null?Zi(m,p):Ae(42886)})(s.field,e,t);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return Ae(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[a,l]of n)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[t]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){io(this.inner,((t,n)=>{for(const[a,l]of n)e(a,l)}))}isEmpty(){return HS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4=new Ft(Ne.comparator);function Es(){return f4}const fA=new Ft(Ne.comparator);function Sd(...s){let e=fA;for(const t of s)e=e.insert(t.key,t);return e}function mA(s){let e=fA;return s.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function la(){return Vd()}function gA(){return Vd()}function Vd(){return new ti((s=>s.toString()),((s,e)=>s.isEqual(e)))}const m4=new Ft(Ne.comparator),g4=new jt(Ne.comparator);function Xe(...s){let e=g4;for(const t of s)e=e.add(t);return e}const p4=new jt(qe);function _v(){return p4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gd(e)?"-0":e}}function pA(s){return{integerValue:""+s}}function yA(s,e){return kS(e)?pA(e):Nv(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(){this._=void 0}}function y4(s,e,t){return s instanceof zc?(function(a,l){const u={fields:{[KS]:{stringValue:$S},[YS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&lg(l)&&(l=cg(l)),l&&(u.fields[QS]=l),{mapValue:u}})(t,e):s instanceof ll?vA(s,e):s instanceof cl?bA(s,e):(function(a,l){const u=xA(a,l),h=zN(u)+zN(a.Ae);return Tx(u)&&Tx(a.Ae)?pA(h):Nv(a.serializer,h)})(s,e)}function x4(s,e,t){return s instanceof ll?vA(s,e):s instanceof cl?bA(s,e):t}function xA(s,e){return s instanceof Hc?(function(n){return Tx(n)||(function(l){return!!l&&"doubleValue"in l})(n)})(e)?e:{integerValue:0}:null}class zc extends dg{}class ll extends dg{constructor(e){super(),this.elements=e}}function vA(s,e){const t=wA(e);for(const n of s.elements)t.some((a=>fa(a,n)))||t.push(n);return{arrayValue:{values:t}}}class cl extends dg{constructor(e){super(),this.elements=e}}function bA(s,e){let t=wA(e);for(const n of s.elements)t=t.filter((a=>!fa(a,n)));return{arrayValue:{values:t}}}class Hc extends dg{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function zN(s){return Gt(s.integerValue||s.doubleValue)}function wA(s){return Jd(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,t){this.field=e,this.transform=t}}function v4(s,e){return s.field.isEqual(e.field)&&(function(n,a){return n instanceof ll&&a instanceof ll||n instanceof cl&&a instanceof cl?kc(n.elements,a.elements,fa):n instanceof Hc&&a instanceof Hc?fa(n.Ae,a.Ae):n instanceof zc&&a instanceof zc})(s.transform,e.transform)}class b4{constructor(e,t){this.version=e,this.transformResults=t}}class Kt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Kt}static exists(e){return new Kt(void 0,e)}static updateTime(e){return new Kt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function um(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class hg{}function _A(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new iu(s.key,Kt.none()):new au(s.key,s.data,Kt.none());{const t=s.data,n=Zn.empty();let a=new jt(Bt.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?n.delete(l):n.set(l,u),a=a.add(l)}return new ni(s.key,n,new Ts(a.toArray()),Kt.none())}}function w4(s,e,t){s instanceof au?(function(a,l,u){const h=a.value.clone(),m=GN(a.fieldTransforms,l,u.transformResults);h.setAll(m),l.convertToFoundDocument(u.version,h).setHasCommittedMutations()})(s,e,t):s instanceof ni?(function(a,l,u){if(!um(a.precondition,l))return void l.convertToUnknownDocument(u.version);const h=GN(a.fieldTransforms,l,u.transformResults),m=l.data;m.setAll(NA(a)),m.setAll(h),l.convertToFoundDocument(u.version,m).setHasCommittedMutations()})(s,e,t):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function Ld(s,e,t,n){return s instanceof au?(function(l,u,h,m){if(!um(l.precondition,u))return h;const p=l.value.clone(),x=$N(l.fieldTransforms,m,u);return p.setAll(x),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null})(s,e,t,n):s instanceof ni?(function(l,u,h,m){if(!um(l.precondition,u))return h;const p=$N(l.fieldTransforms,m,u),x=u.data;return x.setAll(NA(l)),x.setAll(p),u.convertToFoundDocument(u.version,x).setHasLocalMutations(),h===null?null:h.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((w=>w.field)))})(s,e,t,n):(function(l,u,h){return um(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h})(s,e,t)}function _4(s,e){let t=null;for(const n of s.fieldTransforms){const a=e.data.field(n.field),l=xA(n.transform,a||null);l!=null&&(t===null&&(t=Zn.empty()),t.set(n.field,l))}return t||null}function HN(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&kc(n,a,((l,u)=>v4(l,u)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class au extends hg{constructor(e,t,n,a=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ni extends hg{constructor(e,t,n,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function NA(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=s.data.field(t);e.set(t,n)}})),e}function GN(s,e,t){const n=new Map;ke(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let a=0;a<t.length;a++){const l=s[a],u=l.transform,h=e.data.field(l.field);n.set(l.field,x4(u,h,t[a]))}return n}function $N(s,e,t){const n=new Map;for(const a of s){const l=a.transform,u=t.data.field(a.field);n.set(a.field,y4(l,u,e))}return n}class iu extends hg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Tv extends hg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,t,n,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&w4(l,e,n[a])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ld(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ld(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=gA();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let h=this.applyToLocalView(u,l.mutatedFields);h=t.has(a.key)?null:h;const m=_A(u,h);m!==null&&n.set(a.key,m),u.isValidDocument()||u.convertToNoDocument(Oe.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Xe())}isEqual(e){return this.batchId===e.batchId&&kc(this.mutations,e.mutations,((t,n)=>HN(t,n)))&&kc(this.baseMutations,e.baseMutations,((t,n)=>HN(t,n)))}}class Sv{constructor(e,t,n,a){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=a}static from(e,t,n){ke(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return m4})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,n[u].version);return new Sv(e,t,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pn,ft;function EA(s){switch(s){case re.OK:return Ae(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return Ae(15467,{code:s})}}function SA(s){if(s===void 0)return dn("GRPC error has no .code"),re.UNKNOWN;switch(s){case pn.OK:return re.OK;case pn.CANCELLED:return re.CANCELLED;case pn.UNKNOWN:return re.UNKNOWN;case pn.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case pn.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case pn.INTERNAL:return re.INTERNAL;case pn.UNAVAILABLE:return re.UNAVAILABLE;case pn.UNAUTHENTICATED:return re.UNAUTHENTICATED;case pn.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case pn.NOT_FOUND:return re.NOT_FOUND;case pn.ALREADY_EXISTS:return re.ALREADY_EXISTS;case pn.PERMISSION_DENIED:return re.PERMISSION_DENIED;case pn.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case pn.ABORTED:return re.ABORTED;case pn.OUT_OF_RANGE:return re.OUT_OF_RANGE;case pn.UNIMPLEMENTED:return re.UNIMPLEMENTED;case pn.DATA_LOSS:return re.DATA_LOSS;default:return Ae(39323,{code:s})}}(ft=pn||(pn={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ix=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4=new Ki([4294967295,4294967295],0);function KN(s){const e=AA().encode(s),t=new mS;return t.update(e),new Uint8Array(t.digest())}function QN(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Ki([t,n],0),new Ki([a,l],0)]}class jv{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ad(`Invalid padding: ${t}`);if(n<0)throw new Ad(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ad(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ad(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ki.fromNumber(this.ge)}ye(e,t,n){let a=e.add(t.multiply(Ki.fromNumber(n)));return a.compare(T4)===1&&(a=new Ki([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=KN(e),[n,a]=QN(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(n,a,l);if(!this.we(u))return!1}return!0}static create(e,t,n){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new jv(l,a,t);return n.forEach((h=>u.insert(h))),u}insert(e){if(this.ge===0)return;const t=KN(e),[n,a]=QN(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(n,a,l);this.Se(u)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ad extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,t,n,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const a=new Map;return a.set(e,yh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ph(Oe.min(),a,new Ft(qe),Es(),Xe())}}class yh{constructor(e,t,n,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new yh(n,t,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e,t,n,a){this.be=e,this.removedTargetIds=t,this.key=n,this.De=a}}class jA{constructor(e,t){this.targetId=e,this.Ce=t}}class IA{constructor(e,t,n=en.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=a}}class YN{constructor(){this.ve=0,this.Fe=XN(),this.Me=en.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Xe(),t=Xe(),n=Xe();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:n=n.add(a);break;default:Ae(38017,{changeType:l})}})),new yh(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=XN()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ke(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class E4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Es(),this.Je=Hf(),this.He=Hf(),this.Ye=new Ft(qe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Ae(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,n=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(Cm(l))if(n===0){const u=new Ne(l.path);this.et(t,u,Ut.newNoDocument(u,Oe.min()))}else ke(n===1,20013,{expectedCount:n});else{const u=this._t(t);if(u!==n){const h=this.ut(e),m=h?this.ct(h,e,u):1;if(m!==0){this.it(t);const p=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}Ix?.lt((function(x,w,b,E,R){const k={localCacheCount:x,existenceFilterCount:w.count,databaseId:b.database,projectId:b.projectId},U=w.unchangedNames;return U&&(k.bloomFilter={applied:R===0,hashCount:U?.hashCount??0,bitmapLength:U?.bits?.bitmap?.length??0,padding:U?.bits?.padding??0,mightContain:z=>E?.mightContain(z)??!1}),k})(u,e.Ce,this.Ge.ht(),h,m))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:l=0}=t;let u,h;try{u=Wa(n).toUint8Array()}catch(m){if(m instanceof GS)return Ws("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{h=new jv(u,a,l)}catch(m){return Ws(m instanceof Ad?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return h.ge===0?null:h}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let a=0;return n.forEach((l=>{const u=this.Ge.ht(),h=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(h)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const h=this.ot(u);if(h){if(l.current&&Cm(h.target)){const m=new Ne(h.target.path);this.It(m).has(u)||this.Et(u,m)||this.et(u,m,Ut.newNoDocument(m,e))}l.Be&&(t.set(u,l.ke()),l.qe())}}));let n=Xe();this.He.forEach(((l,u)=>{let h=!0;u.forEachWhile((m=>{const p=this.ot(m);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(n=n.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new ph(e,t,this.Ye,this.je,n);return this.je=Es(),this.Je=Hf(),this.He=Hf(),this.Ye=new Ft(qe),a}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new YN,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new jt(qe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new jt(qe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new YN),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Hf(){return new Ft(Ne.comparator)}function XN(){return new Ft(Ne.comparator)}const S4={asc:"ASCENDING",desc:"DESCENDING"},A4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},j4={and:"AND",or:"OR"};class I4{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Cx(s,e){return s.useProto3Json||uh(e)?e:{value:e}}function Gc(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function CA(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function C4(s,e){return Gc(s,e.toTimestamp())}function hn(s){return ke(!!s,49232),Oe.fromTimestamp((function(t){const n=Xa(t);return new wt(n.seconds,n.nanos)})(s))}function Iv(s,e){return Rx(s,e).canonicalString()}function Rx(s,e){const t=(function(a){return new tt(["projects",a.projectId,"databases",a.database])})(s).child("documents");return e===void 0?t:t.child(e)}function RA(s){const e=tt.fromString(s);return ke(UA(e),10190,{key:e.toString()}),e}function eh(s,e){return Iv(s.databaseId,e.path)}function da(s,e){const t=RA(e);if(t.get(1)!==s.databaseId.projectId)throw new he(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new he(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new Ne(PA(t))}function kA(s,e){return Iv(s.databaseId,e)}function DA(s){const e=RA(s);return e.length===4?tt.emptyPath():PA(e)}function kx(s){return new tt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function PA(s){return ke(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function WN(s,e,t){return{name:eh(s,e),fields:t.value.mapValue.fields}}function fg(s,e,t){const n=da(s,e.name),a=hn(e.updateTime),l=e.createTime?hn(e.createTime):Oe.min(),u=new Zn({mapValue:{fields:e.fields}}),h=Ut.newFoundDocument(n,a,l,u);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function R4(s,e){return"found"in e?(function(n,a){ke(!!a.found,43571),a.found.name,a.found.updateTime;const l=da(n,a.found.name),u=hn(a.found.updateTime),h=a.found.createTime?hn(a.found.createTime):Oe.min(),m=new Zn({mapValue:{fields:a.found.fields}});return Ut.newFoundDocument(l,u,h,m)})(s,e):"missing"in e?(function(n,a){ke(!!a.missing,3894),ke(!!a.readTime,22933);const l=da(n,a.missing),u=hn(a.readTime);return Ut.newNoDocument(l,u)})(s,e):Ae(7234,{result:e})}function k4(s,e){let t;if("targetChange"in e){e.targetChange;const n=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Ae(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(p,x){return p.useProto3Json?(ke(x===void 0||typeof x=="string",58123),en.fromBase64String(x||"")):(ke(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),en.fromUint8Array(x||new Uint8Array))})(s,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&(function(p){const x=p.code===void 0?re.UNKNOWN:SA(p.code);return new he(x,p.message||"")})(u);t=new IA(n,a,l,h||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=da(s,n.document.name),l=hn(n.document.updateTime),u=n.document.createTime?hn(n.document.createTime):Oe.min(),h=new Zn({mapValue:{fields:n.document.fields}}),m=Ut.newFoundDocument(a,l,u,h),p=n.targetIds||[],x=n.removedTargetIds||[];t=new dm(p,x,m.key,m)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=da(s,n.document),l=n.readTime?hn(n.readTime):Oe.min(),u=Ut.newNoDocument(a,l),h=n.removedTargetIds||[];t=new dm([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=da(s,n.document),l=n.removedTargetIds||[];t=new dm([],l,a,null)}else{if(!("filter"in e))return Ae(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:l}=n,u=new N4(a,l),h=n.targetId;t=new jA(h,u)}}return t}function th(s,e){let t;if(e instanceof au)t={update:WN(s,e.key,e.value)};else if(e instanceof iu)t={delete:eh(s,e.key)};else if(e instanceof ni)t={update:WN(s,e.key,e.data),updateMask:L4(e.fieldMask)};else{if(!(e instanceof Tv))return Ae(16599,{Vt:e.type});t={verify:eh(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(l,u){const h=u.transform;if(h instanceof zc)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof ll)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof cl)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Hc)return{fieldPath:u.field.canonicalString(),increment:h.Ae};throw Ae(20930,{transform:u.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:C4(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ae(27497)})(s,e.precondition)),t}function Dx(s,e){const t=e.currentDocument?(function(l){return l.updateTime!==void 0?Kt.updateTime(hn(l.updateTime)):l.exists!==void 0?Kt.exists(l.exists):Kt.none()})(e.currentDocument):Kt.none(),n=e.updateTransforms?e.updateTransforms.map((a=>(function(u,h){let m=null;if("setToServerValue"in h)ke(h.setToServerValue==="REQUEST_TIME",16630,{proto:h}),m=new zc;else if("appendMissingElements"in h){const x=h.appendMissingElements.values||[];m=new ll(x)}else if("removeAllFromArray"in h){const x=h.removeAllFromArray.values||[];m=new cl(x)}else"increment"in h?m=new Hc(u,h.increment):Ae(16584,{proto:h});const p=Bt.fromServerFormat(h.fieldPath);return new gh(p,m)})(s,a))):[];if(e.update){e.update.name;const a=da(s,e.update.name),l=new Zn({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(m){const p=m.fieldPaths||[];return new Ts(p.map((x=>Bt.fromServerFormat(x))))})(e.updateMask);return new ni(a,l,u,t,n)}return new au(a,l,t,n)}if(e.delete){const a=da(s,e.delete);return new iu(a,t)}if(e.verify){const a=da(s,e.verify);return new Tv(a,t)}return Ae(1463,{proto:e})}function D4(s,e){return s&&s.length>0?(ke(e!==void 0,14353),s.map((t=>(function(a,l){let u=a.updateTime?hn(a.updateTime):hn(l);return u.isEqual(Oe.min())&&(u=hn(l)),new b4(u,a.transformResults||[])})(t,e)))):[]}function MA(s,e){return{documents:[kA(s,e.path)]}}function mg(s,e){const t={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=kA(s,a);const l=(function(p){if(p.length!==0)return FA(St.create(p,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(p){if(p.length!==0)return p.map((x=>(function(b){return{field:Li(b.field),direction:M4(b.dir)}})(x)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const h=Cx(s,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:a}}function OA(s,e,t,n){const{ft:a,parent:l}=mg(s,e),u={},h=[];let m=0;return t.forEach((p=>{const x=n?p.alias:"aggregate_"+m++;u[x]=p.alias,p.aggregateType==="count"?h.push({alias:x,count:{}}):p.aggregateType==="avg"?h.push({alias:x,avg:{field:Li(p.fieldPath)}}):p.aggregateType==="sum"&&h.push({alias:x,sum:{field:Li(p.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:h,structuredQuery:a.structuredQuery},parent:a.parent},gt:u,parent:l}}function VA(s){let e=DA(s.parent);const t=s.structuredQuery,n=t.from?t.from.length:0;let a=null;if(n>0){ke(n===1,65062);const x=t.from[0];x.allDescendants?a=x.collectionId:e=e.child(x.collectionId)}let l=[];t.where&&(l=(function(w){const b=LA(w);return b instanceof St&&bv(b)?b.getFilters():[b]})(t.where));let u=[];t.orderBy&&(u=(function(w){return w.map((b=>(function(R){return new Zd(_c(R.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(R.direction))})(b)))})(t.orderBy));let h=null;t.limit&&(h=(function(w){let b;return b=typeof w=="object"?w.value:w,uh(b)?null:b})(t.limit));let m=null;t.startAt&&(m=(function(w){const b=!!w.before,E=w.values||[];return new eo(E,b)})(t.startAt));let p=null;return t.endAt&&(p=(function(w){const b=!w.before,E=w.values||[];return new eo(E,b)})(t.endAt)),oA(e,a,u,l,h,"F",m,p)}function P4(s,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function LA(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=_c(t.unaryFilter.field);return ot.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=_c(t.unaryFilter.field);return ot.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=_c(t.unaryFilter.field);return ot.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=_c(t.unaryFilter.field);return ot.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ae(61313);default:return Ae(60726)}})(s):s.fieldFilter!==void 0?(function(t){return ot.create(_c(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ae(58110);default:return Ae(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return St.create(t.compositeFilter.filters.map((n=>LA(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ae(1026)}})(t.compositeFilter.op))})(s):Ae(30097,{filter:s})}function M4(s){return S4[s]}function O4(s){return A4[s]}function V4(s){return j4[s]}function Li(s){return{fieldPath:s.canonicalString()}}function _c(s){return Bt.fromServerFormat(s.fieldPath)}function FA(s){return s instanceof ot?(function(t){if(t.op==="=="){if(MN(t.value))return{unaryFilter:{field:Li(t.field),op:"IS_NAN"}};if(PN(t.value))return{unaryFilter:{field:Li(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(MN(t.value))return{unaryFilter:{field:Li(t.field),op:"IS_NOT_NAN"}};if(PN(t.value))return{unaryFilter:{field:Li(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Li(t.field),op:O4(t.op),value:t.value}}})(s):s instanceof St?(function(t){const n=t.getFilters().map((a=>FA(a)));return n.length===1?n[0]:{compositeFilter:{op:V4(t.op),filters:n}}})(s):Ae(54877,{filter:s})}function L4(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function UA(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,t,n,a,l=Oe.min(),u=Oe.min(),h=en.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=m}withSequenceNumber(e){return new qa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new qa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e){this.yt=e}}function F4(s,e){let t;if(e.document)t=fg(s.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Ne.fromSegments(e.noDocument.path),a=dl(e.noDocument.readTime);t=Ut.newNoDocument(n,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae(56709);{const n=Ne.fromSegments(e.unknownDocument.path),a=dl(e.unknownDocument.version);t=Ut.newUnknownDocument(n,a)}}return e.readTime&&t.setReadTime((function(a){const l=new wt(a[0],a[1]);return Oe.fromTimestamp(l)})(e.readTime)),t}function JN(s,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Dm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(l,u){return{name:eh(l,u.key),fields:u.data.value.mapValue.fields,updateTime:Gc(l,u.version.toTimestamp()),createTime:Gc(l,u.createTime.toTimestamp())}})(s.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:ul(e.version)};else{if(!e.isUnknownDocument())return Ae(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:ul(e.version)}}return n}function Dm(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function ul(s){const e=s.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function dl(s){const e=new wt(s.seconds,s.nanoseconds);return Oe.fromTimestamp(e)}function Ko(s,e){const t=(e.baseMutations||[]).map((l=>Dx(s.yt,l)));for(let l=0;l<e.mutations.length-1;++l){const u=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const h=e.mutations[l+1];u.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const n=e.mutations.map((l=>Dx(s.yt,l))),a=wt.fromMillis(e.localWriteTimeMs);return new Ev(e.batchId,a,t,n)}function jd(s){const e=dl(s.readTime),t=s.lastLimboFreeSnapshotVersion!==void 0?dl(s.lastLimboFreeSnapshotVersion):Oe.min();let n;return n=(function(l){return l.documents!==void 0})(s.query)?(function(l){const u=l.documents.length;return ke(u===1,1966,{count:u}),cs(ru(DA(l.documents[0])))})(s.query):(function(l){return cs(VA(l))})(s.query),new qa(n,s.targetId,"TargetPurposeListen",s.lastListenSequenceNumber,e,t,en.fromBase64String(s.resumeToken))}function qA(s,e){const t=ul(e.snapshotVersion),n=ul(e.lastLimboFreeSnapshotVersion);let a;a=Cm(e.target)?MA(s.yt,e.target):mg(s.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ol(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function gg(s){const e=VA({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?km(e,e.limit,"L"):e}function zy(s,e){return new Av(e.largestBatchId,Dx(s.yt,e.overlayMutation))}function ZN(s,e){const t=e.path.lastSegment();return[s,ls(e.path.popLast()),t]}function eT(s,e,t,n){return{indexId:s,uid:e,sequenceNumber:t,readTime:ul(n.readTime),documentKey:ls(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{getBundleMetadata(e,t){return tT(e).get(t).next((n=>{if(n)return(function(l){return{id:l.bundleId,createTime:dl(l.createTime),version:l.version}})(n)}))}saveBundleMetadata(e,t){return tT(e).put((function(a){return{bundleId:a.id,createTime:ul(hn(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return nT(e).get(t).next((n=>{if(n)return(function(l){return{name:l.name,query:gg(l.bundledQuery),readTime:dl(l.readTime)}})(n)}))}saveNamedQuery(e,t){return nT(e).put((function(a){return{name:a.name,readTime:ul(hn(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function tT(s){return Rn(s,ag)}function nT(s){return Rn(s,ig)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new pg(e,n)}getOverlay(e,t){return gd(e).get(ZN(this.userId,t)).next((n=>n?zy(this.serializer,n):null))}getOverlays(e,t){const n=la();return W.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&n.set(a,l)})))).next((()=>n))}saveOverlays(e,t,n){const a=[];return n.forEach(((l,u)=>{const h=new Av(t,u);a.push(this.St(e,h))})),W.waitFor(a)}removeOverlaysForBatchId(e,t,n){const a=new Set;t.forEach((u=>a.add(ls(u.getCollectionPath()))));const l=[];return a.forEach((u=>{const h=IDBKeyRange.bound([this.userId,u,n],[this.userId,u,n+1],!1,!0);l.push(gd(e).Z(wx,h))})),W.waitFor(l)}getOverlaysForCollection(e,t,n){const a=la(),l=ls(t),u=IDBKeyRange.bound([this.userId,l,n],[this.userId,l,Number.POSITIVE_INFINITY],!0);return gd(e).J(wx,u).next((h=>{for(const m of h){const p=zy(this.serializer,m);a.set(p.getKey(),p)}return a}))}getOverlaysForCollectionGroup(e,t,n,a){const l=la();let u;const h=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return gd(e).ee({index:LS,range:h},((m,p,x)=>{const w=zy(this.serializer,p);l.size()<a||w.largestBatchId===u?(l.set(w.getKey(),w),u=w.largestBatchId):x.done()})).next((()=>l))}St(e,t){return gd(e).put((function(a,l,u){const[h,m,p]=ZN(l,u.mutation.key);return{userId:l,collectionPath:m,documentId:p,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:th(a.yt,u.mutation)}})(this.serializer,this.userId,t))}}function gd(s){return Rn(s,og)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{bt(e){return Rn(e,pv)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const n=t?.value;return n?en.fromUint8Array(n):en.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Gt(e.integerValue));else if("doubleValue"in e){const n=Gt(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Gd(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=Xa(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Wa(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?WS(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ug(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ae(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const a of Object.keys(n))this.Ot(a,t),this.Ct(n[a],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const a=Uc,l=n[a].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Gt(l)),this.Ot(a,t),this.Ct(n[a],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const a of n)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),Ne.fromName(e).path.forEach((n=>{this.Ft(t,60),this.Ut(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Qo.Kt=new Qo;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mc=255;function q4(s){if(s===0)return 8;let e=0;return s>>4||(e+=4,s<<=4),s>>6||(e+=2,s<<=2),s>>7||(e+=1),e}function sT(s){const e=64-(function(n){let a=0;for(let l=0;l<8;++l){const u=q4(255&n[l]);if(a+=u,u!==8)break}return a})(s);return Math.ceil(e/8)}class z4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Ht()}Yt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const a=t.codePointAt(0);this.Jt(240|a>>>18),this.Jt(128|63&a>>>12),this.Jt(128|63&a>>>6),this.Jt(128|63&a)}}this.Ht()}Xt(e){const t=this.en(e),n=sT(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),n=sT(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(mc),this.sn(255)}_n(){this.an(mc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(l){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,l,!1),new Uint8Array(u.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let a=1;a<t.length;++a)t[a]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===mc?(this.sn(mc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===mc?(this.an(mc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class H4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class G4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class pd{constructor(){this.cn=new z4,this.ln=new H4(this.cn),this.hn=new G4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,t,n,a){this.Tn=e,this.In=t,this.En=n,this.dn=a}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new Yo(this.Tn,this.In,this.En,n)}Rn(e,t,n){return{indexId:this.Tn,uid:e,arrayValue:hm(this.En),directionalValue:hm(this.dn),orderedDocumentKey:hm(t),documentKey:n.path.toArray()}}Vn(e,t,n){const a=this.Rn(e,t,n);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function ki(s,e){let t=s.Tn-e.Tn;return t!==0?t:(t=rT(s.En,e.En),t!==0?t:(t=rT(s.dn,e.dn),t!==0?t:Ne.comparator(s.In,e.In)))}function rT(s,e){for(let t=0;t<s.length&&t<e.length;++t){const n=s[t]-e[t];if(n!==0)return n}return s.length-e.length}function hm(s){return SE()?(function(t){let n="";for(let a=0;a<t.length;a++)n+=String.fromCharCode(t[a]);return n})(s):s}function aT(s){return typeof s!="string"?s:(function(t){const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n})(s)}class iT{constructor(e){this.mn=new jt(((t,n)=>Bt.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const n=t;n.isInequality()?this.mn=this.mn.add(n):this.gn.push(n)}}get pn(){return this.mn.size>1}yn(e){if(ke(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=xx(e);if(t!==void 0&&!this.wn(t))return!1;const n=Ho(e);let a=new Set,l=0,u=0;for(;l<n.length&&this.wn(n[l]);++l)a=a.add(n[l].fieldPath.canonicalString());if(l===n.length)return!0;if(this.mn.size>0){const h=this.mn.getIterator().getNext();if(!a.has(h.field.canonicalString())){const m=n[l];if(!this.Sn(h,m)||!this.bn(this.fn[u++],m))return!1}++l}for(;l<n.length;++l){const h=n[l];if(u>=this.fn.length||!this.bn(this.fn[u++],h))return!1}return!0}Dn(){if(this.pn)return null;let e=new jt(Bt.comparator);const t=[];for(const n of this.gn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Zo(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Zo(n.field,0))}for(const n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Zo(n.field,n.dir==="asc"?0:1)));return new Pc(Pc.UNKNOWN_ID,this.collectionId,t,Mc.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(s){if(ke(s instanceof ot||s instanceof St,20012),s instanceof ot){if(s instanceof iA){const t=s.value.arrayValue?.values?.map((n=>ot.create(s.field,"==",n)))||[];return St.create(t,"or")}return s}const e=s.filters.map((t=>zA(t)));return St.create(e,s.op)}function $4(s){if(s.getFilters().length===0)return[];const e=Ox(zA(s));return ke(HA(e),7391),Px(e)||Mx(e)?[e]:e.getFilters()}function Px(s){return s instanceof ot}function Mx(s){return s instanceof St&&bv(s)}function HA(s){return Px(s)||Mx(s)||(function(t){if(t instanceof St&&Ex(t)){for(const n of t.getFilters())if(!Px(n)&&!Mx(n))return!1;return!0}return!1})(s)}function Ox(s){if(ke(s instanceof ot||s instanceof St,34018),s instanceof ot)return s;if(s.filters.length===1)return Ox(s.filters[0]);const e=s.filters.map((n=>Ox(n)));let t=St.create(e,s.op);return t=Pm(t),HA(t)?t:(ke(t instanceof St,64498),ke(qc(t),40251),ke(t.filters.length>1,57927),t.filters.reduce(((n,a)=>Cv(n,a))))}function Cv(s,e){let t;return ke(s instanceof ot||s instanceof St,38388),ke(e instanceof ot||e instanceof St,25473),t=s instanceof ot?e instanceof ot?(function(a,l){return St.create([a,l],"and")})(s,e):oT(s,e):e instanceof ot?oT(e,s):(function(a,l){if(ke(a.filters.length>0&&l.filters.length>0,48005),qc(a)&&qc(l))return sA(a,l.getFilters());const u=Ex(a)?a:l,h=Ex(a)?l:a,m=u.filters.map((p=>Cv(p,h)));return St.create(m,"or")})(s,e),Pm(t)}function oT(s,e){if(qc(e))return sA(e,s.getFilters());{const t=e.filters.map((n=>Cv(s,n)));return St.create(t,"or")}}function Pm(s){if(ke(s instanceof ot||s instanceof St,11850),s instanceof ot)return s;const e=s.getFilters();if(e.length===1)return Pm(e[0]);if(tA(s))return s;const t=e.map((a=>Pm(a))),n=[];return t.forEach((a=>{a instanceof ot?n.push(a):a instanceof St&&(a.op===s.op?n.push(...a.filters):n.push(a))})),n.length===1?n[0]:St.create(n,s.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(){this.Cn=new Rv}addToCollectionParentIndex(e,t){return this.Cn.add(t),W.resolve()}getCollectionParents(e,t){return W.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return W.resolve()}deleteFieldIndex(e,t){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,t){return W.resolve()}getDocumentsMatchingTarget(e,t){return W.resolve(null)}getIndexType(e,t){return W.resolve(0)}getFieldIndexes(e,t){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,t){return W.resolve(Js.min())}getMinOffsetFromCollectionGroup(e,t){return W.resolve(Js.min())}updateCollectionGroup(e,t,n){return W.resolve()}updateIndexEntries(e,t){return W.resolve()}}class Rv{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t]||new jt(tt.comparator),l=!a.has(n);return this.index[t]=a.add(n),l}has(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t];return a&&a.has(n)}getEntries(e){return(this.index[e]||new jt(tt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="IndexedDbIndexManager",Gf=new Uint8Array(0);class Q4{constructor(e,t){this.databaseId=t,this.vn=new Rv,this.Fn=new ti((n=>ol(n)),((n,a)=>hh(n,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const l={collectionId:n,parent:ls(a)};return cT(e).put(l)}return W.resolve()}getCollectionParents(e,t){const n=[],a=IDBKeyRange.bound([t,""],[NS(t),""],!1,!0);return cT(e).J(a).next((l=>{for(const u of l){if(u.collectionId!==t)break;n.push(oa(u.parent))}return n}))}addFieldIndex(e,t){const n=yd(e),a=(function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map((m=>[m.fieldPath.canonicalString(),m.kind]))}})(t);delete a.indexId;const l=n.add(a);if(t.indexState){const u=pc(e);return l.next((h=>{u.put(eT(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return l.next()}deleteFieldIndex(e,t){const n=yd(e),a=pc(e),l=gc(e);return n.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=yd(e),n=gc(e),a=pc(e);return t.Z().next((()=>n.Z())).next((()=>a.Z()))}createTargetIndexes(e,t){return W.forEach(this.Mn(t),(n=>this.getIndexType(e,n).next((a=>{if(a===0||a===1){const l=new iT(n).Dn();if(l!=null)return this.addFieldIndex(e,l)}}))))}getDocumentsMatchingTarget(e,t){const n=gc(e);let a=!0;const l=new Map;return W.forEach(this.Mn(t),(u=>this.xn(e,u).next((h=>{a&&(a=!!h),l.set(u,h)})))).next((()=>{if(a){let u=Xe();const h=[];return W.forEach(l,((m,p)=>{pe(lT,`Using index ${(function(q){return`id=${q.indexId}|cg=${q.collectionGroup}|f=${q.fields.map((G=>`${G.fieldPath}:${G.kind}`)).join(",")}`})(m)} to execute ${ol(t)}`);const x=(function(q,G){const Y=xx(G);if(Y===void 0)return null;for(const L of Rm(q,Y.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null})(p,m),w=(function(q,G){const Y=new Map;for(const L of Ho(G))for(const P of Rm(q,L.fieldPath))switch(P.op){case"==":case"in":Y.set(L.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return Y.set(L.fieldPath.canonicalString(),P.value),Array.from(Y.values())}return null})(p,m),b=(function(q,G){const Y=[];let L=!0;for(const P of Ho(G)){const T=P.kind===0?UN(q,P.fieldPath,q.startAt):BN(q,P.fieldPath,q.startAt);Y.push(T.value),L&&(L=T.inclusive)}return new eo(Y,L)})(p,m),E=(function(q,G){const Y=[];let L=!0;for(const P of Ho(G)){const T=P.kind===0?BN(q,P.fieldPath,q.endAt):UN(q,P.fieldPath,q.endAt);Y.push(T.value),L&&(L=T.inclusive)}return new eo(Y,L)})(p,m),R=this.On(m,p,b),k=this.On(m,p,E),U=this.Nn(m,p,w),z=this.Bn(m.indexId,x,R,b.inclusive,k,E.inclusive,U);return W.forEach(z,(B=>n.Y(B,t.limit).next((q=>{q.forEach((G=>{const Y=Ne.fromSegments(G.documentKey);u.has(Y)||(u=u.add(Y),h.push(Y))}))}))))})).next((()=>h))}return W.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=$4(St.create(e.filters,"and")).map((n=>Ax(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,n,a,l,u,h){const m=(t!=null?t.length:1)*Math.max(n.length,l.length),p=m/(t!=null?t.length:1),x=[];for(let w=0;w<m;++w){const b=t?this.Ln(t[w/p]):Gf,E=this.kn(e,b,n[w%p],a),R=this.qn(e,b,l[w%p],u),k=h.map((U=>this.kn(e,b,U,!0)));x.push(...this.createRange(E,R,k))}return x}kn(e,t,n,a){const l=new Yo(e,Ne.empty(),t,n);return a?l:l.An()}qn(e,t,n,a){const l=new Yo(e,Ne.empty(),t,n);return a?l.An():l}xn(e,t){const n=new iT(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((l=>{let u=null;for(const h of l)n.yn(h)&&(!u||h.fields.length>u.fields.length)&&(u=h);return u}))}getIndexType(e,t){let n=2;const a=this.Mn(t);return W.forEach(a,(l=>this.xn(e,l).next((u=>{u?n!==0&&u.fields.length<(function(m){let p=new jt(Bt.comparator),x=!1;for(const w of m.filters)for(const b of w.getFlattenedFilters())b.field.isKeyField()||(b.op==="array-contains"||b.op==="array-contains-any"?x=!0:p=p.add(b.field));for(const w of m.orderBy)w.field.isKeyField()||(p=p.add(w.field));return p.size+(x?1:0)})(l)&&(n=1):n=0})))).next((()=>(function(u){return u.limit!==null})(t)&&a.length>1&&n===2?1:n))}Qn(e,t){const n=new pd;for(const a of Ho(e)){const l=t.data.field(a.fieldPath);if(l==null)return null;const u=n.Pn(a.kind);Qo.Kt.Dt(l,u)}return n.un()}Ln(e){const t=new pd;return Qo.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const n=new pd;return Qo.Kt.Dt(il(this.databaseId,t),n.Pn((function(l){const u=Ho(l);return u.length===0?0:u[u.length-1].kind})(e))),n.un()}Nn(e,t,n){if(n===null)return[];let a=[];a.push(new pd);let l=0;for(const u of Ho(e)){const h=n[l++];for(const m of a)if(this.Un(t,u.fieldPath)&&Jd(h))a=this.Kn(a,u,h);else{const p=m.Pn(u.kind);Qo.Kt.Dt(h,p)}}return this.Wn(a)}On(e,t,n){return this.Nn(e,t,n.position)}Wn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Kn(e,t,n){const a=[...e],l=[];for(const u of n.arrayValue.values||[])for(const h of a){const m=new pd;m.seed(h.un()),Qo.Kt.Dt(u,m.Pn(t.kind)),l.push(m)}return l}Un(e,t){return!!e.filters.find((n=>n instanceof ot&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=yd(e),a=pc(e);return(t?n.J(bx,IDBKeyRange.bound(t,t)):n.J()).next((l=>{const u=[];return W.forEach(l,(h=>a.get([h.indexId,this.uid]).next((m=>{u.push((function(x,w){const b=w?new Mc(w.sequenceNumber,new Js(dl(w.readTime),new Ne(oa(w.documentKey)),w.largestBatchId)):Mc.empty(),E=x.fields.map((([R,k])=>new Zo(Bt.fromServerFormat(R),k)));return new Pc(x.indexId,x.collectionGroup,E,b)})(h,m))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,a)=>{const l=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return l!==0?l:qe(n.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const a=yd(e),l=pc(e);return this.Gn(e).next((u=>a.J(bx,IDBKeyRange.bound(t,t)).next((h=>W.forEach(h,(m=>l.put(eT(m.indexId,this.uid,u,n))))))))}updateIndexEntries(e,t){const n=new Map;return W.forEach(t,((a,l)=>{const u=n.get(a.collectionGroup);return(u?W.resolve(u):this.getFieldIndexes(e,a.collectionGroup)).next((h=>(n.set(a.collectionGroup,h),W.forEach(h,(m=>this.zn(e,a,m).next((p=>{const x=this.jn(l,m);return p.isEqual(x)?W.resolve():this.Jn(e,l,m,p,x)})))))))}))}Hn(e,t,n,a){return gc(e).put(a.Rn(this.uid,this.$n(n,t.key),t.key))}Yn(e,t,n,a){return gc(e).delete(a.Vn(this.uid,this.$n(n,t.key),t.key))}zn(e,t,n){const a=gc(e);let l=new jt(ki);return a.ee({index:VS,range:IDBKeyRange.only([n.indexId,this.uid,hm(this.$n(n,t))])},((u,h)=>{l=l.add(new Yo(n.indexId,t,aT(h.arrayValue),aT(h.directionalValue)))})).next((()=>l))}jn(e,t){let n=new jt(ki);const a=this.Qn(t,e);if(a==null)return n;const l=xx(t);if(l!=null){const u=e.data.field(l.fieldPath);if(Jd(u))for(const h of u.arrayValue.values||[])n=n.add(new Yo(t.indexId,e.key,this.Ln(h),a))}else n=n.add(new Yo(t.indexId,e.key,Gf,a));return n}Jn(e,t,n,a,l){pe(lT,"Updating index entries for document '%s'",t.key);const u=[];return(function(m,p,x,w,b){const E=m.getIterator(),R=p.getIterator();let k=fc(E),U=fc(R);for(;k||U;){let z=!1,B=!1;if(k&&U){const q=x(k,U);q<0?B=!0:q>0&&(z=!0)}else k!=null?B=!0:z=!0;z?(w(U),U=fc(R)):B?(b(k),k=fc(E)):(k=fc(E),U=fc(R))}})(a,l,ki,(h=>{u.push(this.Hn(e,t,n,h))}),(h=>{u.push(this.Yn(e,t,n,h))})),W.waitFor(u)}Gn(e){let t=1;return pc(e).ee({index:OS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,a,l)=>{l.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((u,h)=>ki(u,h))).filter(((u,h,m)=>!h||ki(u,m[h-1])!==0));const a=[];a.push(e);for(const u of n){const h=ki(u,e),m=ki(u,t);if(h===0)a[0]=e.An();else if(h>0&&m<0)a.push(u),a.push(u.An());else if(m>0)break}a.push(t);const l=[];for(let u=0;u<a.length;u+=2){if(this.Zn(a[u],a[u+1]))return[];const h=a[u].Vn(this.uid,Gf,Ne.empty()),m=a[u+1].Vn(this.uid,Gf,Ne.empty());l.push(IDBKeyRange.bound(h,m))}return l}Zn(e,t){return ki(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(uT)}getMinOffset(e,t){return W.mapArray(this.Mn(t),(n=>this.xn(e,n).next((a=>a||Ae(44426))))).next(uT)}}function cT(s){return Rn(s,Qd)}function gc(s){return Rn(s,Md)}function yd(s){return Rn(s,gv)}function pc(s){return Rn(s,Pd)}function uT(s){ke(s.length!==0,28825);let e=s[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<s.length;n++){const a=s[n].indexState.offset;hv(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new Js(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},GA=41943040;class as{static withCacheSize(e){return new as(e,as.DEFAULT_COLLECTION_PERCENTILE,as.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(s,e,t){const n=s.store(Dr),a=s.store(Oc),l=[],u=IDBKeyRange.only(t.batchId);let h=0;const m=n.ee({range:u},((x,w,b)=>(h++,b.delete())));l.push(m.next((()=>{ke(h===1,47070,{batchId:t.batchId})})));const p=[];for(const x of t.mutations){const w=DS(e,x.key.path,t.batchId);l.push(a.delete(w)),p.push(x.key)}return W.waitFor(l).next((()=>p))}function Mm(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw Ae(14731);e=s.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */as.DEFAULT_COLLECTION_PERCENTILE=10,as.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,as.DEFAULT=new as(GA,as.DEFAULT_COLLECTION_PERCENTILE,as.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),as.DISABLED=new as(-1,0,0);class yg{constructor(e,t,n,a){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=a,this.Xn={}}static wt(e,t,n,a){ke(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new yg(l,t,n,a)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Di(e).ee({index:Wo,range:n},((a,l,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,n,a){const l=Nc(e),u=Di(e);return u.add({}).next((h=>{ke(typeof h=="number",49019);const m=new Ev(h,t,n,a),p=(function(E,R,k){const U=k.baseMutations.map((B=>th(E.yt,B))),z=k.mutations.map((B=>th(E.yt,B)));return{userId:R,batchId:k.batchId,localWriteTimeMs:k.localWriteTime.toMillis(),baseMutations:U,mutations:z}})(this.serializer,this.userId,m),x=[];let w=new jt(((b,E)=>qe(b.canonicalString(),E.canonicalString())));for(const b of a){const E=DS(this.userId,b.key.path,h);w=w.add(b.key.path.popLast()),x.push(u.put(p)),x.push(l.put(E,ID))}return w.forEach((b=>{x.push(this.indexManager.addToCollectionParentIndex(e,b))})),e.addOnCommittedListener((()=>{this.Xn[h]=m.keys()})),W.waitFor(x).next((()=>m))}))}lookupMutationBatch(e,t){return Di(e).get(t).next((n=>n?(ke(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),Ko(this.serializer,n)):null))}er(e,t){return this.Xn[t]?W.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const a=n.keys();return this.Xn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=IDBKeyRange.lowerBound([this.userId,n]);let l=null;return Di(e).ee({index:Wo,range:a},((u,h,m)=>{h.userId===this.userId&&(ke(h.batchId>=n,47524,{tr:n}),l=Ko(this.serializer,h)),m.done()})).next((()=>l))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Qi;return Di(e).ee({index:Wo,range:t,reverse:!0},((a,l,u)=>{n=l.batchId,u.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Qi],[this.userId,Number.POSITIVE_INFINITY]);return Di(e).J(Wo,t).next((n=>n.map((a=>Ko(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=am(this.userId,t.path),a=IDBKeyRange.lowerBound(n),l=[];return Nc(e).ee({range:a},((u,h,m)=>{const[p,x,w]=u,b=oa(x);if(p===this.userId&&t.path.isEqual(b))return Di(e).get(w).next((E=>{if(!E)throw Ae(61480,{nr:u,batchId:w});ke(E.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:E.userId,batchId:w}),l.push(Ko(this.serializer,E))}));m.done()})).next((()=>l))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new jt(qe);const a=[];return t.forEach((l=>{const u=am(this.userId,l.path),h=IDBKeyRange.lowerBound(u),m=Nc(e).ee({range:h},((p,x,w)=>{const[b,E,R]=p,k=oa(E);b===this.userId&&l.path.isEqual(k)?n=n.add(R):w.done()}));a.push(m)})),W.waitFor(a).next((()=>this.rr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1,l=am(this.userId,n),u=IDBKeyRange.lowerBound(l);let h=new jt(qe);return Nc(e).ee({range:u},((m,p,x)=>{const[w,b,E]=m,R=oa(b);w===this.userId&&n.isPrefixOf(R)?R.length===a&&(h=h.add(E)):x.done()})).next((()=>this.rr(e,h)))}rr(e,t){const n=[],a=[];return t.forEach((l=>{a.push(Di(e).get(l).next((u=>{if(u===null)throw Ae(35274,{batchId:l});ke(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:l}),n.push(Ko(this.serializer,u))})))})),W.waitFor(a).next((()=>n))}removeMutationBatch(e,t){return $A(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),W.forEach(n,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return W.resolve();const n=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),a=[];return Nc(e).ee({range:n},((l,u,h)=>{if(l[0]===this.userId){const m=oa(l[1]);a.push(m)}else h.done()})).next((()=>{ke(a.length===0,56720,{sr:a.map((l=>l.canonicalString()))})}))}))}containsKey(e,t){return KA(e,this.userId,t)}_r(e){return QA(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Qi,lastStreamToken:""}))}}function KA(s,e,t){const n=am(e,t.path),a=n[1],l=IDBKeyRange.lowerBound(n);let u=!1;return Nc(s).ee({range:l,X:!0},((h,m,p)=>{const[x,w,b]=h;x===e&&w===a&&(u=!0),p.done()})).next((()=>u))}function Di(s){return Rn(s,Dr)}function Nc(s){return Rn(s,Oc)}function QA(s){return Rn(s,$d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new hl(0)}static cr(){return new hl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const n=new hl(t.highestTargetId);return t.highestTargetId=n.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Oe.fromTimestamp(new wt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.lr(e).next((a=>(a.highestListenSequenceNumber=t,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.hr(e,a))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((n=>(n.targetCount+=1,this.Tr(t,n),this.hr(e,n))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>yc(e).delete(t.targetId))).next((()=>this.lr(e))).next((n=>(ke(n.targetCount>0,8065),n.targetCount-=1,this.hr(e,n))))}removeTargets(e,t,n){let a=0;const l=[];return yc(e).ee(((u,h)=>{const m=jd(h);m.sequenceNumber<=t&&n.get(m.targetId)===null&&(a++,l.push(this.removeTargetData(e,m)))})).next((()=>W.waitFor(l))).next((()=>a))}forEachTarget(e,t){return yc(e).ee(((n,a)=>{const l=jd(a);t(l)}))}lr(e){return hT(e).get(Im).next((t=>(ke(t!==null,2888),t)))}hr(e,t){return hT(e).put(Im,t)}Pr(e,t){return yc(e).put(qA(this.serializer,t))}Tr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const n=ol(t),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let l=null;return yc(e).ee({range:a,index:MS},((u,h,m)=>{const p=jd(h);hh(t,p.target)&&(l=p,m.done())})).next((()=>l))}addMatchingKeys(e,t,n){const a=[],l=Fi(e);return t.forEach((u=>{const h=ls(u.path);a.push(l.put({targetId:n,path:h})),a.push(this.referenceDelegate.addReference(e,n,u))})),W.waitFor(a)}removeMatchingKeys(e,t,n){const a=Fi(e);return W.forEach(t,(l=>{const u=ls(l.path);return W.waitFor([a.delete([n,u]),this.referenceDelegate.removeReference(e,n,l)])}))}removeMatchingKeysForTargetId(e,t){const n=Fi(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),a=Fi(e);let l=Xe();return a.ee({range:n,X:!0},((u,h,m)=>{const p=oa(u[1]),x=new Ne(p);l=l.add(x)})).next((()=>l))}containsKey(e,t){const n=ls(t.path),a=IDBKeyRange.bound([n],[NS(n)],!1,!0);let l=0;return Fi(e).ee({index:mv,X:!0,range:a},(([u,h],m,p)=>{u!==0&&(l++,p.done())})).next((()=>l>0))}At(e,t){return yc(e).get(t).next((n=>n?jd(n):null))}}function yc(s){return Rn(s,Vc)}function hT(s){return Rn(s,el)}function Fi(s){return Rn(s,Lc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT="LruGarbageCollector",YA=1048576;function mT([s,e],[t,n]){const a=qe(s,t);return a===0?qe(e,n):a}class X4{constructor(e){this.Ir=e,this.buffer=new jt(mT),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();mT(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class XA{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(fT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ao(t)?pe(fT,"Ignoring IndexedDB error during garbage collection: ",t):await ro(t)}await this.Vr(3e5)}))}}class W4{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return W.resolve(Ns.ce);const n=new X4(t);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(dT)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),dT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,a,l,u,h,m,p;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),a=this.params.maximumSequenceNumbersToCollect):a=w,u=Date.now(),this.nthSequenceNumber(e,a)))).next((w=>(n=w,h=Date.now(),this.removeTargets(e,n,t)))).next((w=>(l=w,m=Date.now(),this.removeOrphanedDocuments(e,n)))).next((w=>(p=Date.now(),bc()<=it.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-x}ms
	Determined least recently used ${a} in `+(h-u)+`ms
	Removed ${l} targets in `+(m-h)+`ms
	Removed ${w} documents in `+(p-m)+`ms
Total Duration: ${p-x}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:w}))))}}function WA(s,e){return new W4(s,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,t){this.db=e,this.garbageCollector=WA(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((a=>n+a))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((n,a)=>t(a)))}addReference(e,t,n){return $f(e,n)}removeReference(e,t,n){return $f(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return $f(e,t)}br(e,t){return(function(a,l){let u=!1;return QA(a).te((h=>KA(a,h,l).next((m=>(m&&(u=!0),W.resolve(!m)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let l=0;return this.Sr(e,((u,h)=>{if(h<=t){const m=this.br(e,u).next((p=>{if(!p)return l++,n.getEntry(e,u).next((()=>(n.removeEntry(u,Oe.min()),Fi(e).delete((function(w){return[0,ls(w.path)]})(u)))))}));a.push(m)}})).next((()=>W.waitFor(a))).next((()=>n.apply(e))).next((()=>l))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return $f(e,t)}Sr(e,t){const n=Fi(e);let a,l=Ns.ce;return n.ee({index:mv},(([u,h],{path:m,sequenceNumber:p})=>{u===0?(l!==Ns.ce&&t(new Ne(oa(a)),l),l=p,a=m):l=Ns.ce})).next((()=>{l!==Ns.ce&&t(new Ne(oa(a)),l)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function $f(s,e){return Fi(s).put((function(n,a){return{targetId:0,path:ls(n.path),sequenceNumber:a}})(e,s.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(){this.changes=new ti((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ut.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?W.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return qo(e).put(n)}removeEntry(e,t,n){return qo(e).delete((function(l,u){const h=l.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],Dm(u),h[h.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.Dr(e,n))))}getEntry(e,t){let n=Ut.newInvalidDocument(t);return qo(e).ee({index:im,range:IDBKeyRange.only(xd(t))},((a,l)=>{n=this.Cr(t,l)})).next((()=>n))}vr(e,t){let n={size:0,document:Ut.newInvalidDocument(t)};return qo(e).ee({index:im,range:IDBKeyRange.only(xd(t))},((a,l)=>{n={document:this.Cr(t,l),size:Mm(l)}})).next((()=>n))}getEntries(e,t){let n=Es();return this.Fr(e,t,((a,l)=>{const u=this.Cr(a,l);n=n.insert(a,u)})).next((()=>n))}Mr(e,t){let n=Es(),a=new Ft(Ne.comparator);return this.Fr(e,t,((l,u)=>{const h=this.Cr(l,u);n=n.insert(l,h),a=a.insert(l,Mm(u))})).next((()=>({documents:n,Or:a})))}Fr(e,t,n){if(t.isEmpty())return W.resolve();let a=new jt(yT);t.forEach((m=>a=a.add(m)));const l=IDBKeyRange.bound(xd(a.first()),xd(a.last())),u=a.getIterator();let h=u.getNext();return qo(e).ee({index:im,range:l},((m,p,x)=>{const w=Ne.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;h&&yT(h,w)<0;)n(h,null),h=u.getNext();h&&h.isEqual(w)&&(n(h,p),h=u.hasNext()?u.getNext():null),h?x.j(xd(h)):x.done()})).next((()=>{for(;h;)n(h,null),h=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,n,a,l){const u=t.path,h=[u.popLast().toArray(),u.lastSegment(),Dm(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],m=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return qo(e).J(IDBKeyRange.bound(h,m,!0)).next((p=>{l?.incrementDocumentReadCount(p.length);let x=Es();for(const w of p){const b=this.Cr(Ne.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);b.isFoundDocument()&&(mh(t,b)||a.has(b.key))&&(x=x.insert(b.key,b))}return x}))}getAllFromCollectionGroup(e,t,n,a){let l=Es();const u=pT(t,n),h=pT(t,Js.max());return qo(e).ee({index:PS,range:IDBKeyRange.bound(u,h,!0)},((m,p,x)=>{const w=this.Cr(Ne.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);l=l.insert(w.key,w),l.size===a&&x.done()})).next((()=>l))}newChangeBuffer(e){return new eP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return gT(e).get(vx).next((t=>(ke(!!t,20021),t)))}Dr(e,t){return gT(e).put(vx,t)}Cr(e,t){if(t){const n=F4(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(Oe.min())))return n}return Ut.newInvalidDocument(e)}}function ZA(s){return new Z4(s)}class eP extends JA{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ti((n=>n.toString()),((n,a)=>n.isEqual(a)))}applyChanges(e){const t=[];let n=0,a=new jt(((l,u)=>qe(l.canonicalString(),u.canonicalString())));return this.changes.forEach(((l,u)=>{const h=this.Br.get(l);if(t.push(this.Nr.removeEntry(e,l,h.readTime)),u.isValidDocument()){const m=JN(this.Nr.serializer,u);a=a.add(l.path.popLast());const p=Mm(m);n+=p-h.size,t.push(this.Nr.addEntry(e,l,m))}else if(n-=h.size,this.trackRemovals){const m=JN(this.Nr.serializer,u.convertToNoDocument(Oe.min()));t.push(this.Nr.addEntry(e,l,m))}})),a.forEach((l=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,l))})),t.push(this.Nr.updateMetadata(e,n)),W.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((n=>(this.Br.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:n,Or:a})=>(a.forEach(((l,u)=>{this.Br.set(l,{size:u,readTime:n.get(l).readTime})})),n)))}}function gT(s){return Rn(s,Kd)}function qo(s){return Rn(s,jm)}function xd(s){const e=s.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function pT(s,e){const t=e.documentKey.path.toArray();return[s,Dm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function yT(s,e){const t=s.path.toArray(),n=e.path.toArray();let a=0;for(let l=0;l<t.length-2&&l<n.length-2;++l)if(a=qe(t[l],n[l]),a)return a;return a=qe(t.length,n.length),a||(a=qe(t[t.length-2],n[n.length-2]),a||qe(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(e,t,n,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(n!==null&&Ld(n.mutation,a,Ts.empty(),wt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,Xe()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=Xe()){const a=la();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,n).next((l=>{let u=Sd();return l.forEach(((h,m)=>{u=u.insert(h,m.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const n=la();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Xe())))}populateOverlays(e,t,n){const a=[];return n.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,h)=>{t.set(u,h)}))}))}computeViews(e,t,n,a){let l=Es();const u=Vd(),h=(function(){return Vd()})();return t.forEach(((m,p)=>{const x=n.get(p.key);a.has(p.key)&&(x===void 0||x.mutation instanceof ni)?l=l.insert(p.key,p):x!==void 0?(u.set(p.key,x.mutation.getFieldMask()),Ld(x.mutation,p,x.mutation.getFieldMask(),wt.now())):u.set(p.key,Ts.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((p,x)=>u.set(p,x))),t.forEach(((p,x)=>h.set(p,new tP(x,u.get(p)??null)))),h)))}recalculateAndSaveOverlays(e,t){const n=Vd();let a=new Ft(((u,h)=>u-h)),l=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const h of u)h.keys().forEach((m=>{const p=t.get(m);if(p===null)return;let x=n.get(m)||Ts.empty();x=h.applyToLocalView(p,x),n.set(m,x);const w=(a.get(h.batchId)||Xe()).add(m);a=a.insert(h.batchId,w)}))})).next((()=>{const u=[],h=a.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),p=m.key,x=m.value,w=gA();x.forEach((b=>{if(!l.has(b)){const E=_A(t.get(b),n.get(b));E!==null&&w.set(b,E),l=l.add(b)}})),u.push(this.documentOverlayCache.saveOverlays(e,p,w))}return W.waitFor(u)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,a){return(function(u){return Ne.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):wv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,a):this.getDocumentsMatchingCollectionQuery(e,t,n,a)}getNextDocuments(e,t,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,a-l.size):W.resolve(la());let h=Dc,m=l;return u.next((p=>W.forEach(p,((x,w)=>(h<w.largestBatchId&&(h=w.largestBatchId),l.get(x)?W.resolve():this.remoteDocumentCache.getEntry(e,x).next((b=>{m=m.insert(x,b)}))))).next((()=>this.populateOverlays(e,p,l))).next((()=>this.computeViews(e,m,p,Xe()))).next((x=>({batchId:h,changes:mA(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ne(t)).next((n=>{let a=Sd();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,a){const l=t.collectionGroup;let u=Sd();return this.indexManager.getCollectionParents(e,l).next((h=>W.forEach(h,(m=>{const p=(function(w,b){return new ei(b,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,p,n,a).next((x=>{x.forEach(((w,b)=>{u=u.insert(w,b)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,n,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,l,a)))).next((u=>{l.forEach(((m,p)=>{const x=p.getKey();u.get(x)===null&&(u=u.insert(x,Ut.newInvalidDocument(x)))}));let h=Sd();return u.forEach(((m,p)=>{const x=l.get(m);x!==void 0&&Ld(x.mutation,p,Ts.empty(),wt.now()),mh(t,p)&&(h=h.insert(m,p))})),h}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return W.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:hn(a.createTime)}})(t)),W.resolve()}getNamedQuery(e,t){return W.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(a){return{name:a.name,query:gg(a.bundledQuery),readTime:hn(a.readTime)}})(t)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(){this.overlays=new Ft(Ne.comparator),this.qr=new Map}getOverlay(e,t){return W.resolve(this.overlays.get(t))}getOverlays(e,t){const n=la();return W.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&n.set(a,l)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((a,l)=>{this.St(e,t,l)})),W.resolve()}removeOverlaysForBatchId(e,t,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(n)),W.resolve()}getOverlaysForCollection(e,t,n){const a=la(),l=t.length+1,u=new Ne(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const m=h.getNext().value,p=m.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===l&&m.largestBatchId>n&&a.set(m.getKey(),m)}return W.resolve(a)}getOverlaysForCollectionGroup(e,t,n,a){let l=new Ft(((p,x)=>p-x));const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>n){let x=l.get(p.largestBatchId);x===null&&(x=la(),l=l.insert(p.largestBatchId,x)),x.set(p.getKey(),p)}}const h=la(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((p,x)=>h.set(p,x))),!(h.size()>=a)););return W.resolve(h)}St(e,t,n){const a=this.overlays.get(n.key);if(a!==null){const u=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(n.key,new Av(t,n));let l=this.qr.get(t);l===void 0&&(l=Xe(),this.qr.set(t,l)),this.qr.set(t,l.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(){this.sessionToken=en.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(){this.Qr=new jt(qn.$r),this.Ur=new jt(qn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new qn(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Gr(new qn(e,t))}zr(e,t){e.forEach((n=>this.removeReference(n,t)))}jr(e){const t=new Ne(new tt([])),n=new qn(t,e),a=new qn(t,e+1),l=[];return this.Ur.forEachInRange([n,a],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ne(new tt([])),n=new qn(t,e),a=new qn(t,e+1);let l=Xe();return this.Ur.forEachInRange([n,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new qn(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class qn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ne.comparator(e.key,t.key)||qe(e.Yr,t.Yr)}static Kr(e,t){return qe(e.Yr,t.Yr)||Ne.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new jt(qn.$r)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new Ev(l,t,n,a);this.mutationQueue.push(u);for(const h of a)this.Zr=this.Zr.add(new qn(h.key,l)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return W.resolve(u)}lookupMutationBatch(e,t){return W.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=this.ei(n),l=a<0?0:a;return W.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?Qi:this.tr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new qn(t,0),a=new qn(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([n,a],(u=>{const h=this.Xr(u.Yr);l.push(h)})),W.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new jt(qe);return t.forEach((a=>{const l=new qn(a,0),u=new qn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(h=>{n=n.add(h.Yr)}))})),W.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1;let l=n;Ne.isDocumentKey(l)||(l=l.child(""));const u=new qn(new Ne(l),0);let h=new jt(qe);return this.Zr.forEachWhile((m=>{const p=m.key.path;return!!n.isPrefixOf(p)&&(p.length===a&&(h=h.add(m.Yr)),!0)}),u),W.resolve(this.ti(h))}ti(e){const t=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){ke(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return W.forEach(t.mutations,(a=>{const l=new qn(a.key,t.batchId);return n=n.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new qn(t,0),a=this.Zr.firstAfterOrEqual(n);return W.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e){this.ri=e,this.docs=(function(){return new Ft(Ne.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,a=this.docs.get(n),l=a?a.size:0,u=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return W.resolve(n?n.document.mutableCopy():Ut.newInvalidDocument(t))}getEntries(e,t){let n=Es();return t.forEach((a=>{const l=this.docs.get(a);n=n.insert(a,l?l.document.mutableCopy():Ut.newInvalidDocument(a))})),W.resolve(n)}getDocumentsMatchingQuery(e,t,n,a){let l=Es();const u=t.path,h=new Ne(u.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(h);for(;m.hasNext();){const{key:p,value:{document:x}}=m.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||hv(jS(x),n)<=0||(a.has(x.key)||mh(t,x))&&(l=l.insert(x.key,x.mutableCopy()))}return W.resolve(l)}getAllFromCollectionGroup(e,t,n,a){Ae(9500)}ii(e,t){return W.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new oP(this)}getSize(e){return W.resolve(this.size)}}class oP extends JA{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),W.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e){this.persistence=e,this.si=new ti((t=>ol(t)),hh),this.lastRemoteSnapshotVersion=Oe.min(),this.highestTargetId=0,this.oi=0,this._i=new kv,this.targetCount=0,this.ai=hl.ur()}forEachTarget(e,t){return this.si.forEach(((n,a)=>t(a))),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),W.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new hl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,W.resolve()}updateTargetData(e,t){return this.Pr(t),W.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,t,n){let a=0;const l=[];return this.si.forEach(((u,h)=>{h.sequenceNumber<=t&&n.get(h.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,h.targetId)),a++)})),W.waitFor(l).next((()=>a))}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return W.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),W.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),W.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),W.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return W.resolve(n)}containsKey(e,t){return W.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ns(0),this.li=!1,this.li=!0,this.hi=new rP,this.referenceDelegate=e(this),this.Pi=new lP(this),this.indexManager=new K4,this.remoteDocumentCache=(function(a){return new iP(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new BA(t),this.Ii=new nP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new sP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new aP(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){pe("MemoryPersistence","Starting transaction:",e);const a=new cP(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,t){return W.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class cP extends CS{constructor(e){super(),this.currentSequenceNumber=e}}class xg{constructor(e){this.persistence=e,this.Ri=new kv,this.Vi=null}static mi(e){return new xg(e)}get fi(){if(this.Vi)return this.Vi;throw Ae(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),W.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),W.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),W.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.fi,(n=>{const a=Ne.fromPath(n);return this.gi(e,a).next((l=>{l||t.removeEntry(a,Oe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return W.or([()=>W.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Om{constructor(e,t){this.persistence=e,this.pi=new ti((n=>ls(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=WA(this,t)}static mi(e,t){return new Om(e,t)}Ei(){}di(e){return W.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((a=>n+a))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}pr(e,t){return W.forEach(this.pi,((n,a)=>this.br(e,n,a).next((l=>l?W.resolve():t(a)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(u=>this.br(e,u,t).next((h=>{h||(n++,l.removeEntry(u,Oe.min()))})))).next((()=>l.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),W.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),W.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),W.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),W.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=lm(e.data.value)),t}br(e,t,n){return W.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.pi.get(t);return W.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e){this.serializer=e}k(e,t,n,a){const l=new rg("createOrUpgrade",t);n<1&&a>=1&&((function(m){m.createObjectStore(dh)})(e),(function(m){m.createObjectStore($d,{keyPath:jD}),m.createObjectStore(Dr,{keyPath:jN,autoIncrement:!0}).createIndex(Wo,IN,{unique:!0}),m.createObjectStore(Oc)})(e),xT(e),(function(m){m.createObjectStore(Go)})(e));let u=W.resolve();return n<3&&a>=3&&(n!==0&&((function(m){m.deleteObjectStore(Lc),m.deleteObjectStore(Vc),m.deleteObjectStore(el)})(e),xT(e)),u=u.next((()=>(function(m){const p=m.store(el),x={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Oe.min().toTimestamp(),targetCount:0};return p.put(Im,x)})(l)))),n<4&&a>=4&&(n!==0&&(u=u.next((()=>(function(m,p){return p.store(Dr).J().next((w=>{m.deleteObjectStore(Dr),m.createObjectStore(Dr,{keyPath:jN,autoIncrement:!0}).createIndex(Wo,IN,{unique:!0});const b=p.store(Dr),E=w.map((R=>b.put(R)));return W.waitFor(E)}))})(e,l)))),u=u.next((()=>{(function(m){m.createObjectStore(Fc,{keyPath:VD})})(e)}))),n<5&&a>=5&&(u=u.next((()=>this.yi(l)))),n<6&&a>=6&&(u=u.next((()=>((function(m){m.createObjectStore(Kd)})(e),this.wi(l))))),n<7&&a>=7&&(u=u.next((()=>this.Si(l)))),n<8&&a>=8&&(u=u.next((()=>this.bi(e,l)))),n<9&&a>=9&&(u=u.next((()=>{(function(m){m.objectStoreNames.contains("remoteDocumentChanges")&&m.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&a>=10&&(u=u.next((()=>this.Di(l)))),n<11&&a>=11&&(u=u.next((()=>{(function(m){m.createObjectStore(ag,{keyPath:LD})})(e),(function(m){m.createObjectStore(ig,{keyPath:FD})})(e)}))),n<12&&a>=12&&(u=u.next((()=>{(function(m){const p=m.createObjectStore(og,{keyPath:$D});p.createIndex(wx,KD,{unique:!1}),p.createIndex(LS,QD,{unique:!1})})(e)}))),n<13&&a>=13&&(u=u.next((()=>(function(m){const p=m.createObjectStore(jm,{keyPath:CD});p.createIndex(im,RD),p.createIndex(PS,kD)})(e))).next((()=>this.Ci(e,l))).next((()=>e.deleteObjectStore(Go)))),n<14&&a>=14&&(u=u.next((()=>this.Fi(e,l)))),n<15&&a>=15&&(u=u.next((()=>(function(m){m.createObjectStore(gv,{keyPath:UD,autoIncrement:!0}).createIndex(bx,BD,{unique:!1}),m.createObjectStore(Pd,{keyPath:qD}).createIndex(OS,zD,{unique:!1}),m.createObjectStore(Md,{keyPath:HD}).createIndex(VS,GD,{unique:!1})})(e)))),n<16&&a>=16&&(u=u.next((()=>{t.objectStore(Pd).clear()})).next((()=>{t.objectStore(Md).clear()}))),n<17&&a>=17&&(u=u.next((()=>{(function(m){m.createObjectStore(pv,{keyPath:YD})})(e)}))),n<18&&a>=18&&SE()&&(u=u.next((()=>{t.objectStore(Pd).clear()})).next((()=>{t.objectStore(Md).clear()}))),u}wi(e){let t=0;return e.store(Go).ee(((n,a)=>{t+=Mm(a)})).next((()=>{const n={byteSize:t};return e.store(Kd).put(vx,n)}))}yi(e){const t=e.store($d),n=e.store(Dr);return t.J().next((a=>W.forEach(a,(l=>{const u=IDBKeyRange.bound([l.userId,Qi],[l.userId,l.lastAcknowledgedBatchId]);return n.J(Wo,u).next((h=>W.forEach(h,(m=>{ke(m.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:m.batchId});const p=Ko(this.serializer,m);return $A(e,l.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(Lc),n=e.store(Go);return e.store(el).get(Im).next((a=>{const l=[];return n.ee(((u,h)=>{const m=new tt(u),p=(function(w){return[0,ls(w)]})(m);l.push(t.get(p).next((x=>x?W.resolve():(w=>t.put({targetId:0,path:ls(w),sequenceNumber:a.highestListenSequenceNumber}))(m))))})).next((()=>W.waitFor(l)))}))}bi(e,t){e.createObjectStore(Qd,{keyPath:OD});const n=t.store(Qd),a=new Rv,l=u=>{if(a.add(u)){const h=u.lastSegment(),m=u.popLast();return n.put({collectionId:h,parent:ls(m)})}};return t.store(Go).ee({X:!0},((u,h)=>{const m=new tt(u);return l(m.popLast())})).next((()=>t.store(Oc).ee({X:!0},(([u,h,m],p)=>{const x=oa(h);return l(x.popLast())}))))}Di(e){const t=e.store(Vc);return t.ee(((n,a)=>{const l=jd(a),u=qA(this.serializer,l);return t.put(u)}))}Ci(e,t){const n=t.store(Go),a=[];return n.ee(((l,u)=>{const h=t.store(jm),m=(function(w){return w.document?new Ne(tt.fromString(w.document.name).popFirst(5)):w.noDocument?Ne.fromSegments(w.noDocument.path):w.unknownDocument?Ne.fromSegments(w.unknownDocument.path):Ae(36783)})(u).path.toArray(),p={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};a.push(h.put(p))})).next((()=>W.waitFor(a)))}Fi(e,t){const n=t.store(Dr),a=ZA(this.serializer),l=new Dv(xg.mi,this.serializer.yt);return n.J().next((u=>{const h=new Map;return u.forEach((m=>{let p=h.get(m.userId)??Xe();Ko(this.serializer,m).keys().forEach((x=>p=p.add(x))),h.set(m.userId,p)})),W.forEach(h,((m,p)=>{const x=new zn(p),w=pg.wt(this.serializer,x),b=l.getIndexManager(x),E=yg.wt(x,this.serializer,b,l.referenceDelegate);return new ej(a,E,w,b).recalculateAndSaveOverlaysForDocumentKeys(new _x(t,Ns.ce),m).next()}))}))}}function xT(s){s.createObjectStore(Lc,{keyPath:PD}).createIndex(mv,MD,{unique:!0}),s.createObjectStore(Vc,{keyPath:"targetId"}).createIndex(MS,DD,{unique:!0}),s.createObjectStore(el)}const Pi="IndexedDbPersistence",Hy=18e5,Gy=5e3,$y="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",tj="main";class Pv{constructor(e,t,n,a,l,u,h,m,p,x,w=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Mi=l,this.window=u,this.document=h,this.xi=p,this.Oi=x,this.Ni=w,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=b=>Promise.resolve(),!Pv.v())throw new he(re.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new J4(this,a),this.$i=t+tj,this.serializer=new BA(m),this.Ui=new ua(this.$i,this.Ni,new uP(this.serializer)),this.hi=new B4,this.Pi=new Y4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ZA(this.serializer),this.Ii=new U4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,x===!1&&dn(Pi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new he(re.FAILED_PRECONDITION,$y);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Ns(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Kf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(ao(e))return pe(Pi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return pe(Pi,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return vd(e).get(hc).next((t=>W.resolve(this.es(t))))}ts(e){return Kf(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Hy)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=Rn(t,Fc);return n.J().next((a=>{const l=this.ss(a,Hy),u=a.filter((h=>l.indexOf(h)===-1));return W.forEach(u,(h=>n.delete(h.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?W.resolve(!0):vd(e).get(hc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Gy)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new he(re.FAILED_PRECONDITION,$y);return!1}}return!(!this.networkEnabled||!this.inForeground)||Kf(e).J().next((n=>this.ss(n,Gy).find((a=>{if(this.clientId!==a.clientId){const l=!this.networkEnabled&&a.networkEnabled,u=!this.inForeground&&a.inForeground,h=this.networkEnabled===a.networkEnabled;if(l||u&&h)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&pe(Pi,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[dh,Fc],(e=>{const t=new _x(e,Ns.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((n=>this.rs(n.updateTimeMs,t)&&!this.us(n.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Kf(e).J().next((t=>this.ss(t,Hy).map((n=>n.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return yg.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Q4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return pg.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,n){pe(Pi,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",l=(function(m){return m===18?JD:m===17?qS:m===16?WD:m===15?yv:m===14?BS:m===13?US:m===12?XD:m===11?FS:void Ae(60245)})(this.Ni);let u;return this.Ui.runTransaction(e,a,l,(h=>(u=new _x(h,this.ci?this.ci.next():Ns.ce),t==="readwrite-primary"?this.Hi(u).next((m=>!!m||this.Yi(u))).next((m=>{if(!m)throw dn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new he(re.FAILED_PRECONDITION,IS);return n(u)})).next((m=>this.Xi(u).next((()=>m)))):this.Is(u).next((()=>n(u)))))).then((h=>(u.raiseOnCommittedEvent(),h)))}Is(e){return vd(e).get(hc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Gy)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new he(re.FAILED_PRECONDITION,$y)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vd(e).put(hc,t)}static v(){return ua.v()}Zi(e){const t=vd(e);return t.get(hc).next((n=>this.es(n)?(pe(Pi,"Releasing primary lease."),t.delete(hc)):W.resolve()))}rs(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(dn(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;EE()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return pe(Pi,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return dn(Pi,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){dn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function vd(s){return Rn(s,dh)}function Kf(s){return Rn(s,Fc)}function Mv(s,e){let t=s.projectId;return s.isDefaultDatabase||(t+="."+s.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(e,t,n,a){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=a}static As(e,t){let n=Xe(),a=Xe();for(const l of t.docChanges)switch(l.type){case 0:n=n.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Ov(e,t.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return EE()?8:RS(In())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,a){const l={result:null};return this.ys(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,t,a,n).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new dP;return this.Ss(e,t,u).next((h=>{if(l.result=h,this.Vs)return this.bs(e,t,u,h.size)}))})).next((()=>l.result))}bs(e,t,n,a){return n.documentReadCount<this.fs?(bc()<=it.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",wc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),W.resolve()):(bc()<=it.DEBUG&&pe("QueryEngine","Query:",wc(t),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(bc()<=it.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",wc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,cs(t))):W.resolve())}ys(e,t){if(qN(t))return W.resolve(null);let n=cs(t);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=km(t,null,"F"),n=cs(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((l=>{const u=Xe(...l);return this.ps.getDocuments(e,u).next((h=>this.indexManager.getMinOffset(e,n).next((m=>{const p=this.Ds(t,h);return this.Cs(t,p,u,m.readTime)?this.ys(e,km(t,null,"F")):this.vs(e,p,t,m)}))))})))))}ws(e,t,n,a){return qN(t)||a.isEqual(Oe.min())?W.resolve(null):this.ps.getDocuments(e,n).next((l=>{const u=this.Ds(t,l);return this.Cs(t,u,n,a)?W.resolve(null):(bc()<=it.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),wc(t)),this.vs(e,u,t,AS(a,Dc)).next((h=>h)))}))}Ds(e,t){let n=new jt(hA(e));return t.forEach(((a,l)=>{mh(e,l)&&(n=n.add(l))})),n}Cs(e,t,n,a){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,t,n){return bc()<=it.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",wc(t)),this.ps.getDocumentsMatchingQuery(e,t,Js.min(),n)}vs(e,t,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv="LocalStore",hP=3e8;class fP{constructor(e,t,n,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new Ft(qe),this.xs=new ti((l=>ol(l)),hh),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ej(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function sj(s,e,t,n){return new fP(s,e,t,n)}async function rj(s,e){const t=Te(s);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return t.mutationQueue.getAllMutationBatches(n).next((l=>(a=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(n)))).next((l=>{const u=[],h=[];let m=Xe();for(const p of a){u.push(p.batchId);for(const x of p.mutations)m=m.add(x.key)}for(const p of l){h.push(p.batchId);for(const x of p.mutations)m=m.add(x.key)}return t.localDocuments.getDocuments(n,m).next((p=>({Ls:p,removedBatchIds:u,addedBatchIds:h})))}))}))}function mP(s,e){const t=Te(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,m,p,x){const w=p.batch,b=w.keys();let E=W.resolve();return b.forEach((R=>{E=E.next((()=>x.getEntry(m,R))).next((k=>{const U=p.docVersions.get(R);ke(U!==null,48541),k.version.compareTo(U)<0&&(w.applyToRemoteDocument(k,p),k.isValidDocument()&&(k.setReadTime(p.commitVersion),x.addEntry(k)))}))})),E.next((()=>h.mutationQueue.removeMutationBatch(m,w)))})(t,n,e,l).next((()=>l.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(h){let m=Xe();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(m=m.add(h.batch.mutations[p].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(n,a)))}))}function aj(s){const e=Te(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function gP(s,e){const t=Te(s),n=e.snapshotVersion;let a=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});a=t.Ms;const h=[];e.targetChanges.forEach(((x,w)=>{const b=a.get(w);if(!b)return;h.push(t.Pi.removeMatchingKeys(l,x.removedDocuments,w).next((()=>t.Pi.addMatchingKeys(l,x.addedDocuments,w))));let E=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(w)!==null?E=E.withResumeToken(en.EMPTY_BYTE_STRING,Oe.min()).withLastLimboFreeSnapshotVersion(Oe.min()):x.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(x.resumeToken,n)),a=a.insert(w,E),(function(k,U,z){return k.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=hP?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0})(b,E,x)&&h.push(t.Pi.updateTargetData(l,E))}));let m=Es(),p=Xe();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(l,x))})),h.push(ij(l,u,e.documentUpdates).next((x=>{m=x.ks,p=x.qs}))),!n.isEqual(Oe.min())){const x=t.Pi.getLastRemoteSnapshotVersion(l).next((w=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,n)));h.push(x)}return W.waitFor(h).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,p))).next((()=>m))})).then((l=>(t.Ms=a,l)))}function ij(s,e,t){let n=Xe(),a=Xe();return t.forEach((l=>n=n.add(l))),e.getEntries(s,n).next((l=>{let u=Es();return t.forEach(((h,m)=>{const p=l.get(h);m.isFoundDocument()!==p.isFoundDocument()&&(a=a.add(h)),m.isNoDocument()&&m.version.isEqual(Oe.min())?(e.removeEntry(h,m.readTime),u=u.insert(h,m)):!p.isValidDocument()||m.version.compareTo(p.version)>0||m.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(m),u=u.insert(h,m)):pe(Vv,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",m.version)})),{ks:u,qs:a}}))}function pP(s,e){const t=Te(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Qi),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function $c(s,e){const t=Te(s);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return t.Pi.getTargetData(n,e).next((l=>l?(a=l,W.resolve(a)):t.Pi.allocateTargetId(n).next((u=>(a=new qa(e,u,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=t.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n}))}async function Kc(s,e,t){const n=Te(s),a=n.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",l,(u=>n.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!ao(u))throw u;pe(Vv,`Failed to update sequence numbers for target ${e}: ${u}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function Vm(s,e,t){const n=Te(s);let a=Oe.min(),l=Xe();return n.persistence.runTransaction("Execute query","readwrite",(u=>(function(m,p,x){const w=Te(m),b=w.xs.get(x);return b!==void 0?W.resolve(w.Ms.get(b)):w.Pi.getTargetData(p,x)})(n,u,cs(e)).next((h=>{if(h)return a=h.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(u,h.targetId).next((m=>{l=m}))})).next((()=>n.Fs.getDocumentsMatchingQuery(u,e,t?a:Oe.min(),t?l:Xe()))).next((h=>(cj(n,dA(e),h),{documents:h,Qs:l})))))}function oj(s,e){const t=Te(s),n=Te(t.Pi),a=t.Ms.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(l=>n.At(l,e).next((u=>u?u.target:null))))}function lj(s,e){const t=Te(s),n=t.Os.get(e)||Oe.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.Ns.getAllFromCollectionGroup(a,e,AS(n,Dc),Number.MAX_SAFE_INTEGER))).then((a=>(cj(t,e,a),a)))}function cj(s,e,t){let n=s.Os.get(e)||Oe.min();t.forEach(((a,l)=>{l.readTime.compareTo(n)>0&&(n=l.readTime)})),s.Os.set(e,n)}async function yP(s,e,t,n){const a=Te(s);let l=Xe(),u=Es();for(const p of t){const x=e.$s(p.metadata.name);p.document&&(l=l.add(x));const w=e.Us(p);w.setReadTime(e.Ks(p.metadata.readTime)),u=u.insert(x,w)}const h=a.Ns.newChangeBuffer({trackRemovals:!0}),m=await $c(a,(function(x){return cs(ru(tt.fromString(`__bundle__/docs/${x}`)))})(n));return a.persistence.runTransaction("Apply bundle documents","readwrite",(p=>ij(p,h,u).next((x=>(h.apply(p),x))).next((x=>a.Pi.removeMatchingKeysForTargetId(p,m.targetId).next((()=>a.Pi.addMatchingKeys(p,l,m.targetId))).next((()=>a.localDocuments.getLocalViewOfDocuments(p,x.ks,x.qs))).next((()=>x.ks))))))}async function xP(s,e,t=Xe()){const n=await $c(s,cs(gg(e.bundledQuery))),a=Te(s);return a.persistence.runTransaction("Save named query","readwrite",(l=>{const u=hn(e.readTime);if(n.snapshotVersion.compareTo(u)>=0)return a.Ii.saveNamedQuery(l,e);const h=n.withResumeToken(en.EMPTY_BYTE_STRING,u);return a.Ms=a.Ms.insert(h.targetId,h),a.Pi.updateTargetData(l,h).next((()=>a.Pi.removeMatchingKeysForTargetId(l,n.targetId))).next((()=>a.Pi.addMatchingKeys(l,t,n.targetId))).next((()=>a.Ii.saveNamedQuery(l,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj="firestore_clients";function vT(s,e){return`${uj}_${s}_${e}`}const dj="firestore_mutations";function bT(s,e,t){let n=`${dj}_${s}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const hj="firestore_targets";function Ky(s,e){return`${hj}_${s}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra="SharedClientState";class Lm{constructor(e,t,n,a){this.user=e,this.batchId=t,this.state=n,this.error=a}static Ws(e,t,n){const a=JSON.parse(n);let l,u=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return u&&a.error&&(u=typeof a.error.message=="string"&&typeof a.error.code=="string",u&&(l=new he(a.error.code,a.error.message))),u?new Lm(e,t,a.state,l):(dn(ra,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Fd{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ws(e,t){const n=JSON.parse(t);let a,l=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return l&&n.error&&(l=typeof n.error.message=="string"&&typeof n.error.code=="string",l&&(a=new he(n.error.code,n.error.message))),l?new Fd(e,n.state,a):(dn(ra,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Fm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const n=JSON.parse(t);let a=typeof n=="object"&&n.activeTargetIds instanceof Array,l=_v();for(let u=0;a&&u<n.activeTargetIds.length;++u)a=kS(n.activeTargetIds[u]),l=l.add(n.activeTargetIds[u]);return a?new Fm(e,l):(dn(ra,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Lv{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Lv(t.clientId,t.onlineState):(dn(ra,`Failed to parse online state: ${e}`),null)}}class Vx{constructor(){this.activeTargetIds=_v()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Qy{constructor(e,t,n,a,l){this.window=e,this.Mi=t,this.persistenceKey=n,this.Js=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new Ft(qe),this.started=!1,this.Xs=[];const u=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=l,this.eo=vT(this.persistenceKey,this.Js),this.no=(function(m){return`firestore_sequence_number_${m}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Vx),this.ro=new RegExp(`^${uj}_${u}_([^_]*)$`),this.io=new RegExp(`^${dj}_${u}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${hj}_${u}_(\\d+)$`),this.oo=(function(m){return`firestore_online_state_${m}`})(this.persistenceKey),this._o=(function(m){return`firestore_bundle_loaded_v2_${m}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const n of e){if(n===this.Js)continue;const a=this.getItem(vT(this.persistenceKey,n));if(a){const l=Fm.Ws(n,a);l&&(this.Zs=this.Zs.insert(l.clientId,l))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const n=this.uo(t);n&&this.co(n)}for(const n of this.Xs)this.Ys(n);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((n,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,n){this.ho(e,t,n),this.Po(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(Ky(this.persistenceKey,e));if(a){const l=Fd.Ws(e,a);l&&(n=l.state)}}return t&&this.To.zs(e),this.ao(),n}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ky(this.persistenceKey,e))}updateQueryState(e,t,n){this.Io(e,t,n)}handleUserChange(e,t,n){t.forEach((a=>{this.Po(a)})),this.currentUser=e,n.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return pe(ra,"READ",e,t),t}setItem(e,t){pe(ra,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){pe(ra,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(pe(ra,"EVENT",t.key,t.newValue),t.key===this.eo)return void dn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const n=this.Ro(t.key);return this.Vo(n,null)}{const n=this.mo(t.key,t.newValue);if(n)return this.Vo(n.clientId,n)}}else if(this.io.test(t.key)){if(t.newValue!==null){const n=this.fo(t.key,t.newValue);if(n)return this.po(n)}}else if(this.so.test(t.key)){if(t.newValue!==null){const n=this.yo(t.key,t.newValue);if(n)return this.wo(n)}}else if(t.key===this.oo){if(t.newValue!==null){const n=this.uo(t.newValue);if(n)return this.co(n)}}else if(t.key===this.no){const n=(function(l){let u=Ns.ce;if(l!=null)try{const h=JSON.parse(l);ke(typeof h=="number",30636,{So:l}),u=h}catch(h){dn(ra,"Failed to read sequence number from WebStorage",h)}return u})(t.newValue);n!==Ns.ce&&this.sequenceNumberHandler(n)}else if(t.key===this._o){const n=this.bo(t.newValue);await Promise.all(n.map((a=>this.syncEngine.Do(a))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,n){const a=new Lm(this.currentUser,e,t,n),l=bT(this.persistenceKey,this.currentUser,e);this.setItem(l,a.Gs())}Po(e){const t=bT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,n){const a=Ky(this.persistenceKey,e),l=new Fd(e,t,n);this.setItem(a,l.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const n=this.Ro(e);return Fm.Ws(n,t)}fo(e,t){const n=this.io.exec(e),a=Number(n[1]),l=n[2]!==void 0?n[2]:null;return Lm.Ws(new zn(l),a,t)}yo(e,t){const n=this.so.exec(e),a=Number(n[1]);return Fd.Ws(a,t)}uo(e){return Lv.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);pe(ra,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const n=t?this.Zs.insert(e,t):this.Zs.remove(e),a=this.lo(this.Zs),l=this.lo(n),u=[],h=[];return l.forEach((m=>{a.has(m)||u.push(m)})),a.forEach((m=>{l.has(m)||h.push(m)})),this.syncEngine.Fo(u,h).then((()=>{this.Zs=n}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=_v();return e.forEach(((n,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class fj{constructor(){this.Mo=new Vx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Vx,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT="ConnectivityMonitor";class _T{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(wT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(wT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qf=null;function Lx(){return Qf===null?Qf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Qf++,"0x"+Qf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy="RestConnection",bP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wP{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===Xd?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,t,n,a,l){const u=Lx(),h=this.zo(e,t.toUriEncodedString());pe(Yy,`Sending RPC '${e}' ${u}:`,h,n);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,a,l);const{host:p}=new URL(h),x=Za(p);return this.Jo(e,h,m,n,x).then((w=>(pe(Yy,`Received RPC '${e}' ${u}: `,w),w)),(w=>{throw Ws(Yy,`RPC '${e}' ${u} failed with error: `,w,"url: ",h,"request:",n),w}))}Ho(e,t,n,a,l,u){return this.Go(e,t,n,a,l)}jo(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+su})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),n&&n.headers.forEach(((a,l)=>e[l]=a))}zo(e,t){const n=bP[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs="WebChannelConnection";class NP extends wP{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,a,l){const u=Lx();return new Promise(((h,m)=>{const p=new gS;p.setWithCredentials(!0),p.listenOnce(pS.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case rm.NO_ERROR:const w=p.getResponseJson();pe(rs,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(w)),h(w);break;case rm.TIMEOUT:pe(rs,`RPC '${e}' ${u} timed out`),m(new he(re.DEADLINE_EXCEEDED,"Request time out"));break;case rm.HTTP_ERROR:const b=p.getStatus();if(pe(rs,`RPC '${e}' ${u} failed with status:`,b,"response text:",p.getResponseText()),b>0){let E=p.getResponseJson();Array.isArray(E)&&(E=E[0]);const R=E?.error;if(R&&R.status&&R.message){const k=(function(z){const B=z.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(B)>=0?B:re.UNKNOWN})(R.status);m(new he(k,R.message))}else m(new he(re.UNKNOWN,"Server responded with status "+p.getStatus()))}else m(new he(re.UNAVAILABLE,"Connection failed."));break;default:Ae(9055,{l_:e,streamId:u,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{pe(rs,`RPC '${e}' ${u} completed.`)}}));const x=JSON.stringify(a);pe(rs,`RPC '${e}' ${u} sending request:`,a),p.send(t,"POST",x,n,15)}))}T_(e,t,n){const a=Lx(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=vS(),h=xS(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(m.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,t,n),m.encodeInitMessageHeaders=!0;const x=l.join("");pe(rs,`Creating RPC '${e}' stream ${a}: ${x}`,m);const w=u.createWebChannel(x,m);this.I_(w);let b=!1,E=!1;const R=new _P({Yo:U=>{E?pe(rs,`Not sending because RPC '${e}' stream ${a} is closed:`,U):(b||(pe(rs,`Opening RPC '${e}' stream ${a} transport.`),w.open(),b=!0),pe(rs,`RPC '${e}' stream ${a} sending:`,U),w.send(U))},Zo:()=>w.close()}),k=(U,z,B)=>{U.listen(z,(q=>{try{B(q)}catch(G){setTimeout((()=>{throw G}),0)}}))};return k(w,Ed.EventType.OPEN,(()=>{E||(pe(rs,`RPC '${e}' stream ${a} transport opened.`),R.o_())})),k(w,Ed.EventType.CLOSE,(()=>{E||(E=!0,pe(rs,`RPC '${e}' stream ${a} transport closed`),R.a_(),this.E_(w))})),k(w,Ed.EventType.ERROR,(U=>{E||(E=!0,Ws(rs,`RPC '${e}' stream ${a} transport errored. Name:`,U.name,"Message:",U.message),R.a_(new he(re.UNAVAILABLE,"The operation could not be completed")))})),k(w,Ed.EventType.MESSAGE,(U=>{if(!E){const z=U.data[0];ke(!!z,16349);const B=z,q=B?.error||B[0]?.error;if(q){pe(rs,`RPC '${e}' stream ${a} received error:`,q);const G=q.status;let Y=(function(T){const A=pn[T];if(A!==void 0)return SA(A)})(G),L=q.message;Y===void 0&&(Y=re.INTERNAL,L="Unknown error status: "+G+" with message "+q.message),E=!0,R.a_(new he(Y,L)),w.close()}else pe(rs,`RPC '${e}' stream ${a} received:`,z),R.u_(z)}})),k(h,yS.STAT_EVENT,(U=>{U.stat===mx.PROXY?pe(rs,`RPC '${e}' stream ${a} detected buffering proxy`):U.stat===mx.NOPROXY&&pe(rs,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{R.__()}),0),R}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(){return typeof window<"u"?window:null}function fm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vl(s){return new I4(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,t,n=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-n);a>0&&pe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT="PersistentStream";class gj{constructor(e,t,n,a,l,u,h,m){this.Mi=e,this.S_=n,this.b_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Fv(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(dn(t.toString()),dn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===t&&this.G_(n,a)}),(n=>{e((()=>{const a=new he(re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return pe(NT,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(pe(NT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class TP extends gj{constructor(e,t,n,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,a,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=k4(this.serializer,e),n=(function(l){if(!("targetChange"in l))return Oe.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Oe.min():u.readTime?hn(u.readTime):Oe.min()})(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=kx(this.serializer),t.addTarget=(function(l,u){let h;const m=u.target;if(h=Cm(m)?{documents:MA(l,m)}:{query:mg(l,m).ft},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=CA(l,u.resumeToken);const p=Cx(l,u.expectedCount);p!==null&&(h.expectedCount=p)}else if(u.snapshotVersion.compareTo(Oe.min())>0){h.readTime=Gc(l,u.snapshotVersion.toTimestamp());const p=Cx(l,u.expectedCount);p!==null&&(h.expectedCount=p)}return h})(this.serializer,e);const n=P4(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=kx(this.serializer),t.removeTarget=e,this.q_(t)}}class EP extends gj{constructor(e,t,n,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,a,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ke(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ke(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ke(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=D4(e.writeResults,e.commitTime),n=hn(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=kx(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>th(this.serializer,n)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{}class AP extends SP{constructor(e,t,n,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new he(re.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,Rx(t,n),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new he(re.UNKNOWN,l.toString())}))}Ho(e,t,n,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Ho(e,Rx(t,n),a,u,h,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new he(re.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class jP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(dn(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fl="RemoteStore";class IP{constructor(e,t,n,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{n.enqueueAndForget((async()=>{oo(this)&&(pe(fl,"Restarting streams for network reachability change."),await(async function(m){const p=Te(m);p.Ea.add(4),await ou(p),p.Ra.set("Unknown"),p.Ea.delete(4),await xh(p)})(this))}))})),this.Ra=new jP(n,a)}}async function xh(s){if(oo(s))for(const e of s.da)await e(!0)}async function ou(s){for(const e of s.da)await e(!1)}function vg(s,e){const t=Te(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),qv(t)?Bv(t):cu(t).O_()&&Uv(t,e))}function Qc(s,e){const t=Te(s),n=cu(t);t.Ia.delete(e),n.O_()&&pj(t,e),t.Ia.size===0&&(n.O_()?n.L_():oo(t)&&t.Ra.set("Unknown"))}function Uv(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Oe.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}cu(s).Y_(e)}function pj(s,e){s.Va.Ue(e),cu(s).Z_(e)}function Bv(s){s.Va=new E4({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),cu(s).start(),s.Ra.ua()}function qv(s){return oo(s)&&!cu(s).x_()&&s.Ia.size>0}function oo(s){return Te(s).Ea.size===0}function yj(s){s.Va=void 0}async function CP(s){s.Ra.set("Online")}async function RP(s){s.Ia.forEach(((e,t)=>{Uv(s,e)}))}async function kP(s,e){yj(s),qv(s)?(s.Ra.ha(e),Bv(s)):s.Ra.set("Unknown")}async function DP(s,e,t){if(s.Ra.set("Online"),e instanceof IA&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const h of l.targetIds)a.Ia.has(h)&&(await a.remoteSyncer.rejectListen(h,u),a.Ia.delete(h),a.Va.removeTarget(h))})(s,e)}catch(n){pe(fl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Um(s,n)}else if(e instanceof dm?s.Va.Ze(e):e instanceof jA?s.Va.st(e):s.Va.tt(e),!t.isEqual(Oe.min()))try{const n=await aj(s.localStore);t.compareTo(n)>=0&&await(function(l,u){const h=l.Va.Tt(u);return h.targetChanges.forEach(((m,p)=>{if(m.resumeToken.approximateByteSize()>0){const x=l.Ia.get(p);x&&l.Ia.set(p,x.withResumeToken(m.resumeToken,u))}})),h.targetMismatches.forEach(((m,p)=>{const x=l.Ia.get(m);if(!x)return;l.Ia.set(m,x.withResumeToken(en.EMPTY_BYTE_STRING,x.snapshotVersion)),pj(l,m);const w=new qa(x.target,m,p,x.sequenceNumber);Uv(l,w)})),l.remoteSyncer.applyRemoteEvent(h)})(s,t)}catch(n){pe(fl,"Failed to raise snapshot:",n),await Um(s,n)}}async function Um(s,e,t){if(!ao(e))throw e;s.Ea.add(1),await ou(s),s.Ra.set("Offline"),t||(t=()=>aj(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{pe(fl,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await xh(s)}))}function xj(s,e){return e().catch((t=>Um(s,t,e)))}async function lu(s){const e=Te(s),t=to(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Qi;for(;PP(e);)try{const a=await pP(e.localStore,n);if(a===null){e.Ta.length===0&&t.L_();break}n=a.batchId,MP(e,a)}catch(a){await Um(e,a)}vj(e)&&bj(e)}function PP(s){return oo(s)&&s.Ta.length<10}function MP(s,e){s.Ta.push(e);const t=to(s);t.O_()&&t.X_&&t.ea(e.mutations)}function vj(s){return oo(s)&&!to(s).x_()&&s.Ta.length>0}function bj(s){to(s).start()}async function OP(s){to(s).ra()}async function VP(s){const e=to(s);for(const t of s.Ta)e.ea(t.mutations)}async function LP(s,e,t){const n=s.Ta.shift(),a=Sv.from(n,e,t);await xj(s,(()=>s.remoteSyncer.applySuccessfulWrite(a))),await lu(s)}async function FP(s,e){e&&to(s).X_&&await(async function(n,a){if((function(u){return EA(u)&&u!==re.ABORTED})(a.code)){const l=n.Ta.shift();to(n).B_(),await xj(n,(()=>n.remoteSyncer.rejectFailedWrite(l.batchId,a))),await lu(n)}})(s,e),vj(s)&&bj(s)}async function TT(s,e){const t=Te(s);t.asyncQueue.verifyOperationInProgress(),pe(fl,"RemoteStore received new credentials");const n=oo(t);t.Ea.add(3),await ou(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await xh(t)}async function Fx(s,e){const t=Te(s);e?(t.Ea.delete(2),await xh(t)):e||(t.Ea.add(2),await ou(t),t.Ra.set("Unknown"))}function cu(s){return s.ma||(s.ma=(function(t,n,a){const l=Te(t);return l.sa(),new TP(n,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Xo:CP.bind(null,s),t_:RP.bind(null,s),r_:kP.bind(null,s),H_:DP.bind(null,s)}),s.da.push((async e=>{e?(s.ma.B_(),qv(s)?Bv(s):s.Ra.set("Unknown")):(await s.ma.stop(),yj(s))}))),s.ma}function to(s){return s.fa||(s.fa=(function(t,n,a){const l=Te(t);return l.sa(),new EP(n,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:OP.bind(null,s),r_:FP.bind(null,s),ta:VP.bind(null,s),na:LP.bind(null,s)}),s.da.push((async e=>{e?(s.fa.B_(),await lu(s)):(await s.fa.stop(),s.Ta.length>0&&(pe(fl,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e,t,n,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=a,this.removalCallback=l,this.deferred=new Hn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,a,l){const u=Date.now()+n,h=new zv(e,t,u,a,l);return h.start(n),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uu(s,e){if(dn("AsyncQueue",`${e}: ${s}`),ao(s))return new he(re.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{static emptySet(e){return new tl(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ne.comparator(t.key,n.key):(t,n)=>Ne.comparator(t.key,n.key),this.keyedMap=Sd(),this.sortedSet=new Ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof tl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=n.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new tl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(){this.ga=new Ft(Ne.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ae(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class ml{constructor(e,t,n,a,l,u,h,m,p){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=m,this.hasCachedResults=p}static fromInitialDocuments(e,t,n,a,l){const u=[];return t.forEach((h=>{u.push({type:0,doc:h})})),new ml(e,t,tl.emptySet(t),u,n,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==n[a].type||!t[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class BP{constructor(){this.queries=ST(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const a=Te(t),l=a.queries;a.queries=ST(),l.forEach(((u,h)=>{for(const m of h.Sa)m.onError(n)}))})(this,new he(re.ABORTED,"Firestore shutting down"))}}function ST(){return new ti((s=>uA(s)),fh)}async function Hv(s,e){const t=Te(s);let n=3;const a=e.query;let l=t.queries.get(a);l?!l.ba()&&e.Da()&&(n=2):(l=new UP,n=e.Da()?0:1);try{switch(n){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const h=uu(u,`Initialization of query '${wc(e.query)}' failed`);return void e.onError(h)}t.queries.set(a,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&$v(t)}async function Gv(s,e){const t=Te(s),n=e.query;let a=3;const l=t.queries.get(n);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function qP(s,e){const t=Te(s);let n=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const h of u.Sa)h.Fa(a)&&(n=!0);u.wa=a}}n&&$v(t)}function zP(s,e,t){const n=Te(s),a=n.queries.get(e);if(a)for(const l of a.Sa)l.onError(t);n.queries.delete(e)}function $v(s){s.Ca.forEach((e=>{e.next()}))}var Ux,AT;(AT=Ux||(Ux={})).Ma="default",AT.Cache="cache";class Kv{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new ml(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ml.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ux.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(e){this.serializer=e}$s(e){return da(this.serializer,e)}Us(e){return e.metadata.exists?fg(this.serializer,e.document,!1):Ut.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return hn(e)}}class Qv{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=_j(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const n=tt.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,n=new jT(this.serializer);for(const a of e)if(a.metadata.queries){const l=n.$s(a.metadata.name);for(const u of a.metadata.queries){const h=(t.get(u)||Xe()).add(l);t.set(u,h)}}return t}async ja(e){const t=await yP(e,new jT(this.serializer),this.Wa,this.Ua.id),n=this.za(this.documents);for(const a of this.Ka)await xP(e,a,n.get(a.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function _j(s){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:s.totalDocuments,totalBytes:s.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(e){this.key=e}}class Tj{constructor(e){this.key=e}}class Ej{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Xe(),this.mutatedKeys=Xe(),this.eu=hA(e),this.tu=new tl(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new ET,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,h=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,p=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((x,w)=>{const b=a.get(x),E=mh(this.query,w)?w:null,R=!!b&&this.mutatedKeys.has(b.key),k=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let U=!1;b&&E?b.data.isEqual(E.data)?R!==k&&(n.track({type:3,doc:E}),U=!0):this.su(b,E)||(n.track({type:2,doc:E}),U=!0,(m&&this.eu(E,m)>0||p&&this.eu(E,p)<0)&&(h=!0)):!b&&E?(n.track({type:0,doc:E}),U=!0):b&&!E&&(n.track({type:1,doc:b}),U=!0,(m||p)&&(h=!0)),U&&(E?(u=u.add(E),l=k?l.add(x):l.delete(x)):(u=u.delete(x),l=l.delete(x)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const x=this.query.limitType==="F"?u.last():u.first();u=u.delete(x.key),l=l.delete(x.key),n.track({type:1,doc:x})}return{tu:u,iu:n,Cs:h,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((x,w)=>(function(E,R){const k=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae(20277,{Rt:U})}};return k(E)-k(R)})(x.type,w.type)||this.eu(x.doc,w.doc))),this.ou(n),a=a??!1;const h=t&&!a?this._u():[],m=this.Xa.size===0&&this.current&&!a?1:0,p=m!==this.Za;return this.Za=m,u.length!==0||p?{snapshot:new ml(this.query,e.tu,l,u,e.mutatedKeys,m===0,p,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ET,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Xe(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const t=[];return e.forEach((n=>{this.Xa.has(n)||t.push(new Tj(n))})),this.Xa.forEach((n=>{e.has(n)||t.push(new Nj(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=Xe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ml.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const lo="SyncEngine";class HP{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class GP{constructor(e){this.key=e,this.hu=!1}}class $P{constructor(e,t,n,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new ti((h=>uA(h)),fh),this.Iu=new Map,this.Eu=new Set,this.du=new Ft(Ne.comparator),this.Au=new Map,this.Ru=new kv,this.Vu={},this.mu=new Map,this.fu=hl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function KP(s,e,t=!0){const n=bg(s);let a;const l=n.Tu.get(e);return l?(n.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Sj(n,e,t,!0),a}async function QP(s,e){const t=bg(s);await Sj(t,e,!0,!1)}async function Sj(s,e,t,n){const a=await $c(s.localStore,cs(e)),l=a.targetId,u=s.sharedClientState.addLocalQueryTarget(l,t);let h;return n&&(h=await Yv(s,e,l,u==="current",a.resumeToken)),s.isPrimaryClient&&t&&vg(s.remoteStore,a),h}async function Yv(s,e,t,n,a){s.pu=(w,b,E)=>(async function(k,U,z,B){let q=U.view.ru(z);q.Cs&&(q=await Vm(k.localStore,U.query,!1).then((({documents:P})=>U.view.ru(P,q))));const G=B&&B.targetChanges.get(U.targetId),Y=B&&B.targetMismatches.get(U.targetId)!=null,L=U.view.applyChanges(q,k.isPrimaryClient,G,Y);return Bx(k,U.targetId,L.au),L.snapshot})(s,w,b,E);const l=await Vm(s.localStore,e,!0),u=new Ej(e,l.Qs),h=u.ru(l.documents),m=yh.createSynthesizedTargetChangeForCurrentChange(t,n&&s.onlineState!=="Offline",a),p=u.applyChanges(h,s.isPrimaryClient,m);Bx(s,t,p.au);const x=new HP(e,t,u);return s.Tu.set(e,x),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),p.snapshot}async function YP(s,e,t){const n=Te(s),a=n.Tu.get(e),l=n.Iu.get(a.targetId);if(l.length>1)return n.Iu.set(a.targetId,l.filter((u=>!fh(u,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Kc(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),t&&Qc(n.remoteStore,a.targetId),Yc(n,a.targetId)})).catch(ro)):(Yc(n,a.targetId),await Kc(n.localStore,a.targetId,!0))}async function XP(s,e){const t=Te(s),n=t.Tu.get(e),a=t.Iu.get(n.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Qc(t.remoteStore,n.targetId))}async function WP(s,e,t){const n=Zv(s);try{const a=await(function(u,h){const m=Te(u),p=wt.now(),x=h.reduce(((E,R)=>E.add(R.key)),Xe());let w,b;return m.persistence.runTransaction("Locally write mutations","readwrite",(E=>{let R=Es(),k=Xe();return m.Ns.getEntries(E,x).next((U=>{R=U,R.forEach(((z,B)=>{B.isValidDocument()||(k=k.add(z))}))})).next((()=>m.localDocuments.getOverlayedDocuments(E,R))).next((U=>{w=U;const z=[];for(const B of h){const q=_4(B,w.get(B.key).overlayedDocument);q!=null&&z.push(new ni(B.key,q,ZS(q.value.mapValue),Kt.exists(!0)))}return m.mutationQueue.addMutationBatch(E,p,z,h)})).next((U=>{b=U;const z=U.applyToLocalDocumentSet(w,k);return m.documentOverlayCache.saveOverlays(E,U.batchId,z)}))})).then((()=>({batchId:b.batchId,changes:mA(w)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(u,h,m){let p=u.Vu[u.currentUser.toKey()];p||(p=new Ft(qe)),p=p.insert(h,m),u.Vu[u.currentUser.toKey()]=p})(n,a.batchId,t),await si(n,a.changes),await lu(n.remoteStore)}catch(a){const l=uu(a,"Failed to persist write");t.reject(l)}}async function Aj(s,e){const t=Te(s);try{const n=await gP(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=t.Au.get(l);u&&(ke(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?ke(u.hu,14607):a.removedDocuments.size>0&&(ke(u.hu,42227),u.hu=!1))})),await si(t,n,e)}catch(n){await ro(n)}}function IT(s,e,t){const n=Te(s);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const a=[];n.Tu.forEach(((l,u)=>{const h=u.view.va(e);h.snapshot&&a.push(h.snapshot)})),(function(u,h){const m=Te(u);m.onlineState=h;let p=!1;m.queries.forEach(((x,w)=>{for(const b of w.Sa)b.va(h)&&(p=!0)})),p&&$v(m)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function JP(s,e,t){const n=Te(s);n.sharedClientState.updateQueryState(e,"rejected",t);const a=n.Au.get(e),l=a&&a.key;if(l){let u=new Ft(Ne.comparator);u=u.insert(l,Ut.newNoDocument(l,Oe.min()));const h=Xe().add(l),m=new ph(Oe.min(),new Map,new Ft(qe),u,h);await Aj(n,m),n.du=n.du.remove(l),n.Au.delete(e),Jv(n)}else await Kc(n.localStore,e,!1).then((()=>Yc(n,e,t))).catch(ro)}async function ZP(s,e){const t=Te(s),n=e.batch.batchId;try{const a=await mP(t.localStore,e);Wv(t,n,null),Xv(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await si(t,a)}catch(a){await ro(a)}}async function e6(s,e,t){const n=Te(s);try{const a=await(function(u,h){const m=Te(u);return m.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let x;return m.mutationQueue.lookupMutationBatch(p,h).next((w=>(ke(w!==null,37113),x=w.keys(),m.mutationQueue.removeMutationBatch(p,w)))).next((()=>m.mutationQueue.performConsistencyCheck(p))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(p,x,h))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,x))).next((()=>m.localDocuments.getDocuments(p,x)))}))})(n.localStore,e);Wv(n,e,t),Xv(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await si(n,a)}catch(a){await ro(a)}}async function t6(s,e){const t=Te(s);oo(t.remoteStore)||pe(lo,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const n=await(function(u){const h=Te(u);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(m=>h.mutationQueue.getHighestUnacknowledgedBatchId(m)))})(t.localStore);if(n===Qi)return void e.resolve();const a=t.mu.get(n)||[];a.push(e),t.mu.set(n,a)}catch(n){const a=uu(n,"Initialization of waitForPendingWrites() operation failed");e.reject(a)}}function Xv(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function Wv(s,e,t){const n=Te(s);let a=n.Vu[n.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function Yc(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const n of s.Iu.get(e))s.Tu.delete(n),t&&s.Pu.yu(n,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach((n=>{s.Ru.containsKey(n)||jj(s,n)}))}function jj(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(Qc(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),Jv(s))}function Bx(s,e,t){for(const n of t)n instanceof Nj?(s.Ru.addReference(n.key,e),n6(s,n)):n instanceof Tj?(pe(lo,"Document no longer in limbo: "+n.key),s.Ru.removeReference(n.key,e),s.Ru.containsKey(n.key)||jj(s,n.key)):Ae(19791,{wu:n})}function n6(s,e){const t=e.key,n=t.path.canonicalString();s.du.get(t)||s.Eu.has(n)||(pe(lo,"New document in limbo: "+t),s.Eu.add(n),Jv(s))}function Jv(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new Ne(tt.fromString(e)),n=s.fu.next();s.Au.set(n,new GP(t)),s.du=s.du.insert(t,n),vg(s.remoteStore,new qa(cs(ru(t.path)),n,"TargetPurposeLimboResolution",Ns.ce))}}async function si(s,e,t){const n=Te(s),a=[],l=[],u=[];n.Tu.isEmpty()||(n.Tu.forEach(((h,m)=>{u.push(n.pu(m,e,t).then((p=>{if((p||t)&&n.isPrimaryClient){const x=p?!p.fromCache:t?.targetChanges.get(m.targetId)?.current;n.sharedClientState.updateQueryState(m.targetId,x?"current":"not-current")}if(p){a.push(p);const x=Ov.As(m.targetId,p);l.push(x)}})))})),await Promise.all(u),n.Pu.H_(a),await(async function(m,p){const x=Te(m);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>W.forEach(p,(b=>W.forEach(b.Es,(E=>x.persistence.referenceDelegate.addReference(w,b.targetId,E))).next((()=>W.forEach(b.ds,(E=>x.persistence.referenceDelegate.removeReference(w,b.targetId,E)))))))))}catch(w){if(!ao(w))throw w;pe(Vv,"Failed to update sequence numbers: "+w)}for(const w of p){const b=w.targetId;if(!w.fromCache){const E=x.Ms.get(b),R=E.snapshotVersion,k=E.withLastLimboFreeSnapshotVersion(R);x.Ms=x.Ms.insert(b,k)}}})(n.localStore,l))}async function s6(s,e){const t=Te(s);if(!t.currentUser.isEqual(e)){pe(lo,"User change. New user:",e.toKey());const n=await rj(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((h=>{h.forEach((m=>{m.reject(new he(re.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await si(t,n.Ls)}}function r6(s,e){const t=Te(s),n=t.Au.get(e);if(n&&n.hu)return Xe().add(n.key);{let a=Xe();const l=t.Iu.get(e);if(!l)return a;for(const u of l){const h=t.Tu.get(u);a=a.unionWith(h.view.nu)}return a}}async function a6(s,e){const t=Te(s),n=await Vm(t.localStore,e.query,!0),a=e.view.cu(n);return t.isPrimaryClient&&Bx(t,e.targetId,a.au),a}async function i6(s,e){const t=Te(s);return lj(t.localStore,e).then((n=>si(t,n)))}async function o6(s,e,t,n){const a=Te(s),l=await(function(h,m){const p=Te(h),x=Te(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(w=>x.er(w,m).next((b=>b?p.localDocuments.getDocuments(w,b):W.resolve(null)))))})(a.localStore,e);l!==null?(t==="pending"?await lu(a.remoteStore):t==="acknowledged"||t==="rejected"?(Wv(a,e,n||null),Xv(a,e),(function(h,m){Te(Te(h).mutationQueue).ir(m)})(a.localStore,e)):Ae(6720,"Unknown batchState",{Su:t}),await si(a,l)):pe(lo,"Cannot apply mutation batch with id: "+e)}async function l6(s,e){const t=Te(s);if(bg(t),Zv(t),e===!0&&t.gu!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),a=await CT(t,n.toArray());t.gu=!0,await Fx(t.remoteStore,!0);for(const l of a)vg(t.remoteStore,l)}else if(e===!1&&t.gu!==!1){const n=[];let a=Promise.resolve();t.Iu.forEach(((l,u)=>{t.sharedClientState.isLocalQueryTarget(u)?n.push(u):a=a.then((()=>(Yc(t,u),Kc(t.localStore,u,!0)))),Qc(t.remoteStore,u)})),await a,await CT(t,n),(function(u){const h=Te(u);h.Au.forEach(((m,p)=>{Qc(h.remoteStore,p)})),h.Ru.Jr(),h.Au=new Map,h.du=new Ft(Ne.comparator)})(t),t.gu=!1,await Fx(t.remoteStore,!1)}}async function CT(s,e,t){const n=Te(s),a=[],l=[];for(const u of e){let h;const m=n.Iu.get(u);if(m&&m.length!==0){h=await $c(n.localStore,cs(m[0]));for(const p of m){const x=n.Tu.get(p),w=await a6(n,x);w.snapshot&&l.push(w.snapshot)}}else{const p=await oj(n.localStore,u);h=await $c(n.localStore,p),await Yv(n,Ij(p),u,!1,h.resumeToken)}a.push(h)}return n.Pu.H_(l),a}function Ij(s){return oA(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function c6(s){return(function(t){return Te(Te(t).persistence).Ts()})(Te(s).localStore)}async function u6(s,e,t,n){const a=Te(s);if(a.gu)return void pe(lo,"Ignoring unexpected query state notification.");const l=a.Iu.get(e);if(l&&l.length>0)switch(t){case"current":case"not-current":{const u=await lj(a.localStore,dA(l[0])),h=ph.createSynthesizedRemoteEventForCurrentChange(e,t==="current",en.EMPTY_BYTE_STRING);await si(a,u,h);break}case"rejected":await Kc(a.localStore,e,!0),Yc(a,e,n);break;default:Ae(64155,t)}}async function d6(s,e,t){const n=bg(s);if(n.gu){for(const a of e){if(n.Iu.has(a)&&n.sharedClientState.isActiveQueryTarget(a)){pe(lo,"Adding an already active target "+a);continue}const l=await oj(n.localStore,a),u=await $c(n.localStore,l);await Yv(n,Ij(l),u.targetId,!1,u.resumeToken),vg(n.remoteStore,u)}for(const a of t)n.Iu.has(a)&&await Kc(n.localStore,a,!1).then((()=>{Qc(n.remoteStore,a),Yc(n,a)})).catch(ro)}}function bg(s){const e=Te(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=Aj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=r6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JP.bind(null,e),e.Pu.H_=qP.bind(null,e.eventManager),e.Pu.yu=zP.bind(null,e.eventManager),e}function Zv(s){const e=Te(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=e6.bind(null,e),e}function h6(s,e,t){const n=Te(s);(async function(l,u,h){try{const m=await u.getMetadata();if(await(function(E,R){const k=Te(E),U=hn(R.createTime);return k.persistence.runTransaction("hasNewerBundle","readonly",(z=>k.Ii.getBundleMetadata(z,R.id))).then((z=>!!z&&z.createTime.compareTo(U)>=0))})(l.localStore,m))return await u.close(),h._completeWith((function(E){return{taskState:"Success",documentsLoaded:E.totalDocuments,bytesLoaded:E.totalBytes,totalDocuments:E.totalDocuments,totalBytes:E.totalBytes}})(m)),Promise.resolve(new Set);h._updateProgress(_j(m));const p=new Qv(m,u.serializer);let x=await u.bu();for(;x;){const b=await p.Ga(x);b&&h._updateProgress(b),x=await u.bu()}const w=await p.ja(l.localStore);return await si(l,w.Ha,void 0),await(function(E,R){const k=Te(E);return k.persistence.runTransaction("Save bundle","readwrite",(U=>k.Ii.saveBundleMetadata(U,R)))})(l.localStore,m),h._completeWith(w.progress),Promise.resolve(w.Ja)}catch(m){return Ws(lo,`Loading bundle failed with ${m}`),h._failWith(m),Promise.resolve(new Set)}})(n,e,t).then((a=>{n.sharedClientState.notifyBundleLoaded(a)}))}class Xc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return sj(this.persistence,new nj,e.initialUser,this.serializer)}Cu(e){return new Dv(xg.mi,this.serializer)}Du(e){return new fj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xc.provider={build:()=>new Xc};class eb extends Xc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ke(this.persistence.referenceDelegate instanceof Om,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new XA(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?as.withCacheSize(this.cacheSizeBytes):as.DEFAULT;return new Dv((n=>Om.mi(n,t)),this.serializer)}}class tb extends Xc{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Zv(this.xu.syncEngine),await lu(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return sj(this.persistence,new nj,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new XA(n,e.asyncQueue,t)}Mu(e,t){const n=new SD(t,this.persistence);return new ED(e.asyncQueue,n)}Cu(e){const t=Mv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?as.withCacheSize(this.cacheSizeBytes):as.DEFAULT;return new Pv(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,mj(),fm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new fj}}class Cj extends tb{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Qy&&(this.sharedClientState.syncEngine={Co:o6.bind(null,t),vo:u6.bind(null,t),Fo:d6.bind(null,t),Ts:c6.bind(null,t),Do:i6.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async n=>{await l6(this.xu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))}Du(e){const t=mj();if(!Qy.v(t))throw new he(re.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Mv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Qy(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class no{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>IT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=s6.bind(null,this.syncEngine),await Fx(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new BP})()}createDatastore(e){const t=vl(e.databaseInfo.databaseId),n=(function(l){return new NP(l)})(e.databaseInfo);return(function(l,u,h,m){return new AP(l,u,h,m)})(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,a,l,u,h){return new IP(n,a,l,u,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>IT(this.syncEngine,t,0)),(function(){return _T.v()?new _T:new vP})())}createSyncEngine(e,t){return(function(a,l,u,h,m,p,x){const w=new $P(a,l,u,h,m,p);return x&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const n=Te(t);pe(fl,"RemoteStore shutting down."),n.Ea.add(5),await ou(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}no.provider={build:()=>new no};function RT(s,e=10240){let t=0;return{async read(){if(t<s.byteLength){const n={value:s.slice(t,t+e),done:!1};return t+=e,n}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):dn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Hn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((n=>{n&&n.$a()?this.metadata.resolve(n.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n?.Qa)}`))}),(n=>this.metadata.reject(n)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),n=Number(t);isNaN(n)&&this.Qu(`length string (${t}) is not valid number`);const a=await this.$u(n);return new wj(JSON.parse(a),e.length+n)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let n=this.bu();if(!n||!n.$a())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(n?.Qa)}`);this.metadata=n;do n=this.bu(),n!==null&&this.elements.push(n);while(n!==null)}getMetadata(){return this.metadata}Wu(){return this.elements}bu(){if(this.cursor===this.bundleData.length)return null;const e=this.qu(),t=this.$u(e);return new wj(JSON.parse(t),e)}$u(e){if(this.cursor+e>this.bundleData.length)throw new he(re.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}qu(){const e=this.cursor;let t=this.cursor;for(;t<this.bundleData.length;){if(this.bundleData[t]==="{"){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new he(re.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(a,l){const u=Te(a),h={documents:l.map((w=>eh(u.serializer,w)))},m=await u.Ho("BatchGetDocuments",u.serializer.databaseId,tt.emptyPath(),h,l.length),p=new Map;m.forEach((w=>{const b=R4(u.serializer,w);p.set(b.key.toString(),b)}));const x=[];return l.forEach((w=>{const b=p.get(w.toString());ke(!!b,55234,{key:w}),x.push(b)})),x})(this.datastore,e);return t.forEach((n=>this.recordVersion(n))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new iu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,n)=>{const a=Ne.fromPath(n);this.mutations.push(new Tv(a,this.precondition(a)))})),await(async function(n,a){const l=Te(n),u={writes:a.map((h=>th(l.serializer,h)))};await l.Go("Commit",l.serializer.databaseId,tt.emptyPath(),u)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ae(50498,{Gu:e.constructor.name});t=Oe.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new he(re.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Oe.min())?Kt.exists(!1):Kt.updateTime(t):Kt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Oe.min()))throw new he(re.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Kt.updateTime(t)}return Kt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e,t,n,a,l){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=a,this.deferred=l,this.zu=n.maxAttempts,this.M_=new Fv(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new g6(this.datastore),t=this.Hu(e);t&&t.then((n=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(n)})).catch((a=>{this.Yu(a)}))))})).catch((n=>{this.Yu(n)}))}))}Hu(e){try{const t=this.updateFunction(e);return!uh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!EA(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so="FirestoreClient";class y6{constructor(e,t,n,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=a,this.user=zn.UNAUTHENTICATED,this.clientId=ng.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(n,(async u=>{pe(so,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(n,(u=>(pe(so,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=uu(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Xy(s,e){s.asyncQueue.verifyOperationInProgress(),pe(so,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let n=t.initialUser;s.setCredentialChangeListener((async a=>{n.isEqual(a)||(await rj(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function kT(s,e){s.asyncQueue.verifyOperationInProgress();const t=await nb(s);pe(so,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((n=>TT(e.remoteStore,n))),s.setAppCheckTokenChangeListener(((n,a)=>TT(e.remoteStore,a))),s._onlineComponents=e}async function nb(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){pe(so,"Using user provided OfflineComponentProvider");try{await Xy(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===re.FAILED_PRECONDITION||a.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Ws("Error using user provided cache. Falling back to memory cache: "+t),await Xy(s,new Xc)}}else pe(so,"Using default OfflineComponentProvider"),await Xy(s,new eb(void 0));return s._offlineComponents}async function _g(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(pe(so,"Using user provided OnlineComponentProvider"),await kT(s,s._uninitializedComponentsProvider._online)):(pe(so,"Using default OnlineComponentProvider"),await kT(s,new no))),s._onlineComponents}function Rj(s){return nb(s).then((e=>e.persistence))}function du(s){return nb(s).then((e=>e.localStore))}function kj(s){return _g(s).then((e=>e.remoteStore))}function sb(s){return _g(s).then((e=>e.syncEngine))}function Dj(s){return _g(s).then((e=>e.datastore))}async function Wc(s){const e=await _g(s),t=e.eventManager;return t.onListen=KP.bind(null,e.syncEngine),t.onUnlisten=YP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=QP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=XP.bind(null,e.syncEngine),t}function x6(s){return s.asyncQueue.enqueue((async()=>{const e=await Rj(s),t=await kj(s);return e.setNetworkEnabled(!0),(function(a){const l=Te(a);return l.Ea.delete(0),xh(l)})(t)}))}function v6(s){return s.asyncQueue.enqueue((async()=>{const e=await Rj(s),t=await kj(s);return e.setNetworkEnabled(!1),(async function(a){const l=Te(a);l.Ea.add(0),await ou(l),l.Ra.set("Offline")})(t)}))}function b6(s,e){const t=new Hn;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,u){try{const h=await(function(p,x){const w=Te(p);return w.persistence.runTransaction("read document","readonly",(b=>w.localDocuments.getDocument(b,x)))})(a,l);h.isFoundDocument()?u.resolve(h):h.isNoDocument()?u.resolve(null):u.reject(new he(re.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const m=uu(h,`Failed to get document '${l} from cache`);u.reject(m)}})(await du(s),e,t))),t.promise}function Pj(s,e,t={}){const n=new Hn;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,h,m,p){const x=new wg({next:b=>{x.Nu(),u.enqueueAndForget((()=>Gv(l,w)));const E=b.docs.has(h);!E&&b.fromCache?p.reject(new he(re.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&b.fromCache&&m&&m.source==="server"?p.reject(new he(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(b)},error:b=>p.reject(b)}),w=new Kv(ru(h.path),x,{includeMetadataChanges:!0,qa:!0});return Hv(l,w)})(await Wc(s),s.asyncQueue,e,t,n))),n.promise}function w6(s,e){const t=new Hn;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,u){try{const h=await Vm(a,l,!0),m=new Ej(l,h.Qs),p=m.ru(h.documents),x=m.applyChanges(p,!1);u.resolve(x.snapshot)}catch(h){const m=uu(h,`Failed to execute query '${l} against cache`);u.reject(m)}})(await du(s),e,t))),t.promise}function Mj(s,e,t={}){const n=new Hn;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,h,m,p){const x=new wg({next:b=>{x.Nu(),u.enqueueAndForget((()=>Gv(l,w))),b.fromCache&&m.source==="server"?p.reject(new he(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(b)},error:b=>p.reject(b)}),w=new Kv(h,x,{includeMetadataChanges:!0,qa:!0});return Hv(l,w)})(await Wc(s),s.asyncQueue,e,t,n))),n.promise}function _6(s,e,t){const n=new Hn;return s.asyncQueue.enqueueAndForget((async()=>{try{const a=await Dj(s);n.resolve((async function(u,h,m){const p=Te(u),{request:x,gt:w,parent:b}=OA(p.serializer,lA(h),m);p.connection.$o||delete x.parent;const E=(await p.Ho("RunAggregationQuery",p.serializer.databaseId,b,x,1)).filter((k=>!!k.result));ke(E.length===1,64727);const R=E[0].result?.aggregateFields;return Object.keys(R).reduce(((k,U)=>(k[w[U]]=R[U],k)),{})})(a,e,t))}catch(a){n.reject(a)}})),n.promise}function N6(s,e){const t=new wg(e);return s.asyncQueue.enqueueAndForget((async()=>(function(a,l){Te(a).Ca.add(l),l.next()})(await Wc(s),t))),()=>{t.Nu(),s.asyncQueue.enqueueAndForget((async()=>(function(a,l){Te(a).Ca.delete(l)})(await Wc(s),t)))}}function T6(s,e,t,n){const a=(function(u,h){let m;return m=typeof u=="string"?AA().encode(u):u,(function(x,w){return new f6(x,w)})((function(x,w){if(x instanceof Uint8Array)return RT(x,w);if(x instanceof ArrayBuffer)return RT(new Uint8Array(x),w);if(x instanceof ReadableStream)return x.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(m),h)})(t,vl(e));s.asyncQueue.enqueueAndForget((async()=>{h6(await sb(s),a,n)}))}function E6(s,e){return s.asyncQueue.enqueue((async()=>(function(n,a){const l=Te(n);return l.persistence.runTransaction("Get named query","readonly",(u=>l.Ii.getNamedQuery(u,a)))})(await du(s),e)))}function Oj(s,e){return(function(n,a){return new m6(n,a)})(s,e)}function S6(s,e){return s.asyncQueue.enqueue((async()=>(async function(n,a){const l=Te(n),u=l.indexManager,h=[];return l.persistence.runTransaction("Configure indexes","readwrite",(m=>u.getFieldIndexes(m).next((p=>(function(w,b,E,R,k){w=[...w],b=[...b],w.sort(E),b.sort(E);const U=w.length,z=b.length;let B=0,q=0;for(;B<z&&q<U;){const G=E(w[q],b[B]);G<0?k(w[q++]):G>0?R(b[B++]):(B++,q++)}for(;B<z;)R(b[B++]);for(;q<U;)k(w[q++])})(p,a,wD,(x=>{h.push(u.addFieldIndex(m,x))}),(x=>{h.push(u.deleteFieldIndex(m,x))})))).next((()=>W.waitFor(h)))))})(await du(s),e)))}function A6(s,e){return s.asyncQueue.enqueue((async()=>(function(n,a){Te(n).Fs.Vs=a})(await du(s),e)))}function j6(s){return s.asyncQueue.enqueue((async()=>(function(t){const n=Te(t),a=n.indexManager;return n.persistence.runTransaction("Delete All Indexes","readwrite",(l=>a.deleteAllFieldIndexes(l)))})(await du(s))))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vj(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj="firestore.googleapis.com",PT=!0;class MT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new he(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Lj,this.ssl=PT}else this.host=e.host,this.ssl=e.ssl??PT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=GA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<YA)throw new he(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}TS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vj(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new he(re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new he(re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new he(re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vh{constructor(e,t,n,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new MT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new MT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new _S;switch(n.type){case"firstParty":return new mD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new he(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=DT.get(t);n&&(pe("ComponentProvider","Removing Datastore"),DT.delete(t),n.terminate())})(this),Promise.resolve()}}function Fj(s,e,t,n={}){s=nt(s,vh);const a=Za(e),l=s._getSettings(),u={...l,emulatorOptions:s._getEmulatorOptions()},h=`${e}:${t}`;a&&(Xm(`https://${h}`),Wx("Firestore",!0)),l.host!==Lj&&l.host!==h&&Ws("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...l,host:h,ssl:a,emulatorOptions:n};if(!xr(m,u)&&(s._setSettings(m),n.mockUserToken)){let p,x;if(typeof n.mockUserToken=="string")p=n.mockUserToken,x=zn.MOCK_USER;else{p=PI(n.mockUserToken,s._app?.options.projectId);const w=n.mockUserToken.sub||n.mockUserToken.user_id;if(!w)throw new he(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new zn(w)}s._authCredentials=new dD(new wS(p,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Cn(this.firestore,e,this._query)}}class At{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new At(this.firestore,e,this._key)}toJSON(){return{type:At._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(xl(t,At._jsonSchema))return new At(e,n||null,new Ne(tt.fromString(t.referencePath)))}}At._jsonSchemaVersion="firestore/documentReference/1.0",At._jsonSchema={type:bn("string",At._jsonSchemaVersion),referencePath:bn("string")};class Lr extends Cn{constructor(e,t,n){super(e,t,ru(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new At(this.firestore,null,new Ne(e))}withConverter(e){return new Lr(this.firestore,e,this._path)}}function Ce(s,e,...t){if(s=mt(s),dv("collection","path",e),s instanceof vh){const n=tt.fromString(e,...t);return NN(n),new Lr(s,null,n)}{if(!(s instanceof At||s instanceof Lr))throw new he(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(tt.fromString(e,...t));return NN(n),new Lr(s.firestore,null,n)}}function I6(s,e){if(s=nt(s,vh),dv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new he(re.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Cn(s,null,(function(n){return new ei(tt.emptyPath(),n)})(e))}function be(s,e,...t){if(s=mt(s),arguments.length===1&&(e=ng.newId()),dv("doc","path",e),s instanceof vh){const n=tt.fromString(e,...t);return _N(n),new At(s,null,new Ne(n))}{if(!(s instanceof At||s instanceof Lr))throw new he(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(tt.fromString(e,...t));return _N(n),new At(s.firestore,s instanceof Lr?s.converter:null,new Ne(n))}}function C6(s,e){return s=mt(s),e=mt(e),(s instanceof At||s instanceof Lr)&&(e instanceof At||e instanceof Lr)&&s.firestore===e.firestore&&s.path===e.path&&s.converter===e.converter}function rb(s,e){return s=mt(s),e=mt(e),s instanceof Cn&&e instanceof Cn&&s.firestore===e.firestore&&fh(s._query,e._query)&&s.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="AsyncQueue";class VT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Fv(this,"async_queue_retry"),this._c=()=>{const n=fm();n&&pe(OT,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=fm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=fm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Hn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ao(e))throw e;pe(OT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,dn("INTERNAL UNHANDLED ERROR: ",LT(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=zv.createAndSchedule(this,e,t,n,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Ae(47125,{Pc:LT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function LT(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(s){return(function(t,n){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of n)if(l in a&&typeof a[l]=="function")return!0;return!1})(s,["next","error","complete"])}class Uj{constructor(){this._progressObserver={},this._taskCompletionResolver=new Hn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R6=-1;class Pt extends vh{constructor(e,t,n,a){super(e,t,n,a),this.type="firestore",this._queue=new VT,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new VT(e),this._firestoreClient=void 0,await e}}}function k6(s,e,t){t||(t=Xd);const n=ma(s,"firestore");if(n.isInitialized(t)){const a=n.getImmediate({identifier:t}),l=n.getOptions(t);if(xr(l,e))return a;throw new he(re.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new he(re.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<YA)throw new he(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Za(e.host)&&Xm(e.host),n.initialize({options:e,instanceIdentifier:t})}function Bj(s,e){const t=typeof s=="object"?s:Jm(),n=typeof s=="string"?s:e||Xd,a=ma(t,"firestore").getImmediate({identifier:n});if(!a._initialized){const l=bE("firestore");l&&Fj(a,...l)}return a}function Qt(s){if(s._terminated)throw new he(re.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||qj(s),s._firestoreClient}function qj(s){const e=s._freezeSettings(),t=(function(a,l,u,h){return new t4(a,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Vj(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(s._databaseId,s._app?.options.appId||"",s._persistenceKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new y6(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(s._componentsProvider))}function D6(s,e){Ws("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=s._freezeSettings();return zj(s,no.provider,{build:n=>new tb(n,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function P6(s){Ws("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=s._freezeSettings();zj(s,no.provider,{build:t=>new Cj(t,e.cacheSizeBytes)})}function zj(s,e,t){if((s=nt(s,Pt))._firestoreClient||s._terminated)throw new he(re.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(s._componentsProvider||s._getSettings().localCache)throw new he(re.FAILED_PRECONDITION,"SDK cache is already specified.");s._componentsProvider={_online:e,_offline:t},qj(s)}function M6(s){if(s._initialized&&!s._terminated)throw new he(re.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Hn;return s._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(n){if(!ua.v())return Promise.resolve();const a=n+tj;await ua.delete(a)})(Mv(s._databaseId,s._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function O6(s){return(function(t){const n=new Hn;return t.asyncQueue.enqueueAndForget((async()=>t6(await sb(t),n))),n.promise})(Qt(s=nt(s,Pt)))}function V6(s){return x6(Qt(s=nt(s,Pt)))}function L6(s){return v6(Qt(s=nt(s,Pt)))}function F6(s){return QC(s.app,"firestore",s._databaseId.database),s._delete()}function qx(s,e){const t=Qt(s=nt(s,Pt)),n=new Uj;return T6(t,s._databaseId,e,n),n}function Hj(s,e){return E6(Qt(s=nt(s,Pt)),e).then((t=>t?new Cn(s,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class Gj{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _s(en.fromBase64String(e))}catch(t){throw new he(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new _s(en.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:_s._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xl(e,_s._jsonSchema))return _s.fromBase64String(e.bytes)}}_s._jsonSchemaVersion="firestore/bytes/1.0",_s._jsonSchema={type:bn("string",_s._jsonSchemaVersion),bytes:bn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new he(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function U6(){return new co(yx)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new he(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new he(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Fr._jsonSchemaVersion}}static fromJSON(e){if(xl(e,Fr._jsonSchema))return new Fr(e.latitude,e.longitude)}}Fr._jsonSchemaVersion="firestore/geoPoint/1.0",Fr._jsonSchema={type:bn("string",Fr._jsonSchemaVersion),latitude:bn("number"),longitude:bn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let l=0;l<n.length;++l)if(n[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:yr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xl(e,yr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new yr(e.vectorValues);throw new he(re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yr._jsonSchemaVersion="firestore/vectorValue/1.0",yr._jsonSchema={type:bn("string",yr._jsonSchemaVersion),vectorValues:bn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B6=/^__.*__$/;class q6{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new ni(e,this.data,this.fieldMask,t,this.fieldTransforms):new au(e,this.data,t,this.fieldTransforms)}}class $j{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ni(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Kj(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ae(40011,{Ac:s})}}class Ng{constructor(e,t,n,a,l,u){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ng({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Bm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Kj(this.Ac)&&B6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class z6{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||vl(e)}Cc(e,t,n,a=!1){return new Ng({Ac:e,methodName:t,Dc:n,path:Bt.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function bl(s){const e=s._freezeSettings(),t=vl(s._databaseId);return new z6(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Tg(s,e,t,n,a,l={}){const u=s.Cc(l.merge||l.mergeFields?2:0,e,t,a);db("Data must be an object, but it was:",u,n);const h=Xj(n,u);let m,p;if(l.merge)m=new Ts(u.fieldMask),p=u.fieldTransforms;else if(l.mergeFields){const x=[];for(const w of l.mergeFields){const b=nh(e,w,t);if(!u.contains(b))throw new he(re.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);Jj(x,b)||x.push(b)}m=new Ts(x),p=u.fieldTransforms.filter((w=>m.covers(w.field)))}else m=null,p=u.fieldTransforms;return new q6(new Zn(h),m,p)}class bh extends uo{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bh}}function Qj(s,e,t){return new Ng({Ac:3,Dc:e.settings.Dc,methodName:s._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ab extends uo{_toFieldTransform(e){return new gh(e.path,new zc)}isEqual(e){return e instanceof ab}}class ib extends uo{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Qj(this,e,!0),n=this.vc.map((l=>wl(l,t))),a=new ll(n);return new gh(e.path,a)}isEqual(e){return e instanceof ib&&xr(this.vc,e.vc)}}class ob extends uo{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Qj(this,e,!0),n=this.vc.map((l=>wl(l,t))),a=new cl(n);return new gh(e.path,a)}isEqual(e){return e instanceof ob&&xr(this.vc,e.vc)}}class lb extends uo{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Hc(e.serializer,yA(e.serializer,this.Fc));return new gh(e.path,t)}isEqual(e){return e instanceof lb&&this.Fc===e.Fc}}function cb(s,e,t,n){const a=s.Cc(1,e,t);db("Data must be an object, but it was:",a,n);const l=[],u=Zn.empty();io(n,((m,p)=>{const x=Eg(e,m,t);p=mt(p);const w=a.yc(x);if(p instanceof bh)l.push(x);else{const b=wl(p,w);b!=null&&(l.push(x),u.set(x,b))}}));const h=new Ts(l);return new $j(u,h,a.fieldTransforms)}function ub(s,e,t,n,a,l){const u=s.Cc(1,e,t),h=[nh(e,n,t)],m=[a];if(l.length%2!=0)throw new he(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<l.length;b+=2)h.push(nh(e,l[b])),m.push(l[b+1]);const p=[],x=Zn.empty();for(let b=h.length-1;b>=0;--b)if(!Jj(p,h[b])){const E=h[b];let R=m[b];R=mt(R);const k=u.yc(E);if(R instanceof bh)p.push(E);else{const U=wl(R,k);U!=null&&(p.push(E),x.set(E,U))}}const w=new Ts(p);return new $j(x,w,u.fieldTransforms)}function Yj(s,e,t,n=!1){return wl(t,s.Cc(n?4:3,e))}function wl(s,e){if(Wj(s=mt(s)))return db("Unsupported field value:",e,s),Xj(s,e);if(s instanceof uo)return(function(n,a){if(!Kj(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const l=n._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const l=[];let u=0;for(const h of n){let m=wl(h,a.wc(u));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),u++}return{arrayValue:{values:l}}})(s,e)}return(function(n,a){if((n=mt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return yA(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const l=wt.fromDate(n);return{timestampValue:Gc(a.serializer,l)}}if(n instanceof wt){const l=new wt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Gc(a.serializer,l)}}if(n instanceof Fr)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof _s)return{bytesValue:CA(a.serializer,n._byteString)};if(n instanceof At){const l=a.databaseId,u=n.firestore._databaseId;if(!u.isEqual(l))throw a.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Iv(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof yr)return(function(u,h){return{mapValue:{fields:{[xv]:{stringValue:vv},[Uc]:{arrayValue:{values:u.toArray().map((p=>{if(typeof p!="number")throw h.Sc("VectorValues must only contain numeric values.");return Nv(h.serializer,p)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${sg(n)}`)})(s,e)}function Xj(s,e){const t={};return HS(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):io(s,((n,a)=>{const l=wl(a,e.mc(n));l!=null&&(t[n]=l)})),{mapValue:{fields:t}}}function Wj(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof wt||s instanceof Fr||s instanceof _s||s instanceof At||s instanceof uo||s instanceof yr)}function db(s,e,t){if(!Wj(t)||!ES(t)){const n=sg(t);throw n==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+n)}}function nh(s,e,t){if((e=mt(e))instanceof co)return e._internalPath;if(typeof e=="string")return Eg(s,e);throw Bm("Field path arguments must be of type string or ",s,!1,void 0,t)}const H6=new RegExp("[~\\*/\\[\\]]");function Eg(s,e,t){if(e.search(H6)>=0)throw Bm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new co(...e.split("."))._internalPath}catch{throw Bm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Bm(s,e,t,n,a){const l=n&&!n.isEmpty(),u=a!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(l||u)&&(m+=" (found",l&&(m+=` in field ${n}`),u&&(m+=` in document ${a}`),m+=")"),new he(re.INVALID_ARGUMENT,h+s+m)}function Jj(s,e){return s.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,t,n,a,l){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new At(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new G6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Sg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class G6 extends sh{data(){return super.data()}}function Sg(s,e){return typeof e=="string"?Eg(s,e):e instanceof co?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zj(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new he(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hb{}class hu extends hb{}function Le(s,e,...t){let n=[];e instanceof hb&&n.push(e),n=n.concat(t),(function(l){const u=l.filter((m=>m instanceof _l)).length,h=l.filter((m=>m instanceof fu)).length;if(u>1||u>0&&h>0)throw new he(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const a of n)s=a._apply(s);return s}class fu extends hu{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new fu(e,t,n)}_apply(e){const t=this._parse(e);return t1(e._query,t),new Cn(e.firestore,e.converter,jx(e._query,t))}_parse(e){const t=bl(e.firestore);return(function(l,u,h,m,p,x,w){let b;if(p.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new he(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){UT(w,x);const R=[];for(const k of w)R.push(FT(m,l,k));b={arrayValue:{values:R}}}else b=FT(m,l,w)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||UT(w,x),b=Yj(h,u,w,x==="in"||x==="not-in");return ot.create(p,x,b)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ye(s,e,t){const n=e,a=Sg("where",s);return fu._create(a,n,t)}class _l extends hb{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new _l(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:St.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let u=a;const h=l.getFlattenedFilters();for(const m of h)t1(u,m),u=jx(u,m)})(e._query,t),new Cn(e.firestore,e.converter,jx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function $6(...s){return s.forEach((e=>n1("or",e))),_l._create("or",s)}function K6(...s){return s.forEach((e=>n1("and",e))),_l._create("and",s)}class Ag extends hu{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Ag(e,t)}_apply(e){const t=(function(a,l,u){if(a.startAt!==null)throw new he(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new he(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zd(l,u)})(e._query,this._field,this._direction);return new Cn(e.firestore,e.converter,(function(a,l){const u=a.explicitOrderBy.concat([l]);return new ei(a.path,a.collectionGroup,u,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function Jt(s,e="asc"){const t=e,n=Sg("orderBy",s);return Ag._create(n,t)}class wh extends hu{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new wh(e,t,n)}_apply(e){return new Cn(e.firestore,e.converter,km(e._query,this._limit,this._limitType))}}function Zt(s){return SS("limit",s),wh._create("limit",s,"F")}function Q6(s){return SS("limitToLast",s),wh._create("limitToLast",s,"L")}class _h extends hu{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new _h(e,t,n)}_apply(e){const t=e1(e,this.type,this._docOrFields,this._inclusive);return new Cn(e.firestore,e.converter,(function(a,l){return new ei(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,l,a.endAt)})(e._query,t))}}function Y6(...s){return _h._create("startAt",s,!0)}function X6(...s){return _h._create("startAfter",s,!1)}class Nh extends hu{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Nh(e,t,n)}_apply(e){const t=e1(e,this.type,this._docOrFields,this._inclusive);return new Cn(e.firestore,e.converter,(function(a,l){return new ei(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,l)})(e._query,t))}}function W6(...s){return Nh._create("endBefore",s,!1)}function J6(...s){return Nh._create("endAt",s,!0)}function e1(s,e,t,n){if(t[0]=mt(t[0]),t[0]instanceof sh)return(function(l,u,h,m,p){if(!m)throw new he(re.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const x=[];for(const w of jc(l))if(w.field.isKeyField())x.push(il(u,m.key));else{const b=m.data.field(w.field);if(lg(b))throw new he(re.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(b===null){const E=w.field.canonicalString();throw new he(re.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}x.push(b)}return new eo(x,p)})(s._query,s.firestore._databaseId,e,t[0]._document,n);{const a=bl(s.firestore);return(function(u,h,m,p,x,w){const b=u.explicitOrderBy;if(x.length>b.length)throw new he(re.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let R=0;R<x.length;R++){const k=x[R];if(b[R].field.isKeyField()){if(typeof k!="string")throw new he(re.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof k}`);if(!wv(u)&&k.indexOf("/")!==-1)throw new he(re.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${k}' contains a slash.`);const U=u.path.child(tt.fromString(k));if(!Ne.isDocumentKey(U))throw new he(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${U}' is not because it contains an odd number of segments.`);const z=new Ne(U);E.push(il(h,z))}else{const U=Yj(m,p,k);E.push(U)}}return new eo(E,w)})(s._query,s.firestore._databaseId,a,e,t,n)}}function FT(s,e,t){if(typeof(t=mt(t))=="string"){if(t==="")throw new he(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wv(e)&&t.indexOf("/")!==-1)throw new he(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(tt.fromString(t));if(!Ne.isDocumentKey(n))throw new he(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return il(s,new Ne(n))}if(t instanceof At)return il(s,t._key);throw new he(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sg(t)}.`)}function UT(s,e){if(!Array.isArray(s)||s.length===0)throw new he(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function t1(s,e){const t=(function(a,l){for(const u of a)for(const h of u.getFlattenedFilters())if(l.indexOf(h.op)>=0)return h.op;return null})(s.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new he(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function n1(s,e){if(!(e instanceof fu||e instanceof _l))throw new he(re.INVALID_ARGUMENT,`Function ${s}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class fb{convertValue(e,t="none"){switch(Ji(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return io(e,((a,l)=>{n[a]=this.convertValue(l,t)})),n}convertVectorValue(e){const t=e.fields?.[Uc].arrayValue?.values?.map((n=>Gt(n.doubleValue)));return new yr(t)}convertGeoPoint(e){return new Fr(Gt(e.latitude),Gt(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=cg(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Yd(e));default:return null}}convertTimestamp(e){const t=Xa(e);return new wt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=tt.fromString(e);ke(UA(n),9688,{name:e});const a=new Wi(n.get(1),n.get(3)),l=new Ne(n.popFirst(5));return a.isEqual(t)||dn(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jg(s,e,t){let n;return n=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,n}class mb extends fb{constructor(e){super(),this.firestore=e}convertBytes(e){return new _s(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new At(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z6(s){return new Jc("sum",nh("sum",s))}function e3(s){return new Jc("avg",nh("average",s))}function s1(){return new Jc("count")}function t3(s,e){return s instanceof Jc&&e instanceof Jc&&s.aggregateType===e.aggregateType&&s._internalFieldPath?.canonicalString()===e._internalFieldPath?.canonicalString()}function n3(s,e){return rb(s.query,e.query)&&xr(s.data(),e.data())}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r1="NOT SUPPORTED";class za{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Is extends sh{constructor(e,t,n,a,l,u){super(e,t,n,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ud(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Sg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new he(re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Is._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}function s3(s,e,t){if(xl(e,Is._jsonSchema)){if(e.bundle===r1)throw new he(re.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const n=vl(s._databaseId),a=Oj(e.bundle,n),l=a.Wu(),u=new Qv(a.getMetadata(),n);for(const x of l)u.Ga(x);const h=u.documents;if(h.length!==1)throw new he(re.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${h.length} documents.`);const m=fg(n,h[0].document),p=new Ne(tt.fromString(e.bundleName));return new Is(s,new mb(s),p,m,new za(!1,!1),t||null)}}Is._jsonSchemaVersion="firestore/documentSnapshot/1.0",Is._jsonSchema={type:bn("string",Is._jsonSchemaVersion),bundleSource:bn("string","DocumentSnapshot"),bundleName:bn("string"),bundle:bn("string")};class Ud extends Is{data(e={}){return super.data(e)}}class Cs{constructor(e,t,n,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new za(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Ud(this._firestore,this._userDataWriter,n.key,n,new za(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new he(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((h=>{const m=new Ud(a._firestore,a._userDataWriter,h.doc.key,h.doc,new za(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);return h.doc,{type:"added",doc:m,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((h=>l||h.type!==3)).map((h=>{const m=new Ud(a._firestore,a._userDataWriter,h.doc.key,h.doc,new za(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);let p=-1,x=-1;return h.type!==0&&(p=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),x=u.indexOf(h.doc.key)),{type:a3(h.type),doc:m,oldIndex:p,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new he(re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Cs._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ng.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),n.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function r3(s,e,t){if(xl(e,Cs._jsonSchema)){if(e.bundle===r1)throw new he(re.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const n=vl(s._databaseId),a=Oj(e.bundle,n),l=a.Wu(),u=new Qv(a.getMetadata(),n);for(const b of l)u.Ga(b);if(u.queries.length!==1)throw new he(re.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${u.queries.length} queries.`);const h=gg(u.queries[0].bundledQuery),m=u.documents;let p=new tl;m.map((b=>{const E=fg(n,b.document);p=p.add(E)}));const x=ml.fromInitialDocuments(h,p,Xe(),!1,!1),w=new Cn(s,t||null,h);return new Cs(s,new mb(s),w,x)}}function a3(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae(61501,{type:s})}}function i3(s,e){return s instanceof Is&&e instanceof Is?s._firestore===e._firestore&&s._key.isEqual(e._key)&&(s._document===null?e._document===null:s._document.isEqual(e._document))&&s._converter===e._converter:s instanceof Cs&&e instanceof Cs&&s._firestore===e._firestore&&rb(s.query,e.query)&&s.metadata.isEqual(e.metadata)&&s._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(s){s=nt(s,At);const e=nt(s.firestore,Pt);return Pj(Qt(e),s._key).then((t=>gb(e,s,t)))}Cs._jsonSchemaVersion="firestore/querySnapshot/1.0",Cs._jsonSchema={type:bn("string",Cs._jsonSchemaVersion),bundleSource:bn("string","QuerySnapshot"),bundleName:bn("string"),bundle:bn("string")};class ho extends fb{constructor(e){super(),this.firestore=e}convertBytes(e){return new _s(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new At(this.firestore,null,t)}}function o3(s){s=nt(s,At);const e=nt(s.firestore,Pt),t=Qt(e),n=new ho(e);return b6(t,s._key).then((a=>new Is(e,n,s._key,a,new za(a!==null&&a.hasLocalMutations,!0),s.converter)))}function l3(s){s=nt(s,At);const e=nt(s.firestore,Pt);return Pj(Qt(e),s._key,{source:"server"}).then((t=>gb(e,s,t)))}function Ke(s){s=nt(s,Cn);const e=nt(s.firestore,Pt),t=Qt(e),n=new ho(e);return Zj(s._query),Mj(t,s._query).then((a=>new Cs(e,n,s,a)))}function c3(s){s=nt(s,Cn);const e=nt(s.firestore,Pt),t=Qt(e),n=new ho(e);return w6(t,s._query).then((a=>new Cs(e,n,s,a)))}function u3(s){s=nt(s,Cn);const e=nt(s.firestore,Pt),t=Qt(e),n=new ho(e);return Mj(t,s._query,{source:"server"}).then((a=>new Cs(e,n,s,a)))}function Rs(s,e,t){s=nt(s,At);const n=nt(s.firestore,Pt),a=jg(s.converter,e,t);return mu(n,[Tg(bl(n),"setDoc",s._key,a,s.converter!==null,t).toMutation(s._key,Kt.none())])}function $t(s,e,t,...n){s=nt(s,At);const a=nt(s.firestore,Pt),l=bl(a);let u;return u=typeof(e=mt(e))=="string"||e instanceof co?ub(l,"updateDoc",s._key,e,t,n):cb(l,"updateDoc",s._key,e),mu(a,[u.toMutation(s._key,Kt.exists(!0))])}function nl(s){return mu(nt(s.firestore,Pt),[new iu(s._key,Kt.none())])}function Ys(s,e){const t=nt(s.firestore,Pt),n=be(s),a=jg(s.converter,e);return mu(t,[Tg(bl(s.firestore),"addDoc",n._key,a,s.converter!==null,{}).toMutation(n._key,Kt.exists(!1))]).then((()=>n))}function qm(s,...e){s=mt(s);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Ic(e[n])||(t=e[n++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Ic(e[n])){const m=e[n];e[n]=m.next?.bind(m),e[n+1]=m.error?.bind(m),e[n+2]=m.complete?.bind(m)}let l,u,h;if(s instanceof At)u=nt(s.firestore,Pt),h=ru(s._key.path),l={next:m=>{e[n]&&e[n](gb(u,s,m))},error:e[n+1],complete:e[n+2]};else{const m=nt(s,Cn);u=nt(m.firestore,Pt),h=m._query;const p=new ho(u);l={next:x=>{e[n]&&e[n](new Cs(u,p,m,x))},error:e[n+1],complete:e[n+2]},Zj(s._query)}return(function(p,x,w,b){const E=new wg(b),R=new Kv(x,E,w);return p.asyncQueue.enqueueAndForget((async()=>Hv(await Wc(p),R))),()=>{E.Nu(),p.asyncQueue.enqueueAndForget((async()=>Gv(await Wc(p),R)))}})(Qt(u),h,a,l)}function d3(s,e,...t){const n=mt(s),a=(function(m){const p={bundle:"",bundleName:"",bundleSource:""},x=["bundle","bundleName","bundleSource"];for(const w of x){if(!(w in m)){p.error=`snapshotJson missing required field: ${w}`;break}const b=m[w];if(typeof b!="string"){p.error=`snapshotJson field '${w}' must be a string.`;break}if(b.length===0){p.error=`snapshotJson field '${w}' cannot be an empty string.`;break}w==="bundle"?p.bundle=b:w==="bundleName"?p.bundleName=b:w==="bundleSource"&&(p.bundleSource=b)}return p})(e);if(a.error)throw new he(re.INVALID_ARGUMENT,a.error);let l,u=0;if(typeof t[u]!="object"||Ic(t[u])||(l=t[u++]),a.bundleSource==="QuerySnapshot"){let h=null;if(typeof t[u]=="object"&&Ic(t[u])){const m=t[u++];h={next:m.next,error:m.error,complete:m.complete}}else h={next:t[u++],error:t[u++],complete:t[u++]};return(function(p,x,w,b,E){let R,k=!1;return qx(p,x.bundle).then((()=>Hj(p,x.bundleName))).then((z=>{z&&!k&&(E&&z.withConverter(E),R=qm(z,w||{},b))})).catch((z=>(b.error&&b.error(z),()=>{}))),()=>{k||(k=!0,R&&R())}})(n,a,l,h,t[u])}if(a.bundleSource==="DocumentSnapshot"){let h=null;if(typeof t[u]=="object"&&Ic(t[u])){const m=t[u++];h={next:m.next,error:m.error,complete:m.complete}}else h={next:t[u++],error:t[u++],complete:t[u++]};return(function(p,x,w,b,E){let R,k=!1;return qx(p,x.bundle).then((()=>{if(!k){const z=new At(p,E||null,Ne.fromPath(x.bundleName));R=qm(z,w||{},b)}})).catch((z=>(b.error&&b.error(z),()=>{}))),()=>{k||(k=!0,R&&R())}})(n,a,l,h,t[u])}throw new he(re.INVALID_ARGUMENT,`unsupported bundle source: ${a.bundleSource}`)}function h3(s,e){return N6(Qt(s=nt(s,Pt)),Ic(e)?e:{next:e})}function mu(s,e){return(function(n,a){const l=new Hn;return n.asyncQueue.enqueueAndForget((async()=>WP(await sb(n),a,l))),l.promise})(Qt(s),e)}function gb(s,e,t){const n=t.docs.get(e._key),a=new ho(s);return new Is(s,a,e._key,n,new za(t.hasPendingWrites,t.fromCache),e.converter)}function f3(s){return a1(s,{count:s1()})}function a1(s,e){const t=nt(s.firestore,Pt),n=Qt(t),a=zS(e,((l,u)=>new TA(u,l.aggregateType,l._internalFieldPath)));return _6(n,s._query,a).then((l=>(function(h,m,p){const x=new ho(h);return new Gj(m,x,p)})(t,s,l)))}class m3{constructor(e){this.kind="memory",this._onlineComponentProvider=no.provider,this._offlineComponentProvider=e?.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new eb(void 0)}}toJSON(){return{kind:this.kind}}}class g3{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=i1(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class p3{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Xc.provider}toJSON(){return{kind:this.kind}}}class y3{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new eb(e)}}toJSON(){return{kind:this.kind}}}function x3(){return new p3}function v3(s){return new y3(s?.cacheSizeBytes)}function b3(s){return new m3(s)}function w3(s){return new g3(s)}class _3{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=no.provider,this._offlineComponentProvider={build:t=>new tb(t,e?.cacheSizeBytes,this.forceOwnership)}}}class N3{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=no.provider,this._offlineComponentProvider={build:t=>new Cj(t,e?.cacheSizeBytes)}}}function i1(s){return new _3(s?.forceOwnership)}function T3(){return new N3}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=bl(e)}set(e,t,n){this._verifyNotCommitted();const a=qi(e,this._firestore),l=jg(a.converter,t,n),u=Tg(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,n);return this._mutations.push(u.toMutation(a._key,Kt.none())),this}update(e,t,n,...a){this._verifyNotCommitted();const l=qi(e,this._firestore);let u;return u=typeof(t=mt(t))=="string"||t instanceof co?ub(this._dataReader,"WriteBatch.update",l._key,t,n,a):cb(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(u.toMutation(l._key,Kt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=qi(e,this._firestore);return this._mutations=this._mutations.concat(new iu(t._key,Kt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new he(re.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function qi(s,e){if((s=mt(s)).firestore!==e)throw new he(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S3{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=bl(e)}get(e){const t=qi(e,this._firestore),n=new mb(this._firestore);return this._transaction.lookup([t._key]).then((a=>{if(!a||a.length!==1)return Ae(24041);const l=a[0];if(l.isFoundDocument())return new sh(this._firestore,n,l.key,l,t.converter);if(l.isNoDocument())return new sh(this._firestore,n,t._key,null,t.converter);throw Ae(18433,{doc:l})}))}set(e,t,n){const a=qi(e,this._firestore),l=jg(a.converter,t,n),u=Tg(this._dataReader,"Transaction.set",a._key,l,a.converter!==null,n);return this._transaction.set(a._key,u),this}update(e,t,n,...a){const l=qi(e,this._firestore);let u;return u=typeof(t=mt(t))=="string"||t instanceof co?ub(this._dataReader,"Transaction.update",l._key,t,n,a):cb(this._dataReader,"Transaction.update",l._key,t),this._transaction.update(l._key,u),this}delete(e){const t=qi(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1 extends S3{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=qi(e,this._firestore),n=new ho(this._firestore);return super.get(e).then((a=>new Is(this._firestore,n,t._key,a._document,new za(!1,!1),t.converter)))}}function Id(s,e,t){s=nt(s,Pt);const n={...E3,...t};return(function(l){if(l.maxAttempts<1)throw new he(re.INVALID_ARGUMENT,"Max attempts must be at least 1")})(n),(function(l,u,h){const m=new Hn;return l.asyncQueue.enqueueAndForget((async()=>{const p=await Dj(l);new p6(l.asyncQueue,p,h,u,m).ju()})),m.promise})(Qt(s),(a=>e(new l1(s,a))),n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A3(){return new bh("deleteField")}function Me(){return new ab("serverTimestamp")}function Zc(...s){return new ib("arrayUnion",s)}function zm(...s){return new ob("arrayRemove",s)}function mm(s){return new lb("increment",s)}function j3(s){return new yr(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(s){return Qt(s=nt(s,Pt)),new o1(s,(e=>mu(s,e)))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(s,e){const t=Qt(s=nt(s,Pt));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return Ws("Cannot enable indexes when persistence is disabled"),Promise.resolve();const n=(function(l){const u=typeof l=="string"?(function(p){try{return JSON.parse(p)}catch(x){throw new he(re.INVALID_ARGUMENT,"Failed to parse JSON: "+x?.message)}})(l):l,h=[];if(Array.isArray(u.indexes))for(const m of u.indexes){const p=BT(m,"collectionGroup"),x=[];if(Array.isArray(m.fields))for(const w of m.fields){const b=Eg("setIndexConfiguration",BT(w,"fieldPath"));w.arrayConfig==="CONTAINS"?x.push(new Zo(b,2)):w.order==="ASCENDING"?x.push(new Zo(b,0)):w.order==="DESCENDING"&&x.push(new Zo(b,1))}h.push(new Pc(Pc.UNKNOWN_ID,p,x,Mc.empty()))}return h})(e);return S6(t,n)}function BT(s,e){if(typeof s[e]!="string")throw new he(re.INVALID_ARGUMENT,"Missing string value for: "+e);return s[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function C3(s){s=nt(s,Pt);const e=qT.get(s);if(e)return e;if(Qt(s)._uninitializedComponentsProvider?._offline.kind!=="persistent")return null;const n=new c1(s);return qT.set(s,n),n}function R3(s){u1(s,!0)}function k3(s){u1(s,!1)}function D3(s){j6(Qt(s._firestore)).then((e=>pe("deleting all persistent cache indexes succeeded"))).catch((e=>Ws("deleting all persistent cache indexes failed",e)))}function u1(s,e){A6(Qt(s._firestore),e).then((t=>pe(`setting persistent cache index auto creation isEnabled=${e} succeeded`))).catch((t=>Ws(`setting persistent cache index auto creation isEnabled=${e} failed`,t)))}const qT=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P3(s){const e=Qt(nt(s.firestore,Pt)),t=e._onlineComponents?.datastore.serializer;return t===void 0?null:mg(t,cs(s._query)).ft}function M3(s,e){const t=zS(e,((l,u)=>new TA(u,l.aggregateType,l._internalFieldPath))),n=Qt(nt(s.firestore,Pt)),a=n._onlineComponents?.datastore.serializer;return a===void 0?null:OA(a,lA(s._query),t,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return pb.instance.onExistenceFilterMismatch(e)}}class pb{constructor(){this.Mc=new Map}static get instance(){return Yf||(Yf=new pb,(function(t){if(Ix)throw new Error("a TestingHooksSpi instance is already set");Ix=t})(Yf)),Yf}lt(e){this.Mc.forEach((t=>t(e)))}onExistenceFilterMismatch(e){const t=Symbol(),n=this.Mc;return n.set(t,e),()=>n.delete(t)}}let Yf=null;(function(e,t=!0){(function(a){su=a})(tu),Ur(new vr("firestore",((n,{instanceIdentifier:a,options:l})=>{const u=n.getProvider("app").getImmediate(),h=new Pt(new hD(n.getProvider("auth-internal")),new gD(u,n.getProvider("app-check-internal")),(function(p,x){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new he(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wi(p.options.projectId,x)})(u,a),u);return l={useFetchStreams:t,...l},h._setSettings(l),h}),"PUBLIC").setMultipleInstances(!0)),js(bN,wN,e),js(bN,wN,"esm2020")})();const ia=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:fb,AggregateField:Jc,AggregateQuerySnapshot:Gj,Bytes:_s,CACHE_SIZE_UNLIMITED:R6,CollectionReference:Lr,DocumentReference:At,DocumentSnapshot:Is,FieldPath:co,FieldValue:uo,Firestore:Pt,FirestoreError:he,GeoPoint:Fr,LoadBundleTask:Uj,PersistentCacheIndexManager:c1,Query:Cn,QueryCompositeFilterConstraint:_l,QueryConstraint:hu,QueryDocumentSnapshot:Ud,QueryEndAtConstraint:Nh,QueryFieldFilterConstraint:fu,QueryLimitConstraint:wh,QueryOrderByConstraint:Ag,QuerySnapshot:Cs,QueryStartAtConstraint:_h,SnapshotMetadata:za,Timestamp:wt,Transaction:l1,VectorValue:yr,WriteBatch:o1,_AutoId:ng,_ByteString:en,_DatabaseId:Wi,_DocumentKey:Ne,_EmptyAppCheckTokenProvider:pD,_EmptyAuthCredentialsProvider:_S,_FieldPath:Bt,_TestingHooks:O3,_cast:nt,_debugAssert:uD,_internalAggregationQueryToProtoRunAggregationQueryRequest:M3,_internalQueryToProtoQueryTarget:P3,_isBase64Available:ZD,_logWarn:Ws,_validateIsNotUsedTogether:TS,addDoc:Ys,aggregateFieldEqual:t3,aggregateQuerySnapshotEqual:n3,and:K6,arrayRemove:zm,arrayUnion:Zc,average:e3,clearIndexedDbPersistence:M6,collection:Ce,collectionGroup:I6,connectFirestoreEmulator:Fj,count:s1,deleteAllPersistentCacheIndexes:D3,deleteDoc:nl,deleteField:A3,disableNetwork:L6,disablePersistentCacheIndexAutoCreation:k3,doc:be,documentId:U6,documentSnapshotFromJSON:s3,enableIndexedDbPersistence:D6,enableMultiTabIndexedDbPersistence:P6,enableNetwork:V6,enablePersistentCacheIndexAutoCreation:R3,endAt:J6,endBefore:W6,ensureFirestoreConfigured:Qt,executeWrite:mu,getAggregateFromServer:a1,getCountFromServer:f3,getDoc:vt,getDocFromCache:o3,getDocFromServer:l3,getDocs:Ke,getDocsFromCache:c3,getDocsFromServer:u3,getFirestore:Bj,getPersistentCacheIndexManager:C3,increment:mm,initializeFirestore:k6,limit:Zt,limitToLast:Q6,loadBundle:qx,memoryEagerGarbageCollector:x3,memoryLocalCache:b3,memoryLruGarbageCollector:v3,namedQuery:Hj,onSnapshot:qm,onSnapshotResume:d3,onSnapshotsInSync:h3,or:$6,orderBy:Jt,persistentLocalCache:w3,persistentMultipleTabManager:T3,persistentSingleTabManager:i1,query:Le,queryEqual:rb,querySnapshotFromJSON:r3,refEqual:C6,runTransaction:Id,serverTimestamp:Me,setDoc:Rs,setIndexConfiguration:I3,setLogLevel:cD,snapshotEqual:i3,startAfter:X6,startAt:Y6,sum:Z6,terminate:F6,updateDoc:$t,vector:j3,waitForPendingWrites:O6,where:Ye,writeBatch:sl},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V3="type.googleapis.com/google.protobuf.Int64Value",L3="type.googleapis.com/google.protobuf.UInt64Value";function d1(s,e){const t={};for(const n in s)s.hasOwnProperty(n)&&(t[n]=e(s[n]));return t}function Hm(s){if(s==null)return null;if(s instanceof Number&&(s=s.valueOf()),typeof s=="number"&&isFinite(s)||s===!0||s===!1||Object.prototype.toString.call(s)==="[object String]")return s;if(s instanceof Date)return s.toISOString();if(Array.isArray(s))return s.map(e=>Hm(e));if(typeof s=="function"||typeof s=="object")return d1(s,e=>Hm(e));throw new Error("Data cannot be encoded in JSON: "+s)}function eu(s){if(s==null)return s;if(s["@type"])switch(s["@type"]){case V3:case L3:{const e=Number(s.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+s);return e}default:throw new Error("Data cannot be decoded from JSON: "+s)}return Array.isArray(s)?s.map(e=>eu(e)):typeof s=="function"||typeof s=="object"?d1(s,e=>eu(e)):s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ss extends wr{constructor(e,t,n){super(`${yb}/${e}`,t||""),this.details=n,Object.setPrototypeOf(this,Ss.prototype)}}function F3(s){if(s>=200&&s<300)return"ok";switch(s){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Gm(s,e){let t=F3(s),n=t,a;try{const l=e&&e.error;if(l){const u=l.status;if(typeof u=="string"){if(!zT[u])return new Ss("internal","internal");t=zT[u],n=u}const h=l.message;typeof h=="string"&&(n=h),a=l.details,a!==void 0&&(a=eu(a))}}catch{}return t==="ok"?null:new Ss(t,n,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e,t,n,a){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Qs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(l=>this.auth=l,()=>{}),this.messaging||n.get().then(l=>this.messaging=l,()=>{}),this.appCheck||a?.get().then(l=>this.appCheck=l,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),n=await this.getMessagingToken(),a=await this.getAppCheckToken(e);return{authToken:t,messagingToken:n,appCheckToken:a}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx="us-central1",B3=/^data: (.*?)(?:\n|$)/;function q3(s){let e=null;return{promise:new Promise((t,n)=>{e=setTimeout(()=>{n(new Ss("deadline-exceeded","deadline-exceeded"))},s)}),cancel:()=>{e&&clearTimeout(e)}}}class z3{constructor(e,t,n,a,l=zx,u=(...h)=>fetch(...h)){this.app=e,this.fetchImpl=u,this.emulatorOrigin=null,this.contextProvider=new U3(e,t,n,a),this.cancelAllRequests=new Promise(h=>{this.deleteService=()=>Promise.resolve(h())});try{const h=new URL(l);this.customDomain=h.origin+(h.pathname==="/"?"":h.pathname),this.region=zx}catch{this.customDomain=null,this.region=l}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function H3(s,e,t){const n=Za(e);s.emulatorOrigin=`http${n?"s":""}://${e}:${t}`,n&&(Xm(s.emulatorOrigin+"/backends"),Wx("Functions",!0))}function G3(s,e,t){const n=a=>K3(s,e,a,{});return n.stream=(a,l)=>Y3(s,e,a,l),n}function h1(s){return s.emulatorOrigin&&Za(s.emulatorOrigin)?"include":void 0}async function $3(s,e,t,n,a){t["Content-Type"]="application/json";let l;try{l=await n(s,{method:"POST",body:JSON.stringify(e),headers:t,credentials:h1(a)})}catch{return{status:0,json:null}}let u=null;try{u=await l.json()}catch{}return{status:l.status,json:u}}async function f1(s,e){const t={},n=await s.contextProvider.getContext(e.limitedUseAppCheckTokens);return n.authToken&&(t.Authorization="Bearer "+n.authToken),n.messagingToken&&(t["Firebase-Instance-ID-Token"]=n.messagingToken),n.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=n.appCheckToken),t}function K3(s,e,t,n){const a=s._url(e);return Q3(s,a,t,n)}async function Q3(s,e,t,n){t=Hm(t);const a={data:t},l=await f1(s,n),u=n.timeout||7e4,h=q3(u),m=await Promise.race([$3(e,a,l,s.fetchImpl,s),h.promise,s.cancelAllRequests]);if(h.cancel(),!m)throw new Ss("cancelled","Firebase Functions instance was deleted.");const p=Gm(m.status,m.json);if(p)throw p;if(!m.json)throw new Ss("internal","Response is not valid JSON object.");let x=m.json.data;if(typeof x>"u"&&(x=m.json.result),typeof x>"u")throw new Ss("internal","Response is missing data field.");return{data:eu(x)}}function Y3(s,e,t,n){const a=s._url(e);return X3(s,a,t,n||{})}async function X3(s,e,t,n){t=Hm(t);const a={data:t},l=await f1(s,n);l["Content-Type"]="application/json",l.Accept="text/event-stream";let u;try{u=await s.fetchImpl(e,{method:"POST",body:JSON.stringify(a),headers:l,signal:n?.signal,credentials:h1(s)})}catch(b){if(b instanceof Error&&b.name==="AbortError"){const R=new Ss("cancelled","Request was cancelled.");return{data:Promise.reject(R),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(R)}}}}}}const E=Gm(0,null);return{data:Promise.reject(E),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(E)}}}}}}let h,m;const p=new Promise((b,E)=>{h=b,m=E});n?.signal?.addEventListener("abort",()=>{const b=new Ss("cancelled","Request was cancelled.");m(b)});const x=u.body.getReader(),w=W3(x,h,m,n?.signal);return{stream:{[Symbol.asyncIterator](){const b=w.getReader();return{async next(){const{value:E,done:R}=await b.read();return{value:E,done:R}},async return(){return await b.cancel(),{done:!0,value:void 0}}}}},data:p}}function W3(s,e,t,n){const a=(u,h)=>{const m=u.match(B3);if(!m)return;const p=m[1];try{const x=JSON.parse(p);if("result"in x){e(eu(x.result));return}if("message"in x){h.enqueue(eu(x.message));return}if("error"in x){const w=Gm(0,x);h.error(w),t(w);return}}catch(x){if(x instanceof Ss){h.error(x),t(x);return}}},l=new TextDecoder;return new ReadableStream({start(u){let h="";return m();async function m(){if(n?.aborted){const p=new Ss("cancelled","Request was cancelled");return u.error(p),t(p),Promise.resolve()}try{const{value:p,done:x}=await s.read();if(x){h.trim()&&a(h.trim(),u),u.close();return}if(n?.aborted){const b=new Ss("cancelled","Request was cancelled");u.error(b),t(b),await s.cancel();return}h+=l.decode(p,{stream:!0});const w=h.split(`
`);h=w.pop()||"";for(const b of w)b.trim()&&a(b.trim(),u);return m()}catch(p){const x=p instanceof Ss?p:Gm(0,null);u.error(x),t(x)}}},cancel(){return s.cancel()}})}const HT="@firebase/functions",GT="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J3="auth-internal",Z3="app-check-internal",eM="messaging-internal";function tM(s){const e=(t,{instanceIdentifier:n})=>{const a=t.getProvider("app").getImmediate(),l=t.getProvider(J3),u=t.getProvider(eM),h=t.getProvider(Z3);return new z3(a,l,u,h,n)};Ur(new vr(yb,e,"PUBLIC").setMultipleInstances(!0)),js(HT,GT,s),js(HT,GT,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nM(s=Jm(),e=zx){const n=ma(mt(s),yb).getImmediate({identifier:e}),a=bE("functions");return a&&sM(n,...a),n}function sM(s,e,t){H3(mt(s),e,t)}function zi(s,e,t){return G3(mt(s),e)}tM();const m1="@firebase/installations",xb="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1=1e4,p1=`w:${xb}`,y1="FIS_v2",rM="https://firebaseinstallations.googleapis.com/v1",aM=3600*1e3,iM="installations",oM="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},gl=new yl(iM,oM,lM);function x1(s){return s instanceof wr&&s.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1({projectId:s}){return`${rM}/projects/${s}/installations`}function b1(s){return{token:s.token,requestStatus:2,expiresIn:uM(s.expiresIn),creationTime:Date.now()}}async function w1(s,e){const n=(await e.json()).error;return gl.create("request-failed",{requestName:s,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function _1({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function cM(s,{refreshToken:e}){const t=_1(s);return t.append("Authorization",dM(e)),t}async function N1(s){const e=await s();return e.status>=500&&e.status<600?s():e}function uM(s){return Number(s.replace("s","000"))}function dM(s){return`${y1} ${s}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hM({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const n=v1(s),a=_1(s),l=e.getImmediate({optional:!0});if(l){const p=await l.getHeartbeatsHeader();p&&a.append("x-firebase-client",p)}const u={fid:t,authVersion:y1,appId:s.appId,sdkVersion:p1},h={method:"POST",headers:a,body:JSON.stringify(u)},m=await N1(()=>fetch(n,h));if(m.ok){const p=await m.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:b1(p.authToken)}}else throw await w1("Create Installation",m)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(s){return new Promise(e=>{setTimeout(e,s)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fM(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mM=/^[cdef][\w-]{21}$/,Hx="";function gM(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=pM(s);return mM.test(t)?t:Hx}catch{return Hx}}function pM(s){return fM(s).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(s){return`${s.appName}!${s.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1=new Map;function S1(s,e){const t=Ig(s);A1(t,e),yM(t,e)}function A1(s,e){const t=E1.get(s);if(t)for(const n of t)n(e)}function yM(s,e){const t=xM();t&&t.postMessage({key:s,fid:e}),vM()}let Jo=null;function xM(){return!Jo&&"BroadcastChannel"in self&&(Jo=new BroadcastChannel("[Firebase] FID Change"),Jo.onmessage=s=>{A1(s.data.key,s.data.fid)}),Jo}function vM(){E1.size===0&&Jo&&(Jo.close(),Jo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bM="firebase-installations-database",wM=1,pl="firebase-installations-store";let Wy=null;function vb(){return Wy||(Wy=CE(bM,wM,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(pl)}}})),Wy}async function $m(s,e){const t=Ig(s),a=(await vb()).transaction(pl,"readwrite"),l=a.objectStore(pl),u=await l.get(t);return await l.put(e,t),await a.done,(!u||u.fid!==e.fid)&&S1(s,e.fid),e}async function j1(s){const e=Ig(s),n=(await vb()).transaction(pl,"readwrite");await n.objectStore(pl).delete(e),await n.done}async function Cg(s,e){const t=Ig(s),a=(await vb()).transaction(pl,"readwrite"),l=a.objectStore(pl),u=await l.get(t),h=e(u);return h===void 0?await l.delete(t):await l.put(h,t),await a.done,h&&(!u||u.fid!==h.fid)&&S1(s,h.fid),h}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bb(s){let e;const t=await Cg(s.appConfig,n=>{const a=_M(n),l=NM(s,a);return e=l.registrationPromise,l.installationEntry});return t.fid===Hx?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function _M(s){const e=s||{fid:gM(),registrationStatus:0};return I1(e)}function NM(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(gl.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=TM(s,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:EM(s)}:{installationEntry:e}}async function TM(s,e){try{const t=await hM(s,e);return $m(s.appConfig,t)}catch(t){throw x1(t)&&t.customData.serverCode===409?await j1(s.appConfig):await $m(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function EM(s){let e=await $T(s.appConfig);for(;e.registrationStatus===1;)await T1(100),e=await $T(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await bb(s);return n||t}return e}function $T(s){return Cg(s,e=>{if(!e)throw gl.create("installation-not-found");return I1(e)})}function I1(s){return SM(s)?{fid:s.fid,registrationStatus:0}:s}function SM(s){return s.registrationStatus===1&&s.registrationTime+g1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AM({appConfig:s,heartbeatServiceProvider:e},t){const n=jM(s,t),a=cM(s,t),l=e.getImmediate({optional:!0});if(l){const p=await l.getHeartbeatsHeader();p&&a.append("x-firebase-client",p)}const u={installation:{sdkVersion:p1,appId:s.appId}},h={method:"POST",headers:a,body:JSON.stringify(u)},m=await N1(()=>fetch(n,h));if(m.ok){const p=await m.json();return b1(p)}else throw await w1("Generate Auth Token",m)}function jM(s,{fid:e}){return`${v1(s)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wb(s,e=!1){let t;const n=await Cg(s.appConfig,l=>{if(!C1(l))throw gl.create("not-registered");const u=l.authToken;if(!e&&RM(u))return l;if(u.requestStatus===1)return t=IM(s,e),l;{if(!navigator.onLine)throw gl.create("app-offline");const h=DM(l);return t=CM(s,h),h}});return t?await t:n.authToken}async function IM(s,e){let t=await KT(s.appConfig);for(;t.authToken.requestStatus===1;)await T1(100),t=await KT(s.appConfig);const n=t.authToken;return n.requestStatus===0?wb(s,e):n}function KT(s){return Cg(s,e=>{if(!C1(e))throw gl.create("not-registered");const t=e.authToken;return PM(t)?{...e,authToken:{requestStatus:0}}:e})}async function CM(s,e){try{const t=await AM(s,e),n={...e,authToken:t};return await $m(s.appConfig,n),t}catch(t){if(x1(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await j1(s.appConfig);else{const n={...e,authToken:{requestStatus:0}};await $m(s.appConfig,n)}throw t}}function C1(s){return s!==void 0&&s.registrationStatus===2}function RM(s){return s.requestStatus===2&&!kM(s)}function kM(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+aM}function DM(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function PM(s){return s.requestStatus===1&&s.requestTime+g1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MM(s){const e=s,{installationEntry:t,registrationPromise:n}=await bb(e);return n?n.catch(console.error):wb(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OM(s,e=!1){const t=s;return await VM(t),(await wb(t,e)).token}async function VM(s){const{registrationPromise:e}=await bb(s);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LM(s){if(!s||!s.options)throw Jy("App Configuration");if(!s.name)throw Jy("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw Jy(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function Jy(s){return gl.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1="installations",FM="installations-internal",UM=s=>{const e=s.getProvider("app").getImmediate(),t=LM(e),n=ma(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},BM=s=>{const e=s.getProvider("app").getImmediate(),t=ma(e,R1).getImmediate();return{getId:()=>MM(t),getToken:a=>OM(t,a)}};function qM(){Ur(new vr(R1,UM,"PUBLIC")),Ur(new vr(FM,BM,"PRIVATE"))}qM();js(m1,xb);js(m1,xb,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="analytics",zM="firebase_id",HM="origin",GM=60*1e3,$M="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",_b="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks=new Wm("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Xs=new yl("analytics","Analytics",KM);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QM(s){if(!s.startsWith(_b)){const e=Xs.create("invalid-gtag-resource",{gtagURL:s});return ks.warn(e.message),""}return s}function k1(s){return Promise.all(s.map(e=>e.catch(t=>t)))}function YM(s,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(s,e)),t}function XM(s,e){const t=YM("firebase-js-sdk-policy",{createScriptURL:QM}),n=document.createElement("script"),a=`${_b}?l=${s}&id=${e}`;n.src=t?t?.createScriptURL(a):a,n.async=!0,document.head.appendChild(n)}function WM(s){let e=[];return Array.isArray(window[s])?e=window[s]:window[s]=e,e}async function JM(s,e,t,n,a,l){const u=n[a];try{if(u)await e[u];else{const m=(await k1(t)).find(p=>p.measurementId===a);m&&await e[m.appId]}}catch(h){ks.error(h)}s("config",a,l)}async function ZM(s,e,t,n,a){try{let l=[];if(a&&a.send_to){let u=a.send_to;Array.isArray(u)||(u=[u]);const h=await k1(t);for(const m of u){const p=h.find(w=>w.measurementId===m),x=p&&e[p.appId];if(x)l.push(x);else{l=[];break}}}l.length===0&&(l=Object.values(e)),await Promise.all(l),s("event",n,a||{})}catch(l){ks.error(l)}}function e5(s,e,t,n){async function a(l,...u){try{if(l==="event"){const[h,m]=u;await ZM(s,e,t,h,m)}else if(l==="config"){const[h,m]=u;await JM(s,e,t,n,h,m)}else if(l==="consent"){const[h,m]=u;s("consent",h,m)}else if(l==="get"){const[h,m,p]=u;s("get",h,m,p)}else if(l==="set"){const[h]=u;s("set",h)}else s(l,...u)}catch(h){ks.error(h)}}return a}function t5(s,e,t,n,a){let l=function(...u){window[n].push(arguments)};return window[a]&&typeof window[a]=="function"&&(l=window[a]),window[a]=e5(l,s,e,t),{gtagCore:l,wrappedGtag:window[a]}}function n5(s){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(_b)&&t.src.includes(s))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5=30,r5=1e3;class a5{constructor(e={},t=r5){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const D1=new a5;function i5(s){return new Headers({Accept:"application/json","x-goog-api-key":s})}async function o5(s){const{appId:e,apiKey:t}=s,n={method:"GET",headers:i5(t)},a=$M.replace("{app-id}",e),l=await fetch(a,n);if(l.status!==200&&l.status!==304){let u="";try{const h=await l.json();h.error?.message&&(u=h.error.message)}catch{}throw Xs.create("config-fetch-failed",{httpStatus:l.status,responseMessage:u})}return l.json()}async function l5(s,e=D1,t){const{appId:n,apiKey:a,measurementId:l}=s.options;if(!n)throw Xs.create("no-app-id");if(!a){if(l)return{measurementId:l,appId:n};throw Xs.create("no-api-key")}const u=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new d5;return setTimeout(async()=>{h.abort()},GM),P1({appId:n,apiKey:a,measurementId:l},u,h,e)}async function P1(s,{throttleEndTimeMillis:e,backoffCount:t},n,a=D1){const{appId:l,measurementId:u}=s;try{await c5(n,e)}catch(h){if(u)return ks.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${h?.message}]`),{appId:l,measurementId:u};throw h}try{const h=await o5(s);return a.deleteThrottleMetadata(l),h}catch(h){const m=h;if(!u5(m)){if(a.deleteThrottleMetadata(l),u)return ks.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${m?.message}]`),{appId:l,measurementId:u};throw h}const p=Number(m?.customData?.httpStatus)===503?K_(t,a.intervalMillis,s5):K_(t,a.intervalMillis),x={throttleEndTimeMillis:Date.now()+p,backoffCount:t+1};return a.setThrottleMetadata(l,x),ks.debug(`Calling attemptFetch again in ${p} millis`),P1(s,x,n,a)}}function c5(s,e){return new Promise((t,n)=>{const a=Math.max(e-Date.now(),0),l=setTimeout(t,a);s.addEventListener(()=>{clearTimeout(l),n(Xs.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function u5(s){if(!(s instanceof wr)||!s.customData)return!1;const e=Number(s.customData.httpStatus);return e===429||e===500||e===503||e===504}class d5{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function h5(s,e,t,n,a){if(a&&a.global){s("event",t,n);return}else{const l=await e,u={...n,send_to:l};s("event",t,u)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f5(){if(Jx())try{await AE()}catch(s){return ks.warn(Xs.create("indexeddb-unavailable",{errorInfo:s?.toString()}).message),!1}else return ks.warn(Xs.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function m5(s,e,t,n,a,l,u){const h=l5(s);h.then(b=>{t[b.measurementId]=b.appId,s.options.measurementId&&b.measurementId!==s.options.measurementId&&ks.warn(`The measurement ID in the local Firebase config (${s.options.measurementId}) does not match the measurement ID fetched from the server (${b.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(b=>ks.error(b)),e.push(h);const m=f5().then(b=>{if(b)return n.getId()}),[p,x]=await Promise.all([h,m]);n5(l)||XM(l,p.measurementId),a("js",new Date);const w=u?.config??{};return w[HM]="firebase",w.update=!0,x!=null&&(w[zM]=x),a("config",p.measurementId,w),p.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g5=class{constructor(e){this.app=e}_delete(){return delete Bd[this.app.options.appId],Promise.resolve()}},Bd={},QT=[];const YT={};let Zy="dataLayer",p5="gtag",XT,M1,WT=!1;function y5(){const s=[];if(TE()&&s.push("This is a browser extension environment."),BI()||s.push("Cookies are not available."),s.length>0){const e=s.map((n,a)=>`(${a+1}) ${n}`).join(" "),t=Xs.create("invalid-analytics-context",{errorInfo:e});ks.warn(t.message)}}function x5(s,e,t){y5();const n=s.options.appId;if(!n)throw Xs.create("no-app-id");if(!s.options.apiKey)if(s.options.measurementId)ks.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${s.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Xs.create("no-api-key");if(Bd[n]!=null)throw Xs.create("already-exists",{id:n});if(!WT){WM(Zy);const{wrappedGtag:l,gtagCore:u}=t5(Bd,QT,YT,Zy,p5);M1=l,XT=u,WT=!0}return Bd[n]=m5(s,QT,YT,e,XT,Zy,t),new g5(s)}function v5(s=Jm()){s=mt(s);const e=ma(s,Km);return e.isInitialized()?e.getImmediate():b5(s)}function b5(s,e={}){const t=ma(s,Km);if(t.isInitialized()){const a=t.getImmediate();if(xr(e,t.getOptions()))return a;throw Xs.create("already-initialized")}return t.initialize({options:e})}function aa(s,e,t,n){s=mt(s),h5(M1,Bd[s.app.options.appId],e,t,n).catch(a=>ks.error(a))}const JT="@firebase/analytics",ZT="0.10.18";function w5(){Ur(new vr(Km,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return x5(n,a,t)},"PUBLIC")),Ur(new vr("analytics-internal",s,"PRIVATE")),js(JT,ZT),js(JT,ZT,"esm2020");function s(e){try{const t=e.getProvider(Km).getImmediate();return{logEvent:(n,a,l)=>aa(t,n,a,l)}}catch(t){throw Xs.create("interop-component-reg-failed",{reason:t})}}}w5();const _5={apiKey:"AIzaSyDQnrbvsx52ikiWELf6hc4YiXQTC1G5tpY",authDomain:"three-sided-flashcard-app.firebaseapp.com",projectId:"three-sided-flashcard-app",storageBucket:"three-sided-flashcard-app.firebasestorage.app",messagingSenderId:"47503676879",appId:"1:47503676879:web:27fb875159cc4459a12eba",measurementId:"G-PBP1G21Q29"},Rg=RE(_5),ws=aD(Rg),te=Bj(Rg),Ha=nM(Rg),jn=v5(Rg),Ga=Object.freeze(Object.defineProperty({__proto__:null,analytics:jn,auth:ws,db:te,functions:Ha},Symbol.toStringTag,{value:"Module"}));class Ks{static sanitizeInput(e,t={}){if(!e||typeof e!="string")return"";const{maxLength:n=1e4,allowHtml:a=!1,allowLatex:l=!0,stripScripts:u=!0,stripUrls:h=!1}=t;let m=e;return m.length>n&&(m=m.substring(0,n)),(!a||u)&&(m=m.replace(/<script[^>]*>.*?<\/script>/gi,""),m=m.replace(/on\w+\s*=\s*["'][^"']*["']/gi,""),m=m.replace(/javascript:/gi,""),a||(m=m.replace(/data:/gi,"")),["script","iframe","object","embed","form","input","textarea","button"].forEach(x=>{const w=new RegExp(`<${x}[^>]*>.*?</${x}>`,"gi");m=m.replace(w,"");const b=new RegExp(`<${x}[^>]*/?>`,"gi");m=m.replace(b,"")})),h&&(m=m.replace(/https?:\/\/[^\s]+/gi,"[URL_REMOVED]")),m.trim()}static validateFlashcardInput(e){const t=[],n={};if(!e.statement||typeof e.statement!="string"?t.push("Statement is required and must be text"):e.statement.length<3?t.push("Statement must be at least 3 characters long"):e.statement.length>5e3?t.push("Statement must be less than 5000 characters"):n.statement=this.sanitizeInput(e.statement,{maxLength:5e3,allowLatex:!0,allowHtml:!1}),e.hints&&typeof e.hints=="string"&&(e.hints.length>5e3?t.push("Hints must be less than 5000 characters"):n.hints=this.sanitizeInput(e.hints,{maxLength:5e3,allowLatex:!0,allowHtml:!1})),e.proof&&typeof e.proof=="string"&&(e.proof.length>1e4?t.push("Proof must be less than 10000 characters"):n.proof=this.sanitizeInput(e.proof,{maxLength:1e4,allowLatex:!0,allowHtml:!1})),e.tags)if(typeof e.tags=="string"){const a=e.tags.split(",").map(l=>l.trim()).filter(l=>l);a.length>20&&t.push("Maximum 20 tags allowed"),n.tags=a.map(l=>this.sanitizeInput(l,{maxLength:50,allowLatex:!1,allowHtml:!1})).filter(l=>l&&/^[a-zA-Z0-9\s\-_]+$/.test(l))}else Array.isArray(e.tags)&&(e.tags.length>20&&t.push("Maximum 20 tags allowed"),n.tags=e.tags.slice(0,20).map(a=>this.sanitizeInput(String(a),{maxLength:50,allowLatex:!1,allowHtml:!1})).filter(a=>a&&/^[a-zA-Z0-9\s\-_]+$/.test(a)));return e.subject&&typeof e.subject=="string"&&(e.subject.length>100?t.push("Subject must be less than 100 characters"):n.subject=this.sanitizeInput(e.subject,{maxLength:100,allowLatex:!1,allowHtml:!1})),n.isPublic=!!e.isPublic,{isValid:t.length===0,errors:t,sanitizedData:t.length===0?n:null}}static validateProfileInput(e){const t=[],n={};return!e.displayName||typeof e.displayName!="string"?t.push("Display name is required"):e.displayName.length<2?t.push("Display name must be at least 2 characters"):e.displayName.length>50?t.push("Display name must be less than 50 characters"):/^[a-zA-Z0-9\s\-_\.]+$/.test(e.displayName)?n.displayName=this.sanitizeInput(e.displayName,{maxLength:50,allowLatex:!1,allowHtml:!1}):t.push("Display name can only contain letters, numbers, spaces, hyphens, underscores, and periods"),e.bio&&typeof e.bio=="string"&&(e.bio.length>500?t.push("Bio must be less than 500 characters"):n.bio=this.sanitizeInput(e.bio,{maxLength:500,allowLatex:!1,allowHtml:!1})),e.subject&&typeof e.subject=="string"&&(e.subject.length>100?t.push("Subject must be less than 100 characters"):n.subject=this.sanitizeInput(e.subject,{maxLength:100,allowLatex:!1,allowHtml:!1})),{isValid:t.length===0,errors:t,sanitizedData:t.length===0?n:null}}static rateLimiter=new Map;static checkRateLimit(e,t=10,n=6e4){const a=Date.now(),u=(this.rateLimiter.get(e)||[]).filter(h=>a-h<n);return u.length>=t?{allowed:!1,retryAfter:n-(a-u[0]),message:`Rate limit exceeded. Try again in ${Math.ceil((n-(a-u[0]))/1e3)} seconds.`}:(u.push(a),this.rateLimiter.set(e,u),{allowed:!0,remaining:t-u.length})}static getPublicErrorMessage(e,t=!0){if(!t)return e.message||"Unknown error";const n={"auth/user-not-found":"Invalid email or password","auth/wrong-password":"Invalid email or password","auth/email-already-in-use":"An account with this email already exists","auth/weak-password":"Password should be at least 6 characters","auth/invalid-email":"Please enter a valid email address","auth/user-disabled":"This account has been disabled","auth/too-many-requests":"Too many failed attempts. Please try again later","auth/network-request-failed":"Network error. Please check your connection","auth/popup-closed-by-user":"Sign-in was cancelled","auth/popup-blocked":"Sign-in popup was blocked. Please disable popup blockers","permission-denied":"You don't have permission to perform this action","not-found":"The requested item was not found","already-exists":"This item already exists","resource-exhausted":"Service temporarily unavailable. Please try again","failed-precondition":"Unable to complete request. Please try again",aborted:"Request was cancelled. Please try again","out-of-range":"Request parameters are invalid",unimplemented:"This feature is not yet available",internal:"Internal error. Please try again",unavailable:"Service temporarily unavailable. Please try again","data-loss":"Data error occurred. Please contact support","functions/invalid-argument":"Invalid request parameters","functions/failed-precondition":"Unable to process request","functions/out-of-range":"Request parameters are out of range","functions/unauthenticated":"Please sign in to continue","functions/permission-denied":"You don't have permission for this action","functions/not-found":"Requested service not found","functions/already-exists":"Resource already exists","functions/resource-exhausted":"Service limit reached. Please try again later","functions/cancelled":"Request was cancelled","functions/unknown":"An unexpected error occurred","functions/deadline-exceeded":"Request timed out. Please try again","validation-error":"Please check your input and try again","rate-limit-exceeded":"Too many requests. Please wait and try again","content-too-long":"Content is too long. Please shorten and try again","invalid-content":"Content contains invalid characters","network-error":"Network error. Please check your connection"},a=e.code||e.name||"unknown";return n[a]||"Something went wrong. Please try again"}static INACTIVITY_TIMEOUT=7200*1e3;static lastActivity=Date.now();static timeoutWarningShown=!1;static updateActivity(){this.lastActivity=Date.now(),this.timeoutWarningShown=!1}static checkInactivity(e,t){const n=Date.now()-this.lastActivity;return n>this.INACTIVITY_TIMEOUT*.83&&!this.timeoutWarningShown&&(this.timeoutWarningShown=!0,e&&e()),n>this.INACTIVITY_TIMEOUT?(t&&t(),!0):!1}static setupActivityTracking(e,t){["mousedown","mousemove","keypress","scroll","touchstart","click"].forEach(a=>{document.addEventListener(a,this.updateActivity.bind(this),{passive:!0})}),setInterval(()=>{this.checkInactivity(e,t)},6e4)}static detectSuspiciousContent(e){const t=[/<script[\s\S]*?>[\s\S]*?<\/script>/gi,/javascript:/gi,/vbscript:/gi,/onload\s*=/gi,/onerror\s*=/gi,/onclick\s*=/gi,/union\s+select/gi,/drop\s+table/gi,/delete\s+from/gi,/data:text\/html/gi,/data:application/gi,/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g],n=[];return t.forEach((a,l)=>{const u=e.match(a);u&&n.push({pattern:l,matches:u.length,content:u[0]})}),{isSuspicious:n.length>0,findings:n}}static generateSecureId(e=32){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n="";const a=new Uint8Array(e);crypto.getRandomValues(a);for(let l=0;l<e;l++)n+=t[a[l]%t.length];return n}static async hashForLogging(e){const n=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(u=>u.toString(16).padStart(2,"0")).join("")}}const O1=M.createContext(void 0),eE=s=>{switch(s){case"auth/popup-closed-by-user":return"Sign-in popup was closed.";case"auth/cancelled-popup-request":return"Another sign-in is in progress.";case"auth/popup-blocked":return"Popup blocked by the browser. Try again or disable the blocker.";case"auth/network-request-failed":return"Network error. Check your connection and try again.";case"auth/user-disabled":return"This account has been disabled.";default:return"Sign-in failed. Please try again."}},wn=()=>{const s=M.useContext(O1);if(!s)throw new Error("useAuth must be used within <AuthProvider>");return s},N5=({children:s,fallback:e=null})=>{const[t,n]=M.useState(null),[a,l]=M.useState(null),[u,h]=M.useState(!0),[m,p]=M.useState(null),[x,w]=M.useState(!1),b=M.useRef(!1);M.useEffect(()=>{GR(ws,sS).catch(B=>{console.warn("Auth persistence failed, falling back to default:",B)})},[]),M.useEffect(()=>{const B=KR(ws,G=>{n(G),b.current||(b.current=!0,h(!1))}),q=eS(ws,async G=>{if(G)try{const Y=await G.getIdToken(!1);l(Y)}catch(Y){console.warn("Failed to get ID token:",Y),l(null)}else l(null)});return()=>{B(),q()}},[]);const E=async()=>{if(!ws.currentUser)return null;try{const B=await ws.currentUser.getIdToken(!0);return l(B),B}catch(B){return console.warn("getFreshIdToken error:",B),null}},R=async()=>{p(null);const B=new Va;B.setCustomParameters({prompt:"select_account"});try{return(await fk(ws,B)).user}catch(q){if(q?.code==="auth/popup-blocked"||q?.code==="auth/popup-closed-by-user"||q?.code==="auth/cancelled-popup-request")try{return await vk(ws,B),null}catch(G){throw p(eE(G.code)),G}throw p(eE(q.code)),q}},k=async()=>{p(null);try{await QR(ws)}catch(B){throw p("Error signing out. Please try again."),B}};M.useEffect(()=>{if(t){const B=()=>{w(!0)},q=()=>{alert("Your session has expired due to inactivity. Please sign in again."),k()};Ks.setupActivityTracking(B,q)}},[t]);const U=()=>{w(!1),Ks.updateActivity()},z=M.useMemo(()=>({user:t,idToken:a,loading:u,authError:m,sessionWarning:x,dismissSessionWarning:U,signInWithGoogle:R,logout:k,getFreshIdToken:E}),[t,a,u,m,x]);return i.jsx(O1.Provider,{value:z,children:u?e:s})},T5="modulepreload",E5=function(s){return"/new/"+s},tE={},vn=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){let p=function(x){return Promise.all(x.map(w=>Promise.resolve(w).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};var u=p;document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),m=h?.nonce||h?.getAttribute("nonce");a=p(t.map(x=>{if(x=E5(x),x in tE)return;tE[x]=!0;const w=x.endsWith(".css"),b=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${b}`))return;const E=document.createElement("link");if(E.rel=w?"stylesheet":T5,w||(E.as="script"),E.crossOrigin="",E.href=x,m&&E.setAttribute("nonce",m),document.head.appendChild(E),w)return new Promise((R,k)=>{E.addEventListener("load",R),E.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${x}`)))})}))}function l(h){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=h,window.dispatchEvent(m),!m.defaultPrevented)throw h}return a.then(h=>{for(const m of h||[])m.status==="rejected"&&l(m.reason);return e().catch(l)})};class As{static async isSlugTaken(e){try{return(await vt(be(te,"profiles",e))).exists()}catch(t){throw console.error("Error checking slug availability:",t),t}}static slugify(e){if(!e||typeof e!="string")return"";const n=e.trim().toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"").replace(/_{2,}/g,"_").replace(/^_+|_+$/g,"").slice(0,30);return n.length>=3?n:""}static async createProfile(e,t,n){try{const{displayName:a,bio:l="",institution:u="",email:h}=n;if(await this.isSlugTaken(t))throw new Error(`Slug '${t}' is already taken`);const m={userId:e,displayName:a,bio:l,institution:u,email:h,createdAt:Me(),updatedAt:Me(),flashcardCount:0,upvotesReceived:0,loginStreak:0,lastLoginDate:Me()};await Rs(be(te,"profiles",t),m),await Rs(be(te,"userToSlug",e),{slug:t}),console.log("✅ Profile created successfully:",{userId:e,slug:t})}catch(a){throw console.error("❌ Error creating profile:",a),a}}static async getProfileBySlug(e){try{const t=await vt(be(te,"profiles",e));return t.exists()?{id:t.id,slug:t.id,...t.data()}:null}catch(t){throw console.error("Error getting profile by slug:",t),t}}static async getProfileByUserId(e){try{const t=await vt(be(te,"userToSlug",e));if(!t.exists())return null;const{slug:n}=t.data();return await this.getProfileBySlug(n)}catch(t){throw console.error("Error getting profile by user ID:",t),t}}static async updateProfile(e,t){try{const n={...t,updatedAt:Me()};await $t(be(te,"profiles",e),n),console.log("✅ Profile updated successfully:",e)}catch(n){throw console.error("❌ Error updating profile:",n),n}}static async searchProfiles(e,t=20){try{const n=e.toLowerCase().trim();if(!n)return[];const a=Le(Ce(te,"profiles")),l=await Ke(a),u=[];return l.docs.forEach(h=>{const m=h.data(),p=(m.displayName||"").toLowerCase(),x=(m.email||"").toLowerCase();(p.includes(n)||x.includes(n))&&u.push({slug:h.id,userId:m.userId,displayName:m.displayName,email:m.email,institution:m.institution,flashcardCount:m.flashcardCount||0})}),u.slice(0,t)}catch(n){throw console.error("Error searching profiles:",n),n}}static async getUserSlug(e){try{const t=await vt(be(te,"userToSlug",e));return t.exists()?t.data().slug:null}catch(t){return console.error("Error getting user slug:",t),null}}static async hasProfile(e){try{return!!await this.getUserSlug(e)}catch(t){return console.error("Error checking if user has profile:",t),!1}}static async updateUserStats(e,t){try{const n=await this.getUserSlug(e);if(!n)return;await this.updateProfile(n,t)}catch(n){throw console.error("Error updating user stats:",n),n}}}class is{static async createDeck(e,t){try{const n=await Ys(Ce(te,"decks"),{name:t.name||"Untitled Deck",description:t.description||"",userId:e,isPublic:t.isPublic||!1,isDefault:t.isDefault||!1,subject:t.subject||"",difficulty:t.difficulty||"beginner",tags:t.tags||[],cardCount:0,color:t.color||"#635BFF",icon:t.icon||"📚",createdAt:Me(),updatedAt:Me(),authorSlug:t.authorSlug||null,slug:t.slug||null,likeCount:0,importCount:0,viewCount:0,studyStreak:0,lastStudied:null,averageScore:0});return t.isPublic&&t.slug&&t.authorSlug&&await Ys(Ce(te,"publicDecks"),{deckId:n.id,name:t.name,description:t.description,authorSlug:t.authorSlug,slug:t.slug,subject:t.subject||"",difficulty:t.difficulty||"beginner",tags:t.tags||[],cardCount:0,likeCount:0,importCount:0,createdAt:Me()}),n.id}catch(n){throw console.error("Error creating deck:",n),n}}static async getUserDecks(e,t=!0){try{let n=Le(Ce(te,"decks"),Ye("userId","==",e),Jt("updatedAt","desc"));return t||(n=Le(Ce(te,"decks"),Ye("userId","==",e),Ye("isDefault","==",!1),Jt("updatedAt","desc"))),(await Ke(n)).docs.map(l=>({id:l.id,...l.data()}))}catch(n){throw console.error("Error fetching user decks:",n),n}}static async getDeck(e){try{const t=await vt(be(te,"decks",e));if(!t.exists())throw new Error("Deck not found");return{id:t.id,...t.data()}}catch(t){throw console.error("Error fetching deck:",t),t}}static async updateDeck(e,t){try{const n={...t,updatedAt:Me()};await $t(be(te,"decks",e),n);const a=await this.getDeck(e);if(a.isPublic&&a.slug){const l=Le(Ce(te,"publicDecks"),Ye("deckId","==",e),Zt(1)),u=await Ke(l);if(!u.empty){const h=u.docs[0];await $t(be(te,"publicDecks",h.id),{name:t.name||a.name,description:t.description||a.description,subject:t.subject||a.subject,difficulty:t.difficulty||a.difficulty,tags:t.tags||a.tags})}}return!0}catch(n){throw console.error("Error updating deck:",n),n}}static async deleteDeck(e){try{const t=sl(te),n=Le(Ce(te,"deckCards"),Ye("deckId","==",e)),a=await Ke(n);for(const h of a.docs){t.delete(be(te,"deckCards",h.id));const m=h.data().cardId,p=be(te,"cards",m);t.update(p,{deckIds:zm(e)})}t.delete(be(te,"decks",e));const l=Le(Ce(te,"publicDecks"),Ye("deckId","==",e)),u=await Ke(l);for(const h of u.docs)t.delete(be(te,"publicDecks",h.id));return await t.commit(),!0}catch(t){throw console.error("Error deleting deck:",t),t}}static async addCardToDeck(e,t,n=null){try{return await Id(te,async a=>{const l=be(te,"decks",e),u=await a.get(l);if(!u.exists())throw new Error("Deck not found");const h=u.data().cardCount||0,m=n!==null?n:h+1,p=be(Ce(te,"deckCards"));a.set(p,{deckId:e,cardId:t,position:m,addedAt:Me(),addedBy:u.data().userId});const x=be(te,"cards",t);return a.update(x,{deckIds:Zc(e)}),a.update(l,{cardCount:h+1,updatedAt:Me()}),p.id})}catch(a){throw console.error("Error adding card to deck:",a),a}}static async removeCardFromDeck(e,t){try{return await Id(te,async n=>{const a=Le(Ce(te,"deckCards"),Ye("deckId","==",e),Ye("cardId","==",t),Zt(1)),l=await Ke(a);if(l.empty)throw new Error("Card not found in deck");const u=l.docs[0];n.delete(be(te,"deckCards",u.id));const h=be(te,"cards",t);n.update(h,{deckIds:zm(e)});const m=be(te,"decks",e),x=(await n.get(m)).data().cardCount||0;return n.update(m,{cardCount:Math.max(0,x-1),updatedAt:Me()}),!0})}catch(n){throw console.error("Error removing card from deck:",n),n}}static async getDeckCards(e,t=100){try{const n=Le(Ce(te,"deckCards"),Ye("deckId","==",e),Jt("position","asc"),Zt(t)),l=(await Ke(n)).docs.map(h=>h.data().cardId);if(l.length===0)return[];const u=[];for(const h of l)try{const m=await vt(be(te,"cards",h));m.exists()&&u.push({id:m.id,...m.data()})}catch(m){console.warn(`Failed to fetch card ${h}:`,m)}return u}catch(n){throw console.error("Error fetching deck cards:",n),n}}static async reorderCardsInDeck(e,t){try{const n=sl(te);for(const{cardId:a,position:l}of t){const u=Le(Ce(te,"deckCards"),Ye("deckId","==",e),Ye("cardId","==",a),Zt(1)),h=await Ke(u);if(!h.empty){const m=h.docs[0];n.update(be(te,"deckCards",m.id),{position:l})}}return await n.commit(),!0}catch(n){throw console.error("Error reordering deck cards:",n),n}}static async createDefaultDeck(e){try{const t={name:"My Flashcards",description:"Your complete collection - contains all your flashcards",isDefault:!0,isPublic:!1,subject:"",difficulty:"mixed",tags:[],color:"#635BFF",icon:"📚"};return{id:await this.createDeck(e,t),...t}}catch(t){throw console.error("Error creating default deck:",t),t}}static async getOrCreateDefaultDeck(e){try{const t=Le(Ce(te,"decks"),Ye("userId","==",e),Ye("isDefault","==",!0),Zt(1)),n=await Ke(t);if(!n.empty){const a=n.docs[0];return{id:a.id,...a.data()}}return await this.createDefaultDeck(e)}catch(t){throw console.error("Error getting or creating default deck:",t),t}}static async migrateCardsToDefaultDeck(e){try{console.log(`🔄 Starting deck migration for user: ${e}`);const t=await this.getOrCreateDefaultDeck(e);console.log(`📚 Default deck: ${t.name} (${t.id})`);const[n,a]=await Promise.all([this.getUserCardsFromCollection("cards",e),this.getUserCardsFromCollection("flashcards",e)]),l=[...n,...a];if(console.log(`🃏 Found ${l.length} cards to migrate`),l.length===0)return console.log("✅ No cards to migrate"),{migratedCount:0,defaultDeck:t};let u=0;const h=sl(te);for(const m of l)try{const p=be(Ce(te,"deckCards"));h.set(p,{deckId:t.id,cardId:m.id,position:u+1,addedAt:Me(),addedBy:e});const x=be(te,m.collection,m.id),w=m.deckIds||[],b=w.includes(t.id)?w:[...w,t.id];h.update(x,{deckIds:b,defaultDeckId:t.id}),u++}catch(p){console.warn(`Failed to migrate card ${m.id}:`,p)}if(u>0){const m=be(te,"decks",t.id);h.update(m,{cardCount:u,updatedAt:Me()}),await h.commit()}return console.log(`✅ Migration complete: ${u} cards migrated`),{migratedCount:u,defaultDeck:t}}catch(t){throw console.error("Error migrating cards to default deck:",t),t}}static async getUserCardsFromCollection(e,t){try{const n=Le(Ce(te,e),Ye("userId","==",t),Jt("createdAt","desc"));return(await Ke(n)).docs.map(l=>({id:l.id,collection:e,...l.data()}))}catch(n){return console.error(`Error fetching cards from ${e}:`,n),[]}}static async makeDeckPublic(e,t,n){try{return await Id(te,async a=>{const l=be(te,"decks",e),u=await a.get(l);if(!u.exists())throw new Error("Deck not found");const h=u.data();a.update(l,{isPublic:!0,authorSlug:t,slug:n,updatedAt:Me()});const m=be(Ce(te,"publicDecks"));return a.set(m,{deckId:e,name:h.name,description:h.description,authorSlug:t,slug:n,subject:h.subject||"",difficulty:h.difficulty||"beginner",tags:h.tags||[],cardCount:h.cardCount||0,likeCount:0,importCount:0,createdAt:h.createdAt}),!0})}catch(a){throw console.error("Error making deck public:",a),a}}static async getPublicDecks(e={},t=50){try{let n=Le(Ce(te,"publicDecks"));return e.subject&&(n=Le(n,Ye("subject","==",e.subject))),e.difficulty&&(n=Le(n,Ye("difficulty","==",e.difficulty))),e.tag&&(n=Le(n,Ye("tags","array-contains",e.tag))),e.sortBy==="popular"?n=Le(n,Jt("likeCount","desc"),Jt("createdAt","desc")):e.sortBy==="imported"?n=Le(n,Jt("importCount","desc"),Jt("createdAt","desc")):n=Le(n,Jt("createdAt","desc")),n=Le(n,Zt(t)),(await Ke(n)).docs.map(l=>({id:l.id,...l.data()}))}catch(n){throw console.error("Error fetching public decks:",n),n}}static async importPublicDeck(e,t){try{return await Id(te,async n=>{const a=be(te,"decks",e),l=await n.get(a);if(!l.exists())throw new Error("Source deck not found");const u=l.data(),h=be(Ce(te,"decks"));n.set(h,{...u,userId:t,isPublic:!1,isDefault:!1,name:`${u.name} (Imported)`,authorSlug:null,slug:null,likeCount:0,importCount:0,viewCount:0,studyStreak:0,lastStudied:null,averageScore:0,createdAt:Me(),updatedAt:Me()});const m=Le(Ce(te,"deckCards"),Ye("deckId","==",e)),p=await Ke(m);for(const b of p.docs){const E=b.data(),R=be(te,"cards",E.cardId),k=await n.get(R);if(k.exists()){const U=k.data(),z=be(Ce(te,"cards"));n.set(z,{...U,userId:t,isPublic:!1,deckIds:[h.id],defaultDeckId:h.id,createdAt:Me(),originalCardId:E.cardId});const B=be(Ce(te,"deckCards"));n.set(B,{deckId:h.id,cardId:z.id,position:E.position,addedAt:Me(),addedBy:t})}}const x=Le(Ce(te,"publicDecks"),Ye("deckId","==",e),Zt(1)),w=await Ke(x);if(!w.empty){const b=w.docs[0];n.update(be(te,"publicDecks",b.id),{importCount:(b.data().importCount||0)+1})}return h.id})}catch(n){throw console.error("Error importing public deck:",n),n}}static async updateDeckStats(e,t){try{const n=be(te,"decks",e);return await $t(n,{...t,lastStudied:Me(),updatedAt:Me()}),!0}catch(n){throw console.error("Error updating deck stats:",n),n}}static async getDeckAnalytics(e){try{const t=await this.getDeck(e),n=await this.getDeckCards(e);return{cardCount:n.length,studyStreak:t.studyStreak||0,averageScore:t.averageScore||0,lastStudied:t.lastStudied,createdAt:t.createdAt,subjects:[...new Set(n.map(a=>a.subject).filter(Boolean))],tags:[...new Set(n.flatMap(a=>a.tags||[]))]}}catch(t){throw console.error("Error getting deck analytics:",t),t}}static async generateUniqueSlug(e,t){try{const n=`${e.toLowerCase().replace(/[^a-z0-9]+/g,"-").slice(0,30)}-${t}`;let a=n,l=0;for(;l<5;){const u=Le(Ce(te,"publicDecks"),Ye("slug","==",a),Zt(1));if((await Ke(u)).empty)return a;a=`${n}-${Math.floor(Math.random()*1e4)}`,l++}throw new Error("Failed to generate unique slug")}catch(n){throw console.error("Error generating unique slug:",n),n}}}class gm{static async getUserProfile(e){try{return await As.getProfileByUserId(e)}catch(t){throw console.error("Error fetching user profile:",t),t}}static async createUserProfile(e,t){try{const n=be(te,"users",e);return await Rs(n,{...t,createdAt:Me(),updatedAt:Me(),isPremium:!1,flashcardCount:0,upvotes:0,streak:0}),e}catch(n){throw console.error("Error creating user profile:",n),n}}static async updateUserProfile(e,t){try{const n=be(te,"users",e);await $t(n,{...t,updatedAt:Me()})}catch(n){throw console.error("Error updating user profile:",n),n}}static async getUserStats(e){try{const t=await this.getUserProfile(e);if(!t)return null;const n=[Le(Ce(te,"cards"),Ye("userId","==",e)),Le(Ce(te,"flashcards"),Ye("userId","==",e)),Le(Ce(te,"publicCards"),Ye("userId","==",e))],[a,l,u]=await Promise.all(n.map(p=>Ke(p))),h=a.size+l.size+u.size,m=[];return h>0&&m.push("first_card"),h>=10&&m.push("ten_cards"),h>=100&&m.push("hundred_cards"),t.upvotesReceived>50&&m.push("popular_creator"),{...t,flashcardCount:h,achievements:m,studySessions:Math.floor(Math.random()*20)+1,followers:Math.floor(Math.random()*100),rating:(Math.random()*2+3).toFixed(1)}}catch(t){throw console.error("Error fetching user stats:",t),t}}static async checkOnboardingStatus(e){try{const t=await this.getUserProfile(e);if(!t)return{hasProfile:!1,hasCards:!1};const n=Le(Ce(te,"flashcards"),Ye("authorId","==",e),Zt(1));return{hasProfile:!0,hasCards:!(await Ke(n)).empty,profile:t}}catch(t){throw console.error("Error checking onboarding status:",t),t}}static async getTopUsers(e=20,t="allTime"){try{const n=Le(Ce(te,"users"),Jt("flashcardCount","desc"),Jt("upvotes","desc"),Zt(e));return(await Ke(n)).docs.map(l=>({uid:l.id,...l.data()}))}catch(n){return console.error("Error fetching top users:",n),[]}}static async getStudyHistory(e){try{const{AnalyticsService:t}=await vn(async()=>{const{AnalyticsService:l}=await Promise.resolve().then(()=>G5);return{AnalyticsService:l}},void 0),a=(await t.getRecentSessions(e,"month")).map(l=>({date:(l.startTime?.toDate?l.startTime.toDate():new Date(l.startTime)).toISOString().split("T")[0],duration:l.duration||0,cardsStudied:l.cardsStudied||0,accuracy:Math.round((l.accuracy||0)*100)}));return a.sort((l,u)=>new Date(u.date)-new Date(l.date)),a}catch(t){return console.error("Error fetching study history:",t),[]}}static async needsDeckMigration(e){try{if((await is.getUserDecks(e)).length>0)return!1;const n=Le(Ce(te,"cards"),Ye("userId","==",e),Zt(1)),a=await Ke(n),l=Le(Ce(te,"flashcards"),Ye("userId","==",e),Zt(1)),u=await Ke(l);return!a.empty||!u.empty}catch(t){return console.error("Error checking deck migration status:",t),!1}}static async migrateUserToDecks(e){try{if(console.log(`🚀 Starting deck migration for user: ${e}`),!await this.needsDeckMigration(e))return console.log("✅ User already migrated or has no cards"),{success:!0,message:"No migration needed"};const n=await is.migrateCardsToDefaultDeck(e),a=be(te,"users",e);return await Rs(a,{deckMigrationCompleted:!0,deckMigrationDate:Me(),updatedAt:Me()},{merge:!0}),console.log(`✅ Deck migration completed for user: ${e}`),console.log("📊 Migration stats:",n),{success:!0,message:`Successfully migrated ${n.migratedCount} cards`,migrationResult:n}}catch(t){console.error("Error migrating user to decks:",t);try{const n=be(te,"users",e);await Rs(n,{deckMigrationFailed:!0,deckMigrationError:t.message,deckMigrationAttemptDate:Me(),updatedAt:Me()},{merge:!0})}catch(n){console.error("Failed to log migration error:",n)}return{success:!1,message:`Migration failed: ${t.message}`,error:t}}}static async autoMigrateUserDecks(e){try{const t=await vt(be(te,"users",e)),n=t.exists()?t.data():{};if(n.deckMigrationCompleted)return{success:!0,message:"Already migrated"};if(n.deckMigrationFailed&&n.deckMigrationAttemptDate){const a=n.deckMigrationAttemptDate.toMillis();if((Date.now()-a)/(1e3*60*60)<24)return{success:!1,message:"Migration failed recently, will retry later"}}return await this.migrateUserToDecks(e)}catch(t){return console.error("Error in auto-migration:",t),{success:!1,message:"Auto-migration failed",error:t}}}}class os{static async getUserFlashcards(e,t=50){try{const n=Le(Ce(te,"cards"),Ye("userId","==",e),Jt("createdAt","desc"),Zt(t));return(await Ke(n)).docs.map(l=>({id:l.id,...l.data()}))}catch(n){throw console.error("Error fetching user flashcards:",n),n}}static async getPublicFlashcards(e=50){try{const t=Le(Ce(te,"publicCards"),Jt("createdAt","desc"),Zt(e));return(await Ke(t)).docs.map(a=>({id:a.id,...a.data()}))}catch(t){throw console.error("Error fetching public flashcards:",t),t}}static async getPublicFlashcardsByUser(e,t=50){try{const n=Le(Ce(te,"publicCards"),Ye("userId","==",e),Jt("createdAt","desc"),Zt(t));return(await Ke(n)).docs.map(l=>({id:l.id,...l.data()}))}catch(n){throw console.error("Error fetching user public flashcards:",n),n}}static async createFlashcard(e,t,n=null){try{if(console.log("🎯 Creating flashcard for user:",t,"with data:",e),!t||typeof t!="string")throw new Error("Valid user ID is required to create flashcard");const a=await is.getOrCreateDefaultDeck(t);console.log("📚 Default deck obtained:",a.id);const l=n||a.id,u=n&&n!==a.id?[a.id,l]:[a.id],h={statement:e.statement||e.question||"",hints:e.hints||e.answer||"",proof:e.proof||"",tags:Array.isArray(e.tags)?e.tags:typeof e.tags=="string"?e.tags.split(",").map(p=>p.trim()).filter(p=>p):[],subject:e.subject||"",userId:t,createdAt:Me(),isPublic:e.isPublic||!1,defaultDeckId:a.id,deckIds:u};console.log("💾 Creating card document:",h);const m=await Ys(Ce(te,"cards"),h);if(e.isPublic){let p=null;const x=await vt(be(te,"userToSlug",t));if(x.exists())p=x.data().slug;else{const E=await vt(be(te,"users",t));if(E.exists()&&E.data().username)p=E.data().username;else throw new Error("You must create a profile before posting public cards. Please create your profile first.")}const w=(e.question||e.statement).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").slice(0,50),b=await this.ensureUniqueCardSlug(w);await Rs(be(te,"publicCards",b),{statement:e.question||e.statement,hints:e.hints||e.answer,proof:e.proof||e.answer,tags:e.tags||[],userId:t,authorSlug:p,slug:b,id:b,createdAt:Me(),likeCount:0,viewCount:0,importCount:0})}for(const p of u)await is.addCardToDeck(p,m.id);return m.id}catch(a){throw console.error("Error creating flashcard:",a),a}}static async updateCardDeck(e,t){try{const n=be(te,"cards",e),a=await vt(n);if(!a.exists())throw new Error("Card not found");const u=a.data().deckIds||[];if(!u.includes(t)){const h=[...u,t];await $t(n,{deckIds:h})}return!0}catch(n){throw console.error("Error updating card deck:",n),n}}static async ensureUniqueCardSlug(e){let t=e,n=0;for(;n<5;){const a=be(te,"publicCards",t);if(!(await vt(a)).exists())return t;t=e+"-"+Math.floor(Math.random()*1e4),n++}throw new Error("Failed to generate unique card slug after multiple attempts.")}static async updateFlashcard(e,t){try{const n=be(te,"cards",e);await $t(n,{...t,updatedAt:Me()})}catch(n){throw console.error("Error updating flashcard:",n),n}}static async deleteFlashcard(e){try{const t=be(te,"cards",e);await nl(t)}catch(t){throw console.error("Error deleting flashcard:",t),t}}static async searchFlashcards(e,t={},n=20){try{const a=[Ye("isPublic","==",!0)];t.subject&&a.push(Ye("subject","==",t.subject));let l="createdAt",u="desc";t.sortBy==="oldest"?(l="createdAt",u="asc"):t.sortBy==="popular"&&(l="upvotes",u="desc");const h=Le(Ce(te,"flashcards"),...a,Jt(l,u),Zt(n*3));let p=(await Ke(h)).docs.map(x=>({id:x.id,...x.data()}));if(e&&e.trim()){const x=e.toLowerCase();p=p.filter(w=>w.question?.toLowerCase().includes(x)||w.answer?.toLowerCase().includes(x)||Array.isArray(w.hints)&&w.hints.some(b=>b.toLowerCase().includes(x))||Array.isArray(w.tags)&&w.tags.some(b=>b.toLowerCase().includes(x)))}return p.slice(0,n)}catch(a){return console.error("Error searching flashcards:",a),await this.getPublicFlashcards(n)}}static async getSubjects(){try{const e=await this.getPublicFlashcards(1e3),t=new Set;return e.forEach(n=>{n.subject&&t.add(n.subject)}),Array.from(t).sort()}catch(e){return console.error("Error fetching subjects:",e),["Mathematics","Physics","Chemistry","Biology","Computer Science"]}}static async getPopularTags(e=20){try{const t=await this.getPublicFlashcards(1e3),n={};return t.forEach(a=>{a.tags&&a.tags.forEach(l=>{n[l]=(n[l]||0)+1})}),Object.entries(n).sort(([,a],[,l])=>l-a).slice(0,e).map(([a])=>a)}catch(t){return console.error("Error fetching popular tags:",t),["calculus","algebra","geometry","trigonometry","statistics"]}}static async getUserFavorites(e){try{return(await this.getPublicFlashcards(20)).slice(0,10)}catch(t){return console.error("Error fetching user favorites:",t),[]}}static async removeFromFavorites(e,t){try{return!0}catch(n){throw console.error("Error removing from favorites:",n),n}}static async getDeckFlashcards(e,t=100){try{return await is.getDeckCards(e,t)}catch(n){throw console.error("Error fetching deck flashcards:",n),n}}static async moveCardToDeck(e,t,n){try{return t&&await is.removeCardFromDeck(t,e),await is.addCardToDeck(n,e),await $t(be(te,"cards",e),{defaultDeckId:n,deckIds:Zc(n)}),t&&await $t(be(te,"cards",e),{deckIds:zm(t)}),!0}catch(a){throw console.error("Error moving card to deck:",a),a}}static async getUserFlashcardsByDeck(e){try{const t=await is.getUserDecks(e),n={};for(const a of t)n[a.id]={deck:a,cards:await this.getDeckFlashcards(a.id)};return n}catch(t){throw console.error("Error fetching user flashcards by deck:",t),t}}static async createFlashcardInDeck(e,t,n){try{return await this.createFlashcard(e,t,n)}catch(a){throw console.error("Error creating flashcard in deck:",a),a}}static async getFlashcardsFromDecks(e,t=200){try{const n=[];for(const l of e){const u=await this.getDeckFlashcards(l,t);n.push(...u)}return n.reduce((l,u)=>(l.find(h=>h.id===u.id)||l.push(u),l),[]).sort((l,u)=>{const h=l.createdAt?.toMillis?.()||l.createdAt?.getTime?.()||0;return(u.createdAt?.toMillis?.()||u.createdAt?.getTime?.()||0)-h})}catch(n){throw console.error("Error fetching flashcards from multiple decks:",n),n}}static async getPublicFlashcard(e){try{const t=await vt(be(te,"publicCards",e));if(!t.exists())throw new Error("Public flashcard not found");return{id:t.id,...t.data()}}catch(t){throw console.error("Error fetching public flashcard:",t),t}}static async updatePublicFlashcard(e,t,n){try{const a=await vt(be(te,"publicCards",e));if(!a.exists())throw new Error("Public flashcard not found");if(a.data().userId!==n)throw new Error("You can only edit your own public flashcards");const u=be(te,"publicCards",e);return await $t(u,{...t,updatedAt:Me()}),{success:!0}}catch(a){throw console.error("Error updating public flashcard:",a),a}}static async deletePublicFlashcard(e,t){try{const n=await vt(be(te,"publicCards",e));if(!n.exists())throw new Error("Public flashcard not found");if(n.data().userId!==t)throw new Error("You can only delete your own public flashcards");return await nl(be(te,"publicCards",e)),{success:!0}}catch(n){throw console.error("Error deleting public flashcard:",n),n}}static async toggleFlashcardPublic(e,t,n=!0){try{return n?await this.makeFlashcardPublic(e,t):await this.makeFlashcardPrivate(e,t),{success:!0}}catch(a){throw console.error("Error toggling flashcard public status:",a),a}}static async makeFlashcardPublic(e,t){try{const n=await this.getFlashcard(e,t),a=await vt(be(te,"userToSlug",t));if(!a.exists())throw new Error("You must create a profile before making cards public");const l=a.data().slug,u=this.generateSlugFromStatement(n.statement),h=await this.ensureUniqueSlug(u),m={statement:n.statement,hints:n.hints,proof:n.proof,subject:n.subject,tags:n.tags||[],userId:t,authorSlug:l,slug:h,createdAt:n.createdAt||Me(),updatedAt:Me(),likeCount:0,viewCount:0,importCount:0};return await Rs(be(te,"publicCards",h),m),await $t(be(te,"cards",e),{isPublic:!0,publicSlug:h,updatedAt:Me()}),{success:!0,publicSlug:h,publicUrl:`/card/${h}`}}catch(n){throw console.error("Error making flashcard public:",n),n}}static async makeFlashcardPrivate(e,t){try{const n=await vt(be(te,"cards",e));if(!n.exists())throw new Error("Private flashcard not found");const a=n.data();if(a.userId!==t)throw new Error("You can only modify your own flashcards");return a.publicSlug&&await nl(be(te,"publicCards",a.publicSlug)),await $t(be(te,"cards",e),{isPublic:!1,publicSlug:null,updatedAt:Me()}),{success:!0}}catch(n){throw console.error("Error making flashcard private:",n),n}}static async importPublicFlashcard(e,t){try{const n=await this.getPublicFlashcard(e),a={statement:n.statement,hints:n.hints,proof:n.proof,subject:n.subject,tags:n.tags||[],userId:t,createdAt:Me(),isPublic:!1,originalCardId:e,originalAuthor:n.userId,importedAt:Me()},l=await Ys(Ce(te,"cards"),a);return await $t(be(te,"publicCards",e),{importCount:increment(1)}),{success:!0,cardId:l.id}}catch(n){throw console.error("Error importing public flashcard:",n),n}}static generateSlugFromStatement(e){return e.toLowerCase().replace(/[^a-z0-9\s]/g,"").trim().replace(/\s+/g,"-").slice(0,50)}static async ensureUniqueSlug(e){let t=e,n=0;const a=10;for(;n<a;){if(!(await vt(be(te,"publicCards",t))).exists())return t;n++,t=`${e}-${Math.floor(Math.random()*1e4)}`}throw new Error("Failed to generate unique slug after multiple attempts")}}class pm{static async autoFillFromStatement(e){try{const t=await ws.currentUser?.getIdToken(),n=await fetch("https://us-central1-three-sided-flashcard-app.cloudfunctions.net/deepseekAutofill",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t?`Bearer ${t}`:""},body:JSON.stringify({statement:e})});if(!n.ok){const l=await n.json();throw new Error(l.error||"AI request failed")}const a=await n.json();return{hints:a.hints||"",proof:a.proof||"",tags:a.tags||[]}}catch(t){throw console.error("Error with AI autofill:",t),t}}static async autoTagOnly(e){try{const t=await ws.currentUser?.getIdToken(),n=await fetch("https://us-central1-three-sided-flashcard-app.cloudfunctions.net/autoTagOnly",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t?`Bearer ${t}`:""},body:JSON.stringify({statement:e})});if(!n.ok){const l=await n.json();throw new Error(l.error||"AI request failed")}return(await n.json()).tags||[]}catch(t){throw console.error("Error with AI auto-tagging:",t),t}}static async convertToLaTeX(e){try{const t=await ws.currentUser?.getIdToken(),n=await fetch("https://us-central1-three-sided-flashcard-app.cloudfunctions.net/convertToLatex",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t?`Bearer ${t}`:""},body:JSON.stringify({input:e})});if(!n.ok){const l=await n.json();throw new Error(l.error||"AI request failed")}return(await n.json()).latex||e}catch(t){throw console.error("Error converting to LaTeX:",t),t}}}const S5=({value:s,onChange:e,className:t="",placeholder:n="Type tags here or click existing tags below"})=>{const{user:a}=wn(),[l,u]=M.useState([]),[h,m]=M.useState(!0),[p,x]=M.useState(!1),[w,b]=M.useState([]),E=M.useRef(null);M.useEffect(()=>{const Y=s?s.split(",").map(L=>L.trim()).filter(L=>L):[];b(Y)},[s]);const R=()=>{if(!s)return l;const Y=s.split(",").map(P=>P.trim()),L=Y[Y.length-1].toLowerCase();return L?l.filter(P=>P.toLowerCase().includes(L)&&!w.includes(P)).sort((P,T)=>{const A=P.toLowerCase().startsWith(L),F=T.toLowerCase().startsWith(L);return A&&!F?-1:!A&&F?1:P.localeCompare(T)}):l};M.useEffect(()=>{k()},[a]);const k=async()=>{if(!a?.uid){m(!1);return}try{m(!0);const Y=await os.getUserFlashcards(a.uid,200),{collection:L,query:P,where:T,getDocs:A}=await vn(async()=>{const{collection:oe,query:$,where:ge,getDocs:C}=await Promise.resolve().then(()=>ia);return{collection:oe,query:$,where:ge,getDocs:C}},void 0),{db:F}=await vn(async()=>{const{db:oe}=await Promise.resolve().then(()=>Ga);return{db:oe}},void 0),j=P(L(F,"flashcards"),T("userId","==",a.uid)),D=(await A(j)).docs.map(oe=>oe.data()),De=[...Y,...D],Z=new Set;De.forEach(oe=>{oe.tags&&Array.isArray(oe.tags)?oe.tags.forEach($=>{$&&typeof $=="string"&&Z.add($.trim())}):typeof oe.tags=="string"&&oe.tags.split(",").forEach($=>{const ge=$.trim();ge&&Z.add(ge)})});const O=Array.from(Z).sort();u(O)}catch(Y){console.error("Error loading existing tags:",Y),u([])}finally{m(!1)}},U=Y=>{const L=w.slice();if(L.includes(Y))return;const P=[...L,Y],T=P.join(", ");b(P),e(T)},z=Y=>{const L=w.filter(T=>T!==Y),P=L.join(", ");b(L),e(P)},B=Y=>{e(Y.target.value)},q=Y=>{if(Y.key==="Tab"){const L=R();L.length>0&&(Y.preventDefault(),U(L[0]))}},G=()=>{x(!p)};return i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"mb-3",children:i.jsx("textarea",{ref:E,value:s,onChange:B,onKeyDown:q,placeholder:n,className:`claude-input w-full resize-none ${t}`,rows:"2"})}),w.length>0&&i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"text-sm claude-text-secondary mb-2",children:"Selected tags:"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:w.map((Y,L)=>i.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium",style:{backgroundColor:"var(--claude-accent)",color:"white"},children:["#",Y,i.jsx("button",{onClick:()=>z(Y),className:"ml-1 hover:bg-white/20 rounded-full w-4 h-4 flex items-center justify-center text-xs",title:"Remove tag",children:"×"})]},L))})]}),i.jsxs("div",{className:"existing-tags-section",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"text-sm claude-text-secondary",children:s?`Filtered tags (${R().length}):`:"Click to add existing tags:"}),l.length>6&&i.jsxs("button",{onClick:G,className:"text-sm px-2 py-1 rounded",style:{color:"var(--claude-accent)",backgroundColor:"var(--claude-accent-bg)"},children:["View All (",l.length,")"]})]}),i.jsx("div",{className:"existing-tags-list",style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",maxHeight:"120px",overflowY:"auto",padding:"0.75rem",backgroundColor:"var(--claude-surface)",border:"1px solid var(--claude-border)",borderRadius:"8px"},children:h?i.jsx("div",{className:"claude-text-muted italic",children:"Loading existing tags..."}):l.length===0?i.jsx("div",{className:"claude-text-muted italic",children:"No existing tags found. Create your first card to see tags here!"}):R().length===0&&s?i.jsxs("div",{className:"claude-text-muted italic",children:['No tags match your search. Press Enter to add "',s.split(",").pop()?.trim(),'" as a new tag.']}):R().slice(0,p?R().length:12).map(Y=>{const L=w.includes(Y);return i.jsxs("button",{onClick:()=>U(Y),className:`tag-btn transition-all duration-200 ${L?"selected":""}`,style:{backgroundColor:L?"var(--claude-accent)":"var(--claude-subtle)",color:L?"white":"var(--claude-primary-text)",border:"none",padding:"0.25rem 0.75rem",borderRadius:"20px",fontSize:"0.85rem",cursor:"pointer",whiteSpace:"nowrap",opacity:L?.7:1},onMouseEnter:P=>{L||(P.target.style.backgroundColor="var(--claude-border)",P.target.style.color="var(--claude-heading)")},onMouseLeave:P=>{L||(P.target.style.backgroundColor="var(--claude-subtle)",P.target.style.color="var(--claude-primary-text)")},title:L?"Already selected":`Add "${Y}" tag`,children:["#",Y]},Y)})})]}),p&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"claude-card max-w-2xl w-full mx-4 p-6 max-h-[80vh] overflow-hidden",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-bold",style:{color:"var(--claude-heading)"},children:"Select Tags"}),i.jsx("button",{onClick:()=>x(!1),className:"claude-text-muted hover:claude-text-secondary transition-colors text-2xl",style:{color:"var(--claude-text-muted)"},onMouseEnter:Y=>Y.target.style.color="var(--claude-text-secondary)",onMouseLeave:Y=>Y.target.style.color="var(--claude-text-muted)",children:"×"})]}),i.jsx("div",{className:"mb-4",children:i.jsx("p",{className:"claude-text-secondary",children:"Click tags to add them to your flashcard:"})}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 max-h-96 overflow-y-auto p-2",children:l.map(Y=>{const L=w.includes(Y);return i.jsxs("button",{onClick:()=>{U(Y)},className:`p-3 rounded-lg border text-left transition-all duration-200 ${L?"border-purple-500 bg-purple-500/20":"border-gray-600 hover:border-purple-500 hover:bg-purple-500/10"}`,children:[i.jsxs("div",{className:"font-medium",style:{color:L?"var(--claude-accent)":"var(--claude-primary-text)"},children:["#",Y]}),i.jsx("div",{className:"text-sm claude-text-secondary",children:L?"✓ Selected":"Click to add"})]},Y)})}),i.jsx("div",{className:"flex gap-3 mt-6 pt-4 border-t border-gray-600",children:i.jsxs("button",{onClick:()=>x(!1),className:"claude-button-primary flex-1",children:["Done (",w.length," selected)"]})})]})})]})},A5=({value:s,onChange:e,className:t="",placeholder:n="Select or type a subject"})=>{const{user:a}=wn(),[l,u]=M.useState([]),[h,m]=M.useState(!0),[p,x]=M.useState(!1),[w,b]=M.useState(!1),E=["Mathematics","Physics","Chemistry","Biology","Computer Science","History","English","Spanish","French","Psychology","Economics","Philosophy","Art","Music","Geography","Statistics","Calculus","Linear Algebra","Differential Equations","Organic Chemistry","Molecular Biology","Machine Learning","Data Science","Literature","World History","European History","American History","Political Science"];M.useEffect(()=>{R()},[a]);const R=async()=>{if(!a?.uid){m(!1);return}try{m(!0);const L=await os.getUserFlashcards(a.uid,200),{collection:P,query:T,where:A,getDocs:F}=await vn(async()=>{const{collection:$,query:ge,where:C,getDocs:ne}=await Promise.resolve().then(()=>ia);return{collection:$,query:ge,where:C,getDocs:ne}},void 0),{db:j}=await vn(async()=>{const{db:$}=await Promise.resolve().then(()=>Ga);return{db:$}},void 0),V=T(P(j,"flashcards"),A("userId","==",a.uid)),De=(await F(V)).docs.map($=>$.data()),Z=[...L,...De],O=new Set;Z.forEach($=>{if($.subject&&typeof $.subject=="string"){const ge=$.subject.trim();ge&&ge!=="General"&&O.add(ge)}});const oe=Array.from(O).sort();u(oe)}catch(L){console.error("Error loading existing subjects:",L),u([])}finally{m(!1)}},k=()=>{const L=new Set([...E,...l]),P=s?.toLowerCase()||"";return P?Array.from(L).filter(T=>T.toLowerCase().includes(P)).sort((T,A)=>{const F=T.toLowerCase().startsWith(P),j=A.toLowerCase().startsWith(P);return F&&!j?-1:!F&&j?1:T.localeCompare(A)}):Array.from(L).sort()},U=L=>{e(L),x(!1)},z=L=>{e(L.target.value),x(!0)},B=()=>{b(!0),x(!0)},q=()=>{b(!1),setTimeout(()=>x(!1),150)},G=k(),Y=l.length>0;return i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:s||"",onChange:z,onFocus:B,onBlur:q,placeholder:n,className:`claude-input w-full ${t}`}),p&&(w||s)&&i.jsx("div",{className:"absolute top-full left-0 right-0 z-10 mt-1 rounded-lg shadow-lg border",style:{backgroundColor:"var(--claude-surface)",borderColor:"var(--claude-border)",maxHeight:"300px",overflowY:"auto"},children:h?i.jsx("div",{className:"p-4 claude-text-muted text-center",children:"Loading subjects..."}):i.jsxs(i.Fragment,{children:[Y&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"px-4 py-2 border-b border-gray-600",children:i.jsx("div",{className:"text-sm font-medium text-purple-400",children:"📚 Your Subjects"})}),l.filter(L=>!s||L.toLowerCase().includes(s.toLowerCase())).slice(0,5).map(L=>i.jsx("button",{onClick:()=>U(L),className:"w-full text-left px-4 py-3 hover:bg-purple-500/10 transition-colors border-b border-gray-700/50 last:border-b-0",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-purple-400",children:"📖"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",style:{color:"var(--claude-primary-text)"},children:L}),i.jsx("div",{className:"text-sm claude-text-secondary",children:"From your cards"})]})]})},`existing-${L}`))]}),i.jsx("div",{className:"px-4 py-2 border-b border-gray-600",children:i.jsx("div",{className:"text-sm font-medium text-blue-400",children:"🌟 Popular Subjects"})}),G.filter(L=>!l.includes(L)).slice(0,8).map(L=>i.jsx("button",{onClick:()=>U(L),className:"w-full text-left px-4 py-3 hover:bg-blue-500/10 transition-colors border-b border-gray-700/50 last:border-b-0",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-blue-400",children:"📚"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",style:{color:"var(--claude-primary-text)"},children:L}),i.jsx("div",{className:"text-sm claude-text-secondary",children:"Popular choice"})]})]})},`popular-${L}`)),G.length===0&&s&&i.jsxs("div",{className:"p-4 text-center",children:[i.jsx("div",{className:"claude-text-muted mb-2",children:"No matching subjects found"}),i.jsxs("button",{onClick:()=>U(s),className:"px-4 py-2 rounded text-sm",style:{backgroundColor:"var(--claude-accent)",color:"white"},children:['Create "',s,'"']})]}),s&&!G.some(L=>L.toLowerCase()===s.toLowerCase())&&i.jsx("button",{onClick:()=>U(s),className:"w-full text-left px-4 py-3 border-t border-gray-600 hover:bg-green-500/10 transition-colors",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-green-400",children:"✨"}),i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",style:{color:"var(--claude-primary-text)"},children:['Create "',s,'"']}),i.jsx("div",{className:"text-sm claude-text-secondary",children:"New custom subject"})]})]})})]})}),!w&&!s&&Y&&i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"text-sm claude-text-secondary mb-2",children:"Recent subjects:"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:l.slice(0,6).map(L=>i.jsx("button",{onClick:()=>U(L),className:"px-3 py-1 rounded-full text-sm font-medium transition-all duration-200",style:{backgroundColor:"#e2e8f0",color:"#4a5568"},onMouseEnter:P=>{P.target.style.backgroundColor="var(--claude-accent)",P.target.style.color="white"},onMouseLeave:P=>{P.target.style.backgroundColor="#e2e8f0",P.target.style.color="#4a5568"},children:L},L))})]})]})},j5=({value:s,onChange:e,className:t="",placeholder:n="Select a deck for this card",rememberSelection:a=!0})=>{const{user:l}=wn(),[u,h]=M.useState([]),[m,p]=M.useState(!0),[x,w]=M.useState(!1),[b,E]=M.useState(null);M.useEffect(()=>{R(),k()},[l]);const R=async()=>{if(!l?.uid){p(!1);return}try{p(!0);const G=await is.getUserDecks(l.uid,!0);h(G)}catch(G){console.error("Error loading user decks:",G),h([])}finally{p(!1)}},k=()=>{if(!a||!l?.uid)return;const G=localStorage.getItem(`selectedDeck_${l.uid}`);if(G&&!s){const Y=u.find(L=>L.id===G);Y&&(E(Y),e(G))}};M.useEffect(()=>{if(u.length>0&&!s&&a&&l?.uid){const G=localStorage.getItem(`selectedDeck_${l.uid}`);if(G){const Y=u.find(L=>L.id===G);Y&&(E(Y),e(G))}}},[u,s,a,l?.uid,e]),M.useEffect(()=>{if(s&&u.length>0){const G=u.find(Y=>Y.id===s);E(G||null)}else E(null)},[s,u]);const U=G=>{E(G),e(G.id),w(!1),a&&l?.uid&&localStorage.setItem(`selectedDeck_${l.uid}`,G.id)},z=()=>{E(null),e(""),a&&l?.uid&&localStorage.removeItem(`selectedDeck_${l.uid}`)},B=u.find(G=>G.isDefault),q=u.filter(G=>!G.isDefault);return i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:`relative ${t}`,onClick:()=>w(!x),children:i.jsxs("div",{className:"claude-input w-full cursor-pointer flex items-center justify-between",style:{minHeight:"44px"},children:[b?i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-2xl",children:b.icon||"📚"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",style:{color:"var(--claude-primary-text)"},children:b.name}),i.jsxs("div",{className:"text-sm claude-text-secondary",children:[b.cardCount||0," cards • ",b.subject||"General"]})]})]}):i.jsx("span",{className:"claude-text-muted",children:n}),i.jsxs("div",{className:"flex items-center gap-2",children:[b&&i.jsx("button",{onClick:G=>{G.stopPropagation(),z()},className:"transition-colors p-1",style:{color:"var(--claude-text-muted)"},onMouseEnter:G=>G.target.style.color="var(--claude-primary-text)",onMouseLeave:G=>G.target.style.color="var(--claude-text-muted)",title:"Clear selection",children:"×"}),i.jsx("span",{className:"text-gray-400",children:x?"▲":"▼"})]})]})}),x&&i.jsx("div",{className:"absolute top-full left-0 right-0 z-10 mt-1 rounded-lg shadow-lg border",style:{backgroundColor:"var(--claude-surface)",borderColor:"var(--claude-border)",maxHeight:"300px",overflowY:"auto"},children:m?i.jsx("div",{className:"p-4 claude-text-muted text-center",children:"Loading decks..."}):u.length===0?i.jsxs("div",{className:"p-4 text-center",children:[i.jsx("div",{className:"claude-text-muted mb-3",children:"No decks found"}),i.jsx("div",{className:"text-sm claude-text-secondary",children:"Create a deck first to organize your cards"})]}):i.jsxs(i.Fragment,{children:[B&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"px-4 py-2 border-b border-gray-600",children:i.jsx("div",{className:"text-sm font-medium text-blue-400",children:"🏠 Default Collection"})}),i.jsx("button",{onClick:()=>U(B),className:`w-full text-left px-4 py-3 hover:bg-blue-500/10 transition-colors border-b border-gray-700/50 ${b?.id===B.id?"bg-blue-500/20":""}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-2xl",children:B.icon||"📚"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",style:{color:"var(--claude-primary-text)"},children:B.name}),i.jsxs("div",{className:"text-sm claude-text-secondary",children:[B.cardCount||0," cards • All your flashcards"]})]})]})})]}),q.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"px-4 py-2 border-b border-gray-600",children:i.jsx("div",{className:"text-sm font-medium text-purple-400",children:"📁 Your Decks"})}),q.map(G=>i.jsx("button",{onClick:()=>U(G),className:`w-full text-left px-4 py-3 hover:bg-purple-500/10 transition-colors border-b border-gray-700/50 last:border-b-0 ${b?.id===G.id?"bg-purple-500/20":""}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-2xl",children:G.icon||"📚"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",style:{color:"var(--claude-primary-text)"},children:G.name}),i.jsxs("div",{className:"text-sm claude-text-secondary",children:[G.cardCount||0," cards • ",G.subject||"General"]})]})]})},G.id))]}),i.jsx("button",{onClick:()=>{z(),w(!1)},className:"w-full text-left px-4 py-3 border-t border-gray-600 hover:bg-gray-500/10 transition-colors",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-gray-400",children:"○"}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-300 font-medium",children:"No specific deck"}),i.jsx("div",{className:"text-sm claude-text-secondary",children:"Just use default collection"})]})]})})]})}),a&&b&&i.jsxs("div",{className:"mt-2 text-xs claude-text-secondary flex items-center gap-1",children:[i.jsx("span",{children:"💾"}),i.jsx("span",{children:"This deck will be remembered for future cards"})]}),x&&i.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>w(!1)})]})},yn=({size:s=24,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M3 19H21"}),i.jsx("rect",{x:"5",y:"13",width:"4",height:"6",rx:"2",ry:"2"}),i.jsx("rect",{x:"10",y:"9",width:"4",height:"10",rx:"2",ry:"2"}),i.jsx("rect",{x:"15",y:"5",width:"4",height:"14",rx:"2",ry:"2"})]})})},Yi=({size:s=24,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("circle",{cx:"12",cy:"8",r:"3"}),i.jsx("path",{d:"M4 19c0-3.314 3.134-6 8-6s8 2.686 8 6"})]})})},$a=({size:s=24,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"white":return"#FFFFFF";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("rect",{x:"5",y:"5",width:"12",height:"14",rx:"2",ry:"2"}),i.jsx("rect",{x:"7",y:"3",width:"12",height:"14",rx:"2",ry:"2"}),i.jsx("rect",{x:"3",y:"7",width:"12",height:"14",rx:"2",ry:"2"})]})})},pr=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"white":return"#FFFFFF";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"}),i.jsx("path",{d:"M14.06 6.19l3.75 3.75 1.41-1.41c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.41 1.41z"})]})})},Nb=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M8 6h8"}),i.jsx("path",{d:"M5 8h14"}),i.jsx("rect",{x:"6",y:"8",width:"12",height:"12",rx:"2",ry:"2"}),i.jsx("path",{d:"M10 12v6"}),i.jsx("path",{d:"M14 12v6"})]})})},La=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M2 12s4-6 10-6 10 6 10 6-4 6-10 6S2 12 2 12z"}),i.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})},V1=({size:s=24,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"white":return"#FFFFFF";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("circle",{cx:"12",cy:"3",r:"1"}),i.jsx("path",{d:"M12 4v2"}),i.jsx("rect",{x:"5",y:"6",width:"14",height:"12",rx:"3",ry:"3"}),i.jsx("circle",{cx:"9",cy:"12",r:"1.25"}),i.jsx("circle",{cx:"15",cy:"12",r:"1.25"}),i.jsx("path",{d:"M9 15h6"})]})})},Cc=({size:s=20,color:e="success",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"success-dark":return"#4A9B7F";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":return"#606164";default:return"#5BC8A2"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("circle",{cx:"12",cy:"12",r:"9"}),i.jsx("path",{d:"M8 12l3 3 5-6"})]})})},kg=({size:s=20,color:e="error",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"error-dark":return"#E55555";case"default":return"#606164";default:return"#FF6363"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("circle",{cx:"12",cy:"12",r:"9"}),i.jsx("path",{d:"M9 9l6 6M15 9l-6 6"})]})})},L1=({size:s=20,color:e="warning",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"warning-dark":return"#FFB800";case"error":return"#FF6363";case"default":return"#606164";default:return"#FFD554"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3l-8.47-14.14a2 2 0 0 0-3.42 0z"}),i.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),i.jsx("circle",{cx:"12",cy:"16",r:"1"})]})})},I5=({size:s=20,color:e="warning",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"warning-dark":return"#FFB800";case"error":return"#FF6363";case"default":return"#606164";default:return"#FFD554"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M9 18h6M10 21h4"}),i.jsx("path",{d:"M12 2a7 7 0 0 0-4 12c.67.67 1 1.33 1 2h6c0-.67.33-1.33 1-2a7 7 0 0 0-4-12z"})]})})},C5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M6 2h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"}),i.jsx("line",{x1:"8",y1:"13",x2:"16",y2:"13"}),i.jsx("line",{x1:"8",y1:"17",x2:"16",y2:"17"})]})})},R5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M10 4a3 3 0 0 0-6 2v3a3 3 0 0 0 0 6v3a3 3 0 0 0 6 2"}),i.jsx("path",{d:"M14 4a3 3 0 0 1 6 2v3a3 3 0 0 1 0 6v3a3 3 0 0 1-6 2"}),i.jsx("path",{d:"M12 2v20"})]})})},rl=({size:s=24,color:e="success",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"white":return"#FFFFFF";case"default":return"#606164";default:return"#5BC8A2"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("circle",{cx:"12",cy:"12",r:"9"}),i.jsx("circle",{cx:"12",cy:"12",r:"5"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.5"})]})})},k5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("circle",{cx:"12",cy:"12",r:"9"}),i.jsx("path",{d:"M12 7v5"}),i.jsx("path",{d:"M12 12l3 3"})]})})},Tc=({size:s=20,color:e="success",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":return"#606164";default:return"#5BC8A2"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M3 3v18h18"}),i.jsx("path",{d:"M19 9l-5 5-4-4-4 5"})]})})},D5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M21 12a9 9 0 1 1-2.64-6.36L21 8"}),i.jsx("path",{d:"M21 3v5h-5"})]})})},F1=({size:s=20,color:e="secondary",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":return"#606164";default:return"#445AFF"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M20 12l-8-8H4v8l8 8 8-8z"}),i.jsx("circle",{cx:"7.5",cy:"7.5",r:"1.5"})]})})},qd=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"white":return"#FFFFFF";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M3 21h18L3 3v18z"}),i.jsx("path",{d:"M7 17h7L7 10v7z"})]})})},P5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("rect",{x:"7",y:"3",width:"10",height:"18",rx:"2.5",ry:"2.5"}),i.jsx("line",{x1:"10",y1:"6",x2:"14",y2:"6"})]})})},M5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("rect",{x:"4",y:"5",width:"16",height:"10",rx:"2",ry:"2"}),i.jsx("path",{d:"M2 17h20"}),i.jsx("path",{d:"M10 19h4"})]})})},O5=({size:s=20,color:e="warning",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":return"#606164";default:return"#FFD554"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("rect",{x:"6",y:"5",width:"4",height:"14",rx:"1"}),i.jsx("rect",{x:"14",y:"5",width:"4",height:"14",rx:"1"})]})})},rh=({size:s=16,color:e="error",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":return"#606164";default:return"#FF6363"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:i.jsx("path",{d:"M20.8 4.6a5.5 5.5 0 0 0-7.8 0L12 5.6l-1-1a5.5 5.5 0 0 0-7.8 7.8l1 1L12 21l7.8-7.6 1-1a5.5 5.5 0 0 0 0-7.8z"})})})},V5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M4 12a8 8 0 0 1 16 0"}),i.jsx("rect",{x:"3",y:"12",width:"3",height:"6",rx:"1.5"}),i.jsx("rect",{x:"18",y:"12",width:"3",height:"6",rx:"1.5"})]})})},Gx=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M5 3h11l5 5v13H5V3z"}),i.jsx("rect",{x:"7",y:"3",width:"7",height:"5"}),i.jsx("rect",{x:"9",y:"13",width:"6",height:"6"})]})})},L5=({size:s=24,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M3 6l6-2 6 2 6-2v14l-6 2-6-2-6 2V6z"}),i.jsx("path",{d:"M9 4v14M15 6v14"}),i.jsx("path",{d:"M16.5 10.5a2.5 2.5 0 1 0 5 0c0-1.38-1.12-2.5-2.5-2.5s-2.5 1.12-2.5 2.5z"}),i.jsx("path",{d:"M19 13.5v0"})]})})},F5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:i.jsx("path",{d:"M6 4l6 14 2-6 6-2L6 4z"})})})},Qm=({size:s=20,color:e="warning",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"warning-dark":return"#FFB800";case"error":return"#FF6363";case"default":return"#606164";default:return"#FFD554"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:i.jsx("path",{d:"M13 2L5 13h6l-2 9 10-13h-6l2-7z"})})})},Pr=({size:s=20,color:e="warning",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":return"#606164";default:return"#FFD554"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M8 4h8v3a4 4 0 0 1-4 4 4 4 0 0 1-4-4V4z"}),i.jsx("path",{d:"M8 5H5a2 2 0 0 0 2 3"}),i.jsx("path",{d:"M16 5h3a2 2 0 0 1-2 3"}),i.jsx("path",{d:"M12 11v4"}),i.jsx("rect",{x:"9",y:"15",width:"6",height:"2",rx:"1"}),i.jsx("rect",{x:"8",y:"17",width:"8",height:"2",rx:"1"})]})})},U5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M12 4a8 8 0 1 0 8 8c0-1.7-1.3-3-3-3h-1a2 2 0 0 1-2-2V7c0-1.7-1.3-3-3-3z"}),i.jsx("circle",{cx:"10",cy:"14",r:"1.5"})]})})},Fa=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"white":return"#FFFFFF";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("circle",{cx:"11",cy:"11",r:"6"}),i.jsx("line",{x1:"16",y1:"16",x2:"20",y2:"20"})]})})},B5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("rect",{x:"6",y:"3",width:"12",height:"18",rx:"2"}),i.jsx("rect",{x:"8",y:"5",width:"8",height:"4",rx:"1"}),i.jsx("circle",{cx:"9",cy:"12",r:"0.8"}),i.jsx("circle",{cx:"12",cy:"12",r:"0.8"}),i.jsx("circle",{cx:"15",cy:"12",r:"0.8"}),i.jsx("circle",{cx:"9",cy:"15",r:"0.8"}),i.jsx("circle",{cx:"12",cy:"15",r:"0.8"}),i.jsx("circle",{cx:"15",cy:"15",r:"0.8"}),i.jsx("circle",{cx:"9",cy:"18",r:"0.8"}),i.jsx("circle",{cx:"12",cy:"18",r:"0.8"}),i.jsx("circle",{cx:"15",cy:"18",r:"0.8"})]})})},q5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("rect",{x:"5",y:"19",width:"14",height:"2",rx:"1"}),i.jsx("line",{x1:"8",y1:"19",x2:"8",y2:"13"}),i.jsx("line",{x1:"8",y1:"13",x2:"14",y2:"7"}),i.jsx("rect",{x:"13",y:"5",width:"4",height:"2",rx:"1"}),i.jsx("line",{x1:"9",y1:"15",x2:"13",y2:"15"})]})})},z5=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M3 9l9-4 9 4-9 4-9-4z"}),i.jsx("path",{d:"M12 13v3"}),i.jsx("path",{d:"M7 12v2c0 1.66 3 3 5 3s5-1.34 5-3v-2"}),i.jsx("path",{d:"M21 9v4"}),i.jsx("circle",{cx:"21",cy:"14",r:"0.8"})]})})},Ja=({size:s=20,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"white":return"#FFFFFF";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("path",{d:"M3 5h7a3 3 0 0 1 3 3v11a3 3 0 0 0-3-3H3z"}),i.jsx("path",{d:"M21 5h-7a3 3 0 0 0-3 3v11a3 3 0 0 1 3-3h7z"}),i.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"19"})]})})},U1=({size:s=24,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("line",{x1:"4",y1:"20",x2:"20",y2:"20"}),i.jsx("line",{x1:"4",y1:"20",x2:"4",y2:"4"}),i.jsx("path",{d:"M4 16l4-4 4 3 5-5 3 2"}),i.jsx("circle",{cx:"4",cy:"16",r:"0.8"}),i.jsx("circle",{cx:"8",cy:"12",r:"0.8"}),i.jsx("circle",{cx:"12",cy:"15",r:"0.8"}),i.jsx("circle",{cx:"17",cy:"10",r:"0.8"}),i.jsx("circle",{cx:"20",cy:"12",r:"0.8"})]})})},$x=({size:s=24,color:e="default",className:t="",...n})=>{const a=()=>{switch(e){case"primary":return"#635BFF";case"secondary":return"#445AFF";case"success":return"#5BC8A2";case"warning":return"#FFD554";case"error":return"#FF6363";case"white":return"#FFFFFF";case"default":default:return"#606164"}};return i.jsx("div",{className:`inline-flex items-center justify-center ${t}`,style:{width:s,height:s},...n,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a(),strokeWidth:s===16?1:s===20?1.5:2,strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[i.jsx("circle",{cx:"9",cy:"8",r:"3"}),i.jsx("path",{d:"M4 20v-1a5 5 0 0 1 10 0v1"}),i.jsx("circle",{cx:"17",cy:"10",r:"3"}),i.jsx("path",{d:"M12 20v-1a5 5 0 0 1 10 0v1"})]})})},H5=({onCardCreated:s,onClose:e})=>{const{user:t}=wn(),[n,a]=M.useState({statement:"",hints:"",proof:"",tags:"",subject:"",isPublic:!0,deckId:""}),[l,u]=M.useState(!1),[h,m]=M.useState(""),[p,x]=M.useState(!1),[w,b]=M.useState({autoFill:!1,autoTag:!1,convertLatex:!1});M.useEffect(()=>{window.MathJax&&window.MathJax.typesetPromise&&window.MathJax.typesetPromise()},[n]),M.useEffect(()=>{if(!t?.uid)return;const B=localStorage.getItem(`flashcard_draft_${t.uid}`);if(B)try{const q=JSON.parse(B);Date.now()-(q.timestamp||0)<1440*60*1e3?a(Y=>({...Y,...q.data})):localStorage.removeItem(`flashcard_draft_${t.uid}`)}catch(q){console.warn("Failed to restore draft:",q),localStorage.removeItem(`flashcard_draft_${t.uid}`)}},[t?.uid]),M.useEffect(()=>{if(!t?.uid||!(n.statement.trim()||n.hints.trim()||n.proof.trim()))return;const q=setTimeout(()=>{const G={data:n,timestamp:Date.now()};localStorage.setItem(`flashcard_draft_${t.uid}`,JSON.stringify(G))},2e3);return()=>clearTimeout(q)},[n,t?.uid]);const E=(B,q)=>{a(G=>({...G,[B]:q})),m("")},R=async()=>{if(!n.statement.trim()){m("Please enter a statement first");return}b(B=>({...B,autoFill:!0})),m("");try{const B=await pm.autoFillFromStatement(n.statement);a(q=>({...q,hints:B.hints||q.hints,proof:B.proof||q.proof,tags:B.tags?B.tags.join(", "):q.tags})),setTimeout(()=>{window.MathJax&&window.MathJax.typesetPromise&&window.MathJax.typesetPromise()},100)}catch(B){console.error("AI autofill error:",B),m(`AI autofill failed: ${B.message}`)}finally{b(B=>({...B,autoFill:!1}))}},k=async()=>{if(!n.statement.trim()){m("Please enter a statement first");return}b(B=>({...B,autoTag:!0})),m("");try{const B=await pm.autoTagOnly(n.statement);a(q=>({...q,tags:B.join(", ")}))}catch(B){console.error("AI auto-tag error:",B),m(`AI auto-tag failed: ${B.message}`)}finally{b(B=>({...B,autoTag:!1}))}},U=async B=>{const q=n[B];if(!q.trim()){m(`Please enter some ${B} content first`);return}b(G=>({...G,convertLatex:!0})),m("");try{const G=await pm.convertToLaTeX(q);a(Y=>({...Y,[B]:G})),setTimeout(()=>{window.MathJax&&window.MathJax.typesetPromise&&window.MathJax.typesetPromise()},100)}catch(G){console.error("LaTeX conversion error:",G),m(`LaTeX conversion failed: ${G.message}`)}finally{b(G=>({...G,convertLatex:!1}))}},z=async B=>{if(B.preventDefault(),!t){m("Please sign in to create flashcards");return}const q=Ks.checkRateLimit(`flashcard_create_${t.uid}`,5,3e5);if(!q.allowed){m(q.message);return}const G=Ks.validateFlashcardInput(n);if(!G.isValid){m(G.errors[0]);return}const Y=Ks.detectSuspiciousContent(`${n.statement} ${n.hints} ${n.proof}`);if(Y.isSuspicious){m("Content contains potentially unsafe elements. Please review and try again."),console.warn("Suspicious content detected:",Y.findings);return}u(!0),m("");try{const L={...G.sanitizedData,createdAt:new Date};await os.createFlashcard(L,t.uid,n.deckId||null),localStorage.removeItem(`flashcard_draft_${t.uid}`),a(P=>({statement:"",hints:"",proof:"",tags:P.tags,subject:P.subject,isPublic:P.isPublic,deckId:P.deckId})),x(!0),s&&s(),setTimeout(()=>{x(!1)},2e3)}catch(L){console.error("Error creating flashcard:",L);const P=Ks.getPublicErrorMessage(L,!0);m(P)}finally{u(!1)}};return i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl text-white shadow-lg",style:{background:"linear-gradient(135deg, #8B7355 0%, #7A6245 100%)"},children:i.jsx(pr,{size:32,color:"white"})}),i.jsx("h1",{className:"text-4xl font-extrabold",style:{color:"var(--claude-heading)"},children:"Create Flashcard"})]}),i.jsx("p",{className:"claude-text-secondary text-lg",children:"Build a three-sided flashcard with statement, hints, and proof"}),p&&i.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 border border-green-200 rounded-xl text-sm shadow-md",children:[i.jsx(Cc,{size:16,color:"green"}),i.jsx("span",{className:"font-medium",children:"Flashcard created successfully! Ready to create another?"})]}),t&&!p&&(n.statement.trim()||n.hints.trim()||n.proof.trim())&&i.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),i.jsx("span",{children:"Auto-saving draft..."})]})]}),i.jsxs("form",{onSubmit:z,className:"space-y-8",children:[i.jsxs("div",{className:"claude-card p-8",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx("div",{className:"w-10 h-10 claude-gradient rounded-xl flex items-center justify-center text-white font-bold",children:"1"}),i.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--claude-heading)"},children:"Statement"}),i.jsx("span",{className:"claude-error text-sm",children:"*Required"})]}),i.jsx("textarea",{value:n.statement,onChange:B=>E("statement",B.target.value),placeholder:`Enter the problem statement, theorem, or question here...

Example: Prove that the derivative of sin(x) is cos(x)`,className:"claude-input w-full h-32 resize-none",required:!0}),n.statement.trim()&&i.jsxs("div",{className:"mt-4 flex flex-wrap gap-3",children:[i.jsxs("button",{type:"button",onClick:R,disabled:w.autoFill,className:"flex items-center gap-2 px-4 py-2 rounded-xl text-white font-medium shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",style:{background:w.autoFill?"var(--claude-muted)":"linear-gradient(135deg, #8B7355 0%, #7A6245 100%)"},children:[w.autoFill?i.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):i.jsx(pr,{size:16,color:"white"}),i.jsx("span",{children:w.autoFill?"Generating...":"Autofill Hints, Proof & Tags"})]}),i.jsxs("button",{type:"button",onClick:k,disabled:w.autoTag,className:"flex items-center gap-2 px-4 py-2 rounded-xl text-white font-medium shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",style:{background:w.autoTag?"var(--claude-muted)":"linear-gradient(135deg, #10B981 0%, #059669 100%)"},children:[w.autoTag?i.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):i.jsx(F1,{size:16,color:"white"}),i.jsx("span",{children:w.autoTag?"Generating...":"Auto Tag Only"})]})]}),n.statement&&i.jsxs("div",{className:"mt-4 p-4",style:{backgroundColor:"var(--claude-subtle)",border:"1px solid var(--claude-border)",borderRadius:"12px"},children:[i.jsx("div",{className:"text-sm claude-text-muted mb-2",children:"Preview:"}),i.jsx("div",{style:{color:"var(--claude-primary-text)"},dangerouslySetInnerHTML:{__html:n.statement}})]})]}),i.jsxs("div",{className:"claude-card p-8",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold",style:{background:"linear-gradient(135deg, #9333ea 0%, #a855f7 100%)"},children:"2"}),i.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--claude-heading)"},children:"Hints"}),i.jsx("span",{className:"claude-text-muted text-sm",children:"Optional"})]}),i.jsx("textarea",{value:n.hints,onChange:B=>E("hints",B.target.value),placeholder:`Provide helpful hints or guidance...

Example: Start by using the definition of derivative as a limit. Consider the addition formula for sine.`,className:"claude-input w-full h-24 resize-none"}),n.hints.trim()&&i.jsx("div",{className:"mt-3",children:i.jsxs("button",{type:"button",onClick:()=>U("hints"),disabled:w.convertLatex,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-white font-medium text-sm shadow hover:shadow-lg transform hover:scale-105 transition-all duration-200",style:{background:w.convertLatex?"var(--claude-muted)":"linear-gradient(135deg, #F59E0B 0%, #D97706 100%)"},children:[w.convertLatex?i.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}):i.jsx(qd,{size:14,color:"white"}),i.jsx("span",{children:w.convertLatex?"Converting...":"Convert to LaTeX"})]})})]}),i.jsxs("div",{className:"claude-card p-8",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold",style:{background:"linear-gradient(135deg, var(--claude-success) 0%, #10b981 100%)"},children:"3"}),i.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--claude-heading)"},children:"Proof / Answer"}),i.jsx("span",{className:"claude-error text-sm",children:"*Required"})]}),i.jsx("textarea",{value:n.proof,onChange:B=>E("proof",B.target.value),placeholder:`Provide the complete proof, solution, or detailed answer...

Example: Using the definition of derivative:
f'(x) = lim(h→0) [sin(x+h) - sin(x)]/h
= lim(h→0) [sin(x)cos(h) + cos(x)sin(h) - sin(x)]/h
...`,className:"claude-input w-full h-40 resize-none",required:!0}),n.proof.trim()&&i.jsx("div",{className:"mt-3",children:i.jsxs("button",{type:"button",onClick:()=>U("proof"),disabled:w.convertLatex,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-white font-medium text-sm shadow hover:shadow-lg transform hover:scale-105 transition-all duration-200",style:{background:w.convertLatex?"var(--claude-muted)":"linear-gradient(135deg, #F59E0B 0%, #D97706 100%)"},children:[w.convertLatex?i.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}):i.jsx(qd,{size:14,color:"white"}),i.jsx("span",{children:w.convertLatex?"Converting...":"Convert to LaTeX"})]})}),n.proof&&i.jsxs("div",{className:"mt-4 p-4",style:{backgroundColor:"var(--claude-subtle)",border:"1px solid var(--claude-border)",borderRadius:"12px"},children:[i.jsx("div",{className:"text-sm claude-text-muted mb-2",children:"Preview:"}),i.jsx("div",{className:"whitespace-pre-wrap",style:{color:"var(--claude-primary-text)"},dangerouslySetInnerHTML:{__html:n.proof}})]})]}),i.jsxs("div",{className:"claude-card p-8",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--claude-heading)"},children:"Card Details"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block claude-text-secondary font-medium mb-2",children:"Subject"}),i.jsx(A5,{value:n.subject,onChange:B=>E("subject",B),placeholder:"Select or type a subject (e.g. Calculus, Physics)"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block claude-text-secondary font-medium mb-2",children:"Tags"}),i.jsx(S5,{value:n.tags,onChange:B=>E("tags",B),placeholder:"Type tags here or click existing tags below"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block claude-text-secondary font-medium mb-2",children:["Deck ",i.jsx("span",{className:"text-sm claude-text-muted",children:"(optional)"})]}),i.jsx(j5,{value:n.deckId,onChange:B=>E("deckId",B),placeholder:"Choose a deck to organize this card",rememberSelection:!0})]})]}),i.jsx("div",{className:"mt-6",children:i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:n.isPublic,onChange:B=>E("isPublic",B.target.checked),className:"w-5 h-5 rounded",style:{accentColor:"var(--claude-accent)",backgroundColor:n.isPublic?"var(--claude-accent)":"var(--claude-surface)",borderColor:"var(--claude-border)"}}),i.jsx("span",{className:"claude-text-secondary font-medium",children:"Make this flashcard public (others can discover and study it)"})]})})]}),h&&i.jsx("div",{className:"p-4 rounded-2xl",style:{backgroundColor:"rgba(255, 99, 99, 0.1)",border:"1px solid var(--claude-error)"},children:i.jsxs("div",{className:"flex items-center gap-2 claude-error",children:[i.jsx(kg,{size:16,color:"red"}),i.jsx("span",{children:h})]})}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-end",children:[e&&i.jsx("button",{type:"button",onClick:e,className:"claude-button-secondary",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:l||!n.statement.trim()||!n.proof.trim(),className:"claude-button-primary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",style:{background:l||!n.statement.trim()||!n.proof.trim()?"var(--claude-muted)":"var(--claude-accent)"},children:l?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Creating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(pr,{size:16,color:"white"}),"Create Flashcard"]})})]})]}),i.jsxs("div",{className:"mt-8 p-6 rounded-2xl",style:{backgroundColor:"rgba(68, 90, 255, 0.1)",border:"1px solid var(--claude-accent-blue)"},children:[i.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",style:{color:"var(--claude-accent-blue)"},children:[i.jsx(qd,{size:20,color:"blue"}),"LaTeX Math Support"]}),i.jsxs("div",{className:"claude-text-secondary text-sm space-y-2",children:[i.jsx("p",{children:"Use LaTeX for mathematical expressions:"}),i.jsxs("div",{className:"claude-card p-3 font-mono text-xs",children:[i.jsxs("div",{children:["Inline: ",i.jsx("code",{children:"$f(x) = x^2 + 2x + 1$"})]}),i.jsxs("div",{children:["Block: ",i.jsxs("code",{children:["$$\\int_0^1 x^2 dx = \\frac",1,3,"$$"]})]})]})]})]})]})})};class Ka{static isPermissionOrIndexError(e){const t=e.message||"";return t.includes("Missing or insufficient permissions")||t.includes("requires an index")||t.includes("permission-denied")}static async startStudySession(e,t={}){try{const n={userId:e,sessionId:this.generateSessionId(),startTime:Me(),mode:t.mode||"study",deckId:t.deckId||null,deckName:t.deckName||null,cardsStudied:0,cardsCorrect:0,cardsIncorrect:0,cardResults:[],isActive:!0},a=await Ys(Ce(te,"studySessions"),n);if(jn)try{aa(jn,"study_session_start",{mode:t.mode,deck_id:t.deckId,user_id:e})}catch(l){console.warn("Firebase Analytics not available:",l)}return{id:a.id,...n}}catch(n){throw console.error("Error starting study session:",n),n}}static async endStudySession(e,t){try{const n=be(te,"studySessions",e),a=await vt(n);if(!a.exists())throw new Error("Session not found");const l=a.data(),u=l.startTime.toMillis(),h=Date.now(),m=Math.round((h-u)/1e3),p=l.cardsStudied>0?l.cardsCorrect/l.cardsStudied:0,x=l.cardsStudied>0?m/l.cardsStudied:0;if(await $t(n,{endTime:Me(),duration:m,accuracy:p,averageTimePerCard:x,isActive:!1}),await this.updateUserAnalytics(t,{sessionDuration:m,cardsStudied:l.cardsStudied,accuracy:p,deckId:l.deckId}),await this.updateDailyStats(t,{studyTime:m,sessionsCount:1,cardsStudied:l.cardsStudied,accuracy:p}),jn)try{aa(jn,"study_session_end",{duration:m,cards_studied:l.cardsStudied,accuracy:p,user_id:t})}catch(w){console.warn("Firebase Analytics not available:",w)}return{duration:m,cardsStudied:l.cardsStudied,accuracy:p,averageTimePerCard:x}}catch(n){if(this.isPermissionOrIndexError(n))return{duration:0,cardsStudied:0,accuracy:0,averageTimePerCard:0};throw console.error("Error ending study session:",n),n}}static async recordCardAnswer(e,t){try{const n=be(te,"studySessions",e),a=await vt(n);if(!a.exists())throw new Error("Session not found");const l=sl(te),u={cardId:t.cardId,timeSpent:t.timeSpent,wasCorrect:t.wasCorrect,attempts:t.attempts||1,difficulty:t.difficulty||"medium",confidenceLevel:t.confidenceLevel||3,timestamp:Me()};if(l.update(n,{cardResults:Zc(u),cardsStudied:(a.data().cardsStudied||0)+1,[`cards${t.wasCorrect?"Correct":"Incorrect"}`]:(a.data()[`cards${t.wasCorrect?"Correct":"Incorrect"}`]||0)+1}),await this.updateCardProgress(t.userId,t.cardId,{wasCorrect:t.wasCorrect,timeSpent:t.timeSpent,confidenceLevel:t.confidenceLevel}),await l.commit(),jn)try{aa(jn,"card_answered",{card_id:t.cardId,was_correct:t.wasCorrect,time_spent:t.timeSpent,user_id:t.userId})}catch(h){console.warn("Firebase Analytics not available:",h)}return!0}catch(n){throw console.error("Error recording card answer:",n),n}}static async updateCardProgress(e,t,n){try{const a=be(te,"learningProgress",e,"cards",t),l=await vt(a);let u;l.exists()?u=l.data():u={cardId:t,userId:e,totalReviews:0,correctReviews:0,accuracy:0,averageTimeToAnswer:0,fastestTime:1/0,slowestTime:0,masteryLevel:0,improvementRate:0,createdAt:Me()},u.totalReviews+=1,n.wasCorrect&&(u.correctReviews+=1),u.accuracy=u.correctReviews/u.totalReviews;const h=n.timeSpent;u.averageTimeToAnswer=(u.averageTimeToAnswer*(u.totalReviews-1)+h)/u.totalReviews,u.fastestTime=Math.min(u.fastestTime,h),u.slowestTime=Math.max(u.slowestTime,h);const m=u.accuracy,p=1-(u.slowestTime-u.fastestTime)/u.slowestTime,x=(n.confidenceLevel||3)/5;return u.masteryLevel=m*.5+p*.3+x*.2,u.lastMasteryUpdate=Me(),await Rs(a,u,{merge:!0}),u}catch(a){throw console.error("Error updating card progress:",a),a}}static async getCardProgress(e,t=null){try{const n=Ce(te,"learningProgress",e,"cards");let a=n;t&&t.length>0&&(a=Le(n,Ye("cardId","in",t)));const l=await Ke(a),u={};return l.docs.forEach(h=>{const m=h.data();u[m.cardId]=m}),u}catch(n){if(this.isPermissionOrIndexError(n))return{};throw console.error("Error getting card progress:",n),n}}static async updateUserAnalytics(e,t){try{const n=be(te,"userAnalytics",e),a=await vt(n);let l;if(a.exists()?l=a.data():l={userId:e,totalStudyTime:0,totalSessions:0,studyStreak:0,longestStreak:0,overallAccuracy:0,improvementRate:0,subjectStats:{},deckStats:{},createdAt:Me()},l.totalStudyTime+=t.sessionDuration,l.totalSessions+=1,l.overallAccuracy=(l.overallAccuracy*(l.totalSessions-1)+t.accuracy)/l.totalSessions,t.deckId){l.deckStats[t.deckId]||(l.deckStats[t.deckId]={studyTime:0,sessions:0,accuracy:0});const u=l.deckStats[t.deckId];u.studyTime+=t.sessionDuration,u.sessions+=1,u.accuracy=(u.accuracy*(u.sessions-1)+t.accuracy)/u.sessions}return l.lastUpdated=Me(),await Rs(n,l,{merge:!0}),l}catch(n){throw console.error("Error updating user analytics:",n),n}}static async updateDailyStats(e,t){try{const n=new Date().toISOString().split("T")[0],a=be(te,"dailyStats",e,"days",n),l=await vt(a);let u;return l.exists()?u=l.data():u={date:n,userId:e,studyTime:0,sessionsCount:0,cardsStudied:0,accuracy:0,decksStudied:[],subjectsStudied:[]},u.studyTime+=t.studyTime,u.sessionsCount+=t.sessionsCount,u.cardsStudied+=t.cardsStudied,u.sessionsCount>0&&(u.accuracy=(u.accuracy*(u.sessionsCount-1)+t.accuracy)/u.sessionsCount),await Rs(a,u,{merge:!0}),u}catch(n){throw console.error("Error updating daily stats:",n),n}}static async getUserInsights(e,t="week"){try{const[n,a,l]=await Promise.all([this.getUserAnalytics(e),this.getRecentSessions(e,t),this.getCardProgress(e)]);return{accuracyTrend:this.calculateTrend(a,"accuracy"),studyTimeTrend:this.calculateTrend(a,"duration"),masteryProgress:this.calculateMasteryProgress(l),strugglingCards:this.identifyStrugglingCards(l),strongSubjects:this.identifyStrongSubjects(n.subjectStats),optimalStudyTime:this.identifyOptimalStudyTime(a),consistencyScore:this.calculateConsistencyScore(a),recommendations:this.generateRecommendations(n,l)}}catch(n){if(this.isPermissionOrIndexError(n))return{studyStreaks:{current:0,longest:0},totalStudyTime:0,averageAccuracy:0,cardsStudied:0,sessionsCompleted:0,improvementTrend:"stable",weeklyProgress:[],strongSubjects:[],weakSubjects:[]};throw console.error("Error getting user insights:",n),n}}static async getRecentSessions(e,t="week"){try{const n=t==="week"?7:t==="month"?30:1,a=new Date(Date.now()-n*24*60*60*1e3),l=Le(Ce(te,"studySessions"),Ye("userId","==",e),Ye("startTime",">=",a),Ye("isActive","==",!1),Jt("startTime","desc"),Zt(100));return(await Ke(l)).docs.map(h=>({id:h.id,...h.data()}))}catch(n){return this.isPermissionOrIndexError(n)?[]:(console.error("Error getting recent sessions:",n),[])}}static async getUserAnalytics(e){try{const t=be(te,"userAnalytics",e),n=await vt(t);return n.exists()?n.data():{totalStudyTime:0,totalSessions:0,overallAccuracy:0,studyStreak:0,subjectStats:{},deckStats:{}}}catch(t){throw console.error("Error getting user analytics:",t),t}}static generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static calculateTrend(e,t){if(e.length<2)return 0;const n=e.slice(0,Math.floor(e.length/2)),a=e.slice(Math.floor(e.length/2)),l=n.reduce((h,m)=>h+(m[t]||0),0)/n.length,u=a.reduce((h,m)=>h+(m[t]||0),0)/a.length;return u>0?(l-u)/u:0}static calculateMasteryProgress(e){const t=Object.values(e);return t.length===0?0:t.reduce((n,a)=>n+(a.masteryLevel||0),0)/t.length}static identifyStrugglingCards(e){return Object.values(e).filter(t=>t.accuracy<.6&&t.totalReviews>=3).sort((t,n)=>t.accuracy-n.accuracy).slice(0,5)}static identifyStrongSubjects(e){return Object.entries(e).filter(([t,n])=>n.accuracy>.8).sort(([t,n],[a,l])=>l.accuracy-n.accuracy).slice(0,3).map(([t,n])=>t)}static identifyOptimalStudyTime(e){const t={morning:[],afternoon:[],evening:[]};e.forEach(l=>{const u=new Date(l.startTime.toMillis()).getHours();let h="afternoon";u<12?h="morning":u>18&&(h="evening"),t[h].push(l.accuracy||0)});let n="afternoon",a=0;return Object.entries(t).forEach(([l,u])=>{if(u.length>0){const h=u.reduce((m,p)=>m+p)/u.length;h>a&&(a=h,n=l)}}),n}static calculateConsistencyScore(e){if(e.length<3)return 0;const t=e.map(u=>u.duration||0),n=t.reduce((u,h)=>u+h)/t.length,a=t.reduce((u,h)=>u+Math.pow(h-n,2),0)/t.length,l=Math.sqrt(a);return Math.max(0,1-l/n)}static generateRecommendations(e,t){const n=[];e.totalStudyTime<3600&&n.push({type:"study_time",title:"Increase Study Time",description:"Try to study for at least 20 minutes per day to see better results.",priority:"high"}),e.overallAccuracy<.7&&n.push({type:"accuracy",title:"Focus on Understanding",description:"Review the hints and explanations more carefully before answering.",priority:"high"});const a=this.identifyStrugglingCards(t);return a.length>0&&n.push({type:"struggling_cards",title:"Review Difficult Cards",description:`You have ${a.length} cards that need extra attention.`,priority:"medium"}),n}}const G5=Object.freeze(Object.defineProperty({__proto__:null,AnalyticsService:Ka},Symbol.toStringTag,{value:"Module"})),Th=(s=[],e)=>{M.useEffect(()=>{let t=!1;const n=()=>{if(!window.MathJax?.typesetPromise)return;const a=typeof e=="string"?document.querySelector(e):e||document.body;window.MathJax.typesetClear&&window.MathJax.typesetClear([a]),window.MathJax.typesetPromise([a]).catch(l=>{t||console.error("MathJax typeset error:",l)})};if(window.MathJax&&window.MathJax.typesetPromise)n();else if(window.MathJaxReady)n();else{const a=()=>{t||(window.MathJax?.typesetPromise||window.MathJaxReady?n():requestAnimationFrame(a))},l=()=>!t&&n();return document.addEventListener("mathjax:ready",l),a(),()=>{t=!0,document.removeEventListener("mathjax:ready",l)}}return()=>{t=!0}},s)},$5=()=>{const{user:s}=wn(),[e,t]=M.useState([]),[n,a]=M.useState(0),[l,u]=M.useState(0),[h,m]=M.useState(!0),[p,x]=M.useState(""),[w,b]=M.useState(null),[E,R]=M.useState(null),[k,U]=M.useState(!1),[z,B]=M.useState({}),q=M.useRef(null),G=M.useRef(!1),Y=M.useRef(null),L=e[n],P=M.useMemo(()=>{const C=L?.statement??L?.question??"No statement available",ne=Array.isArray(L?.hints)?L.hints.join(`
`):L?.hints??L?.hint??"No hint available",ve=L?.proof??L?.answer??"No proof available";return[C,ne,ve]},[L?.statement,L?.question,L?.hints,L?.hint,L?.proof,L?.answer]),T=["Statement","Hint","Proof"];Th([n,l],Y?.current),M.useEffect(()=>{V()},[s]),M.useEffect(()=>{s&&e.length>0&&!w&&A()},[s,e.length,w]),M.useEffect(()=>{L&&R(Date.now())},[n]),M.useEffect(()=>()=>{w&&F()},[w]);const A=async()=>{try{const C=await Ka.startStudySession(s.uid,{mode:"study",deckId:null,deckName:"All Cards"});b(C),console.log("Study session started:",C.sessionId)}catch(C){console.error("Failed to start study session:",C)}},F=async()=>{if(w)try{const C=await Ka.endStudySession(w.sessionId,s.uid);console.log("Study session ended:",C),b(null)}catch(C){console.warn("Analytics not available for session end:",C),b(null)}},j=async(C,ne=3)=>{if(!w||!L||!E)return;const ve=Math.round((Date.now()-E)/1e3);try{await Ka.recordCardAnswer(w.sessionId,{cardId:L.id,userId:s.uid,timeSpent:ve,wasCorrect:C,attempts:1,difficulty:"medium",confidenceLevel:ne}),B(ue=>({...ue,[L.id]:C})),setTimeout(()=>{D()},1e3)}catch(ue){console.warn("Analytics not available, but rating recorded locally:",ue),B(Ie=>({...Ie,[L.id]:C})),setTimeout(()=>{D()},1e3)}},V=M.useCallback(async()=>{try{m(!0),x("");let C=[];if(s)try{const ne=await os.getUserFlashcards(s.uid,50),{collection:ve,query:ue,where:Ie,orderBy:ye,limit:Se,getDocs:ce}=await vn(async()=>{const{collection:Ge,query:lt,where:ze,orderBy:Qe,limit:gt,getDocs:ct}=await Promise.resolve().then(()=>ia);return{collection:Ge,query:lt,where:ze,orderBy:Qe,limit:gt,getDocs:ct}},void 0),{db:we}=await vn(async()=>{const{db:Ge}=await Promise.resolve().then(()=>Ga);return{db:Ge}},void 0),Ee=ue(ve(we,"flashcards"),Ie("userId","==",s.uid),ye("createdAt","desc"),Se(50)),Ze=(await ce(Ee)).docs.map(Ge=>({id:Ge.id,...Ge.data()}));C=[...ne,...Ze].sort((Ge,lt)=>{const ze=Ge.createdAt?.toMillis?.()||Ge.createdAt?.getTime?.()||0;return(lt.createdAt?.toMillis?.()||lt.createdAt?.getTime?.()||0)-ze})}catch(ne){console.warn("Failed to load user cards, falling back to public:",ne)}C.length||(C=await os.getPublicFlashcards(50)),Array.isArray(C)&&C.length>0?(t(C),a(0),u(0)):(t([]),a(0),u(0))}catch(C){x("Failed to load flashcards"),console.error("Error loading flashcards:",C),t([])}finally{m(!1)}},[s]),D=M.useCallback(()=>{e.length>0&&(a(C=>Math.min(C+1,e.length-1)),u(0))},[e.length]),De=M.useCallback(()=>{e.length>0&&(a(C=>Math.max(C-1,0)),u(0))},[e.length]),Z=M.useCallback(()=>{u(C=>(C+1)%3)},[]),O=M.useCallback(C=>{if(l===2&&w)switch(C.key){case"1":C.preventDefault(),j(!1,1);return;case"2":C.preventDefault(),j(!1,2);return;case"3":C.preventDefault(),j(!0,4);return;case"4":C.preventDefault(),j(!0,5);return}C.key==="ArrowRight"?D():C.key==="ArrowLeft"?De():(C.key===" "||C.code==="Space")&&(C.preventDefault(),Z())},[D,De,Z,l,w,j]),oe=C=>{q.current=C.touches[0].clientX,G.current=!1},$=C=>{G.current=!0},ge=C=>{if(!q.current)return;const ne=q.current-C.changedTouches[0].clientX;if(q.current=null,Math.abs(ne)>50)return ne>0?D():De();G.current||Z()};return M.useEffect(()=>(window.addEventListener("keydown",O),()=>window.removeEventListener("keydown",O)),[O]),h?i.jsx("div",{className:"bg-slate-900 min-h-screen pt-20 flex items-center justify-center",children:i.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-3xl p-12 text-center max-w-lg",children:[i.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-6"}),i.jsxs("h3",{className:"text-2xl font-bold text-white mb-4 flex items-center justify-center gap-2",children:[i.jsx(Ja,{size:24,color:"white"}),"Loading Flashcards..."]}),i.jsx("p",{className:"text-slate-300",children:"Please wait while we load your study materials."})]})}):p?i.jsx("div",{className:"bg-slate-900 min-h-screen pt-20 flex items-center justify-center",children:i.jsxs("div",{className:"bg-red-900/20 border border-red-700 rounded-3xl p-12 text-center max-w-lg",children:[i.jsx("h3",{className:"text-2xl font-bold text-red-400 mb-4",children:"❌ Error Loading Flashcards"}),i.jsx("p",{className:"text-red-300 mb-6",children:p}),i.jsx("button",{onClick:V,className:"px-6 py-3 text-white font-semibold rounded-xl transition-all duration-200",style:{background:"linear-gradient(135deg, #A86240 0%, #97552B 100%)"},onMouseEnter:C=>C.target.style.background="linear-gradient(135deg, #97552B 0%, #86481A 100%)",onMouseLeave:C=>C.target.style.background="linear-gradient(135deg, #A86240 0%, #97552B 100)",children:"Try Again"})]})}):e.length===0?i.jsx("div",{className:"bg-slate-900 min-h-screen pt-20 flex items-center justify-center",children:i.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-3xl p-12 text-center max-w-lg",children:[i.jsx("div",{className:"mb-6",children:i.jsx(Ja,{size:64,color:"white"})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"No Flashcards Available"}),i.jsx("p",{className:"text-slate-300",children:"Create your first flashcard to start studying!"})]})}):L?i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},role:"main",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"flex justify-between items-center mb-8",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl text-white shadow-lg",style:{background:"linear-gradient(135deg, #A86240 0%, #97552B 100%)"},children:i.jsx(rl,{size:32,color:"white"})}),i.jsx("h2",{className:"text-4xl font-extrabold",style:{color:"var(--claude-heading)"},children:"Study Mode"})]}),i.jsx("div",{className:"claude-card px-4 py-2",children:i.jsxs("span",{className:"claude-text-secondary font-medium",children:[n+1," of ",e.length]})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"flex claude-card p-2",children:T.map((C,ne)=>i.jsx("button",{onClick:()=>u(ne),className:`px-6 py-2 rounded-xl font-medium transition-colors duration-200 ${l===ne?"bg-[var(--claude-accent)] text-white":"text-[var(--claude-secondary-text)] hover:bg-[var(--claude-surface-hover)] hover:text-[var(--claude-primary-text)]"}`,"aria-pressed":l===ne,"aria-label":`Show ${C} (${ne+1} of ${T.length})`,children:C},ne))})}),i.jsxs("div",{onClick:Z,onTouchStart:oe,onTouchMove:$,onTouchEnd:ge,onKeyDown:C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),Z())},className:"claude-card p-12 min-h-[400px] flex flex-col justify-center items-center cursor-pointer transition-all duration-300 group hover:-translate-y-0.5 hover:border-[var(--claude-accent)] focus:outline-none focus:ring-2 focus:ring-[var(--claude-accent)] focus:ring-opacity-50",style:{borderRadius:"24px"},tabIndex:0,role:"button","aria-label":`Show ${T[l]} content. Press Space or Enter to continue.`,children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-sm font-medium mb-4 uppercase tracking-wider",style:{color:"var(--claude-accent)"},children:T[l]}),i.jsx("div",{ref:Y,className:"text-xl leading-relaxed transition-colors whitespace-pre-wrap",style:{color:"var(--claude-primary-text)"},children:P[l]})]}),i.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 claude-text-muted text-sm",children:l<2?"Tap to see next side":"Tap to restart"})]}),i.jsxs("div",{className:"mt-4 flex justify-center items-center gap-4",children:[L.subject&&i.jsx("span",{className:"claude-tag",children:L.subject}),L.slug?i.jsxs("a",{href:`/card/${L.slug}`,target:"_blank",rel:"noopener noreferrer",className:"claude-button-primary inline-flex items-center gap-2 text-sm",children:[i.jsx("span",{children:"🔗"}),"View Public Card"]}):i.jsxs("div",{className:"claude-button-secondary inline-flex items-center gap-2 text-sm opacity-50 cursor-not-allowed",children:[i.jsx("span",{children:"🔒"}),"Private Card"]})]}),l===2&&w&&i.jsxs("div",{className:"mt-6 claude-card p-6",style:{background:"linear-gradient(135deg, #A86240 0%, #97552B 100%)",color:"white"},children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h4",{className:"font-semibold text-white mb-2 text-lg",children:"How well did you know this?"}),i.jsx("p",{className:"text-sm text-white/90 mb-4",children:"This helps track your learning progress"}),i.jsxs("div",{className:"text-xs text-white/80 bg-white/10 rounded-lg px-3 py-2 inline-block",children:["💡 ",i.jsx("strong",{children:"Keyboard shortcuts:"})," Press ",i.jsx("kbd",{className:"bg-white/20 px-1 rounded",children:"1"}),", ",i.jsx("kbd",{className:"bg-white/20 px-1 rounded",children:"2"}),", ",i.jsx("kbd",{className:"bg-white/20 px-1 rounded",children:"3"}),", or ",i.jsx("kbd",{className:"bg-white/20 px-1 rounded",children:"4"})," to rate quickly"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[i.jsxs("button",{onClick:()=>j(!1,1),onKeyDown:C=>C.key==="1"&&j(!1,1),className:"flex flex-col items-center gap-2 px-4 py-3 bg-red-500/20 hover:bg-red-500/30 border border-red-400/30 hover:border-red-400/50 text-white rounded-lg transition-all text-sm font-medium group",children:[i.jsx(kg,{size:20,color:"white"}),i.jsx("span",{children:"Struggled"}),i.jsx("span",{className:"text-xs opacity-70",children:"(1)"})]}),i.jsxs("button",{onClick:()=>j(!1,2),onKeyDown:C=>C.key==="2"&&j(!1,2),className:"flex flex-col items-center gap-2 px-4 py-3 bg-yellow-500/20 hover:bg-yellow-500/30 border border-yellow-400/30 hover:border-yellow-400/50 text-white rounded-lg transition-all text-sm font-medium group",children:[i.jsx(L1,{size:20,color:"white"}),i.jsx("span",{children:"Unsure"}),i.jsx("span",{className:"text-xs opacity-70",children:"(2)"})]}),i.jsxs("button",{onClick:()=>j(!0,4),onKeyDown:C=>C.key==="3"&&j(!0,4),className:"flex flex-col items-center gap-2 px-4 py-3 bg-green-500/20 hover:bg-green-500/30 border border-green-400/30 hover:border-green-400/50 text-white rounded-lg transition-all text-sm font-medium group",children:[i.jsx(Cc,{size:20,color:"white"}),i.jsx("span",{children:"Good"}),i.jsx("span",{className:"text-xs opacity-70",children:"(3)"})]}),i.jsxs("button",{onClick:()=>j(!0,5),onKeyDown:C=>C.key==="4"&&j(!0,5),className:"flex flex-col items-center gap-2 px-4 py-3 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-400/30 hover:border-blue-400/50 text-white rounded-lg transition-all text-sm font-medium group",children:[i.jsx(Qm,{size:20,color:"white"}),i.jsx("span",{children:"Perfect"}),i.jsx("span",{className:"text-xs opacity-70",children:"(4)"})]})]}),z[L.id]!==void 0&&i.jsx("div",{className:"mt-3 text-center",children:i.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ${z[L.id]?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:z[L.id]?"✅ Recorded as correct":"❌ Recorded as incorrect"})})]})]}),i.jsxs("div",{className:"flex justify-between items-center mt-8",children:[i.jsx("button",{onClick:De,disabled:n===0,className:"claude-button-secondary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"← Previous"}),i.jsxs("div",{className:"claude-text-muted text-sm",children:[i.jsx("div",{className:"mb-2",children:"Use arrow keys or swipe to navigate • Space to flip sides"}),i.jsxs("div",{className:"text-xs bg-white/10 rounded-lg px-3 py-2 inline-block",children:["💡 ",i.jsx("strong",{children:"Rating shortcuts:"})," Press ",i.jsx("kbd",{className:"bg-white/20 px-1 rounded",children:"1-4"})," when reviewing to rate quickly"]})]}),i.jsx("button",{onClick:D,disabled:n===e.length-1,className:"claude-button-primary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",style:{background:n===e.length-1?"var(--claude-muted)":"var(--claude-accent)"},children:"Next →"})]}),i.jsx("span",{className:"sr-only","aria-live":"polite",children:T[l]})]})}):i.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"claude-card p-12 text-center max-w-lg",children:[i.jsx("div",{className:"text-6xl mb-6",children:"⚠️"}),i.jsx("h3",{className:"text-2xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"Card Not Found"}),i.jsx("p",{className:"claude-text-secondary",children:"Unable to load the requested flashcard."}),i.jsx("button",{onClick:V,className:"claude-button-primary mt-6",children:"Reload Cards"})]})})},K5=()=>{const{user:s}=wn(),[e,t]=M.useState(""),[n,a]=M.useState(""),[l,u]=M.useState(!0),[h,m]=M.useState([]),[p,x]=M.useState("recent"),[w,b]=M.useState(""),[E,R]=M.useState(new Set),[k,U]=M.useState(1),[z,B]=M.useState(new Set),[q,G]=M.useState(new Set),[Y,L]=M.useState(new Set),[P,T]=M.useState(new Set),[A,F]=M.useState(""),j=12;M.useEffect(()=>{const ce=setTimeout(()=>a(e),200);return()=>clearTimeout(ce)},[e]);const V=M.useCallback(ce=>ce?.toMillis?ce.toMillis():ce||0,[]),D=M.useCallback(ce=>{if(!ce)return"Unknown date";const we=ce.toDate?ce.toDate():new Date(ce);return Number.isNaN(we.getTime())?"Unknown date":we.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},[]),De=M.useCallback(async()=>{const ce=await vn(()=>Promise.resolve().then(()=>ia),void 0),{db:we}=await vn(async()=>{const{db:Ee}=await Promise.resolve().then(()=>Ga);return{db:Ee}},void 0);return{db:we,firestore:ce}},[]),Z=M.useMemo(()=>{const ce=n.trim().toLowerCase(),we=h.filter(Ee=>{const Fe=Array.isArray(Ee.hints)?Ee.hints.join(" "):typeof Ee.hints=="string"?Ee.hints:"",Ze=!ce||(Ee.statement||"").toLowerCase().includes(ce)||Fe.toLowerCase().includes(ce)||(Ee.proof||"").toLowerCase().includes(ce)||(Ee.authorSlug||"").toLowerCase().includes(ce)||(Ee.tags||[]).some(lt=>(lt||"").toLowerCase().includes(ce)),Ge=!w||(Ee.tags||[]).includes(w);return Ze&&Ge});switch(p){case"upvotes":we.sort((Ee,Fe)=>(Fe.likeCount||0)-(Ee.likeCount||0));break;case"oldest":we.sort((Ee,Fe)=>V(Ee.createdAt)-V(Fe.createdAt));break;case"alphabetical":we.sort((Ee,Fe)=>(Ee.statement||"").localeCompare(Fe.statement||""));break;default:we.sort((Ee,Fe)=>V(Fe.createdAt)-V(Ee.createdAt))}return we},[h,n,p,w]);Th([Z,k]),M.useEffect(()=>{oe(),s&&O()},[s]);const O=async()=>{if(s)try{const{collection:ce,query:we,where:Ee,getDocs:Fe}=await vn(async()=>{const{collection:gt,query:ct,where:It,getDocs:Gn}=await Promise.resolve().then(()=>ia);return{collection:gt,query:ct,where:It,getDocs:Gn}},void 0),{db:Ze}=await vn(async()=>{const{db:gt}=await Promise.resolve().then(()=>Ga);return{db:gt}},void 0),Ge=await Fe(we(ce(Ze,"userUpvotes"),Ee("userId","==",s.uid))),lt=new Set(Ge.docs.map(gt=>gt.data().cardId));B(lt);const ze=await Fe(we(ce(Ze,"flashcards"),Ee("userId","==",s.uid))),Qe=new Set;ze.docs.forEach(gt=>{Qe.add(gt.data().statement)}),G(Qe)}catch(ce){console.error("Error loading user data:",ce)}},oe=M.useCallback(async()=>{try{u(!0);const{db:ce,firestore:we}=await De(),{collection:Ee,orderBy:Fe,query:Ze,getDocs:Ge}=we;console.log("🔍 Loading public cards...");const lt=Ze(Ee(ce,"publicCards"),Fe("createdAt","desc")),ze=await Ge(lt),Qe=new Set,gt=ze.docs.map(ct=>{const It=ct.data();return(It.tags||[]).forEach(Gn=>Qe.add(Gn)),{id:ct.id,...It}});console.log("✅ Loaded public cards:",gt.length,gt.slice(0,3)),m(gt),R(Qe)}catch(ce){console.error("❌ Error loading public cards:",ce),m([]),R(new Set)}finally{u(!1)}},[De]);M.useEffect(()=>{U(1)},[n,p,w]);const $=M.useCallback(async ce=>{if(s&&!Y.has(ce)){L(we=>new Set(we).add(ce));try{const{runTransaction:we,doc:Ee,serverTimestamp:Fe}=await vn(async()=>{const{runTransaction:ze,doc:Qe,serverTimestamp:gt}=await Promise.resolve().then(()=>ia);return{runTransaction:ze,doc:Qe,serverTimestamp:gt}},void 0),{db:Ze}=await vn(async()=>{const{db:ze}=await Promise.resolve().then(()=>Ga);return{db:ze}},void 0),Ge=Ee(Ze,"userUpvotes",`${s.uid}_${ce}`),lt=Ee(Ze,"publicCards",ce);await we(Ze,async ze=>{const Qe=await ze.get(Ge),ct=(await ze.get(lt)).data()?.likeCount||0;Qe.exists()?(ze.delete(Ge),ze.update(lt,{likeCount:Math.max(0,ct-1)})):(ze.set(Ge,{userId:s.uid,cardId:ce,createdAt:Fe()}),ze.update(lt,{likeCount:ct+1}))}),B(ze=>{const Qe=new Set(ze);return Qe.has(ce)?Qe.delete(ce):Qe.add(ce),Qe}),m(ze=>ze.map(Qe=>Qe.id===ce?{...Qe,likeCount:Math.max(0,(Qe.likeCount||0)+(z.has(ce)?-1:1))}:Qe))}catch(we){console.error("Error upvoting card:",we),F("Error upvoting card. Please try again."),setTimeout(()=>F(""),5e3)}finally{L(we=>{const Ee=new Set(we);return Ee.delete(ce),Ee})}}},[s,z,Y,m]),ge=M.useCallback(async ce=>{if(!s||P.has(ce))return;const we=h.find(Ee=>Ee.id===ce);if(we){if(q.has(we.statement)){F("Card already imported"),setTimeout(()=>F(""),3e3);return}T(Ee=>new Set(Ee).add(ce));try{const{collection:Ee,addDoc:Fe,doc:Ze,updateDoc:Ge,increment:lt}=await vn(async()=>{const{collection:It,addDoc:Gn,doc:an,updateDoc:$n,increment:_r}=await Promise.resolve().then(()=>ia);return{collection:It,addDoc:Gn,doc:an,updateDoc:$n,increment:_r}},void 0),{serverTimestamp:ze}=await vn(async()=>{const{serverTimestamp:It}=await Promise.resolve().then(()=>ia);return{serverTimestamp:It}},void 0),{db:Qe}=await vn(async()=>{const{db:It}=await Promise.resolve().then(()=>Ga);return{db:It}},void 0);await Fe(Ee(Qe,"flashcards"),{userId:s.uid,statement:we.statement,hints:we.hints,proof:we.proof||"",tags:we.tags||[],createdAt:ze(),updatedAt:ze(),importedFrom:ce}),await Ge(Ze(Qe,"publicCards",ce),{importCount:lt(1)});const gt=new Set(q);gt.add(we.statement),G(gt);const ct=h.map(It=>It.id===ce?{...It,importCount:(It.importCount||0)+1}:It);m(ct),F("Card imported successfully!"),setTimeout(()=>F(""),3e3)}catch(Ee){console.error("Error importing card:",Ee),F("Error importing card. Please try again."),setTimeout(()=>F(""),5e3)}finally{T(Ee=>{const Fe=new Set(Ee);return Fe.delete(ce),Fe})}}},[s,h,q,De,P]),C=ce=>{if(!ce)return"";const we=document.createElement("div");return we.textContent=ce,we.innerHTML},ne=ce=>{const we=s&&z.has(ce.id),Ee=s&&q.has(ce.statement),Fe=Y.has(ce.id),Ze=P.has(ce.id),Ge=D(ce.createdAt),lt=ce.authorSlug?ce.authorSlug.charAt(0).toUpperCase():"U";return i.jsxs("div",{className:"claude-card p-6 hover:shadow-lg transition-all duration-200",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-semibold text-sm",style:{background:"linear-gradient(135deg, #9B8B73 0%, #8A7A63 100%)"},children:lt}),i.jsxs("div",{children:[ce.authorSlug?i.jsx("a",{href:`/profile/${ce.authorSlug}`,target:"_blank",rel:"noopener noreferrer",className:"font-medium hover:underline",style:{color:"#9B8B73"},children:ce.authorSlug}):i.jsx("span",{className:"font-medium claude-text-secondary",children:"Anonymous User"}),i.jsx("div",{className:"claude-text-muted text-sm",children:Ge})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:"font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"Statement"}),i.jsx("div",{className:"text-sm leading-relaxed",style:{color:"var(--claude-primary-text)"},dangerouslySetInnerHTML:{__html:C(ce.statement)}})]}),ce.hints&&i.jsxs("div",{className:"mb-4",children:[i.jsx("h4",{className:"font-medium mb-1 claude-text-secondary text-sm",children:"Hints"}),i.jsx("div",{className:"text-sm claude-text-secondary",dangerouslySetInnerHTML:{__html:C(ce.hints)}})]}),ce.proof&&i.jsxs("div",{className:"mb-4 p-3 rounded-lg",style:{backgroundColor:"var(--claude-subtle)",borderLeft:"4px solid #9B8B73"},children:[i.jsx("div",{className:"text-xs font-semibold claude-text-secondary mb-1 uppercase tracking-wider",children:"Proof Preview"}),i.jsx("div",{className:"text-sm",style:{color:"var(--claude-primary-text)"},dangerouslySetInnerHTML:{__html:C(ce.proof.substring(0,150)+(ce.proof.length>150?"...":""))}})]}),i.jsxs("div",{className:"flex gap-4 mb-4 text-sm claude-text-muted",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(La,{size:16,color:"default"}),i.jsxs("span",{children:[Math.max(0,ce.viewCount||0)," views"]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Gx,{size:16,color:"default"}),i.jsxs("span",{children:[Math.max(0,ce.importCount||0)," imports"]})]})]}),ce.tags&&ce.tags.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:ce.tags.map(ze=>i.jsx("span",{className:"cursor-pointer hover:opacity-80",style:{backgroundColor:"rgba(155, 139, 115, 0.1)",color:"#9B8B73",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"500"},onClick:()=>b(ze),children:ze},ze))}),i.jsxs("div",{className:"flex gap-3 items-center",children:[i.jsxs("button",{onClick:()=>$(ce.id),disabled:!s||Fe,className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${we?"text-white":"claude-button-secondary"} ${!s||Fe?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:we?"linear-gradient(135deg, #9B8B73 0%, #8A7A63 100%)":void 0,border:we?"none":void 0},title:s?`${we?"Remove upvote from":"Upvote"} this flashcard`:"Sign in to upvote cards","aria-label":s?`${we?"Remove upvote from":"Upvote"} this flashcard`:"Sign in to upvote cards",children:[Fe?i.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):i.jsx(rh,{size:16,color:we?"white":"default"}),Math.max(0,ce.likeCount||0)]}),i.jsxs("button",{onClick:()=>ge(ce.id),disabled:!s||Ee||Ze,className:`text-sm flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all ${!s||Ee||Ze?"opacity-50 cursor-not-allowed":""}`,style:{background:Ee?"var(--claude-success)":"linear-gradient(135deg, #9B8B73 0%, #8A7A63 100%)",color:"white"},title:s?Ee?"Card already imported":"Import this flashcard to your collection":"Sign in to import cards","aria-label":s?Ee?"Card already imported":"Import this flashcard to your collection":"Sign in to import cards",children:[i.jsx(Gx,{size:16,color:"white"}),Ze?"Importing...":Ee?"Imported":"Import"]}),i.jsxs("a",{href:`/card/${ce.slug}`,target:"_blank",rel:"noopener noreferrer",className:"claude-button-secondary text-sm flex items-center gap-2",children:[i.jsx(La,{size:16,color:"default"}),"View"]})]})]},ce.id)},ve=Math.ceil(Z.length/j),ue=(k-1)*j,Ie=ue+j,ye=Z.slice(ue,Ie),Se=M.useCallback(ce=>{ce<1||ce>ve||(U(ce),window.scrollTo({top:0,behavior:"smooth"}))},[ve]);return i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl text-white shadow-lg",style:{background:"linear-gradient(135deg, #9B8B73 0%, #8A7A63 100%)"},children:i.jsx(Fa,{size:32,color:"white"})}),i.jsx("h1",{className:"text-4xl font-extrabold",style:{color:"var(--claude-heading)"},children:"Search Flashcards"})]}),i.jsx("p",{className:"claude-text-secondary text-lg",children:"Discover and import flashcards from the community"})]}),A&&i.jsx("div",{className:`mb-6 p-4 rounded-lg border ${A.includes("successfully")?"border-green-200 bg-green-50 text-green-800":"border-red-200 bg-red-50 text-red-800"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:A}),i.jsx("button",{onClick:()=>F(""),className:"ml-2 text-lg font-bold opacity-60 hover:opacity-100",children:"×"})]})}),!s&&i.jsxs("div",{className:"text-center p-4 mb-6 rounded-2xl",style:{background:"linear-gradient(135deg, #9B8B73 0%, #8A7A63 100%)",color:"white"},children:[i.jsx("p",{className:"mb-3",children:"Unlock the full experience!"}),i.jsx("a",{href:"/index.html",className:"inline-block px-6 py-2 rounded-lg font-semibold transition-all hover:scale-105",style:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",textDecoration:"none"},onMouseEnter:ce=>ce.target.style.backgroundColor="rgba(255, 255, 255, 0.3)",onMouseLeave:ce=>ce.target.style.backgroundColor="rgba(255, 255, 255, 0.2)",children:"Sign in"}),i.jsx("span",{children:" to upvote and import flashcards to your account."})]}),i.jsx("div",{className:"claude-card p-6 mb-8",children:i.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[i.jsxs("div",{className:"relative flex-1 w-full",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center",children:i.jsx(Fa,{size:16,color:"default"})}),i.jsx("input",{type:"text",value:e,onChange:ce=>t(ce.target.value),placeholder:"Search flashcards, tags, or authors...",className:"claude-input w-full pl-10"}),e&&i.jsx("button",{onClick:()=>t(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center claude-text-muted hover:opacity-70",children:"×"})]}),i.jsxs("div",{className:"flex gap-3 items-center",children:[i.jsxs("select",{value:p,onChange:ce=>x(ce.target.value),className:"claude-input",children:[i.jsx("option",{value:"recent",children:"Most Recent"}),i.jsx("option",{value:"upvotes",children:"Most Upvoted"}),i.jsx("option",{value:"oldest",children:"Oldest First"}),i.jsx("option",{value:"alphabetical",children:"Alphabetical"})]}),i.jsxs("select",{value:w,onChange:ce=>b(ce.target.value),className:"claude-input",children:[i.jsx("option",{value:"",children:"All Tags"}),Array.from(E).sort().map(ce=>i.jsx("option",{value:ce,children:ce},ce))]})]})]})}),Z.length>0&&i.jsx("div",{className:"claude-card p-4 mb-6",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"claude-text-secondary",children:[i.jsx("span",{className:"font-semibold",children:Z.length})," flashcards found"]}),i.jsxs("div",{className:"claude-text-muted text-sm",children:["Showing ",ue+1,"-",Math.min(Ie,Z.length)," of ",Z.length]})]})}),l&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-10 h-10 border-4 border-t-4 rounded-full animate-spin mx-auto mb-4",style:{borderColor:"var(--claude-border)",borderTopColor:"#9B8B73"}}),i.jsx("div",{className:"claude-text-secondary",children:"Loading flashcards..."})]}),!l&&Z.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Fa,{size:64,color:"default",className:"mx-auto mb-4 opacity-50"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"No flashcards found"}),i.jsx("p",{className:"claude-text-muted",children:"Try adjusting your search terms or filters"})]}),!l&&ye.length>0&&i.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:ye.map(ne)}),ve>1&&i.jsxs("div",{className:"flex justify-center items-center gap-2",children:[i.jsx("button",{onClick:()=>Se(k-1),disabled:k===1,className:"claude-button-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"← Previous"}),Array.from({length:Math.min(5,ve)},(ce,we)=>{const Ee=we+1;return i.jsx("button",{onClick:()=>Se(Ee),className:`px-4 py-2 rounded-lg font-medium transition-all ${Ee===k?"text-white":"claude-button-secondary"}`,style:{backgroundColor:Ee===k?"#9B8B73":void 0},children:Ee},Ee)}),i.jsx("button",{onClick:()=>Se(k+1),disabled:k===ve,className:"claude-button-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Next →"})]})]})})},nE=new Map,Q5=300*1e3,Y5=()=>{const{user:s}=wn(),[e,t]=M.useState([]),[n,a]=M.useState({totalUsers:0,totalCards:0,totalViews:0}),[l,u]=M.useState(!0),[h,m]=M.useState("creators"),[p,x]=M.useState(!1);M.useEffect(()=>{w(),b()},[h]);const w=async(k=!1)=>{try{u(!0);let U="upvotes";h==="creators"?U="flashcards":h==="streak"&&(U="streak");const z=`leaderboard_${U}`;if(!k){const G=nE.get(z);if(G&&Date.now()-G.timestamp<Q5){console.log("📋 Using cached leaderboard data for:",U),t(G.data),x(!0),u(!1);return}}console.log("🏆 Loading leaderboard using backend API for:",U);const B=await fetch(`https://us-central1-three-sided-flashcard-app.cloudfunctions.net/getLeaderboard?sort=${encodeURIComponent(U)}`);if(!B.ok)throw new Error(`HTTP error! status: ${B.status}`);const q=await B.json();if(console.log("📊 Leaderboard data loaded:",q),!q.leaderboard||!Array.isArray(q.leaderboard))throw new Error("Invalid leaderboard data format");nE.set(z,{data:q.leaderboard,timestamp:Date.now()}),t(q.leaderboard),x(!1),console.log("✅ Leaderboard loaded:",q.leaderboard.length,"entries")}catch(U){console.error("💥 Error loading leaderboard:",U),t([])}finally{u(!1)}},b=async()=>{try{const k=Le(Ce(te,"profiles")),U=await Ke(k),z=Le(Ce(te,"publicCards")),B=await Ke(z);let q=0;B.docs.forEach(G=>{const Y=G.data();q+=Y.viewCount||0}),a({totalUsers:U.size,totalCards:B.size,totalViews:q})}catch(k){console.error("Error loading community stats:",k)}},E=k=>k?k.split(" ").map(U=>U.charAt(0)).join("").toUpperCase().slice(0,2):"?",R=k=>{switch(k){case 0:return i.jsx(Pr,{size:20,color:"white"});case 1:return i.jsx(Pr,{size:20,color:"white"});case 2:return i.jsx(Pr,{size:20,color:"white"});default:return`#${k+1}`}};return i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl text-white shadow-lg",style:{background:"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)"},children:i.jsx(Pr,{size:32,color:"white"})}),i.jsx("h1",{className:"text-4xl font-extrabold",style:{color:"var(--claude-heading)"},children:"Community Leaderboard"})]}),i.jsx("p",{className:"claude-text-secondary text-lg",children:"Celebrating our top contributors and creators"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[i.jsxs("div",{className:"claude-card p-6 text-center",children:[i.jsx(Yi,{size:32,color:"default",className:"mx-auto mb-2"}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--claude-accent-blue)"},children:n.totalUsers.toLocaleString()}),i.jsx("div",{className:"claude-text-secondary",children:"Community Members"})]}),i.jsxs("div",{className:"claude-card p-6 text-center",children:[i.jsx(Pr,{size:32,color:"default",className:"mx-auto mb-2"}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--claude-accent)"},children:n.totalCards.toLocaleString()}),i.jsx("div",{className:"claude-text-secondary",children:"Total Flashcards"})]}),i.jsxs("div",{className:"claude-card p-6 text-center",children:[i.jsx(La,{size:32,color:"default",className:"mx-auto mb-2"}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--claude-success)"},children:n.totalViews.toLocaleString()}),i.jsx("div",{className:"claude-text-secondary",children:"Total Views"})]})]}),i.jsx("div",{className:"claude-card p-2 mb-8",children:i.jsx("div",{className:"flex",children:[{id:"popular",label:"Most Upvoted",icon:"heart"},{id:"creators",label:"Top Creators",icon:"target"},{id:"streak",label:"Login Streak",icon:"fast"}].map(k=>i.jsxs("button",{onClick:()=>m(k.id),className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-medium transition-all duration-200",style:{backgroundColor:h===k.id?"var(--claude-accent)":"transparent",color:h===k.id?"white":"var(--claude-secondary-text)"},onMouseEnter:U=>{h!==k.id&&(U.target.style.backgroundColor="var(--claude-surface-hover)",U.target.style.color="var(--claude-primary-text)")},onMouseLeave:U=>{h!==k.id&&(U.target.style.backgroundColor="transparent",U.target.style.color="var(--claude-secondary-text)")},children:[k.icon==="heart"?i.jsx(rh,{size:20,color:h===k.id?"white":"default"}):k.icon==="target"?i.jsx(rl,{size:20,color:h===k.id?"white":"default"}):i.jsx(Qm,{size:20,color:h===k.id?"white":"default"}),k.label]},k.id))})}),i.jsxs("div",{className:"claude-card p-8",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold flex items-center gap-2",style:{color:"var(--claude-heading)"},children:h==="creators"?i.jsxs(i.Fragment,{children:[i.jsx(rl,{size:24,color:"default"}),"Top Creators"]}):h==="popular"?i.jsxs(i.Fragment,{children:[i.jsx(rh,{size:24,color:"default"}),"Most Upvoted"]}):i.jsxs(i.Fragment,{children:[i.jsx(Qm,{size:24,color:"default"}),"Login Streak Champions"]})}),i.jsxs("div",{className:"flex items-center gap-3",children:[p&&i.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-green-100 text-green-700 font-medium",children:"📋 Cached"}),i.jsx("button",{onClick:()=>w(!0),className:"claude-button-primary",title:"Force refresh from server (bypasses cache)",children:"Refresh"})]})]}),l?i.jsx("div",{className:"space-y-4",children:Array.from({length:10}).map((k,U)=>i.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-xl animate-pulse",style:{backgroundColor:"var(--claude-subtle)"},children:[i.jsx("div",{className:"w-12 h-12 rounded-full",style:{backgroundColor:"var(--claude-border)"}}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"h-4 rounded mb-2",style:{backgroundColor:"var(--claude-border)"}}),i.jsx("div",{className:"h-3 rounded w-1/2",style:{backgroundColor:"var(--claude-border)"}})]}),i.jsx("div",{className:"w-16 h-8 rounded",style:{backgroundColor:"var(--claude-border)"}})]},U))}):e.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx(Pr,{size:64,color:"default",className:"mx-auto mb-4 opacity-50"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"No users found"}),i.jsx("p",{className:"claude-text-muted",children:"Be the first to create some flashcards!"})]}):i.jsx("div",{className:"space-y-3",children:e.map((k,U)=>i.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-xl transition-all duration-300 hover:scale-105",style:{backgroundColor:U<3?"rgba(255, 215, 0, 0.1)":"var(--claude-subtle)",border:`1px solid ${U<3?"rgba(255, 215, 0, 0.3)":"var(--claude-border)"}`},children:[i.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg",style:{background:U<3?"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)":"var(--claude-muted)",color:U<3?"white":"var(--claude-background)"},children:R(U)}),i.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold",style:{background:"var(--claude-accent)"},children:E(k.displayName)}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h3",{className:"font-semibold",style:{color:"var(--claude-heading)"},children:k.displayName||"Anonymous"}),k.slug&&i.jsxs("a",{href:`/profile/${k.slug}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm transition-colors hover:underline",style:{color:"var(--claude-accent)"},children:["@",k.slug]})]}),i.jsx("div",{className:"claude-text-muted text-sm",children:h==="creators"?`${k.flashcardCount||0} flashcards created`:h==="popular"?`${k.upvotesReceived||0} upvotes received`:`${k.loginStreak||0} day login streak`})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-2xl font-bold",style:{color:U<3?"#B8860B":"var(--claude-accent-blue)"},children:h==="creators"?k.flashcardCount||0:h==="popular"?k.upvotesReceived||0:k.loginStreak||0}),i.jsx("div",{className:"claude-text-muted text-sm",children:h==="creators"?"cards":h==="popular"?"upvotes":"day streak"})]})]},k.slug||k.id))})]}),s&&i.jsxs("div",{className:"mt-8 bg-slate-800/30 border border-slate-700 rounded-2xl p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Your Position"}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold",style:{background:"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)"},children:E(s.displayName)}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-white",children:s.displayName}),i.jsx("div",{className:"text-slate-400 text-sm",children:"That's you!"})]})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-xl font-bold text-blue-400",children:["#",e.findIndex(k=>k.id===s.uid)+1||"Unranked"]}),i.jsx("div",{className:"text-slate-400 text-sm",children:"Position"})]})]})]})]})})},X5=({onClose:s,refreshCallback:e})=>{const{user:t}=wn(),[n,a]=M.useState([]),[l,u]=M.useState(!0),[h,m]=M.useState(""),[p,x]=M.useState(null),[w,b]=M.useState(null),[E,R]=M.useState({statement:"",hints:"",proof:"",subject:"",tags:""});M.useEffect(()=>{t&&k()},[t]);const k=async()=>{try{u(!0);const T=await os.getPublicFlashcardsByUser(t.uid);a(T),m("")}catch(T){console.error("Error loading public cards:",T),m("Failed to load your public flashcards")}finally{u(!1)}},U=T=>{x(T),R({statement:T.statement||"",hints:Array.isArray(T.hints)?T.hints.join(`
`):T.hints||"",proof:T.proof||"",subject:T.subject||"",tags:Array.isArray(T.tags)?T.tags.join(", "):""})},z=async()=>{if(p)try{const T=Ks.checkRateLimit(`edit_public_${t.uid}`,10,3e5);if(!T.allowed){m(T.message);return}const A=Ks.validateFlashcardInput(E);if(!A.isValid){m(A.errors[0]);return}await os.updatePublicFlashcard(p.id,A.sanitizedData,t.uid),x(null),m(""),await k(),e&&e()}catch(T){console.error("Error updating public card:",T);const A=Ks.getPublicErrorMessage(T,!0);m(A)}},B=async T=>{try{const A=Ks.checkRateLimit(`delete_public_${t.uid}`,5,3e5);if(!A.allowed){m(A.message);return}await os.deletePublicFlashcard(T,t.uid),b(null),m(""),await k(),e&&e()}catch(A){console.error("Error deleting public card:",A);const F=Ks.getPublicErrorMessage(A,!0);m(F)}},q=async T=>{try{const A=Ks.checkRateLimit(`toggle_public_${t.uid}`,10,3e5);if(!A.allowed){m(A.message);return}await os.toggleFlashcardPublic(T,t.uid,!1),m(""),await k(),e&&e()}catch(A){console.error("Error making card private:",A);const F=Ks.getPublicErrorMessage(A,!0);m(F)}},G=(T,A)=>{R(F=>({...F,[T]:A}))},Y=T=>T?(T.toDate?T.toDate():new Date(T)).toLocaleDateString():"Unknown",L=T=>`${window.location.origin}/card/${T.slug}`,P=T=>{const A=L(T);navigator.clipboard.writeText(A).then(()=>{alert("Card URL copied to clipboard!")})};return l?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:i.jsx("div",{className:"claude-card p-8 rounded-2xl shadow-2xl max-w-md",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),i.jsx("p",{className:"claude-text-secondary",children:"Loading your public flashcards..."})]})})}):i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:i.jsxs("div",{className:"claude-card rounded-2xl shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-300 flex justify-between items-center",children:[i.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--claude-heading)"},children:"📢 Manage Public Flashcards"}),i.jsx("button",{onClick:s,className:"claude-text-muted hover:text-gray-700 text-3xl transition-colors","aria-label":"Close manager",children:"×"})]}),h&&i.jsx("div",{className:"mx-6 mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-red-700 text-sm",children:h})}),i.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:n.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-6xl mb-4",children:"📝"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"No Public Flashcards Yet"}),i.jsx("p",{className:"claude-text-secondary mb-4",children:"Create flashcards and make them public to share your knowledge with the world!"}),i.jsx("button",{onClick:s,className:"claude-button-primary",children:"Create Your First Public Card"})]}):i.jsx("div",{className:"space-y-4",children:n.map(T=>i.jsxs("div",{className:"claude-card p-6 rounded-xl border-l-4 border-l-blue-500",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-semibold text-lg mb-2",style:{color:"var(--claude-heading)"},children:T.statement?.length>100?`${T.statement.slice(0,100)}...`:T.statement}),i.jsxs("div",{className:"flex gap-4 text-sm claude-text-secondary",children:[i.jsxs("span",{children:["Created: ",Y(T.createdAt)]}),i.jsxs("span",{children:["❤️ ",T.likeCount||0," likes"]}),i.jsxs("span",{children:["👁️ ",T.viewCount||0," views"]}),i.jsxs("span",{children:["📥 ",T.importCount||0," imports"]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>P(T),className:"claude-button-secondary text-sm px-3 py-1",title:"Copy public URL",children:"🔗 Copy Link"}),i.jsx("button",{onClick:()=>U(T),className:"claude-button-secondary text-sm px-3 py-1",children:"✏️ Edit"}),i.jsx("button",{onClick:()=>q(T.id),className:"claude-button-secondary text-sm px-3 py-1 text-orange-600",title:"Make private (remove from public)",children:"🔒 Make Private"}),i.jsx("button",{onClick:()=>b(T.id),className:"claude-button-secondary text-sm px-3 py-1 text-red-600",children:"🗑️ Delete"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-700 mb-1",children:"Subject & Tags:"}),i.jsxs("div",{className:"flex gap-2 flex-wrap",children:[i.jsx("span",{className:"claude-tag",children:T.subject||"General"}),T.tags?.map((A,F)=>i.jsx("span",{className:"claude-tag",children:A},F))]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-700 mb-1",children:"Public URL:"}),i.jsx("a",{href:L(T),target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 text-xs break-all",children:L(T)})]})]})]},T.id))})}),p&&i.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:i.jsxs("div",{className:"claude-card rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-300 flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold",style:{color:"var(--claude-heading)"},children:"Edit Public Flashcard"}),i.jsx("button",{onClick:()=>x(null),className:"claude-text-muted hover:text-gray-700 text-2xl",children:"×"})]}),i.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-140px)]",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Statement *"}),i.jsx("textarea",{value:E.statement,onChange:T=>G("statement",T.target.value),className:"claude-input w-full h-24 resize-none",placeholder:"Enter the main statement or question...",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Hints"}),i.jsx("textarea",{value:E.hints,onChange:T=>G("hints",T.target.value),className:"claude-input w-full h-20 resize-none",placeholder:"Helpful hints (optional)..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Proof/Answer *"}),i.jsx("textarea",{value:E.proof,onChange:T=>G("proof",T.target.value),className:"claude-input w-full h-32 resize-none",placeholder:"Enter the proof, solution, or answer...",required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Subject"}),i.jsx("input",{type:"text",value:E.subject,onChange:T=>G("subject",T.target.value),className:"claude-input w-full",placeholder:"Mathematics, Physics, etc."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Tags"}),i.jsx("input",{type:"text",value:E.tags,onChange:T=>G("tags",T.target.value),className:"claude-input w-full",placeholder:"algebra, calculus, geometry (comma-separated)"})]})]})]})}),i.jsxs("div",{className:"px-6 py-4 border-t border-gray-300 flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>x(null),className:"claude-button-secondary",children:"Cancel"}),i.jsx("button",{onClick:z,className:"claude-button-primary",disabled:!E.statement.trim()||!E.proof.trim(),children:"Save Changes"})]})]})}),w&&i.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:i.jsx("div",{className:"claude-card rounded-2xl shadow-2xl max-w-md w-full mx-4",children:i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"⚠️"}),i.jsx("h3",{className:"text-xl font-bold mb-2 text-red-600",children:"Delete Public Flashcard?"}),i.jsx("p",{className:"claude-text-secondary mb-6",children:"This will permanently delete this flashcard from the public collection. This action cannot be undone."}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>b(null),className:"claude-button-secondary",children:"Cancel"}),i.jsx("button",{onClick:()=>B(w),className:"claude-button-secondary bg-red-100 text-red-800 hover:bg-red-200 border-red-300",children:"Delete Forever"})]})]})})})]})})},xc=(...s)=>!1,Kx=s=>{if(!s)return null;if(typeof s?.toDate=="function")return s.toDate();const e=new Date(s);return Number.isNaN(e.getTime())?null:e},W5=(s,e=0)=>({id:s.id??`card-${e}`,subject:s.subject??"General",question:s.question??s.statement??"",answer:s.answer??s.proof??"",createdAt:Kx(s.createdAt)??new Date(0),...s}),sE=(s,e)=>typeof s=="string"?s.length>e?s.slice(0,e)+"…":s:"",J5=()=>{const{user:s}=wn(),[e,t]=M.useState(null),[n,a]=M.useState([]),[l,u]=M.useState([]),[h,m]=M.useState(!0),[p,x]=M.useState(!1),[w,b]=M.useState("overview"),[E,R]=M.useState(null),[k,U]=M.useState(!1),[z,B]=M.useState(!1),[q,G]=M.useState(null),[Y,L]=M.useState([]),[P,T]=M.useState(!1);M.useEffect(()=>{if(!s?.uid){t(null),a([]),u([]),m(!1);return}A()},[s?.uid]);const A=M.useCallback(async()=>{let $=!0;m(!0),b(ge=>ge);try{const ge=s.uid;xc("🔍 Loading user data for:",ge);const C=[gm.getUserProfile(ge),(async()=>{try{const we=await os.getUserFlashcards(ge,100),{collection:Ee,query:Fe,where:Ze,orderBy:Ge,limit:lt,getDocs:ze}=await vn(async()=>{const{collection:an,query:$n,where:_r,orderBy:Ds,limit:Ps,getDocs:Ms}=await Promise.resolve().then(()=>ia);return{collection:an,query:$n,where:_r,orderBy:Ds,limit:Ps,getDocs:Ms}},void 0),{db:Qe}=await vn(async()=>{const{db:an}=await Promise.resolve().then(()=>Ga);return{db:an}},void 0),gt=Fe(Ee(Qe,"flashcards"),Ze("userId","==",ge),Ge("createdAt","desc"),lt(100)),It=(await ze(gt)).docs.map(an=>({id:an.id,...an.data()}));return[...we,...It].sort((an,$n)=>{const _r=an.createdAt?.toMillis?.()||an.createdAt?.getTime?.()||0;return($n.createdAt?.toMillis?.()||$n.createdAt?.getTime?.()||0)-_r})}catch(we){return xc("Failed to load user cards:",we),[]}})(),(async()=>{try{const{collection:we,query:Ee,where:Fe,getDocs:Ze}=await vn(async()=>{const{collection:Qe,query:gt,where:ct,getDocs:It}=await Promise.resolve().then(()=>ia);return{collection:Qe,query:gt,where:ct,getDocs:It}},void 0),{db:Ge}=await vn(async()=>{const{db:Qe}=await Promise.resolve().then(()=>Ga);return{db:Qe}},void 0),lt=Ee(we(Ge,"cards"),Fe("userId","==",ge),Fe("originalCardId","!=",null));return(await Ze(lt)).docs.map(Qe=>({id:Qe.id,...Qe.data()}))}catch(we){return xc("Failed to load imported cards:",we),[]}})()],[ne,ve,ue]=await Promise.allSettled(C);if(!$)return;const Ie=ne.status==="fulfilled"?ne.value:null,Se=(ve.status==="fulfilled"?ve.value??[]:[]).map(W5),ce=ue.status==="fulfilled"?ue.value??[]:[];xc("👤 User profile:",Ie),xc("📝 Private cards found:",Se.length),xc("📥 Imported cards found:",ce.length),t(Ie),a(Se),u(ce)}catch(ge){console.error("💥 Error loading user data:",ge)}finally{$&&m(!1)}return()=>{$=!1}},[s?.uid]),F=async $=>{if(!confirm("Delete this card? This cannot be undone."))return;const ge=n;a(C=>C.filter(ne=>ne.id!==$));try{await os.deleteFlashcard($)}catch(C){console.error("Error deleting card:",C),a(ge)}},j=M.useCallback(async()=>{try{if(!s?.uid)return;const $=await is.getUserDecks(s.uid,!0);L($)}catch($){console.error("Error loading user decks:",$)}},[s?.uid]);M.useEffect(()=>{j()},[j]);const V=$=>{G($),T(!0)},D=async $=>{if(q)try{await is.addCardToDeck($,q.id),await os.updateCardDeck(q.id,$),T(!1),G(null),await A()}catch(ge){console.error("Error moving card to deck:",ge),alert("Failed to move card. Please try again.")}},De=async()=>{x(!0),await A(),x(!1)},Z=M.useCallback($=>{R($),U(!0)},[]),O=M.useCallback(()=>{U(!1),R(null)},[]);Th([E]);const oe=M.useMemo(()=>!n||n.length===0?0:new Set(n.map(ge=>ge.subject??"General")).size,[n]);return h?i.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"claude-card p-12 text-center max-w-lg",children:[i.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-t-transparent rounded-full mx-auto mb-6",style:{borderColor:"var(--claude-accent)",borderTopColor:"transparent"}}),i.jsx("h3",{className:"text-2xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"Loading Dashboard..."}),i.jsx("p",{className:"claude-text-secondary",children:"Fetching your data"})]})}):i.jsxs("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:[i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"mb-8",children:[i.jsxs("h1",{className:"text-4xl font-extrabold mb-4",style:{color:"var(--claude-heading)"},children:[i.jsx(yn,{size:32,color:"primary"}),"Your Dashboard"]}),i.jsxs("p",{className:"claude-text-secondary text-lg",children:["Welcome back, ",s?.displayName||"Student","!"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[i.jsxs("div",{className:"claude-card p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("div",{className:"p-3 bg-blue-500/20 rounded-xl",children:i.jsx($a,{size:24,color:"primary"})}),i.jsx("span",{className:"claude-text-muted text-sm",children:"Total"})]}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--claude-heading)"},children:n.length}),i.jsx("div",{className:"claude-text-secondary text-sm",children:"Flashcards Created"})]}),i.jsxs("div",{className:"claude-card rounded-2xl p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("div",{className:"p-3 bg-blue-500/20 rounded-xl",children:i.jsx(Tc,{size:24,color:"success"})}),i.jsx("span",{className:"claude-text-muted text-sm",children:"Imported"})]}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--claude-heading)"},children:l.length}),i.jsx("div",{className:"claude-text-secondary text-sm",children:"Imported"})]}),i.jsxs("div",{className:"claude-card rounded-2xl p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("div",{className:"p-3 bg-green-500/20 rounded-xl",children:i.jsx(Pr,{size:24,color:"warning"})}),i.jsx("span",{className:"claude-text-muted text-sm",children:"Streak"})]}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--claude-heading)"},children:e?.loginStreak||0}),i.jsx("div",{className:"claude-text-secondary text-sm",children:"Day Streak"})]})]}),i.jsx("div",{role:"tablist","aria-label":"Dashboard sections",className:"flex claude-card rounded-2xl p-2 mb-8",children:[{id:"overview",label:"Overview",icon:"dashboard"},{id:"profile",label:"My Profile",icon:"user"},{id:"cards",label:"My Cards",icon:"cards"},{id:"public",label:"Public Cards",icon:"view"},{id:"imported",label:"Imported Cards",icon:"progress"}].map(($,ge)=>{const C=[{id:"overview",label:"Overview",icon:"dashboard"},{id:"profile",label:"My Profile",icon:"user"},{id:"cards",label:"My Cards",icon:"cards"},{id:"public",label:"Public Cards",icon:"view"},{id:"imported",label:"Imported Cards",icon:"progress"}],ne=w===$.id;return i.jsxs("button",{role:"tab","aria-selected":ne,"aria-controls":`${$.id}-panel`,id:`${$.id}-tab`,tabIndex:ne?0:-1,onKeyDown:ve=>{ve.key==="ArrowRight"&&b(C[(ge+1)%C.length].id),ve.key==="ArrowLeft"&&b(C[(ge-1+C.length)%C.length].id)},onClick:()=>b($.id),className:`flex-1 flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-medium transition-all duration-200 ${ne?"text-white":"claude-text-secondary hover:text-gray-700 hover:bg-gray-100"}`,style:ne?{background:"linear-gradient(135deg, #7E6B5A 0%, #6D5A4A 100%)"}:{},children:[$.icon==="dashboard"?i.jsx(yn,{size:20,color:ne?"primary":"default"}):$.icon==="user"?i.jsx(Yi,{size:20,color:ne?"primary":"default"}):$.icon==="cards"?i.jsx($a,{size:20,color:ne?"primary":"default"}):$.icon==="view"?i.jsx(La,{size:20,color:ne?"primary":"default"}):$.icon==="progress"?i.jsx(Tc,{size:20,color:ne?"primary":"default"}):i.jsx("span",{children:$.icon}),$.label]},$.id)})}),w==="overview"&&i.jsxs("div",{role:"tabpanel",id:"overview-panel","aria-labelledby":"overview-tab",className:"space-y-8",children:[i.jsxs("div",{className:"claude-card rounded-3xl p-8",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-3",style:{color:"var(--claude-heading)"},children:[i.jsx(Tc,{size:24,color:"success"}),"Recent Activity"]}),i.jsxs("div",{className:"space-y-4",children:[n.slice(0,5).map($=>i.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-700/30 rounded-xl",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"font-medium",style:{color:"var(--claude-primary-text)"},children:[$.question?.slice(0,60),"..."]}),i.jsxs("p",{className:"claude-text-muted text-sm",children:["Created ",new Date($.createdAt?.toDate?.()||$.createdAt).toLocaleDateString()]})]}),i.jsx("span",{className:"text-blue-400 text-sm",children:$.subject||"General"})]},$.id)),n.length===0&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"text-4xl mb-4",children:i.jsx(pr,{size:48,color:"default"})}),i.jsx("h3",{className:"text-xl font-semibold claude-text-secondary mb-2",children:"No cards yet"}),i.jsx("p",{className:"claude-text-muted",children:"Create your first flashcard to get started!"})]})]})]}),i.jsxs("div",{className:"claude-card rounded-3xl p-8",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-3",style:{color:"var(--claude-heading)"},children:[i.jsx(yn,{size:24,color:"default"}),"Quick Stats"]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:n.length}),i.jsx("div",{className:"claude-text-secondary text-sm",children:"Total Cards"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold mb-1",style:{color:"#7E6B5A"},children:l.length}),i.jsx("div",{className:"claude-text-secondary text-sm",children:"Imported Cards"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:oe}),i.jsx("div",{className:"claude-text-secondary text-sm",children:"Subjects"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-yellow-400 mb-1",children:e?.loginStreak||0}),i.jsx("div",{className:"claude-text-secondary text-sm",children:"Day Streak"})]})]})]})]}),w==="profile"&&i.jsxs("div",{role:"tabpanel",id:"profile-panel","aria-labelledby":"profile-tab",className:"claude-card rounded-3xl p-8",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-3",style:{color:"var(--claude-heading)"},children:[i.jsx(Yi,{size:24,color:"default"}),"My Profile"]}),e?i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium claude-text-secondary mb-2",children:"Display Name"}),i.jsx("div",{className:"claude-card p-4 rounded-xl",children:i.jsx("span",{className:"claude-text-primary",children:e.displayName||"Not set"})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium claude-text-secondary mb-2",children:"Profile URL"}),i.jsx("div",{className:"claude-card p-4 rounded-xl",children:i.jsxs("a",{href:`/profile/${e.slug}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 transition-colors",children:["three-sided.com/profile/",e.slug]})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium claude-text-secondary mb-2",children:"Bio"}),i.jsx("div",{className:"claude-card p-4 rounded-xl",children:i.jsx("span",{className:"claude-text-primary",children:e.bio||"No bio added yet"})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium claude-text-secondary mb-2",children:"Institution"}),i.jsx("div",{className:"claude-card p-4 rounded-xl",children:i.jsx("span",{className:"claude-text-primary",children:e.institution||"Not specified"})})]}),i.jsxs("div",{className:"flex gap-4 pt-4",children:[i.jsxs("button",{onClick:()=>{console.log("Edit profile")},className:"claude-button-primary",style:{background:"linear-gradient(135deg, #D4A574 0%, #C19A6B 100%)"},children:[i.jsx(pr,{size:16,color:"white"}),"Edit Profile"]}),i.jsxs("a",{href:`/profile/${e.slug}`,target:"_blank",rel:"noopener noreferrer",className:"claude-button-secondary",children:[i.jsx(La,{size:16,color:"default"}),"View Public Profile"]})]})]}):i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"mb-4",children:i.jsx(Yi,{size:48,color:"default"})}),i.jsx("h3",{className:"text-xl font-semibold claude-text-secondary mb-2",children:"No profile yet"}),i.jsx("p",{className:"claude-text-muted mb-6",children:"Create a profile to share your flashcards publicly and connect with other students."}),i.jsx("button",{onClick:()=>{console.log("Create profile")},className:"claude-button-primary",style:{background:"linear-gradient(135deg, #B8A082 0%, #A68B5B 100%)"},children:"Create My Profile"})]})]}),w==="cards"&&i.jsxs("div",{role:"tabpanel",id:"cards-panel","aria-labelledby":"cards-tab",className:"claude-card rounded-3xl p-8",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-3",style:{color:"var(--claude-heading)"},children:[i.jsx($a,{size:24,color:"primary"}),"My Cards (",n.length,")"]}),i.jsx("button",{onClick:De,disabled:p,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:opacity-60 rounded-lg transition-all duration-200",style:{color:"white"},children:p?"Refreshing…":"Refresh"})]}),n.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-6xl mb-4",children:i.jsx(pr,{size:64,color:"default"})}),i.jsx("h3",{className:"text-xl font-semibold claude-text-secondary mb-2",children:"No cards found"}),i.jsx("p",{className:"claude-text-muted mb-6",children:"It looks like you haven't created any flashcards yet, or there might be a connection issue."}),i.jsxs("div",{className:"space-x-4",children:[i.jsx("a",{href:"#",onClick:$=>{$.preventDefault(),window.location.href="/#create"},className:"inline-block px-6 py-3 bg-blue-500 hover:bg-blue-600 rounded-xl transition-all duration-200",style:{color:"white"},children:"Create a Flashcard"}),i.jsx("button",{onClick:De,disabled:p,className:"px-6 py-3 disabled:opacity-60 font-semibold rounded-xl transition-all duration-200",style:{background:"linear-gradient(135deg, #7E6B5A 0%, #6D5A4A 100%)",color:"white"},children:p?"Refreshing…":"Try Loading Again"})]})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map($=>i.jsxs("div",{className:"group claude-card border hover:border-blue-500/50 rounded-2xl p-6 transition-all duration-300",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("span",{className:"text-sm text-blue-400 font-medium",children:$.subject||"General"}),i.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-all duration-200",children:[i.jsx("button",{onClick:()=>V($),className:"text-sm px-2 py-1 rounded transition-all duration-200",style:{color:"#7E6B5A",backgroundColor:"rgba(126, 107, 90, 0.1)"},onMouseEnter:ge=>{ge.target.style.backgroundColor="rgba(126, 107, 90, 0.2)",ge.target.style.color="#6D5A4A"},onMouseLeave:ge=>{ge.target.style.backgroundColor="rgba(126, 107, 90, 0.1)",ge.target.style.color="#7E6B5A"},title:"Move to deck",children:i.jsx(Ja,{size:16,color:"current"})}),i.jsx("button",{onClick:()=>F($.id),className:"text-red-400 hover:text-red-300",title:"Delete card",children:i.jsx(Nb,{size:16,color:"error"})})]})]}),i.jsx("h3",{className:"font-semibold mb-3 group-hover:text-blue-300 transition-colors",style:{color:"var(--claude-primary-text)"},children:sE($.question,80)}),i.jsx("p",{className:"claude-text-secondary text-sm mb-4 leading-relaxed",children:sE($.answer,100)}),i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsx("span",{className:"claude-text-muted",children:Kx($.createdAt)?.toLocaleDateString()??"—"}),i.jsx("div",{className:"flex gap-2",children:$.slug?i.jsx("a",{href:`/card/${$.slug}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"View Public →"}):i.jsxs("button",{onClick:()=>Z($),className:"text-blue-400 hover:text-blue-300 font-medium transition-colors cursor-pointer",children:[i.jsx(La,{size:16,color:"primary"}),"Inspect"]})})]})]},$.id))})]}),w==="public"&&i.jsxs("div",{role:"tabpanel",id:"public-panel","aria-labelledby":"public-tab",className:"claude-card rounded-3xl p-8",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-3",style:{color:"var(--claude-heading)"},children:[i.jsx(La,{size:24,color:"primary"}),"Your Public Cards"]}),i.jsx("button",{onClick:()=>B(!0),className:"claude-button-primary",style:{background:"linear-gradient(135deg, #9B8B73 0%, #8A7A63 100%)"},children:"📋 Manage Public Cards"})]}),i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-6xl mb-4",children:i.jsx(La,{size:64,color:"primary"})}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"Public Flashcard Management"}),i.jsx("p",{className:"claude-text-muted mb-6",children:"View, edit, and manage all your public flashcards in one place. Control what the world sees and track engagement."}),i.jsx("button",{onClick:()=>B(!0),className:"claude-button-primary",style:{background:"linear-gradient(135deg, #7E6B5A 0%, #6D5A4A 100%)"},children:"Open Public Card Manager"})]})]}),w==="imported"&&i.jsxs("div",{role:"tabpanel",id:"imported-panel","aria-labelledby":"imported-tab",className:"claude-card rounded-3xl p-8",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-3",style:{color:"var(--claude-heading)"},children:[i.jsx(Tc,{size:24,color:"success"}),"Imported Cards (",l.length,")"]}),l.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-6xl mb-4",children:i.jsx($a,{size:64,color:"primary"})}),i.jsx("h3",{className:"text-xl font-semibold claude-text-secondary mb-2",children:"No imported cards yet"}),i.jsx("p",{className:"claude-text-muted",children:"Import useful cards from the public library!"})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map($=>i.jsxs("div",{className:"group claude-card border rounded-2xl p-6 transition-all duration-300",style:{"&:hover":{borderColor:"rgba(126, 107, 90, 0.5)"}},children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("span",{className:"text-sm font-medium",style:{color:"#7E6B5A"},children:$.subject||"General"}),i.jsx(Tc,{size:16,color:"success"})]}),i.jsx("h3",{className:"font-semibold mb-3 transition-colors",style:{color:"var(--claude-primary-text)"},children:$.question?.length>80?$.question.slice(0,80)+"...":$.question}),i.jsx("p",{className:"claude-text-secondary text-sm leading-relaxed",children:$.answer?.length>100?$.answer.slice(0,100)+"...":$.answer})]},$.id))})]})]}),k&&E&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:i.jsxs("div",{className:"claude-card rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-300 flex justify-between items-center",children:[i.jsx("h2",{className:"text-xl font-bold",style:{color:"var(--claude-heading)"},children:"Card Inspector"}),i.jsx("button",{onClick:O,className:"claude-text-muted hover:text-gray-700 text-2xl transition-colors","aria-label":"Close inspector",children:"×"})]}),i.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[i.jsxs("div",{className:"flex gap-4 mb-6",children:[i.jsx("span",{className:"claude-tag",children:E.subject||"General"}),i.jsxs("span",{className:"claude-text-muted text-sm",children:["Created: ",Kx(E.createdAt)?.toLocaleDateString()??"Unknown"]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",style:{color:"#7E6B5A"},children:"Statement"}),i.jsx("div",{className:"claude-card rounded-xl p-4 leading-relaxed claude-text-primary",children:E.statement||E.question||"No statement available"})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-400 mb-3",children:"Hints"}),i.jsx("div",{className:"claude-card rounded-xl p-4 leading-relaxed claude-text-primary",children:Array.isArray(E.hints)?E.hints.join(`
`):E.hints||E.hint||"No hints available"})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-green-400 mb-3",children:"Proof"}),i.jsx("div",{className:"claude-card rounded-xl p-4 leading-relaxed claude-text-primary",children:E.proof||E.answer||"No proof available"})]}),E.tags&&E.tags.length>0&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-orange-400 mb-3",children:"Tags"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:E.tags.map(($,ge)=>i.jsx("span",{className:"claude-tag",children:$},ge))})]}),i.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-300",children:[i.jsx("button",{onClick:()=>{console.log("Edit card:",E.id)},className:"claude-button-secondary",children:"✏️ Edit Card"}),i.jsx("button",{onClick:async()=>{await F(E.id),O()},className:"claude-button-danger",children:"🗑️ Delete Card"}),i.jsx("button",{onClick:O,className:"claude-button-primary ml-auto",style:{background:"linear-gradient(135deg, #6B5B4A 0%, #5A4A3A 100%)"},children:"✓ Close"})]})]})]})}),z&&i.jsx(X5,{onClose:()=>B(!1),refreshCallback:A}),P&&q&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"claude-card max-w-md w-full mx-4 p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-bold",style:{color:"var(--claude-heading)"},children:"Move Card to Deck"}),i.jsx("button",{onClick:()=>T(!1),className:"transition-colors",style:{color:"var(--claude-text-muted)"},onMouseEnter:$=>$.target.style.color="var(--claude-primary-text)",onMouseLeave:$=>$.target.style.color="var(--claude-text-muted)",children:"×"})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"claude-text-secondary mb-2",children:"Moving card:"}),i.jsx("p",{className:"font-medium truncate",style:{color:"var(--claude-primary-text)"},children:q.statement||q.question||"Untitled Card"})]}),i.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:[Y.map($=>i.jsx("button",{onClick:()=>D($.id),className:"w-full text-left p-3 rounded-lg border border-gray-600 transition-all duration-200",style:{"&:hover":{borderColor:"#7E6B5A",backgroundColor:"rgba(126, 107, 90, 0.1)"}},onMouseEnter:ge=>{ge.target.style.borderColor="#7E6B5A",ge.target.style.backgroundColor="rgba(126, 107, 90, 0.1)"},onMouseLeave:ge=>{ge.target.style.borderColor="#4a5568",ge.target.style.backgroundColor="transparent"},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-2xl",children:$.icon||i.jsx(Ja,{size:24,color:"default"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",style:{color:"var(--claude-primary-text)"},children:$.name}),i.jsxs("div",{className:"text-sm claude-text-secondary",children:[$.cardCount||0," cards • ",$.subject||"General"]})]})]})},$.id)),Y.length===0&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx("p",{className:"claude-text-secondary",children:"No decks available"}),i.jsx("p",{className:"text-sm claude-text-muted mt-2",children:"Create a deck first to organize your cards"})]})]}),i.jsx("div",{className:"flex gap-3 mt-6 pt-4 border-t border-gray-600",children:i.jsx("button",{onClick:()=>T(!1),className:"claude-button-secondary flex-1",children:"Cancel"})})]})})]})},Z5="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M20%2012l-8-8H4v8l8%208%208-8z'/%3e%3ccircle%20cx='7.5'%20cy='7.5'%20r='1.5'/%3e%3c/svg%3e",vc=s=>s.trim().toLowerCase().replace(/[\s_]+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-|-$/g,"").slice(0,40),eO=(s,e=200)=>{const[t,n]=M.useState(s);return M.useEffect(()=>{const a=setTimeout(()=>n(s),e);return()=>clearTimeout(a)},[s,e]),t},tO=({selectedTags:s=[],onTagsChange:e,onClose:t,isVisible:n=!1,maxSelected:a})=>{const[l,u]=M.useState([]),[h,m]=M.useState(""),[p,x]=M.useState(!0),[w,b]=M.useState(""),[E,R]=M.useState(""),k=M.useRef(null),U=eO(E,150);M.useEffect(()=>{if(!n)return;const T=document.body.style.overflow;document.body.style.overflow="hidden",setTimeout(()=>k.current?.focus(),0);const A=F=>{F.key==="Escape"&&t?.()};return window.addEventListener("keydown",A),()=>{document.body.style.overflow=T,window.removeEventListener("keydown",A)}},[n,t]),M.useEffect(()=>{if(!n)return;let T=!0;return(async()=>{x(!0),b("");try{const A=await os.getPopularTags(100);if(!T)return;const F=Array.from(new Set((A||[]).map(j=>vc(String(j||""))).filter(Boolean))).sort((j,V)=>j.localeCompare(V));u(F.length?F:z())}catch(A){if(console.error("Error loading tags:",A),!T)return;u(z()),b("Could not load popular tags. Showing common tags.")}finally{T&&x(!1)}})(),()=>{T=!1}},[n]);const z=()=>["calculus","algebra","geometry","trigonometry","statistics","physics","chemistry","biology","computer-science","mathematics","linear-algebra","differential-equations","real-analysis","abstract-algebra","topology","number-theory","combinatorics","probability","optimization"],B=M.useMemo(()=>Array.from(new Set(s.map(T=>vc(T)).filter(Boolean))),[s]),q=T=>typeof a=="number"?T<=a:!0,G=M.useCallback(T=>{const A=vc(T),j=B.includes(A)?B.filter(V=>V!==A):[...B,A];q(j.length)&&e?.(j)},[B,e,a]),Y=M.useCallback(()=>{const T=vc(h);if(T){if(!l.includes(T)){const A=[...l,T].sort((F,j)=>F.localeCompare(j));u(A)}if(!B.includes(T)){const A=[...B,T];q(A.length)&&e?.(A)}m("")}},[h,l,B,e,a]),L=M.useCallback(T=>{const A=vc(T),F=B.filter(j=>j!==A);e?.(F)},[B,e]),P=M.useMemo(()=>{const T=U.trim().toLowerCase();return T?l.filter(A=>A.includes(T)):l},[l,U]);return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:i.jsxs("div",{ref:k,tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":"tags-title",className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden outline-none",children:[i.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-secondary-600 px-6 py-4 text-white",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:Z5,alt:"Tags",className:"w-6 h-6"}),i.jsx("h2",{id:"tags-title",className:"text-2xl font-bold",children:"🏷️ Tag Management"})]}),i.jsx("button",{onClick:t,className:"text-white/80 hover:text-white text-2xl transition-colors","aria-label":"Close",children:"✕"})]}),i.jsx("p",{className:"text-white/90 mt-1",children:"Organize your flashcards with tags"})]}),i.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-120px)]",children:[w&&i.jsx("div",{className:"mb-4 p-3 rounded-lg border border-yellow-200 bg-yellow-50 text-yellow-900",children:w}),B.length>0&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-neutral-800 mb-3",children:"Selected Tags"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(T=>i.jsxs("span",{className:"inline-flex items-center gap-2 bg-primary-100 text-primary-800 px-3 py-2 rounded-full text-sm font-medium",children:["#",T,i.jsx("button",{onClick:()=>L(T),className:"text-primary-600 hover:text-primary-800 transition-colors","aria-label":`Remove tag ${T}`,children:"✕"})]},T))})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-neutral-800 mb-3",children:"Add Custom Tag"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:h,onChange:T=>m(T.target.value),placeholder:"Enter new tag (e.g., linear-algebra)…",className:"input flex-1",onKeyDown:T=>T.key==="Enter"&&Y(),"aria-label":"New tag"}),i.jsx("button",{onClick:Y,className:"btn btn-primary whitespace-nowrap",disabled:!vc(h),children:"Add Tag"})]}),!!a&&i.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:[B.length,"/",a," selected"]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-neutral-800 mb-3",children:"Browse Tags"}),i.jsx("input",{type:"text",value:E,onChange:T=>R(T.target.value),placeholder:"Search tags…",className:"input","aria-label":"Search tags"})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-neutral-800 mb-3",children:["Available Tags (",P.length,")"]}),p?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-neutral-600",children:"Loading tags…"})]}):P.length===0?i.jsxs("div",{className:"text-center py-8 text-neutral-600",children:['No tags found matching "',U,'"']}):i.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3 lg:grid-cols-4",children:P.map(T=>{const A=B.includes(T),F=!A&&a&&B.length>=a;return i.jsxs("button",{onClick:()=>G(T),disabled:F,className:`p-3 rounded-lg text-sm font-medium transition-all duration-200 text-left
                        ${A?"bg-primary-100 text-primary-800 border-2 border-primary-300":"bg-neutral-100 text-neutral-700 hover:bg-neutral-200 border-2 border-transparent"}
                        ${F?"opacity-50 cursor-not-allowed":""}`,"aria-pressed":A,"aria-label":`Tag ${T}`,title:F?"Maximum selected":`#${T}`,children:["#",T]},T)})})]})]}),i.jsx("div",{className:"bg-neutral-50 px-6 py-4 border-t border-neutral-200",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("span",{className:"text-sm text-neutral-600",children:[B.length," tag",B.length!==1?"s":""," selected",a?` • max ${a}`:""]}),i.jsx("button",{onClick:t,className:"btn btn-primary",children:"Done"})]})})]})}):null},nO=1.3;function sO(s,e,t){const n={repetition:s.repetition??0,interval:s.interval??0,easeFactor:s.easeFactor??2.5};let{repetition:a,interval:l,easeFactor:u}=n;if(e<3)a=0,l=1;else{a===0?l=1:a===1?l=6:l=Math.round(l*u),a+=1;const p=.1-(5-e)*(.08+(5-e)*.02);u=Math.max(nO,parseFloat((u+p).toFixed(2)))}const h=new Date(t+l*24*60*60*1e3);return{next:{...s,repetition:a,interval:l,easeFactor:u,reviewCount:(s.reviewCount??0)+1,lastReviewed:new Date(t),nextReview:h}}}const rO=({onClose:s,isVisible:e=!1})=>{const{user:t}=wn(),[n,a]=M.useState([]),[l,u]=M.useState(0),[h,m]=M.useState(!1),[p,x]=M.useState(!0),[w,b]=M.useState({total:0,due:0,new:0,learning:0,reviewing:0}),[E,R]=M.useState(null),[k,U]=M.useState(null),z=M.useRef(!0);M.useEffect(()=>(z.current=!0,e&&Y(),()=>{z.current=!1}),[e]),M.useEffect(()=>{t&&n.length>0&&!E&&e&&B()},[t,n.length,E,e]),M.useEffect(()=>{n[l]&&U(Date.now())},[l]),M.useEffect(()=>()=>{E&&q()},[E]),M.useEffect(()=>{if(!e)return;const V=D=>{if(D.key==="Escape")return s?.();if(n.length){if(!h&&(D.key===" "||D.key==="Enter")){D.preventDefault(),m(!0);return}h&&"12345".includes(D.key)&&(D.preventDefault(),P(parseInt(D.key,10))),D.key.toLowerCase()==="r"&&T()}};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[e,n.length,h]),M.useEffect(()=>{if(!e)return;const V=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=V}},[e]);const B=async()=>{if(t)try{const V=await Ka.startStudySession(t.uid,{mode:"spaced_repetition",deckId:null,deckName:"Spaced Repetition"});R(V),console.log("Spaced repetition session started:",V.sessionId)}catch(V){console.error("Failed to start spaced repetition session:",V)}},q=async()=>{if(!(!E||!t))try{const V=await Ka.endStudySession(E.sessionId,t.uid);console.log("Spaced repetition session ended:",V),R(null)}catch(V){console.warn("Analytics not available for session end:",V),R(null)}},G=async(V,D)=>{if(!E||!t||!k)return;const De=Math.round((Date.now()-k)/1e3),Z=V>=3;try{await Ka.recordCardAnswer(E.sessionId,{cardId:D.id,userId:t.uid,timeSpent:De,wasCorrect:Z,attempts:1,difficulty:"medium",confidenceLevel:V})}catch(O){console.warn("Analytics not available for card answer:",O)}},Y=async()=>{try{x(!0);const V=await os.getPublicFlashcards(50);if(!z.current)return;const D=Date.now(),Z=V.map((O,oe)=>({...O,id:O.id||`card-${oe}`,repetition:O.repetition??0,interval:O.interval??0,easeFactor:O.easeFactor??2.5,reviewCount:O.reviewCount??0,nextReview:O.nextReview?new Date(O.nextReview):new Date(D),difficulty:O.difficulty??3,lastReviewed:O.lastReviewed?new Date(O.lastReviewed):null,question:O.statement??O.question??"",answer:O.proof??O.answer??"",hints:Array.isArray(O.hints)?O.hints:O.hints?[O.hints]:[]})).sort((O,oe)=>O.nextReview-oe.nextReview);if(!z.current)return;a(Z),L(Z)}catch(V){console.error("Error loading cards:",V),z.current&&a([])}finally{z.current&&x(!1)}},L=V=>{const D=Date.now(),De=V.length,Z=V.filter($=>($.nextReview?.getTime?.()??$.nextReview)<=D).length,O=$=>$.reviewCount??0,oe={total:De,due:Z,new:V.filter($=>O($)===0).length,learning:V.filter($=>O($)>0&&O($)<5).length,reviewing:V.filter($=>O($)>=5).length};b(oe)},P=async V=>{const D=Date.now(),De=n[l];De&&await G(V,De),a(Z=>{if(!Z.length)return Z;const O=Z[l];if(!O)return Z;const{next:oe}=sO(O,V,D),$=[...Z];$[l]=oe;const ge=[...$].sort((C,ne)=>C.nextReview-ne.nextReview);return L(ge),ge}),u(Z=>Math.min(Z+1,n.length-1)),m(!1)},T=()=>{u(0),m(!1)},A=()=>n[l]||null,F=A();Th([F,h]);const j=()=>[{value:1,label:"Again",color:"bg-danger-500 hover:bg-danger-600"},{value:2,label:"Hard",color:"bg-warning-500 hover:bg-warning-600"},{value:3,label:"Good",color:"bg-success-500 hover:bg-success-600"},{value:4,label:"Easy",color:"bg-primary-500 hover:bg-primary-600"},{value:5,label:"Perfect",color:"bg-accent-500 hover:bg-accent-600"}];return e?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:i.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"sr-title",className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",tabIndex:-1,children:[i.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-secondary-600 px-6 py-4 text-white",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{id:"sr-title",className:"text-2xl font-bold",children:"🎯 Spaced Repetition"}),i.jsx("button",{onClick:s,className:"text-white/80 hover:text-white text-2xl transition-colors","aria-label":"Close spaced repetition",title:"Close (Esc)",children:"✕"})]}),i.jsx("p",{className:"text-white/90 mt-1",children:"Intelligent study scheduling for optimal learning"})]}),i.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:p?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-12 h-12 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-neutral-600 text-lg",children:"Loading your study session..."})]}):n.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-6xl mb-4",children:"📚"}),i.jsx("h3",{className:"text-2xl font-bold text-neutral-800 mb-2",children:"No cards available"}),i.jsx("p",{className:"text-neutral-600",children:"Create some flashcards to start studying!"})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8",children:[i.jsxs("div",{className:"card p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-primary-600",children:w.total}),i.jsx("div",{className:"text-sm text-neutral-600",children:"Total"})]}),i.jsxs("div",{className:"card p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-danger-600",children:w.due}),i.jsx("div",{className:"text-sm text-neutral-600",children:"Due"})]}),i.jsxs("div",{className:"card p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-accent-600",children:w.new}),i.jsx("div",{className:"text-sm text-neutral-600",children:"New"})]}),i.jsxs("div",{className:"card p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-warning-600",children:w.learning}),i.jsx("div",{className:"text-sm text-neutral-600",children:"Learning"})]}),i.jsxs("div",{className:"card p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-success-600",children:w.reviewing}),i.jsx("div",{className:"text-sm text-neutral-600",children:"Reviewing"})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("span",{className:"text-sm font-medium text-neutral-700",children:["Card ",l+1," of ",n.length]}),i.jsxs("span",{className:"text-sm text-neutral-500",children:[Math.round((l+1)/n.length*100),"% complete"]})]}),i.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:i.jsx("div",{className:"bg-gradient-to-r from-primary-500 to-secondary-500 h-2 rounded-full transition-all duration-300",style:{width:`${(l+1)/n.length*100}%`}})})]}),i.jsx("div",{className:"card p-8 mb-8",children:i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex justify-center gap-4 mb-6 text-sm text-neutral-600",children:[i.jsxs("span",{children:["Interval: ",A()?.interval||0," days"]}),i.jsxs("span",{children:["Reviews: ",A()?.reviewCount||0]}),i.jsxs("span",{children:["Ease: ",A()?.easeFactor?.toFixed(1)||"2.5"]})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-xl font-semibold text-neutral-800 mb-4",children:"Question"}),i.jsx("div",{className:"bg-neutral-50 p-6 rounded-xl text-lg text-neutral-700 min-h-[100px] flex items-center justify-center",children:A()?.question||"Loading..."})]}),h&&i.jsxs("div",{className:"mb-8 animate-fade-in",children:[i.jsx("h3",{className:"text-xl font-semibold text-neutral-800 mb-4",children:"Answer"}),i.jsx("div",{className:"bg-neutral-50 p-6 rounded-xl text-lg text-neutral-700 min-h-[100px] flex items-center justify-center",children:A()?.answer||"No answer available"}),A()?.hints&&A().hints.length>0&&i.jsxs("div",{className:"mt-4",children:[i.jsx("h4",{className:"text-lg font-medium text-neutral-700 mb-2",children:"Hints"}),i.jsx("div",{className:"space-y-2",children:A().hints.map((V,D)=>i.jsxs("div",{className:"bg-accent-50 p-3 rounded-lg text-neutral-700",children:["💡 ",V]},D))})]})]}),h?i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-neutral-800",children:"How well did you know this?"}),i.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:j().map(({value:V,label:D,color:De})=>i.jsxs("button",{onClick:()=>P(V),className:`btn text-white px-6 py-3 ${De}`,title:`${D} (${V})`,"aria-label":`Rate as ${D} (Press ${V})`,children:[V,". ",D]},V))})]}):i.jsx("button",{onClick:()=>m(!0),className:"btn btn-primary text-lg px-8 py-4",title:"Show Answer (Space or Enter)",children:"Show Answer"})]})}),i.jsxs("div",{className:"text-center mt-6 p-4 bg-gray-50 rounded-lg",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"⌨️ Keyboard Shortcuts"}),i.jsxs("div",{className:"text-xs text-gray-600 grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("kbd",{className:"px-1 py-0.5 bg-white border rounded text-xs",children:"Space"})," Show Answer"]}),i.jsxs("div",{children:[i.jsx("kbd",{className:"px-1 py-0.5 bg-white border rounded text-xs",children:"1-5"})," Rate Quality"]}),i.jsxs("div",{children:[i.jsx("kbd",{className:"px-1 py-0.5 bg-white border rounded text-xs",children:"R"})," Reset Session"]}),i.jsxs("div",{children:[i.jsx("kbd",{className:"px-1 py-0.5 bg-white border rounded text-xs",children:"Esc"})," Close"]})]})]}),i.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[i.jsx("button",{onClick:T,className:"btn btn-secondary",title:"Reset Session (R)",children:"🔄 Reset Session"}),i.jsx("button",{onClick:s,className:"btn btn-primary",title:"Finish Session (Esc)",children:"Finish Session"})]})]})})]})}):null},aO=(s,e=200)=>{const[t,n]=M.useState(s);return M.useEffect(()=>{const a=setTimeout(()=>n(s),e);return()=>clearTimeout(a)},[s,e]),t},iO=({onClose:s,isVisible:e=!1})=>{const[t,n]=M.useState(""),[a,l]=M.useState(""),[u,h]=M.useState(!1),[m,p]=M.useState(!1),[x,w]=M.useState(""),b=M.useRef(null),E=M.useRef(null),[R]=M.useState(["A direct sum B","The integral from 0 to infinity of x squared dx","The limit as x approaches 0 of sin x over x","The matrix with rows [1,2] and [3,4]","The set of all real numbers x such that x is greater than 0","The derivative of f with respect to x","The sum from n equals 1 to infinity of 1 over n squared","The product from i equals 1 to n of i","The square root of a squared plus b squared","The absolute value of x minus 3"]),k=aO(a,150);M.useEffect(()=>{e&&setTimeout(()=>b.current?.focus(),0)},[e]),M.useEffect(()=>{if(!e)return;const Y=L=>{L.key==="Escape"&&s?.()};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[e,s]),Th([k],E.current);const U=M.useCallback(async()=>{if(!(!t.trim()||u)){h(!0),w(""),p(!1);try{const Y=await pm.convertToLaTeX(t);l(Y||"")}catch(Y){console.error("Error converting to LaTeX:",Y),w("Could not convert to LaTeX. Please try again.")}finally{h(!1)}}},[t,u]),z=async Y=>{n(Y),setTimeout(()=>{U()},0)},B=async()=>{if(a)try{await navigator.clipboard.writeText(a),p(!0),setTimeout(()=>p(!1),1500)}catch(Y){console.error("Failed to copy:",Y),p(!1)}},q=()=>{n(""),l(""),p(!1),w(""),h(!1)},G=Y=>{(Y.ctrlKey||Y.metaKey)&&Y.key==="Enter"&&(Y.preventDefault(),U())};return e?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},role:"dialog","aria-modal":"true","aria-labelledby":"latex-converter-title",children:i.jsxs("div",{className:"claude-card rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[i.jsxs("div",{className:"px-6 py-4 text-white claude-gradient",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{id:"latex-converter-title",className:"text-2xl font-bold",children:"🔄 LaTeX Converter"}),i.jsx("button",{onClick:s,className:"text-white/80 hover:text-white text-2xl transition-colors","aria-label":"Close",children:"✕"})]}),i.jsx("p",{className:"text-white/90 mt-1",children:"Convert natural language to beautiful mathematical notation"})]}),i.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold mb-4",style:{color:"var(--heading)"},children:"Input"}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"nl-input",className:"block text-sm font-medium claude-text-secondary mb-2",children:"Natural Language Description"}),i.jsx("textarea",{id:"nl-input",ref:b,value:t,onChange:Y=>n(Y.target.value),placeholder:"e.g., A direct sum B, The integral from 0 to infinity of x squared dx...",className:"claude-input h-32",onKeyDown:G}),i.jsx("p",{className:"text-xs claude-text-muted mt-1",children:"Press Ctrl/⌘ + Enter to convert"})]}),i.jsx("button",{onClick:U,disabled:!t.trim()||u,className:"claude-button-primary w-full mb-4 disabled:opacity-60",children:u?i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Converting..."]}):"🔄 Convert to LaTeX"}),x&&i.jsxs("div",{className:"claude-alert claude-alert-error mb-4",children:[x," ",i.jsx("button",{className:"underline ml-1 font-medium",onClick:U,disabled:u,children:"Retry"})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-medium claude-text-secondary mb-3",children:"Quick Examples"}),i.jsx("div",{className:"space-y-2",children:R.map((Y,L)=>i.jsx("button",{onClick:()=>z(Y),className:"claude-card block w-full text-left p-3 text-sm claude-text-secondary transition-all hover:shadow-md","aria-label":`Use example: ${Y}`,children:Y},L))})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold mb-4",style:{color:"var(--heading)"},children:"Output"}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"latex-output",className:"block text-sm font-medium claude-text-secondary mb-2",children:"LaTeX Code"}),i.jsxs("div",{className:"relative",children:[i.jsx("textarea",{id:"latex-output",value:a,readOnly:!0,placeholder:"LaTeX will appear here...",className:"claude-input h-32 font-mono",style:{backgroundColor:"var(--background-modal)"}}),i.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-2",children:[a&&i.jsx("button",{onClick:B,className:"claude-button-secondary p-2",title:"Copy to clipboard","aria-label":"Copy LaTeX to clipboard",children:"📋"}),m&&i.jsx("span",{className:"px-2 py-1 text-xs rounded",style:{backgroundColor:"rgba(91, 200, 162, 0.1)",color:"var(--success)"},role:"status","aria-live":"polite",children:"Copied!"})]})]})]}),a&&i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium claude-text-secondary mb-2",children:"Preview"}),i.jsxs("div",{className:"claude-card p-4 min-h-[100px]",style:{border:"2px dashed var(--border-light)"},children:[i.jsx("div",{ref:E,className:"prose max-w-none",children:k}),!window.MathJax&&i.jsx("div",{className:"text-center mt-2 claude-text-muted text-xs",children:"(MathJax not loaded – preview shows raw TeX)"})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:q,disabled:!t&&!a&&!x,className:"claude-button-secondary w-full disabled:opacity-60",children:"🗑️ Clear All"}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-sm claude-text-secondary",children:"💡 Tip: Use this tool to quickly convert mathematical expressions"}),i.jsx("p",{className:"text-xs claude-text-muted mt-1",children:"Perfect for creating flashcards with LaTeX support"})]})]})]})]}),i.jsxs("div",{className:"mt-8 p-4 rounded-xl",style:{background:"linear-gradient(to right, var(--background-modal), rgba(68, 90, 255, 0.05))"},children:[i.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--heading)"},children:"How to use LaTeX in Three-Sided:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm claude-text-secondary",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Inline math:"})," Wrap with ",i.jsx("code",{className:"px-2 py-1 rounded",style:{backgroundColor:"var(--background-surface)"},children:"$ $"}),i.jsx("br",{}),i.jsxs("span",{className:"text-xs claude-text-muted",children:["Example: ",i.jsx("code",{children:"$x^2 + y^2 = z^2$"})]})]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Block math:"})," Wrap with ",i.jsx("code",{className:"px-2 py-1 rounded",style:{backgroundColor:"var(--background-surface)"},children:"$$ $$"}),i.jsx("br",{}),i.jsxs("span",{className:"text-xs claude-text-muted",children:["Example: ",i.jsxs("code",{children:["$$\\int_0^\\infty e^","{-x}"," \\, dx = 1$$"]})]})]})]})]})]})]})}):null};class ex{static async createCheckoutSession(){try{const e=await ws.currentUser?.getIdToken();if(!e)throw new Error("User must be authenticated");const t=await fetch("https://us-central1-three-sided-flashcard-app.cloudfunctions.net/createCheckoutSession",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(!t.ok){const a=await t.json();throw new Error(a.error||"Failed to create checkout session")}return(await t.json()).id}catch(e){throw console.error("Error creating checkout session:",e),e}}static async createPortalLink(){try{const e=await ws.currentUser?.getIdToken();if(!e)throw new Error("User must be authenticated");const t=await fetch("https://us-central1-three-sided-flashcard-app.cloudfunctions.net/createPortalLink",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(!t.ok){const a=await t.json();throw new Error(a.error||"Failed to create portal link")}return(await t.json()).url}catch(e){throw console.error("Error creating portal link:",e),e}}static async redirectToCheckout(e){const t=window.Stripe?window.Stripe("pk_live_51RUu9KE3qmOAkttRGqw7Cr2wJ6qRHtCz9qXpHJHO0Bv4Q7gGHg5QXI9GFdXGh4IhQD5Xf9XUvLFCr9G2PHK0003w0Q"):null;if(!t)throw new Error("Stripe.js not loaded. Please include the Stripe script in your HTML.");const{error:n}=await t.redirectToCheckout({sessionId:e});if(n)throw new Error(n.message)}}const Ma={monthly:{label:"Monthly",displayPrice:"£5",period:"month",savings:null,popular:!1,priceId:"price_1RUvcJE3qmOAkttR2Rh4YzOY",interval:"month"},yearly:{label:"Yearly",displayPrice:"£50",period:"year",savings:"£10",popular:!0,priceId:"price_YEARLY_REPLACE_ME",interval:"year"}},oO=[{name:"Spaced Repetition Mode",description:"Advanced algorithm for optimal learning",free:"✅",premium:"✅",icon:"🎯"},{name:"AI Autofill (Hint, Proof, Tags)",description:"Generate content with AI assistance",free:"⚠️ Limited (1/day)",premium:"✅ Unlimited",icon:"🤖"},{name:"AI Auto-Tagging",description:"Automatic tag suggestions",free:"⚠️ Limited (1/day)",premium:"✅ Unlimited",icon:"🏷️"},{name:"AI LaTeX Conversion",description:"Convert text to mathematical notation",free:"✅ Unlimited",premium:"✅ Unlimited",icon:"📐"},{name:"Public Profile & Sharing",description:"Share your flashcards with the community",free:"✅",premium:"✅ + Custom Themes",icon:"👤"},{name:"Advanced Analytics",description:"Detailed learning progress tracking",free:"❌",premium:"✅",icon:"📊"},{name:"Priority Support",description:"Get help when you need it most",free:"❌",premium:"✅",icon:"🎧"},{name:"Export & Backup",description:"Download your data anytime",free:"❌",premium:"✅",icon:"💾"}],lO=({onClose:s,isVisible:e=!1})=>{const[t,n]=M.useState("monthly"),[a,l]=M.useState(!1),[u,h]=M.useState(!1),[m,p]=M.useState(""),x=M.useRef(null);M.useEffect(()=>{if(e){const E=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=E}}},[e]),M.useEffect(()=>{if(!e)return;setTimeout(()=>x.current?.focus(),0);const E=R=>{R.key==="Escape"&&s?.()};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[e,s]);const w=M.useCallback(async()=>{p("");try{l(!0);const E=await ex.createCheckoutSession();await ex.redirectToCheckout(E)}catch(E){console.error("Error creating subscription:",E),p("Failed to start subscription. Please check your connection and try again.")}finally{l(!1)}},[t]),b=M.useCallback(async()=>{p("");try{h(!0);const E=await ex.createPortalLink();window.location.href=E}catch(E){console.error("Error accessing subscription management:",E),p("Failed to open the billing portal. Please try again.")}finally{h(!1)}},[]);return e?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:i.jsxs("div",{ref:x,tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":"premium-title",className:"claude-card rounded-2xl shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden outline-none",children:[i.jsxs("div",{className:"px-6 py-4 text-white claude-gradient",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{id:"premium-title",className:"text-2xl font-bold",children:"✨ Premium Features"}),i.jsx("button",{onClick:s,className:"text-white/80 hover:text-white text-2xl transition-colors","aria-label":"Close",children:"✕"})]}),i.jsx("p",{className:"text-white/90 mt-1",children:"Unlock the full potential of Three-Sided"})]}),i.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[m&&i.jsx("div",{className:"claude-alert claude-alert-error mb-4",children:m}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-2xl font-bold text-center mb-6",style:{color:"var(--heading)"},children:"Choose Your Plan"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto",role:"radiogroup","aria-label":"Billing plan",children:[i.jsxs("label",{className:`claude-card p-6 cursor-pointer transition-all duration-200 ${t==="monthly"?"claude-card-elevated":""}`,style:{border:t==="monthly"?"2px solid var(--accent-primary)":void 0,boxShadow:t==="monthly"?"0 0 20px rgba(99, 91, 255, 0.2)":void 0},children:[i.jsx("input",{type:"radio",name:"plan",value:"monthly",className:"sr-only",checked:t==="monthly",onChange:()=>n("monthly"),"aria-label":"Monthly plan"}),i.jsxs("div",{className:"text-center",children:[i.jsx("h4",{className:"text-xl font-bold mb-2",style:{color:"var(--heading)"},children:Ma.monthly.label}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--accent-primary)"},children:Ma.monthly.displayPrice}),i.jsxs("div",{className:"claude-text-secondary mb-4",children:["per ",Ma.monthly.period]}),i.jsx("div",{className:"w-4 h-4 rounded-full border-2 mx-auto border-2",style:{backgroundColor:t==="monthly"?"var(--accent-primary)":"transparent",borderColor:t==="monthly"?"var(--accent-primary)":"var(--border-light)"}})]})]}),i.jsxs("label",{className:`claude-card p-6 cursor-pointer transition-all duration-200 relative ${t==="yearly"?"claude-card-elevated":""}`,style:{border:t==="yearly"?"2px solid var(--accent-primary)":void 0,boxShadow:t==="yearly"?"0 0 20px rgba(99, 91, 255, 0.2)":void 0},children:[i.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:i.jsx("span",{className:"text-white px-3 py-1 rounded-full text-xs font-bold",style:{backgroundColor:"var(--accent-secondary)"},children:"MOST POPULAR"})}),i.jsx("input",{type:"radio",name:"plan",value:"yearly",className:"sr-only",checked:t==="yearly",onChange:()=>n("yearly"),"aria-label":"Yearly plan"}),i.jsxs("div",{className:"text-center",children:[i.jsx("h4",{className:"text-xl font-bold mb-2",style:{color:"var(--heading)"},children:Ma.yearly.label}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--accent-primary)"},children:Ma.yearly.displayPrice}),i.jsxs("div",{className:"claude-text-secondary mb-2",children:["per ",Ma.yearly.period]}),i.jsxs("div",{className:"font-bold mb-4",style:{color:"var(--success)"},children:["Save ",Ma.yearly.savings,"!"]}),i.jsx("div",{className:"w-4 h-4 rounded-full border-2 mx-auto",style:{backgroundColor:t==="yearly"?"var(--accent-primary)":"transparent",borderColor:t==="yearly"?"var(--accent-primary)":"var(--border-light)"}})]})]})]})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-2xl font-bold text-center mb-6",style:{color:"var(--heading)"},children:"Feature Comparison"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"2px solid var(--border-light)"},children:[i.jsx("th",{className:"text-left p-4 font-semibold",style:{color:"var(--heading)"},children:"Feature"}),i.jsx("th",{className:"text-center p-4 font-semibold",style:{color:"var(--heading)"},children:"Free"}),i.jsx("th",{className:"text-center p-4 font-semibold rounded-lg",style:{color:"var(--heading)",background:"linear-gradient(to right, rgba(99, 91, 255, 0.1), rgba(68, 90, 255, 0.1))"},children:"Premium"})]})}),i.jsx("tbody",{children:oO.map((E,R)=>i.jsxs("tr",{className:"claude-card hover:shadow-sm transition-all",style:{border:"none",marginBottom:"4px"},children:[i.jsx("td",{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-2xl",children:E.icon}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",style:{color:"var(--heading)"},children:E.name}),i.jsx("div",{className:"text-sm claude-text-secondary",children:E.description})]})]})}),i.jsx("td",{className:"p-4 text-center",children:i.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium",style:{backgroundColor:E.free==="✅"?"rgba(91, 200, 162, 0.1)":E.free.startsWith("⚠️")?"rgba(255, 213, 84, 0.1)":"var(--background-modal)",color:E.free==="✅"?"var(--success)":E.free.startsWith("⚠️")?"var(--warning)":"var(--text-secondary)"},children:E.free})}),i.jsx("td",{className:"p-4 text-center",style:{background:"linear-gradient(to right, rgba(99, 91, 255, 0.05), rgba(68, 90, 255, 0.05))"},children:i.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium",style:{backgroundColor:"rgba(91, 200, 162, 0.1)",color:"var(--success)"},children:E.premium})})]},R))})]})})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-2xl font-bold text-center mb-6",style:{color:"var(--heading)"},children:"Why Go Premium?"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"claude-card p-6 text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"🚀"}),i.jsx("h4",{className:"text-lg font-bold mb-2",style:{color:"var(--heading)"},children:"Accelerate Learning"}),i.jsx("p",{className:"claude-text-secondary",children:"Unlimited AI assistance helps you create better flashcards faster"})]}),i.jsxs("div",{className:"claude-card p-6 text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"📈"}),i.jsx("h4",{className:"text-lg font-bold mb-2",style:{color:"var(--heading)"},children:"Track Progress"}),i.jsx("p",{className:"claude-text-secondary",children:"Advanced analytics show your learning journey and improvement"})]}),i.jsxs("div",{className:"claude-card p-6 text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"🎯"}),i.jsx("h4",{className:"text-lg font-bold mb-2",style:{color:"var(--heading)"},children:"Study Smarter"}),i.jsx("p",{className:"claude-text-secondary",children:"Spaced repetition algorithm optimizes your study schedule"})]})]})]}),i.jsxs("div",{className:"text-center space-y-4",children:[i.jsx("button",{onClick:w,disabled:a,className:"claude-button-primary text-lg px-12 py-4 disabled:opacity-60 disabled:cursor-not-allowed",style:{boxShadow:"0 0 20px rgba(99, 91, 255, 0.3)"},children:a?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Processing..."]}):`Go Premium - ${Ma[t].displayPrice}/${Ma[t].period}`}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:b,disabled:u,className:"claude-button-secondary disabled:opacity-60 disabled:cursor-not-allowed",children:u?"Opening…":"Manage Subscription"}),i.jsx("button",{onClick:s,className:"claude-button-secondary",children:"Maybe Later"})]})]}),i.jsx("div",{className:"mt-8 p-4 rounded-xl text-center",style:{backgroundColor:"var(--background-modal)"},children:i.jsx("p",{className:"text-sm claude-text-secondary",children:"💳 Secure payment powered by Stripe • Cancel anytime • 30-day money-back guarantee"})})]})]})}):null},cO=({onProfileCreated:s,onClose:e})=>{const{user:t}=wn(),[n,a]=M.useState({displayName:"",bio:"",institution:""}),[l,u]=M.useState(""),[h,m]=M.useState({state:"idle",message:""}),[p,x]=M.useState(!1),[w,b]=M.useState(null),E={displayName:50,bio:1e3,institution:100},R=M.useCallback(async q=>{const G=As.slugify(q);if(u(G),!G){m({state:"idle",message:""});return}m({state:"checking",message:"Checking availability..."});try{const Y=await As.isSlugTaken(G);m(Y?{state:"taken",message:`❌ ${G} is already taken`}:{state:"available",message:`✅ ${G} is available!`})}catch{m({state:"error",message:"❌ Error checking availability. Please try again."})}},[]),k=q=>{a(Y=>({...Y,displayName:q})),w&&clearTimeout(w);const G=setTimeout(()=>{R(q)},400);b(G)},U=async q=>{if(q.preventDefault(),!t){alert("You must be logged in to create a profile.");return}if(n.displayName.length<2||n.displayName.length>E.displayName){alert(`Display name must be between 2 and ${E.displayName} characters.`);return}if(n.bio.length>E.bio){alert(`Bio must be ${E.bio} characters or less.`);return}if(n.institution.length>E.institution){alert(`Institution must be ${E.institution} characters or less.`);return}if(!l||h.state!=="available"){alert("Please wait for slug availability check or choose a different name.");return}x(!0);try{if(await As.isSlugTaken(l)){alert(`Username "${l}" was just taken. Please choose another name.`),await R(n.displayName);return}await As.createProfile(t.uid,l,{displayName:n.displayName.trim(),bio:n.bio.trim(),institution:n.institution.trim(),email:t.email}),s&&s()}catch(G){console.error("Error creating profile:",G),alert("Something went wrong. Please try again.")}finally{x(!1)}},z=({current:q,max:G,label:Y})=>{const L=q/G*100;let P="text-sm ";return L>90?P+="text-red-500":L>70?P+="text-yellow-500":P+="text-gray-500",i.jsxs("div",{className:P,children:[q,"/",G," ",Y]})};M.useEffect(()=>()=>{w&&clearTimeout(w)},[w]);const B=n.displayName.length>=2&&n.displayName.length<=E.displayName&&n.bio.length<=E.bio&&n.institution.length<=E.institution&&h.state==="available";return i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-4xl font-extrabold mb-4",style:{color:"var(--claude-heading)"},children:"Create Your Profile"}),i.jsx("p",{className:"claude-text-secondary text-lg",children:"Set up your public profile to connect with others"})]}),i.jsx("div",{className:"claude-card p-8",children:i.jsxs("form",{onSubmit:U,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Display Name *"}),i.jsx("input",{type:"text",value:n.displayName,onChange:q=>k(q.target.value),placeholder:"Enter your display name",maxLength:E.displayName,required:!0,className:"w-full px-4 py-3 rounded-xl border transition-colors focus:outline-none focus:ring-2",style:{backgroundColor:"var(--claude-subtle)",borderColor:"var(--claude-border)",color:"var(--claude-primary-text)"},onFocus:q=>{q.target.style.borderColor="var(--claude-accent)",q.target.style.boxShadow="0 0 0 3px rgba(99, 91, 255, 0.1)"},onBlur:q=>{q.target.style.borderColor="var(--claude-border)",q.target.style.boxShadow="none"}}),i.jsx("div",{className:"flex justify-between items-center mt-2",children:i.jsx(z,{current:n.displayName.length,max:E.displayName,label:"characters"})}),i.jsxs("div",{className:"mt-3 p-3 rounded-lg",style:{backgroundColor:"var(--claude-subtle)"},children:[i.jsxs("div",{className:"text-sm claude-text-secondary",children:["Your profile URL: ",i.jsxs("strong",{children:["three-sided.app/profile/",i.jsx("span",{className:"font-mono",children:l||"..."})]})]}),h.message&&i.jsxs("div",{className:`text-sm mt-1 ${h.state==="checking"?"text-blue-500":h.state==="available"?"text-green-500":(h.state==="taken","text-red-500")}`,children:[h.state==="checking"&&i.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 border border-blue-500 border-t-transparent rounded-full animate-spin"}),h.message]}),h.state!=="checking"&&h.message]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Short Bio"}),i.jsx("textarea",{value:n.bio,onChange:q=>a(G=>({...G,bio:q.target.value})),placeholder:"Tell others a bit about yourself...",maxLength:E.bio,rows:4,className:"w-full px-4 py-3 rounded-xl border transition-colors focus:outline-none focus:ring-2 resize-none",style:{backgroundColor:"var(--claude-subtle)",borderColor:"var(--claude-border)",color:"var(--claude-primary-text)"},onFocus:q=>{q.target.style.borderColor="var(--claude-accent)",q.target.style.boxShadow="0 0 0 3px rgba(99, 91, 255, 0.1)"},onBlur:q=>{q.target.style.borderColor="var(--claude-border)",q.target.style.boxShadow="none"}}),i.jsxs("div",{className:"flex justify-between items-center mt-2",children:[i.jsx("div",{className:"text-sm claude-text-secondary",children:"Share your interests, expertise, or what you're studying"}),i.jsx(z,{current:n.bio.length,max:E.bio,label:"characters"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Institution"}),i.jsx("input",{type:"text",value:n.institution,onChange:q=>a(G=>({...G,institution:q.target.value})),placeholder:"University, company, or organization (optional)",maxLength:E.institution,className:"w-full px-4 py-3 rounded-xl border transition-colors focus:outline-none focus:ring-2",style:{backgroundColor:"var(--claude-subtle)",borderColor:"var(--claude-border)",color:"var(--claude-primary-text)"},onFocus:q=>{q.target.style.borderColor="var(--claude-accent)",q.target.style.boxShadow="0 0 0 3px rgba(99, 91, 255, 0.1)"},onBlur:q=>{q.target.style.borderColor="var(--claude-border)",q.target.style.boxShadow="none"}}),i.jsxs("div",{className:"flex justify-between items-center mt-2",children:[i.jsx("div",{}),i.jsx(z,{current:n.institution.length,max:E.institution,label:"characters"})]})]}),i.jsxs("div",{className:"flex gap-4 pt-4",children:[i.jsx("button",{type:"submit",disabled:!B||p,className:"flex-1 claude-button-primary disabled:opacity-50 disabled:cursor-not-allowed",children:p?i.jsxs("span",{className:"flex items-center justify-center gap-2",children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating Profile..."]}):"Create Profile"}),e&&i.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 rounded-xl font-medium transition-colors",style:{backgroundColor:"var(--claude-subtle)",color:"var(--claude-secondary-text)"},onMouseEnter:q=>{q.target.style.backgroundColor="var(--claude-surface-hover)"},onMouseLeave:q=>{q.target.style.backgroundColor="var(--claude-subtle)"},children:"Cancel"})]})]})})]})})};class xn{static async getFriendRequests(e){try{const t=Le(Ce(te,"friendRequests"),Ye("to","==",e),Jt("timestamp","desc")),n=await Ke(t),a=[];for(const l of n.docs){const u=l.data(),h=u.from,m=await As.getProfileByUserId(h);a.push({id:l.id,fromId:h,toId:u.to,timestamp:u.timestamp,senderProfile:m||{displayName:"Unknown User",slug:null}})}return a}catch(t){throw console.error("Error getting friend requests:",t),t}}static async sendFriendRequest(e,t){try{if(!e||!t||e===t)throw new Error("Invalid user IDs");const[n,a]=await Promise.all([this.checkExistingRequest(e,t),this.checkExistingRequest(t,e)]);if(n)throw new Error("Friend request already sent");if(a)throw new Error("This user has already sent you a friend request");if(await this.areFriends(e,t))throw new Error("You are already friends");const u=3;let h;for(let m=1;m<=u;m++)try{await Ys(Ce(te,"friendRequests"),{from:e,to:t,timestamp:Me(),status:"pending"}),console.log("✅ Friend request sent:",{fromId:e,toId:t});return}catch(p){h=p,m<u&&(console.warn(`Retry ${m}/${u} for friend request:`,p.message),await new Promise(x=>setTimeout(x,1e3*m)))}throw h}catch(n){throw console.error("❌ Error sending friend request:",n),n}}static async acceptFriendRequest(e,t,n){try{if(!e||!t||!n||t===n)throw new Error("Invalid parameters for accepting friend request");const a=await vt(be(te,"friendRequests",e));if(!a.exists())throw new Error("Friend request not found");const l=a.data();if(l.from!==t||l.to!==n)throw new Error("Friend request does not match the specified users");if(await this.areFriends(t,n)){await nl(be(te,"friendRequests",e)),console.log("Users were already friends, cleaned up request");return}const h=sl(te),m=be(te,"userFriends",n,"friends",t),p=be(te,"userFriends",t,"friends",n),x={addedAt:Me(),requestAcceptedAt:Me(),status:"active"};h.set(m,x),h.set(p,x);const w=be(te,"friendRequests",e);h.delete(w);const b=3;let E;for(let R=1;R<=b;R++)try{await h.commit(),console.log("✅ Friend request accepted:",{fromId:t,toId:n,requestId:e});return}catch(k){E=k,R<b&&(console.warn(`Retry ${R}/${b} for accepting friend request:`,k.message),await new Promise(U=>setTimeout(U,1e3*R)))}throw E}catch(a){throw console.error("❌ Error accepting friend request:",a),a}}static async rejectFriendRequest(e){try{await nl(be(te,"friendRequests",e)),console.log("✅ Friend request rejected:",e)}catch(t){throw console.error("❌ Error rejecting friend request:",t),t}}static async removeFriend(e,t){try{if(!e||!t||e===t)throw new Error("Invalid user IDs for removing friend");if(!await this.areFriends(e,t)){console.log("Users are not friends, nothing to remove");return}const a=sl(te),l=be(te,"userFriends",e,"friends",t),u=be(te,"userFriends",t,"friends",e);a.delete(l),a.delete(u);const h=3;let m;for(let p=1;p<=h;p++)try{await a.commit(),console.log("✅ Friend removed:",{userId:e,friendId:t});return}catch(x){m=x,p<h&&(console.warn(`Retry ${p}/${h} for removing friend:`,x.message),await new Promise(w=>setTimeout(w,1e3*p)))}throw m}catch(n){throw console.error("❌ Error removing friend:",n),n}}static async getFriends(e){try{const t=Le(Ce(te,"userFriends",e,"friends")),n=await Ke(t),a=[];for(const l of n.docs){const u=l.id,h=l.data(),m=await As.getProfileByUserId(u);m&&a.push({userId:u,addedAt:h.addedAt,...m})}return a}catch(t){throw console.error("Error getting friends:",t),t}}static async getFriendshipStatus(e,t){try{const n=await this.areFriends(e,t),a=await this.checkExistingRequest(e,t),l=await this.checkExistingRequest(t,e);return{areFriends:n,sentRequest:!!a,receivedRequest:!!l,receivedRequestId:l?.id||null}}catch(n){return console.error("Error getting friendship status:",n),{areFriends:!1,sentRequest:!1,receivedRequest:!1,receivedRequestId:null}}}static async areFriends(e,t){try{return(await vt(be(te,"userFriends",e,"friends",t))).exists()}catch(n){return console.error("Error checking friendship:",n),!1}}static async checkExistingRequest(e,t){try{const n=Le(Ce(te,"friendRequests"),Ye("from","==",e),Ye("to","==",t)),a=await Ke(n);if(!a.empty){const l=a.docs[0];return{id:l.id,...l.data()}}return null}catch(n){return console.error("Error checking existing request:",n),null}}static async getMutualFriends(e,t){try{const[n,a]=await Promise.all([this.getFriendIds(e),this.getFriendIds(t)]),l=n.filter(h=>a.includes(h)),u=[];for(let h=0;h<Math.min(3,l.length);h++){const m=await As.getProfileByUserId(l[h]);m&&u.push(m)}return{total:l.length,profiles:u,hasMore:l.length>3}}catch(n){return console.error("Error getting mutual friends:",n),{total:0,profiles:[],hasMore:!1}}}static async getFriendCount(e){try{const t=Le(Ce(te,"userFriends",e,"friends"));return(await Ke(t)).size}catch(t){return console.error("Error getting friend count:",t),0}}static async getFriendIds(e){try{const t=Le(Ce(te,"userFriends",e,"friends"));return(await Ke(t)).docs.map(a=>a.id)}catch(t){return console.error("Error getting friend IDs:",t),[]}}}const uO=({onViewProfile:s})=>{const{user:e}=wn(),[t,n]=M.useState("friends"),[a,l]=M.useState([]),[u,h]=M.useState([]),[m,p]=M.useState([]),[x,w]=M.useState(""),[b,E]=M.useState(!1),[R,k]=M.useState([]),[U,z]=M.useState({friendCount:0,requestCount:0,sharedCardsCount:0,mutualConnections:0});M.useEffect(()=>{e&&B()},[e]),M.useEffect(()=>{switch(t){case"friends":q();break;case"requests":G();break;case"leaderboard":F();break}},[t]);const B=async()=>{try{const[Z,O,oe]=await Promise.all([xn.getFriendCount(e.uid),xn.getFriendRequests(e.uid),os.getPublicFlashcardsByUser(e.uid)]);z($=>({...$,friendCount:Z,requestCount:O.length,sharedCardsCount:oe.length}))}catch(Z){console.error("Error loading initial data:",Z)}},q=async()=>{E(!0);try{const Z=await xn.getFriends(e.uid);l(Z),z(O=>({...O,friendCount:Z.length}))}catch(Z){console.error("Error loading friends:",Z)}finally{E(!1)}},G=async()=>{E(!0);try{const Z=await xn.getFriendRequests(e.uid);h(Z),z(O=>({...O,requestCount:Z.length}))}catch(Z){console.error("Error loading friend requests:",Z)}finally{E(!1)}},Y=async()=>{if(x.trim()){E(!0);try{const O=(await As.searchProfiles(x)).filter($=>$.userId!==e.uid),oe=await Promise.all(O.map(async $=>{const ge=await xn.getFriendshipStatus(e.uid,$.userId),C=await xn.getMutualFriends(e.uid,$.userId);return{...$,friendshipStatus:ge,mutualFriends:C}}));p(oe)}catch(Z){console.error("Error searching users:",Z)}finally{E(!1)}}},L=async Z=>{try{await xn.sendFriendRequest(e.uid,Z),j("Friend request sent!"),x&&await Y(),await B()}catch(O){console.error("Error sending friend request:",O),j("Failed to send friend request",!0)}},P=async Z=>{try{await xn.acceptFriendRequest(Z.id,Z.fromId,e.uid),j("Friend request accepted!"),await G(),await B(),t==="friends"&&await q()}catch(O){console.error("Error accepting friend request:",O),j("Failed to accept friend request",!0)}},T=async Z=>{try{await xn.rejectFriendRequest(Z),j("Friend request declined"),await G(),await B()}catch(O){console.error("Error rejecting friend request:",O),j("Failed to reject friend request",!0)}},A=async(Z,O)=>{if(confirm(`Remove ${O} from your friends?`))try{await xn.removeFriend(e.uid,Z),j("Friend removed"),await q(),await B()}catch(oe){console.error("Error removing friend:",oe),j("Failed to remove friend",!0)}},F=async()=>{E(!0);try{const Z=await xn.getFriendIds(e.uid),O=[e.uid,...Z],oe=[];for(const ge of O){const C=await As.getProfileByUserId(ge);C&&oe.push({...C,userId:ge})}const $=await Promise.all(oe.map(async ge=>{const C=await xn.getFriendCount(ge.userId);return{...ge,friendCount:C,isCurrentUser:ge.userId===e.uid}}));$.sort((ge,C)=>C.friendCount-ge.friendCount),k($)}catch(Z){console.error("Error loading leaderboard:",Z)}finally{E(!1)}},j=(Z,O=!1)=>{const oe=document.createElement("div");oe.className="fixed top-4 right-4 px-6 py-3 rounded-lg text-white font-medium z-50 transition-transform transform translate-x-full",oe.style.backgroundColor=O?"#ef4444":"#10b981",oe.textContent=Z,document.body.appendChild(oe),setTimeout(()=>{oe.style.transform="translateX(0)"},100),setTimeout(()=>{oe.style.transform="translateX(100%)",setTimeout(()=>{document.body.removeChild(oe)},300)},3e3)},V=Z=>Z?Z.split(" ").map(O=>O.charAt(0)).join("").toUpperCase().slice(0,2):"?",D=(Z,O,oe,$=!0)=>{const ge=()=>$?O?.areFriends?i.jsx("button",{onClick:()=>A(Z.userId,Z.displayName),className:"px-3 py-1 rounded-lg text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:"Remove"}):O?.sentRequest?i.jsx("span",{className:"px-3 py-1 rounded-lg text-sm font-medium bg-yellow-100 text-yellow-800",children:"Request Sent"}):O?.receivedRequest?i.jsx("button",{onClick:()=>P({id:O.receivedRequestId,fromId:Z.userId}),className:"px-3 py-1 rounded-lg text-sm font-medium bg-green-500 text-white hover:bg-green-600 transition-colors",children:"Accept"}):i.jsx("button",{onClick:()=>L(Z.userId),className:"px-3 py-1 rounded-lg text-sm font-medium bg-blue-500 text-white hover:bg-blue-600 transition-colors",children:"Add Friend"}):null,C=()=>O?.areFriends?i.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-100 text-green-800",children:"Friends"}):O?.sentRequest?i.jsx("span",{className:"px-2 py-1 rounded text-xs bg-yellow-100 text-yellow-800",children:"Pending"}):O?.receivedRequest?i.jsx("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 text-blue-800",children:"Wants to connect"}):null;return i.jsx("div",{className:"claude-card p-4 hover:scale-[1.02] transition-transform",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold",style:{background:"var(--claude-accent)"},children:V(Z.displayName)}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h3",{className:"font-semibold",style:{color:"var(--claude-heading)"},children:s&&Z.slug?i.jsx("button",{onClick:()=>s(Z.slug),className:"hover:underline transition-colors",style:{color:"var(--claude-heading)"},children:Z.displayName||"Unknown User"}):Z.displayName||"Unknown User"}),C()]}),i.jsxs("div",{className:"text-sm claude-text-secondary space-y-1",children:[Z.email&&i.jsx("div",{children:Z.email}),Z.institution&&i.jsxs("div",{children:["🏫 ",Z.institution]}),oe?.total>0&&i.jsxs("div",{className:"text-green-600 font-medium",children:[oe.total," mutual friend",oe.total>1?"s":""]})]})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:ge()})]})},Z.userId)},De=[{id:"friends",label:"My Friends",icon:"👥"},{id:"discover",label:"Discover",icon:"🔍"},{id:"requests",label:"Requests",icon:"📬",badge:U.requestCount},{id:"leaderboard",label:"Leaderboard",icon:"🏆"}];return i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-4xl font-extrabold mb-4",style:{color:"var(--claude-heading)"},children:"👥 Friends & Social"}),i.jsx("p",{className:"claude-text-secondary text-lg",children:"Connect with fellow learners and share your progress"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[i.jsxs("div",{className:"claude-card p-6 text-center",children:[i.jsx("div",{className:"text-3xl mb-2",children:"👥"}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--claude-accent-blue)"},children:U.friendCount}),i.jsx("div",{className:"claude-text-secondary",children:"Friends"})]}),i.jsxs("div",{className:"claude-card p-6 text-center",children:[i.jsx("div",{className:"text-3xl mb-2",children:"📚"}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--claude-accent)"},children:U.sharedCardsCount}),i.jsx("div",{className:"claude-text-secondary",children:"Cards Shared"})]}),i.jsxs("div",{className:"claude-card p-6 text-center",children:[i.jsx("div",{className:"text-3xl mb-2",children:"📬"}),i.jsx("div",{className:"text-3xl font-bold mb-1",style:{color:"var(--claude-success)"},children:U.requestCount}),i.jsx("div",{className:"claude-text-secondary",children:"Pending Requests"})]})]}),i.jsx("div",{className:"claude-card p-2 mb-8",children:i.jsx("div",{className:"flex",children:De.map(Z=>i.jsxs("button",{onClick:()=>n(Z.id),className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-medium transition-all duration-200 relative",style:{backgroundColor:t===Z.id?"var(--claude-accent)":"transparent",color:t===Z.id?"white":"var(--claude-secondary-text)"},children:[i.jsx("span",{children:Z.icon}),Z.label,Z.badge>0&&i.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-2 py-1 min-w-[20px] text-center",children:Z.badge})]},Z.id))})}),i.jsxs("div",{className:"claude-card p-8",children:[t==="friends"&&i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--claude-heading)"},children:["👥 My Friends (",U.friendCount,")"]}),b?i.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((Z,O)=>i.jsx("div",{className:"animate-pulse claude-card p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-full",style:{backgroundColor:"var(--claude-border)"}}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"h-4 rounded mb-2",style:{backgroundColor:"var(--claude-border)"}}),i.jsx("div",{className:"h-3 rounded w-1/2",style:{backgroundColor:"var(--claude-border)"}})]})]})},O))}):a.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-6xl mb-4",children:"👥"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"No friends yet"}),i.jsx("p",{className:"claude-text-secondary",children:"Search for users to add your first friend!"})]}):i.jsx("div",{className:"space-y-4",children:a.map(Z=>D(Z,{areFriends:!0},null,!0))})]}),t==="discover"&&i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--claude-heading)"},children:"🔍 Discover Users"}),i.jsxs("div",{className:"flex gap-4 mb-6",children:[i.jsx("input",{type:"text",value:x,onChange:Z=>w(Z.target.value),onKeyPress:Z=>Z.key==="Enter"&&Y(),placeholder:"Search by email or display name...",className:"flex-1 px-4 py-3 rounded-xl border transition-colors focus:outline-none focus:ring-2",style:{backgroundColor:"var(--claude-subtle)",borderColor:"var(--claude-border)",color:"var(--claude-primary-text)"}}),i.jsxs("button",{onClick:Y,disabled:!x.trim()||b,className:"claude-button-primary disabled:opacity-50",children:[b?"⏳":"🔍"," Search"]})]}),i.jsx("p",{className:"text-sm claude-text-secondary mb-6",children:"💡 Tip: Search by email address or display name for best results"}),b?i.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((Z,O)=>i.jsx("div",{className:"animate-pulse claude-card p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-full",style:{backgroundColor:"var(--claude-border)"}}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"h-4 rounded mb-2",style:{backgroundColor:"var(--claude-border)"}}),i.jsx("div",{className:"h-3 rounded w-1/2",style:{backgroundColor:"var(--claude-border)"}})]})]})},O))}):m.length===0&&x?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-6xl mb-4",children:"😔"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"No users found"}),i.jsx("p",{className:"claude-text-secondary",children:"Try searching with a different email or username"})]}):m.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"Discover new friends"}),i.jsx("p",{className:"claude-text-secondary",children:"Search for users to connect with and share your learning journey!"})]}):i.jsx("div",{className:"space-y-4",children:m.map(Z=>D(Z,Z.friendshipStatus,Z.mutualFriends,!0))})]}),t==="requests"&&i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--claude-heading)"},children:["📬 Friend Requests (",U.requestCount,")"]}),b?i.jsx("div",{className:"space-y-4",children:Array.from({length:2}).map((Z,O)=>i.jsx("div",{className:"animate-pulse claude-card p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-full",style:{backgroundColor:"var(--claude-border)"}}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"h-4 rounded mb-2",style:{backgroundColor:"var(--claude-border)"}}),i.jsx("div",{className:"h-3 rounded w-1/2",style:{backgroundColor:"var(--claude-border)"}})]})]})},O))}):u.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-6xl mb-4",children:"📬"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"No pending requests"}),i.jsx("p",{className:"claude-text-secondary",children:"You're all caught up! New friend requests will appear here."})]}):i.jsx("div",{className:"space-y-4",children:u.map(Z=>i.jsx("div",{className:"claude-card p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold",style:{background:"var(--claude-accent)"},children:V(Z.senderProfile.displayName)}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold",style:{color:"var(--claude-heading)"},children:Z.senderProfile.displayName||"Unknown User"}),i.jsx("div",{className:"text-sm claude-text-secondary",children:"Wants to connect with you"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>P(Z),className:"px-4 py-2 rounded-lg font-medium bg-green-500 text-white hover:bg-green-600 transition-colors",children:"Accept"}),i.jsx("button",{onClick:()=>T(Z.id),className:"px-4 py-2 rounded-lg font-medium bg-gray-500 text-white hover:bg-gray-600 transition-colors",children:"Decline"})]})]})},Z.id))})]}),t==="leaderboard"&&i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--claude-heading)"},children:"🏆 Friends Leaderboard"}),i.jsx("p",{className:"claude-text-secondary mb-6",children:"Top learners among you and your friends"}),b?i.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((Z,O)=>i.jsx("div",{className:"animate-pulse claude-card p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-full",style:{backgroundColor:"var(--claude-border)"}}),i.jsx("div",{className:"w-12 h-12 rounded-full",style:{backgroundColor:"var(--claude-border)"}}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"h-4 rounded mb-2",style:{backgroundColor:"var(--claude-border)"}}),i.jsx("div",{className:"h-3 rounded w-1/2",style:{backgroundColor:"var(--claude-border)"}})]}),i.jsx("div",{className:"w-16 h-8 rounded",style:{backgroundColor:"var(--claude-border)"}})]})},O))}):R.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-6xl mb-4",children:"🏆"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"No leaderboard data"}),i.jsx("p",{className:"claude-text-secondary",children:"Add some friends to see the leaderboard!"})]}):i.jsx("div",{className:"space-y-3",children:R.map((Z,O)=>i.jsx("div",{className:`claude-card p-4 transition-all duration-300 hover:scale-[1.02] ${Z.isCurrentUser?"ring-2 ring-blue-500 bg-blue-50/10":""}`,style:{backgroundColor:O<3&&!Z.isCurrentUser?"rgba(255, 215, 0, 0.1)":Z.isCurrentUser?"rgba(59, 130, 246, 0.1)":"var(--claude-surface)",border:`1px solid ${O<3&&!Z.isCurrentUser?"rgba(255, 215, 0, 0.3)":Z.isCurrentUser?"rgba(59, 130, 246, 0.3)":"var(--claude-border)"}`},children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm",style:{background:O<3?"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)":"var(--claude-muted)",color:O<3?"white":"var(--claude-text)"},children:O===0?"🥇":O===1?"🥈":O===2?"🥉":O+1}),i.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold",style:{background:"var(--claude-accent)"},children:V(Z.displayName)}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold",style:{color:"var(--claude-heading)"},children:[Z.displayName||"Unknown User",Z.isCurrentUser&&i.jsx("span",{className:"ml-2 px-2 py-1 rounded text-xs bg-blue-100 text-blue-800",children:"You"})]}),Z.slug&&i.jsxs("button",{onClick:()=>s&&s(Z.slug),className:"text-sm transition-colors hover:underline",style:{color:"var(--claude-accent)"},children:["@",Z.slug]})]}),i.jsx("div",{className:"claude-text-secondary text-sm",children:Z.institution&&`🏫 ${Z.institution}`})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xl font-bold",style:{color:O<3?"#FFD700":"var(--claude-accent-blue)"},children:Z.friendCount}),i.jsxs("div",{className:"claude-text-secondary text-sm",children:["friend",Z.friendCount!==1?"s":""]})]})]})},Z.userId))})]})]})]})})},dO=({profile:s,onSave:e,onCancel:t})=>{const[n,a]=M.useState({displayName:"",bio:"",institution:""}),[l,u]=M.useState(!1),h={displayName:50,bio:1e3,institution:100};M.useEffect(()=>{s&&a({displayName:s.displayName||"",bio:s.bio||"",institution:s.institution||""})},[s]);const m=async x=>{if(x.preventDefault(),n.displayName.length<2||n.displayName.length>h.displayName){alert(`Display name must be between 2 and ${h.displayName} characters.`);return}if(n.bio.length>h.bio){alert(`Bio must be ${h.bio} characters or less.`);return}if(n.institution.length>h.institution){alert(`Institution must be ${h.institution} characters or less.`);return}u(!0);try{await As.updateProfile(s.slug,{displayName:n.displayName.trim(),bio:n.bio.trim(),institution:n.institution.trim()}),e&&e({...s,displayName:n.displayName.trim(),bio:n.bio.trim(),institution:n.institution.trim()})}catch(w){console.error("Error updating profile:",w),alert("Something went wrong. Please try again.")}finally{u(!1)}},p=({current:x,max:w,label:b})=>{const E=x/w*100;let R="text-sm ";return E>90?R+="text-red-500":E>70?R+="text-yellow-500":R+="text-gray-500",i.jsxs("div",{className:R,children:[x,"/",w," ",b]})};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"claude-card p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h2",{className:"text-3xl font-extrabold mb-4",style:{color:"var(--claude-heading)"},children:"Edit Profile"}),i.jsx("p",{className:"claude-text-secondary",children:"Update your public profile information"})]}),i.jsxs("form",{onSubmit:m,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Display Name *"}),i.jsx("input",{type:"text",value:n.displayName,onChange:x=>a(w=>({...w,displayName:x.target.value})),placeholder:"Enter your display name",maxLength:h.displayName,required:!0,className:"w-full px-4 py-3 rounded-xl border transition-colors focus:outline-none focus:ring-2",style:{backgroundColor:"var(--claude-subtle)",borderColor:"var(--claude-border)",color:"var(--claude-primary-text)"},onFocus:x=>{x.target.style.borderColor="var(--claude-accent)",x.target.style.boxShadow="0 0 0 3px rgba(99, 91, 255, 0.1)"},onBlur:x=>{x.target.style.borderColor="var(--claude-border)",x.target.style.boxShadow="none"}}),i.jsxs("div",{className:"flex justify-between items-center mt-2",children:[i.jsxs("div",{className:"text-sm claude-text-secondary",children:["Your username @",s?.slug," cannot be changed"]}),i.jsx(p,{current:n.displayName.length,max:h.displayName,label:"characters"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Bio"}),i.jsx("textarea",{value:n.bio,onChange:x=>a(w=>({...w,bio:x.target.value})),placeholder:"Tell others a bit about yourself...",maxLength:h.bio,rows:4,className:"w-full px-4 py-3 rounded-xl border transition-colors focus:outline-none focus:ring-2 resize-none",style:{backgroundColor:"var(--claude-subtle)",borderColor:"var(--claude-border)",color:"var(--claude-primary-text)"},onFocus:x=>{x.target.style.borderColor="var(--claude-accent)",x.target.style.boxShadow="0 0 0 3px rgba(99, 91, 255, 0.1)"},onBlur:x=>{x.target.style.borderColor="var(--claude-border)",x.target.style.boxShadow="none"}}),i.jsxs("div",{className:"flex justify-between items-center mt-2",children:[i.jsx("div",{className:"text-sm claude-text-secondary",children:"Share your interests, expertise, or what you're studying"}),i.jsx(p,{current:n.bio.length,max:h.bio,label:"characters"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--claude-heading)"},children:"Institution"}),i.jsx("input",{type:"text",value:n.institution,onChange:x=>a(w=>({...w,institution:x.target.value})),placeholder:"University, company, or organization (optional)",maxLength:h.institution,className:"w-full px-4 py-3 rounded-xl border transition-colors focus:outline-none focus:ring-2",style:{backgroundColor:"var(--claude-subtle)",borderColor:"var(--claude-border)",color:"var(--claude-primary-text)"},onFocus:x=>{x.target.style.borderColor="var(--claude-accent)",x.target.style.boxShadow="0 0 0 3px rgba(99, 91, 255, 0.1)"},onBlur:x=>{x.target.style.borderColor="var(--claude-border)",x.target.style.boxShadow="none"}}),i.jsxs("div",{className:"flex justify-between items-center mt-2",children:[i.jsx("div",{}),i.jsx(p,{current:n.institution.length,max:h.institution,label:"characters"})]})]}),i.jsxs("div",{className:"flex gap-4 pt-4",children:[i.jsx("button",{type:"submit",disabled:l,className:"flex-1 claude-button-primary disabled:opacity-50 disabled:cursor-not-allowed",children:l?i.jsxs("span",{className:"flex items-center justify-center gap-2",children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):"Save Changes"}),i.jsx("button",{type:"button",onClick:t,disabled:l,className:"px-6 py-3 rounded-xl font-medium transition-colors disabled:opacity-50",style:{backgroundColor:"var(--claude-subtle)",color:"var(--claude-secondary-text)"},onMouseEnter:x=>{l||(x.target.style.backgroundColor="var(--claude-surface-hover)")},onMouseLeave:x=>{l||(x.target.style.backgroundColor="var(--claude-subtle)")},children:"Cancel"})]})]})]})})},hO=({profileSlug:s,onClose:e})=>{const{user:t}=wn(),[n,a]=M.useState(null),[l,u]=M.useState([]),[h,m]=M.useState(null),[p,x]=M.useState(null),[w,b]=M.useState({cardCount:0,friendCount:0}),[E,R]=M.useState(!0),[k,U]=M.useState("upvotes"),[z,B]=M.useState(!1),[q,G]=M.useState(null);M.useEffect(()=>{s&&Y()},[s]),M.useEffect(()=>{n&&n.userId&&L()},[n,k]);const Y=async()=>{R(!0);try{const O=await As.getProfileBySlug(s);if(!O)throw new Error("Profile not found");a(O)}catch(O){console.error("Error loading profile:",O),alert("Profile not found or error loading profile"),e&&e()}finally{R(!1)}},L=async()=>{try{const[O,oe,$,ge]=await Promise.all([P(),xn.getFriendCount(n.userId),t?xn.getFriendshipStatus(t.uid,n.userId):null,t?xn.getMutualFriends(t.uid,n.userId):null]);b({cardCount:O.length,friendCount:oe}),m($),x(ge)}catch(O){console.error("Error loading profile data:",O)}},P=async()=>{try{const oe=(await os.getPublicFlashcardsByUser(n.userId)).sort(($,ge)=>{switch(k){case"upvotes":return(ge.upvotes||0)-($.upvotes||0);case"date":return new Date(ge.createdAt)-new Date($.createdAt);default:return 0}});return u(oe),oe}catch(O){return console.error("Error loading public cards:",O),[]}},T=async O=>{if(!t){alert("Please sign in to connect with friends");return}try{switch(O){case"send_request":await xn.sendFriendRequest(t.uid,n.userId),A("Friend request sent!");break;case"accept_request":await xn.acceptFriendRequest(h.receivedRequestId,n.userId,t.uid),A("Friend request accepted!");break;case"remove_friend":confirm(`Remove ${n.displayName} from your friends?`)&&(await xn.removeFriend(t.uid,n.userId),A("Friend removed"));break}const oe=await xn.getFriendshipStatus(t.uid,n.userId);m(oe);const $=await xn.getFriendCount(n.userId);b(ge=>({...ge,friendCount:$}))}catch(oe){console.error("Error with friend action:",oe),A("Failed to perform action",!0)}},A=(O,oe=!1)=>{const $=document.createElement("div");$.className="fixed top-4 right-4 px-6 py-3 rounded-lg text-white font-medium z-50 transition-transform transform translate-x-full",$.style.backgroundColor=oe?"#ef4444":"#10b981",$.textContent=O,document.body.appendChild($),setTimeout(()=>{$.style.transform="translateX(0)"},100),setTimeout(()=>{$.style.transform="translateX(100%)",setTimeout(()=>{document.body.removeChild($)},300)},3e3)},F=O=>O?O.split(" ").map(oe=>oe.charAt(0)).join("").toUpperCase().slice(0,2):"?",j=()=>!t||!h?null:h.areFriends?i.jsx("button",{onClick:()=>T("remove_friend"),className:"px-4 py-2 rounded-lg font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:"Remove Friend"}):h.sentRequest?i.jsx("span",{className:"px-4 py-2 rounded-lg font-medium bg-yellow-100 text-yellow-800",children:"Request Sent"}):h.receivedRequest?i.jsx("button",{onClick:()=>T("accept_request"),className:"px-4 py-2 rounded-lg font-medium bg-green-500 text-white hover:bg-green-600 transition-colors",children:"Accept Friend Request"}):i.jsx("button",{onClick:()=>T("send_request"),className:"px-4 py-2 rounded-lg font-medium bg-blue-500 text-white hover:bg-blue-600 transition-colors",children:"Add Friend"}),V=O=>O?(O.toDate?O.toDate():new Date(O)).toLocaleDateString():"Unknown",D=O=>{a(O),B(!1),A("Profile updated successfully!")},De=()=>{B(!1)};if(E)return i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"claude-text-secondary",children:"Loading profile..."})]})})});if(!n)return i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:"😔"}),i.jsx("h2",{className:"text-2xl font-bold mb-2",style:{color:"var(--claude-heading)"},children:"Profile not found"}),i.jsx("p",{className:"claude-text-secondary mb-4",children:"The profile you're looking for doesn't exist or has been removed."}),e&&i.jsx("button",{onClick:e,className:"claude-button-primary",children:"Go Back"})]})})});const Z=t&&t.uid===n.userId;return i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e&&i.jsx("button",{onClick:e,className:"mb-4 px-4 py-2 rounded-lg font-medium transition-colors",style:{backgroundColor:"var(--claude-subtle)",color:"var(--claude-secondary-text)"},children:"← Back"}),i.jsx("div",{className:"claude-card p-8 mb-8",children:i.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[i.jsxs("div",{className:"text-center md:text-left",children:[i.jsx("div",{className:"w-24 h-24 rounded-full flex items-center justify-center text-white font-bold text-2xl mx-auto md:mx-0 mb-4",style:{background:"var(--claude-accent)"},children:F(n.displayName)}),i.jsx("h1",{className:"text-3xl font-bold mb-2",style:{color:"var(--claude-heading)"},children:n.displayName||"Anonymous User"}),i.jsxs("p",{className:"claude-text-secondary text-lg mb-2",children:["@",n.slug]}),n.institution&&i.jsxs("p",{className:"claude-text-secondary",children:["🏫 ",n.institution]})]}),i.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[n.bio&&i.jsx("div",{className:"mb-4",children:i.jsx("p",{className:"claude-text-primary",children:n.bio})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold",style:{color:"var(--claude-accent-blue)"},children:w.cardCount}),i.jsx("div",{className:"claude-text-secondary text-sm",children:"Flashcards"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold",style:{color:"var(--claude-accent)"},children:w.friendCount}),i.jsx("div",{className:"claude-text-secondary text-sm",children:"Friends"})]})]}),p&&p.total>0&&i.jsxs("div",{className:"mb-4 p-3 rounded-lg",style:{backgroundColor:"var(--claude-subtle)"},children:[i.jsxs("div",{className:"text-sm font-medium",style:{color:"var(--claude-heading)"},children:[p.total," mutual friend",p.total>1?"s":""]}),i.jsxs("div",{className:"text-sm claude-text-secondary",children:[p.profiles.map(O=>O.displayName).join(", "),p.hasMore&&` and ${p.total-p.profiles.length} more`]})]}),i.jsxs("div",{className:"flex gap-3",children:[j(),Z&&i.jsx("button",{onClick:()=>B(!0),className:"px-4 py-2 rounded-lg font-medium bg-gray-500 text-white hover:bg-gray-600 transition-colors",children:"Edit Profile"})]})]})]})}),i.jsxs("div",{className:"claude-card p-8",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h2",{className:"text-2xl font-bold",style:{color:"var(--claude-heading)"},children:["Public Flashcards (",w.cardCount,")"]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("label",{className:"text-sm font-medium",style:{color:"var(--claude-secondary-text)"},children:"Sort by:"}),i.jsxs("select",{value:k,onChange:O=>U(O.target.value),className:"px-3 py-1 rounded-lg border",style:{backgroundColor:"var(--claude-subtle)",borderColor:"var(--claude-border)",color:"var(--claude-primary-text)"},children:[i.jsx("option",{value:"upvotes",children:"Upvotes"}),i.jsx("option",{value:"date",children:"Date Created"})]})]})]}),l.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-6xl mb-4",children:"📚"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--claude-heading)"},children:"No public flashcards"}),i.jsx("p",{className:"claude-text-secondary",children:Z?"You haven't shared any flashcards publicly yet.":`${n.displayName} hasn't shared any flashcards publicly yet.`})]}):i.jsx("div",{className:"grid gap-4",children:l.map(O=>i.jsxs("div",{className:"border rounded-xl p-6 transition-all hover:shadow-md",style:{backgroundColor:"var(--claude-subtle)",borderColor:"var(--claude-border)"},children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-semibold mb-2",style:{color:"var(--claude-heading)"},children:O.statement||O.question||"Untitled Card"}),O.subject&&i.jsx("span",{className:"inline-block px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800 mb-2",children:O.subject}),i.jsxs("div",{className:"text-sm claude-text-secondary",children:["Created ",V(O.createdAt)]})]}),i.jsxs("div",{className:"flex items-center gap-3 text-sm claude-text-secondary",children:[i.jsxs("span",{children:["👍 ",O.upvotes||0]}),i.jsxs("span",{children:["👁️ ",O.viewCount||0]})]})]}),O.tags&&O.tags.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2",children:O.tags.map((oe,$)=>i.jsxs("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:"var(--claude-border)",color:"var(--claude-secondary-text)"},children:["#",oe]},$))})]},O.id))})]}),z&&i.jsx(dO,{profile:n,onSave:D,onCancel:De})]})})},rE=({onDeckCreated:s,onClose:e,editingDeck:t=null})=>{const{user:n}=wn(),[a,l]=M.useState({name:"",description:"",subject:"",difficulty:"beginner",tags:"",color:"#635BFF",icon:"📚",isPublic:!1}),[u,h]=M.useState(!1),[m,p]=M.useState(""),[x,w]=M.useState(!1),b=["#635BFF","#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#BB8FCE"],E=["📚","🧮","🔬","🎓","📖","✏️","🎯","💡","🚀","⚡","🏆","🎨","🔍","💻","🧠","📊"],R=["Mathematics","Physics","Chemistry","Biology","Computer Science","History","English","Spanish","French","Psychology","Economics","Philosophy","Art","Music","Geography","Other"];M.useEffect(()=>{t&&l({name:t.name||"",description:t.description||"",subject:t.subject||"",difficulty:t.difficulty||"beginner",tags:(t.tags||[]).join(", "),color:t.color||"#635BFF",icon:t.icon||"📚",isPublic:t.isPublic||!1})},[t]);const k=(z,B)=>{l(q=>({...q,[z]:B})),p("")},U=async z=>{if(z.preventDefault(),!n){p("Please sign in to create decks");return}if(!a.name.trim()){p("Deck name is required");return}h(!0),p("");try{const B={name:a.name.trim(),description:a.description.trim(),subject:a.subject,difficulty:a.difficulty,tags:a.tags.split(",").map(G=>G.trim()).filter(G=>G),color:a.color,icon:a.icon,isPublic:a.isPublic};if(a.isPublic){const G=await As.getUserSlug(n.uid);if(!G){p("You must create a profile before making public decks."),h(!1);return}B.authorSlug=G,B.slug=await is.generateUniqueSlug(a.name,G)}let q;t?(await is.updateDeck(t.id,B),q=t.id):q=await is.createDeck(n.uid,B),w(!0),setTimeout(()=>{s&&s(q),e&&e()},1500)}catch(B){console.error("Error saving deck:",B),p(B.message||"Failed to save deck. Please try again.")}finally{h(!1)}};return x?i.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"claude-card p-12 text-center max-w-lg",children:[i.jsx("div",{className:"text-6xl mb-4",children:"✅"}),i.jsx("h3",{className:"text-2xl font-bold claude-success mb-4",children:t?"Deck Updated!":"Deck Created!"}),i.jsxs("p",{className:"claude-text-secondary",children:["Your deck has been ",t?"updated":"created"," successfully."]})]})}):i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-4xl font-extrabold mb-4",style:{color:"var(--claude-heading)"},children:t?"✏️ Edit Deck":"📚 Create New Deck"}),i.jsx("p",{className:"claude-text-secondary text-lg",children:t?"Update your deck details":"Organize your flashcards into a themed collection"})]}),i.jsxs("form",{onSubmit:U,className:"space-y-8",children:[i.jsxs("div",{className:"claude-card p-8",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--claude-heading)"},children:"Basic Information"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block claude-text-secondary font-medium mb-2",children:["Deck Name ",i.jsx("span",{className:"claude-error",children:"*"})]}),i.jsx("input",{type:"text",value:a.name,onChange:z=>k("name",z.target.value),placeholder:"e.g. Calculus I - Derivatives",className:"claude-input w-full",maxLength:100,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block claude-text-secondary font-medium mb-2",children:"Description"}),i.jsx("textarea",{value:a.description,onChange:z=>k("description",z.target.value),placeholder:"Brief description of what this deck covers...",className:"claude-input w-full h-24 resize-none",maxLength:300}),i.jsxs("div",{className:"text-xs claude-text-muted mt-1",children:[a.description.length,"/300 characters"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block claude-text-secondary font-medium mb-2",children:"Subject"}),i.jsxs("select",{value:a.subject,onChange:z=>k("subject",z.target.value),className:"claude-input w-full",children:[i.jsx("option",{value:"",children:"Select a subject"}),R.map(z=>i.jsx("option",{value:z,children:z},z))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block claude-text-secondary font-medium mb-2",children:"Difficulty Level"}),i.jsxs("select",{value:a.difficulty,onChange:z=>k("difficulty",z.target.value),className:"claude-input w-full",children:[i.jsx("option",{value:"beginner",children:"Beginner"}),i.jsx("option",{value:"intermediate",children:"Intermediate"}),i.jsx("option",{value:"advanced",children:"Advanced"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block claude-text-secondary font-medium mb-2",children:"Tags"}),i.jsx("input",{type:"text",value:a.tags,onChange:z=>k("tags",z.target.value),placeholder:"e.g. calculus, derivatives, math (comma-separated)",className:"claude-input w-full"}),i.jsx("div",{className:"text-xs claude-text-muted mt-1",children:"Separate tags with commas"})]})]})]}),i.jsxs("div",{className:"claude-card p-8",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--claude-heading)"},children:"Appearance"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block claude-text-secondary font-medium mb-3",children:"Deck Color"}),i.jsx("div",{className:"flex flex-wrap gap-3",children:b.map(z=>i.jsx("button",{type:"button",onClick:()=>k("color",z),className:`w-12 h-12 rounded-xl border-4 transition-all duration-200 ${a.color===z?"border-white shadow-lg scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:z},title:z},z))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block claude-text-secondary font-medium mb-3",children:"Deck Icon"}),i.jsx("div",{className:"flex flex-wrap gap-3",children:E.map(z=>i.jsx("button",{type:"button",onClick:()=>k("icon",z),className:`w-12 h-12 rounded-xl text-2xl flex items-center justify-center transition-all duration-200 ${a.icon===z?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg scale-110":"claude-card hover:scale-105"}`,title:z,children:z},z))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block claude-text-secondary font-medium mb-3",children:"Preview"}),i.jsxs("div",{className:"claude-card p-6 max-w-xs rounded-2xl shadow-lg",style:{borderLeft:`6px solid ${a.color}`},children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:a.color,color:"white"},children:a.icon}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold claude-text-primary",children:a.name||"Deck Name"}),i.jsx("p",{className:"text-sm claude-text-muted",children:a.subject||"Subject"})]})]}),a.description&&i.jsx("p",{className:"text-sm claude-text-secondary",children:a.description})]})]})]})]}),i.jsxs("div",{className:"claude-card p-8",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--claude-heading)"},children:"Privacy & Sharing"}),i.jsx("div",{className:"space-y-4",children:i.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:a.isPublic,onChange:z=>k("isPublic",z.target.checked),className:"w-5 h-5 rounded mt-1",style:{accentColor:"var(--claude-accent)",backgroundColor:a.isPublic?"var(--claude-accent)":"var(--claude-surface)",borderColor:"var(--claude-border)"}}),i.jsxs("div",{children:[i.jsx("span",{className:"claude-text-secondary font-medium",children:"Make this deck public"}),i.jsx("p",{className:"text-sm claude-text-muted mt-1",children:"Public decks can be discovered and imported by other users. You need a profile to create public decks."})]})]})})]}),m&&i.jsx("div",{className:"p-4 rounded-2xl",style:{backgroundColor:"rgba(255, 99, 99, 0.1)",border:"1px solid var(--claude-error)"},children:i.jsxs("div",{className:"flex items-center gap-2 claude-error",children:[i.jsx("span",{children:"❌"}),i.jsx("span",{children:m})]})}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-end",children:[e&&i.jsx("button",{type:"button",onClick:e,className:"claude-button-secondary",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:u||!a.name.trim(),className:"claude-button-primary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",style:{background:u||!a.name.trim()?"var(--claude-muted)":"var(--claude-accent)"},children:u?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),t?"Updating...":"Creating..."]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{children:t?"✏️":"📚"}),t?"Update Deck":"Create Deck"]})})]})]})]})})},fO=({onCreateDeck:s,onEditDeck:e,onSelectDeck:t})=>{const{user:n}=wn(),[a,l]=M.useState([]),[u,h]=M.useState(!0),[m,p]=M.useState(""),[x,w]=M.useState(""),[b,E]=M.useState("all");M.useEffect(()=>{n&&R()},[n]);const R=async()=>{try{h(!0),p("");const z=await is.getUserDecks(n.uid);l(z)}catch(z){console.error("Error loading decks:",z),p("Failed to load decks. Please try again.")}finally{h(!1)}},k=async(z,B)=>{if(window.confirm(`Are you sure you want to delete "${B}"? This action cannot be undone.`))try{await is.deleteDeck(z),l(a.filter(q=>q.id!==z))}catch(q){console.error("Error deleting deck:",q),p("Failed to delete deck. Please try again.")}},U=a.filter(z=>{const B=!x||z.name.toLowerCase().includes(x.toLowerCase())||z.description.toLowerCase().includes(x.toLowerCase())||z.subject&&z.subject.toLowerCase().includes(x.toLowerCase()),q=b==="all"||b==="public"&&z.isPublic||b==="private"&&!z.isPublic;return B&&q});return u?i.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"claude-card p-8 text-center",children:[i.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"claude-text-secondary",children:"Loading your decks..."})]})}):i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4 md:mb-0",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl text-white shadow-lg",style:{background:"linear-gradient(135deg, #6B5B4A 0%, #5A4A3A 100%)"},children:i.jsx(Ja,{size:32,color:"white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-4xl font-extrabold",style:{color:"var(--claude-heading)"},children:"My Decks"}),i.jsx("p",{className:"claude-text-secondary",children:"Organize and manage your flashcard collections"})]})]}),i.jsxs("button",{onClick:()=>s&&s(),className:"claude-button-primary mt-4 md:mt-0 flex items-center gap-2",style:{background:"linear-gradient(135deg, #6B5B4A 0%, #5A4A3A 100%)"},children:[i.jsx("span",{className:"text-lg",children:"+"}),"Create New Deck"]})]}),i.jsxs("div",{className:"claude-card p-6 mb-8",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsx("input",{type:"text",value:x,onChange:z=>w(z.target.value),placeholder:"Search decks by name, subject, or description...",className:"claude-input w-full"})}),i.jsx("div",{className:"md:w-48",children:i.jsxs("select",{value:b,onChange:z=>E(z.target.value),className:"claude-input w-full",children:[i.jsx("option",{value:"all",children:"All Decks"}),i.jsx("option",{value:"private",children:"Private Only"}),i.jsx("option",{value:"public",children:"Public Only"})]})})]}),i.jsxs("div",{className:"flex flex-wrap gap-6 mt-4 pt-4 border-t",style:{borderColor:"var(--claude-border)"},children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold",style:{color:"var(--claude-heading)"},children:a.length}),i.jsx("div",{className:"text-sm claude-text-muted",children:"Total Decks"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold",style:{color:"var(--claude-heading)"},children:a.reduce((z,B)=>z+(B.cardCount||0),0)}),i.jsx("div",{className:"text-sm claude-text-muted",children:"Total Cards"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold",style:{color:"var(--claude-heading)"},children:a.filter(z=>z.isPublic).length}),i.jsx("div",{className:"text-sm claude-text-muted",children:"Public Decks"})]})]})]}),m&&i.jsx("div",{className:"p-4 rounded-2xl mb-6",style:{backgroundColor:"rgba(255, 99, 99, 0.1)",border:"1px solid var(--claude-error)"},children:i.jsxs("div",{className:"flex items-center gap-2 claude-error",children:[i.jsx(kg,{size:16,color:"red"}),i.jsx("span",{children:m})]})}),U.length===0?i.jsxs("div",{className:"claude-card p-12 text-center",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-2xl mb-4",style:{background:"linear-gradient(135deg, #6B5B4A 0%, #5A4A3A 100%)"},children:i.jsx(Ja,{size:40,color:"white"})}),i.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:"var(--claude-heading)"},children:x||b!=="all"?"No matching decks found":"No decks yet"}),i.jsx("p",{className:"claude-text-secondary mb-6",children:x||b!=="all"?"Try adjusting your search or filter criteria":"Create your first deck to start organizing your flashcards"}),!x&&b==="all"&&i.jsxs("button",{onClick:()=>s&&s(),className:"claude-button-primary flex items-center gap-2 mx-auto",style:{background:"linear-gradient(135deg, #6B5B4A 0%, #5A4A3A 100%)"},children:[i.jsx("span",{className:"text-lg",children:"+"}),"Create Your First Deck"]})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:U.map(z=>i.jsx(mO,{deck:z,onEdit:()=>e&&e(z),onDelete:()=>k(z.id,z.name),onSelect:()=>t&&t(z)},z.id))})]})})},mO=({deck:s,onEdit:e,onDelete:t,onSelect:n})=>{const a=l=>l?(l.toDate?l.toDate():new Date(l)).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"Unknown";return i.jsxs("div",{className:"claude-card p-6 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer relative group",style:{borderLeft:`6px solid ${s.color||"#6B5B4A"}`},onClick:()=>n&&n(),children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white",style:{backgroundColor:s.color||"#6B5B4A"},children:s.icon?i.jsx("span",{className:"text-2xl",children:s.icon}):i.jsx(Ja,{size:24,color:"white"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold claude-text-primary truncate",children:s.name}),i.jsx("p",{className:"text-sm claude-text-muted",children:s.subject||"No subject"})]})]}),i.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:l=>{l.stopPropagation(),e()},className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-800",title:"Edit deck",children:i.jsx(pr,{size:16,color:"default"})}),!s.isDefault&&i.jsx("button",{onClick:l=>{l.stopPropagation(),t()},className:"p-2 rounded-lg hover:bg-red-100 text-red-600 hover:text-red-800",title:"Delete deck",children:i.jsx(Nb,{size:16,color:"red"})})]})})]}),s.description&&i.jsx("p",{className:"text-sm claude-text-secondary mb-4 line-clamp-2",children:s.description}),i.jsxs("div",{className:"flex items-center justify-between text-sm claude-text-muted mb-4",children:[i.jsxs("span",{children:[s.cardCount||0," cards"]}),i.jsx("span",{children:s.difficulty||"Mixed"})]}),s.tags&&s.tags.length>0&&i.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[s.tags.slice(0,3).map((l,u)=>i.jsx("span",{className:"px-2 py-1 rounded-full text-xs",style:{backgroundColor:`${s.color||"#6B5B4A"}20`,color:s.color||"#6B5B4A"},children:l},u)),s.tags.length>3&&i.jsxs("span",{className:"px-2 py-1 rounded-full text-xs claude-text-muted",children:["+",s.tags.length-3]})]}),i.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",style:{borderColor:"var(--claude-border)"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[s.isPublic&&i.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-green-100 text-green-700",children:"Public"}),s.isDefault&&i.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700",children:"Default"})]}),i.jsx("span",{className:"text-xs claude-text-muted",children:a(s.updatedAt||s.createdAt)})]})]})},gO=({onClose:s})=>{const{user:e}=wn(),[t,n]=M.useState(null),[a,l]=M.useState(null),[u,h]=M.useState("week"),[m,p]=M.useState(!0),[x,w]=M.useState("overview");M.useEffect(()=>{e&&b()},[e,u]);const b=async()=>{try{p(!0);const[k,U]=await Promise.all([Ka.getUserAnalytics(e.uid),Ka.getUserInsights(e.uid,u)]);n(k),l(U)}catch(k){console.error("Error loading analytics:",k)}finally{p(!1)}},E=k=>{const U=Math.floor(k/3600),z=Math.floor(k%3600/60);return U>0?`${U}h ${z}m`:`${z}m`},R=k=>`${Math.round(k*100)}%`;return m?i.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"claude-card p-8 text-center",children:[i.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"claude-text-secondary",children:"Loading your analytics..."})]})}):i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-4xl font-extrabold mb-2",style:{color:"var(--claude-heading)"},children:"📊 Learning Analytics"}),i.jsx("p",{className:"claude-text-secondary",children:"Track your progress, identify patterns, and optimize your learning"})]}),i.jsxs("div",{className:"flex items-center gap-4 mt-4 md:mt-0",children:[i.jsxs("select",{value:u,onChange:k=>h(k.target.value),className:"claude-input",children:[i.jsx("option",{value:"day",children:"Today"}),i.jsx("option",{value:"week",children:"This Week"}),i.jsx("option",{value:"month",children:"This Month"})]}),s&&i.jsx("button",{onClick:s,className:"claude-button-secondary",children:"✕ Close"})]})]}),i.jsx("div",{className:"flex space-x-1 mb-8 claude-card p-1 rounded-2xl",children:[{id:"overview",label:"📈 Overview",icon:"📈"},{id:"performance",label:"🎯 Performance",icon:"🎯"},{id:"insights",label:"💡 Insights",icon:"💡"},{id:"progress",label:"📚 Progress",icon:"📚"}].map(k=>i.jsxs("button",{onClick:()=>w(k.id),className:`flex-1 px-4 py-3 rounded-xl font-medium transition-all duration-200 ${x===k.id?"claude-gradient text-white shadow-lg":"claude-text-secondary hover:bg-gray-100"}`,children:[i.jsx("span",{className:"mr-2",children:k.icon}),i.jsx("span",{className:"hidden sm:inline",children:k.label.replace(/^.+\s/,"")})]},k.id))}),x==="overview"&&i.jsx(pO,{analytics:t,insights:a,formatTime:E,formatPercentage:R}),x==="performance"&&i.jsx(yO,{analytics:t,insights:a,formatPercentage:R}),x==="insights"&&i.jsx(xO,{insights:a,formatTime:E}),x==="progress"&&i.jsx(vO,{analytics:t,insights:a,formatPercentage:R})]})})},pO=({analytics:s,insights:e,formatTime:t,formatPercentage:n})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(Xf,{title:"Total Study Time",value:t(s?.totalStudyTime||0),icon:"⏱️",color:"blue",trend:e?.studyTimeTrend}),i.jsx(Xf,{title:"Study Sessions",value:s?.totalSessions||0,icon:"📚",color:"green"}),i.jsx(Xf,{title:"Overall Accuracy",value:n(s?.overallAccuracy||0),icon:"🎯",color:"purple",trend:e?.accuracyTrend}),i.jsx(Xf,{title:"Study Streak",value:`${s?.studyStreak||0} days`,icon:"🔥",color:"orange"})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"📅 Recent Activity"}),i.jsxs("div",{className:"space-y-4",children:[s?.deckStats&&Object.entries(s.deckStats).slice(0,5).map(([a,l])=>i.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:["Deck ",a.slice(-6)]}),i.jsxs("div",{className:"text-sm claude-text-muted",children:[l.sessions," sessions"]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-bold text-green-600",children:n(l.accuracy)}),i.jsx("div",{className:"text-sm claude-text-muted",children:t(l.studyTime)})]})]},a)),(!s?.deckStats||Object.keys(s.deckStats).length===0)&&i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"No study activity yet. Start studying to see your progress!"})]})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"📈 Performance Trends"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(aE,{label:"Accuracy Trend",value:e?.accuracyTrend||0,description:"How your accuracy has changed recently"}),i.jsx(aE,{label:"Study Time Trend",value:e?.studyTimeTrend||0,description:"How your study duration has changed"}),i.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[i.jsx("div",{className:"font-medium text-blue-800",children:"Mastery Progress"}),i.jsxs("div",{className:"text-sm text-blue-600 mb-2",children:["Overall understanding: ",n(e?.masteryProgress||0)]}),i.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${(e?.masteryProgress||0)*100}%`}})})]})]})]})]})]}),yO=({analytics:s,insights:e,formatPercentage:t})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"📊 Subject Performance"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s?.subjectStats&&Object.entries(s.subjectStats).map(([n,a])=>i.jsxs("div",{className:"p-4 border rounded-lg",children:[i.jsx("div",{className:"font-medium mb-2",children:n||"General"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm claude-text-muted",children:"Accuracy:"}),i.jsx("span",{className:"font-medium",children:t(a.accuracy)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm claude-text-muted",children:"Mastery:"}),i.jsx("span",{className:"font-medium",children:t(a.masteryLevel||0)})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${a.accuracy*100}%`}})})]})]},n)),(!s?.subjectStats||Object.keys(s.subjectStats).length===0)&&i.jsx("div",{className:"col-span-full text-center py-8 claude-text-muted",children:"No subject data available yet. Study more to see subject breakdown!"})]})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"⚠️ Cards Needing Attention"}),i.jsx("div",{className:"space-y-4",children:e?.strugglingCards&&e.strugglingCards.length>0?e.strugglingCards.map((n,a)=>i.jsxs("div",{className:"flex items-center justify-between p-4 border-l-4 border-red-500 bg-red-50",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:["Card ",n.cardId.slice(-6)]}),i.jsxs("div",{className:"text-sm text-red-600",children:[n.totalReviews," attempts"]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-red-700 font-bold",children:t(n.accuracy)}),i.jsx("div",{className:"text-sm text-red-600",children:"accuracy"})]})]},n.cardId)):i.jsx("div",{className:"text-center py-8 text-green-600",children:"🎉 Great job! No cards need special attention right now."})})]})]}),xO=({insights:s,formatTime:e})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"💡 Personalized Recommendations"}),i.jsx("div",{className:"space-y-4",children:s?.recommendations&&s.recommendations.length>0?s.recommendations.map((t,n)=>i.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${t.priority==="high"?"border-red-500 bg-red-50":t.priority==="medium"?"border-yellow-500 bg-yellow-50":"border-blue-500 bg-blue-50"}`,children:[i.jsx("div",{className:`font-medium ${t.priority==="high"?"text-red-800":t.priority==="medium"?"text-yellow-800":"text-blue-800"}`,children:t.title}),i.jsx("div",{className:`text-sm mt-1 ${t.priority==="high"?"text-red-600":t.priority==="medium"?"text-yellow-600":"text-blue-600"}`,children:t.description})]},n)):i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"Keep studying to get personalized recommendations!"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"⏰ Optimal Study Time"}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl mb-2",children:s?.optimalStudyTime==="morning"?"🌅":s?.optimalStudyTime==="afternoon"?"☀️":"🌙"}),i.jsx("div",{className:"text-lg font-medium capitalize",children:s?.optimalStudyTime||"Not enough data"}),i.jsx("div",{className:"text-sm claude-text-muted mt-2",children:"You perform best during this time"})]})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"📊 Consistency Score"}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-3xl font-bold mb-2",style:{color:"var(--claude-accent)"},children:[Math.round((s?.consistencyScore||0)*100),"%"]}),i.jsx("div",{className:"text-sm claude-text-muted",children:"How consistent your study sessions are"}),i.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-3",children:i.jsx("div",{className:"claude-gradient h-3 rounded-full transition-all duration-300",style:{width:`${(s?.consistencyScore||0)*100}%`}})})]})]})]})]}),vO=({analytics:s,insights:e,formatPercentage:t})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"📈 Learning Progress"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold mb-2",style:{color:"var(--claude-success)"},children:t(e?.masteryProgress||0)}),i.jsx("div",{className:"text-sm claude-text-muted",children:"Overall Mastery"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold mb-2",style:{color:"var(--claude-accent)"},children:s?.studyStreak||0}),i.jsx("div",{className:"text-sm claude-text-muted",children:"Day Streak"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold mb-2",style:{color:"var(--claude-warning)"},children:s?.longestStreak||0}),i.jsx("div",{className:"text-sm claude-text-muted",children:"Longest Streak"})]})]})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"🌟 Your Strongest Subjects"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e?.strongSubjects&&e.strongSubjects.length>0?e.strongSubjects.map((n,a)=>i.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg border-2 border-green-200",children:[i.jsx("div",{className:"text-2xl mb-2",children:"🏆"}),i.jsx("div",{className:"font-medium text-green-800",children:n}),i.jsx("div",{className:"text-sm text-green-600",children:"Strong performance"})]},n)):i.jsx("div",{className:"col-span-full text-center py-8 claude-text-muted",children:"Keep studying to identify your strongest subjects!"})})]})]}),Xf=({title:s,value:e,icon:t,color:n,trend:a})=>i.jsxs("div",{className:"claude-card p-6 rounded-2xl relative overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("div",{className:"text-2xl",children:t}),a!==void 0&&i.jsxs("div",{className:`text-sm font-medium ${a>0?"text-green-600":a<0?"text-red-600":"text-gray-600"}`,children:[a>0?"↗️":a<0?"↘️":"→"," ",Math.abs(a*100).toFixed(1),"%"]})]}),i.jsx("div",{className:"text-2xl font-bold mb-1",style:{color:`var(--claude-${n||"accent"})`},children:e}),i.jsx("div",{className:"text-sm claude-text-muted",children:s})]}),aE=({label:s,value:e,description:t})=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:s}),i.jsx("div",{className:"text-sm claude-text-muted",children:t})]}),i.jsxs("div",{className:`text-right ${e>0?"text-green-600":e<0?"text-red-600":"text-gray-600"}`,children:[i.jsxs("div",{className:"font-bold",children:[e>0?"↗️":e<0?"↘️":"→"," ",Math.abs(e*100).toFixed(1),"%"]}),i.jsx("div",{className:"text-sm",children:e>0?"Improving":e<0?"Declining":"Stable"})]})]});class Bn{static async initializeSession(e=null){try{const t=this.generateSessionId(),n={sessionId:t,userId:e||null,startTime:Me(),isActive:!0,userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight},referrer:document.referrer||null,initialUrl:window.location.href,pageViews:0,clicks:0,timeSpent:0,pagesVisited:[],actionsPerformed:[],isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isTablet:/iPad/i.test(navigator.userAgent),platform:navigator.platform};if(await Rs(be(te,"websiteSessions",t),n),localStorage.setItem("website_session_id",t),jn)try{aa(jn,"session_start",{session_id:t,user_id:e,is_mobile:n.isMobile})}catch(a){console.warn("Firebase Analytics not available:",a)}return this.setupVisibilityTracking(t),this.setupUnloadTracking(t),t}catch(t){throw console.error("Error initializing session:",t),t}}static async trackPageView(e,t=null,n=null){try{const a=t||localStorage.getItem("website_session_id");if(!a)return;const l={sessionId:a,userId:n||null,page:e,url:window.location.href,timestamp:Me(),referrer:document.referrer||null,timeOnPage:0,scrollDepth:0,interactions:0},u=await Ys(Ce(te,"pageViews"),l),h=be(te,"websiteSessions",a);if(await $t(h,{pageViews:mm(1),pagesVisited:Zc(e),lastPageView:Me(),currentPage:e}),jn)try{aa(jn,"page_view",{page_title:document.title,page_location:window.location.href,session_id:a,user_id:n})}catch(m){console.warn("Firebase Analytics not available:",m)}return this.startPageTimeTracking(u.id,a),u.id}catch(a){console.error("Error tracking page view:",a)}}static async trackInteraction(e,t=null,n=null){try{const a=t||localStorage.getItem("website_session_id");if(!a)return;const l={sessionId:a,userId:n||null,timestamp:Me(),page:window.location.pathname,...e};await Ys(Ce(te,"interactions"),l);const u=be(te,"websiteSessions",a);if(await $t(u,{clicks:mm(1),actionsPerformed:Zc(e.action||"unknown"),lastActivity:Me()}),jn)try{aa(jn,"user_interaction",{action:e.action,element:e.element,session_id:a,user_id:n})}catch(h){console.warn("Firebase Analytics not available:",h)}}catch(a){console.error("Error tracking interaction:",a)}}static async trackScrollDepth(e,t=null){try{const n=t||localStorage.getItem("website_session_id");if(!n)return;const a=Le(Ce(te,"pageViews"),Ye("sessionId","==",n),Jt("timestamp","desc"),Zt(1)),l=await Ke(a);if(!l.empty){const u=l.docs[0];await $t(u.ref,{scrollDepth:Math.max(e,u.data().scrollDepth||0)})}}catch(n){if(n.message&&(n.message.includes("requires an index")||n.message.includes("Missing or insufficient permissions")||n.message.includes("permission-denied")))return;console.error("Error tracking scroll depth:",n)}}static async trackFeatureUsage(e,t,n={},a=null){try{const l=localStorage.getItem("website_session_id"),u={sessionId:l,userId:a||null,feature:e,action:t,metadata:n,timestamp:Me(),page:window.location.pathname};if(await Ys(Ce(te,"featureUsage"),u),jn)try{aa(jn,"feature_usage",{feature_name:e,action_type:t,session_id:l,user_id:a})}catch(h){console.warn("Firebase Analytics not available:",h)}}catch(l){console.error("Error tracking feature usage:",l)}}static async trackConversion(e,t=null,n=null){try{const a=localStorage.getItem("website_session_id"),l={sessionId:a,userId:n||null,conversionType:e,value:t,timestamp:Me(),page:window.location.pathname};if(await Ys(Ce(te,"conversions"),l),jn)try{aa(jn,"conversion",{conversion_type:e,conversion_value:t,session_id:a,user_id:n})}catch(u){console.warn("Firebase Analytics not available:",u)}}catch(a){console.error("Error tracking conversion:",a)}}static async trackUserFlow(e,t,n="navigation",a=null){try{const u={sessionId:localStorage.getItem("website_session_id"),userId:a||null,fromPage:e,toPage:t,action:n,timestamp:Me()};await Ys(Ce(te,"userFlows"),u)}catch(l){console.error("Error tracking user flow:",l)}}static async trackClick(e,t={},n=null){try{await this.trackInteraction({action:"click",element:e,context:t,elementText:t.text||"",elementId:t.id||"",elementClass:t.className||""},null,n)}catch(a){console.error("Error tracking click:",a)}}static async trackFormInteraction(e,t,n=null,a=null){try{await this.trackInteraction({action:"form_interaction",element:"form",formName:e,formAction:t,field:n},null,a)}catch(l){console.error("Error tracking form interaction:",l)}}static startPageTimeTracking(e,t){window.pageTimeTracking||(window.pageTimeTracking={}),window.pageTimeTracking[e]={startTime:Date.now(),sessionId:t,pageViewId:e}}static async endPageTimeTracking(e){try{if(!window.pageTimeTracking||!window.pageTimeTracking[e])return;const t=window.pageTimeTracking[e],n=Math.round((Date.now()-t.startTime)/1e3),a=be(te,"pageViews",e);await $t(a,{timeOnPage:n});const l=be(te,"websiteSessions",t.sessionId);await $t(l,{timeSpent:mm(n)}),delete window.pageTimeTracking[e]}catch(t){console.error("Error ending page time tracking:",t)}}static async endSession(e=null){try{const t=e||localStorage.getItem("website_session_id");if(!t)return;if(window.pageTimeTracking)for(const a of Object.keys(window.pageTimeTracking))await this.endPageTimeTracking(a);const n=be(te,"websiteSessions",t);if(await $t(n,{endTime:Me(),isActive:!1}),localStorage.removeItem("website_session_id"),jn)try{aa(jn,"session_end",{session_id:t})}catch(a){console.warn("Firebase Analytics not available:",a)}}catch(t){console.error("Error ending session:",t)}}static async getAnalyticsSummary(e="week"){try{const t=e==="week"?7:e==="month"?30:1,n=new Date(Date.now()-t*24*60*60*1e3),a=Le(Ce(te,"websiteSessions"),Ye("startTime",">=",n)),u=(await Ke(a)).docs.map(L=>({id:L.id,...L.data()})),h=Le(Ce(te,"pageViews"),Ye("timestamp",">=",n)),p=(await Ke(h)).docs.map(L=>({id:L.id,...L.data()})),x=Le(Ce(te,"interactions"),Ye("timestamp",">=",n)),b=(await Ke(x)).docs.map(L=>({id:L.id,...L.data()})),E=new Set(u.filter(L=>L.userId).map(L=>L.userId)).size,R=u.length,k=p.length,U=b.length,z=u.reduce((L,P)=>L+(P.timeSpent||0),0)/u.length,B=k/R,q={};p.forEach(L=>{const P=L.page||"unknown";q[P]||(q[P]={views:0,totalTime:0,interactions:0}),q[P].views++,q[P].totalTime+=L.timeOnPage||0}),b.forEach(L=>{const P=L.page||"unknown";q[P]&&q[P].interactions++});const G=Object.entries(q).map(([L,P])=>({page:L,...P,avgTimeOnPage:P.totalTime/P.views})).sort((L,P)=>P.views-L.views).slice(0,10),Y={mobile:u.filter(L=>L.isMobile).length,tablet:u.filter(L=>L.isTablet).length,desktop:u.filter(L=>!L.isMobile&&!L.isTablet).length};return{summary:{uniqueUsers:E,totalSessions:R,totalPageViews:k,totalInteractions:U,avgSessionDuration:Math.round(z),avgPagesPerSession:Math.round(B*10)/10},popularPages:G,deviceStats:Y,sessions:u,timeframe:e}}catch(t){throw console.error("Error getting analytics summary:",t),t}}static async getUserJourneyAnalytics(e="week"){try{const t=e==="week"?7:e==="month"?30:1,n=new Date(Date.now()-t*24*60*60*1e3),a=Le(Ce(te,"userFlows"),Ye("timestamp",">=",n)),u=(await Ke(a)).docs.map(w=>({id:w.id,...w.data()})),h={};u.forEach(w=>{const b=`${w.fromPage} → ${w.toPage}`;h[b]=(h[b]||0)+1});const m=Object.entries(h).map(([w,b])=>({path:w,count:b})).sort((w,b)=>b.count-w.count).slice(0,10),p={},x={};return u.forEach(w=>{p[w.fromPage]=(p[w.fromPage]||0)+1,x[w.toPage]=(x[w.toPage]||0)+1}),{commonPaths:m,entryPoints:Object.entries(p).map(([w,b])=>({page:w,count:b})).sort((w,b)=>b.count-w.count).slice(0,5),exitPoints:Object.entries(x).map(([w,b])=>({page:w,count:b})).sort((w,b)=>b.count-w.count).slice(0,5)}}catch(t){throw console.error("Error getting user journey analytics:",t),t}}static generateSessionId(){return`ws_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static setupVisibilityTracking(e){let t=!document.hidden,n=Date.now();const a=()=>{const l=Date.now();if(document.hidden&&t){const u=l-n;this.trackInteraction({action:"page_hidden",element:"page",timeVisible:u},e),t=!1}else!document.hidden&&!t&&(this.trackInteraction({action:"page_visible",element:"page"},e),t=!0,n=l)};document.addEventListener("visibilitychange",a)}static setupUnloadTracking(e){const t=()=>{this.endSession(e)};window.addEventListener("beforeunload",t)}static setupScrollTracking(){let e=0,t;const n=()=>{const a=window.pageYOffset||document.documentElement.scrollTop,l=document.documentElement.scrollHeight-window.innerHeight,u=l>0?a/l*100:0;e=Math.max(e,u),clearTimeout(t),t=setTimeout(()=>{this.trackScrollDepth(Math.round(e))},1e3)};window.addEventListener("scroll",n,{passive:!0})}static setupAutoClickTracking(){document.addEventListener("click",e=>{const t=e.target.closest("[data-track]");if(t){const n={action:t.getAttribute("data-track"),text:t.textContent.trim(),id:t.id,className:t.className};this.trackClick(t.tagName.toLowerCase(),n)}})}static initializeAutoTracking(e=null){this.initializeSession(e),this.setupScrollTracking(),this.setupAutoClickTracking(),setTimeout(()=>{this.trackPageView(window.location.pathname,null,e)},100)}}const bO=({onClose:s})=>{const{user:e}=wn(),[t,n]=M.useState(null),[a,l]=M.useState(null),[u,h]=M.useState("week"),[m,p]=M.useState(!0),[x,w]=M.useState("overview"),[b,E]=M.useState({activeSessions:0,currentPageViews:0,recentInteractions:[]});M.useEffect(()=>{if(e){R();const z=setInterval(R,3e4);return()=>clearInterval(z)}},[e,u]);const R=async()=>{try{p(!0);const[z,B]=await Promise.all([Bn.getAnalyticsSummary(u),Bn.getUserJourneyAnalytics(u)]);n(z),l(B);const q=z.sessions.filter(Y=>Y.isActive).length,G=z.sessions.flatMap(Y=>Y.actionsPerformed||[]).slice(-10);E({activeSessions:q,currentPageViews:z.summary.totalPageViews,recentInteractions:G})}catch(z){console.error("Error loading analytics:",z)}finally{p(!1)}},k=z=>{const B=Math.floor(z/3600),q=Math.floor(z%3600/60),G=z%60;return B>0?`${B}h ${q}m ${G}s`:q>0?`${q}m ${G}s`:`${G}s`},U=z=>`${Math.round(z*100)}%`;return m?i.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"claude-card p-8 text-center",children:[i.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"claude-text-secondary",children:"Loading website analytics..."})]})}):i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-4xl font-extrabold mb-2",style:{color:"var(--claude-heading)"},children:"🚀 Website Analytics"}),i.jsx("p",{className:"claude-text-secondary",children:"Track growth, engagement, and user behavior across your platform"})]}),i.jsxs("div",{className:"flex items-center gap-4 mt-4 md:mt-0",children:[i.jsxs("select",{value:u,onChange:z=>h(z.target.value),className:"claude-input",children:[i.jsx("option",{value:"day",children:"Today"}),i.jsx("option",{value:"week",children:"This Week"}),i.jsx("option",{value:"month",children:"This Month"})]}),i.jsx("button",{onClick:R,className:"claude-button-secondary",children:"🔄 Refresh"}),s&&i.jsx("button",{onClick:s,className:"claude-button-secondary",children:"✕ Close"})]})]}),i.jsx("div",{className:"mb-8 claude-card p-4 bg-gradient-to-r from-green-50 to-blue-50 border-green-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),i.jsx("span",{className:"font-medium",children:"Live Now"})]}),i.jsxs("div",{className:"text-sm claude-text-muted",children:[b.activeSessions," active sessions • ",b.currentPageViews," page views today"]})]}),i.jsxs("div",{className:"text-xs claude-text-muted",children:["Last updated: ",new Date().toLocaleTimeString()]})]})}),i.jsx("div",{className:"flex space-x-1 mb-8 claude-card p-1 rounded-2xl",children:[{id:"overview",label:"📊 Overview",icon:"📊"},{id:"traffic",label:"🌐 Traffic",icon:"🌐"},{id:"engagement",label:"👆 Engagement",icon:"👆"},{id:"journeys",label:"🗺️ User Journeys",icon:"🗺️"},{id:"realtime",label:"⚡ Real-time",icon:"⚡"}].map(z=>i.jsxs("button",{onClick:()=>w(z.id),className:`flex-1 px-4 py-3 rounded-xl font-medium transition-all duration-200 ${x===z.id?"claude-gradient text-white shadow-lg":"claude-text-secondary hover:bg-gray-100"}`,children:[i.jsx("span",{className:"mr-2",children:z.icon}),i.jsx("span",{className:"hidden sm:inline",children:z.label.replace(/^.+\s/,"")})]},z.id))}),x==="overview"&&i.jsx(wO,{analytics:t,formatDuration:k,formatPercentage:U}),x==="traffic"&&i.jsx(_O,{analytics:t,formatDuration:k}),x==="engagement"&&i.jsx(NO,{analytics:t,formatDuration:k}),x==="journeys"&&i.jsx(TO,{userJourney:a}),x==="realtime"&&i.jsx(EO,{realTimeData:b,analytics:t})]})})},wO=({analytics:s,formatDuration:e,formatPercentage:t})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(Or,{title:"Unique Users",value:s?.summary?.uniqueUsers||0,icon:"👥",color:"blue",description:"Distinct users this period"}),i.jsx(Or,{title:"Total Sessions",value:s?.summary?.totalSessions||0,icon:"🎯",color:"green",description:"User sessions tracked"}),i.jsx(Or,{title:"Page Views",value:s?.summary?.totalPageViews||0,icon:"👀",color:"purple",description:"Total pages visited"}),i.jsx(Or,{title:"Avg Session Duration",value:e(s?.summary?.avgSessionDuration||0),icon:"⏱️",color:"orange",description:"Average time per session"})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"📈 Most Popular Pages"}),i.jsxs("div",{className:"space-y-4",children:[s?.popularPages?.slice(0,8).map((n,a)=>i.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-bold text-blue-800",children:a+1}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:n.page}),i.jsxs("div",{className:"text-sm claude-text-muted",children:[n.views," views"]})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-bold text-blue-600",children:e(n.avgTimeOnPage||0)}),i.jsx("div",{className:"text-sm claude-text-muted",children:"avg time"})]})]},n.page)),(!s?.popularPages||s.popularPages.length===0)&&i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"No page data available yet"})]})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"📱 Device Breakdown"}),i.jsx("div",{className:"space-y-4",children:s?.deviceStats&&Object.entries(s.deviceStats).map(([n,a])=>{const l=Object.values(s.deviceStats).reduce((m,p)=>m+p,0),u=l>0?a/l*100:0,h=n==="mobile"?"📱":n==="tablet"?"📚":"💻";return i.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-2xl",children:h}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium capitalize",children:n}),i.jsxs("div",{className:"text-sm claude-text-muted",children:[a," sessions"]})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"font-bold text-green-600",children:[Math.round(u),"%"]}),i.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2 mt-1",children:i.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${u}%`}})})]})]},n)})})]})]})]}),_O=({analytics:s,formatDuration:e})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx(Or,{title:"Pages per Session",value:s?.summary?.avgPagesPerSession||0,icon:"📄",color:"blue",description:"Average pages viewed per session"}),i.jsx(Or,{title:"Total Interactions",value:s?.summary?.totalInteractions||0,icon:"🖱️",color:"green",description:"Total clicks and interactions"}),i.jsx(Or,{title:"Bounce Rate",value:`${Math.round(((s?.summary?.totalSessions-s?.summary?.totalPageViews)/s?.summary?.totalSessions||0)*100)}%`,icon:"⚡",color:"orange",description:"Single page sessions"})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"📊 Detailed Page Analytics"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",children:[i.jsx("th",{className:"text-left py-3 px-4 font-medium claude-text-secondary",children:"Page"}),i.jsx("th",{className:"text-right py-3 px-4 font-medium claude-text-secondary",children:"Views"}),i.jsx("th",{className:"text-right py-3 px-4 font-medium claude-text-secondary",children:"Avg Time"}),i.jsx("th",{className:"text-right py-3 px-4 font-medium claude-text-secondary",children:"Interactions"}),i.jsx("th",{className:"text-right py-3 px-4 font-medium claude-text-secondary",children:"Engagement"})]})}),i.jsx("tbody",{children:s?.popularPages?.map((t,n)=>{const a=t.views>0?t.interactions/t.views*100:0;return i.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[i.jsx("td",{className:"py-3 px-4",children:i.jsx("div",{className:"font-medium",children:t.page})}),i.jsx("td",{className:"text-right py-3 px-4 font-medium",children:t.views}),i.jsx("td",{className:"text-right py-3 px-4",children:e(t.avgTimeOnPage||0)}),i.jsx("td",{className:"text-right py-3 px-4",children:t.interactions}),i.jsx("td",{className:"text-right py-3 px-4",children:i.jsxs("span",{className:`font-medium ${a>50?"text-green-600":a>20?"text-yellow-600":"text-red-600"}`,children:[Math.round(a),"%"]})})]},t.page)})})]})})]})]}),NO=({analytics:s,formatDuration:e})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(Or,{title:"Click Rate",value:`${Math.round((s?.summary?.totalInteractions/s?.summary?.totalPageViews||0)*100)}%`,icon:"👆",color:"blue",description:"Interactions per page view"}),i.jsx(Or,{title:"Session Depth",value:s?.summary?.avgPagesPerSession||0,icon:"📚",color:"green",description:"Pages explored per session"}),i.jsx(Or,{title:"Return Rate",value:`${Math.round((s?.summary?.uniqueUsers/s?.summary?.totalSessions||0)*100)}%`,icon:"🔄",color:"purple",description:"Users who return"}),i.jsx(Or,{title:"Engagement Score",value:Math.round((s?.summary?.avgSessionDuration||0)/60*(s?.summary?.avgPagesPerSession||0)),icon:"⭐",color:"orange",description:"Overall engagement rating"})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"🔥 Most Engaging Content"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s?.popularPages?.slice(0,6).map((t,n)=>{const a=(t.avgTimeOnPage||0)*(t.interactions||0)/100;return i.jsxs("div",{className:"p-4 border rounded-lg hover:border-blue-500 transition-colors",children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:t.page}),i.jsxs("span",{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:["#",n+1]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"claude-text-muted",children:"Time on Page"}),i.jsx("div",{className:"font-medium",children:e(t.avgTimeOnPage||0)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"claude-text-muted",children:"Interactions"}),i.jsx("div",{className:"font-medium",children:t.interactions||0})]}),i.jsxs("div",{children:[i.jsx("div",{className:"claude-text-muted",children:"Views"}),i.jsx("div",{className:"font-medium",children:t.views})]}),i.jsxs("div",{children:[i.jsx("div",{className:"claude-text-muted",children:"Engagement"}),i.jsx("div",{className:"font-medium text-green-600",children:Math.round(a)})]})]})]},t.page)})})]})]}),TO=({userJourney:s})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"🗺️ Most Common User Paths"}),i.jsxs("div",{className:"space-y-4",children:[s?.commonPaths?.slice(0,8).map((e,t)=>i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-sm font-bold text-purple-800",children:t+1}),i.jsx("div",{className:"font-mono text-sm",children:e.path})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-bold text-purple-600",children:e.count}),i.jsx("div",{className:"text-sm claude-text-muted",children:"transitions"})]})]},e.path)),(!s?.commonPaths||s.commonPaths.length===0)&&i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"No user journey data available yet"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"🚪 Top Entry Points"}),i.jsxs("div",{className:"space-y-3",children:[s?.entryPoints?.map((e,t)=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[i.jsx("div",{className:"font-medium",children:e.page}),i.jsx("div",{className:"text-green-700 font-bold",children:e.count})]},e.page)),(!s?.entryPoints||s.entryPoints.length===0)&&i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"No entry data"})]})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"🚪 Top Exit Points"}),i.jsxs("div",{className:"space-y-3",children:[s?.exitPoints?.map((e,t)=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[i.jsx("div",{className:"font-medium",children:e.page}),i.jsx("div",{className:"text-red-700 font-bold",children:e.count})]},e.page)),(!s?.exitPoints||s.exitPoints.length===0)&&i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"No exit data"})]})]})]})]}),EO=({realTimeData:s,analytics:e})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl bg-gradient-to-br from-green-50 to-emerald-50 border-green-200",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full animate-pulse"}),i.jsx("h3",{className:"font-bold text-green-800",children:"Active Now"})]}),i.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:s.activeSessions}),i.jsx("div",{className:"text-sm text-green-700",children:"Active sessions"})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl bg-gradient-to-br from-blue-50 to-cyan-50 border-blue-200",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("span",{className:"text-2xl",children:"👀"}),i.jsx("h3",{className:"font-bold text-blue-800",children:"Page Views"})]}),i.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:s.currentPageViews}),i.jsx("div",{className:"text-sm text-blue-700",children:"Total today"})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl bg-gradient-to-br from-purple-50 to-violet-50 border-purple-200",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("span",{className:"text-2xl",children:"🖱️"}),i.jsx("h3",{className:"font-bold text-purple-800",children:"Interactions"})]}),i.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:e?.summary?.totalInteractions||0}),i.jsx("div",{className:"text-sm text-purple-700",children:"Total clicks"})]})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"⚡ Recent Activity"}),i.jsxs("div",{className:"space-y-3",children:[s.recentInteractions.slice(0,10).map((t,n)=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsx("span",{className:"font-medium",children:t})]}),i.jsx("span",{className:"text-sm claude-text-muted",children:"Just now"})]},n)),s.recentInteractions.length===0&&i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"No recent interactions"})]})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"var(--claude-heading)"},children:"👥 Active Sessions Detail"}),i.jsxs("div",{className:"space-y-4",children:[e?.sessions?.filter(t=>t.isActive).slice(0,5).map((t,n)=>i.jsxs("div",{className:"p-4 border rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"font-medium",children:["Session ",t.sessionId.slice(-6)]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),i.jsx("span",{className:"text-sm text-green-600",children:"Active"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"claude-text-muted",children:"Device"}),i.jsx("div",{children:t.isMobile?"📱 Mobile":t.isTablet?"📚 Tablet":"💻 Desktop"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"claude-text-muted",children:"Page Views"}),i.jsx("div",{children:t.pageViews||0})]}),i.jsxs("div",{children:[i.jsx("div",{className:"claude-text-muted",children:"Duration"}),i.jsxs("div",{children:[Math.round((t.timeSpent||0)/60),"m"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"claude-text-muted",children:"Current Page"}),i.jsx("div",{className:"truncate",children:t.currentPage||"Unknown"})]})]})]},t.sessionId)),e?.sessions?.filter(t=>t.isActive).length===0&&i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"No active sessions"})]})]})]}),Or=({title:s,value:e,icon:t,color:n,description:a})=>i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsx("div",{className:"text-2xl",children:t})}),i.jsx("div",{className:"text-2xl font-bold mb-1",style:{color:`var(--claude-${n||"accent"})`},children:e}),i.jsx("div",{className:"text-sm font-medium mb-1",children:s}),a&&i.jsx("div",{className:"text-xs claude-text-muted",children:a})]}),SO=()=>i.jsx("div",{className:"min-h-screen bg-[#F6F5EC] p-8",children:i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsx("h1",{className:"text-4xl font-bold mb-8",style:{color:"var(--claude-heading)"},children:"🎨 Icon System Test"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-card",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:"var(--claude-heading)"},children:"Size Variants"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(yn,{size:16,color:"default"}),i.jsx("span",{children:"16px - Small"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(yn,{size:20,color:"default"}),i.jsx("span",{children:"20px - Medium"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(yn,{size:24,color:"default"}),i.jsx("span",{children:"24px - Large"})]})]})]}),i.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-card",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:"var(--claude-heading)"},children:"Color Variants"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(yn,{size:24,color:"default"}),i.jsx("span",{children:"Default (#606164)"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(yn,{size:24,color:"primary"}),i.jsx("span",{children:"Primary (#635BFF)"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(yn,{size:24,color:"secondary"}),i.jsx("span",{children:"Secondary (#445AFF)"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(yn,{size:24,color:"success"}),i.jsx("span",{children:"Success (#5BC8A2)"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(yn,{size:24,color:"warning"}),i.jsx("span",{children:"Warning (#FFD554)"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(yn,{size:24,color:"error"}),i.jsx("span",{children:"Error (#FF6363)"})]})]})]}),i.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-card",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:"var(--claude-heading)"},children:"Usage Examples"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[i.jsx(yn,{size:20,color:"primary"}),i.jsx("span",{children:"Active Tab"})]}),i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[i.jsx(yn,{size:20,color:"default"}),i.jsx("span",{children:"Inactive Tab"})]}),i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[i.jsx(yn,{size:24,color:"default"}),i.jsx("span",{children:"Section Header"})]})]})]}),i.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-card md:col-span-2 lg:col-span-3",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:"var(--claude-heading)"},children:"Before vs After"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium mb-2 text-red-600",children:"Before (Emoji)"}),i.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[i.jsx("span",{className:"text-2xl",children:"📊"}),i.jsx("span",{children:"Dashboard Overview"})]}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Inconsistent rendering across devices and browsers"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium mb-2 text-green-600",children:"After (SVG Icon)"}),i.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[i.jsx(yn,{size:24,color:"primary"}),i.jsx("span",{children:"Dashboard Overview"})]}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Consistent, scalable, and matches your design theme"})]})]})]})]}),i.jsxs("div",{className:"mt-8 space-y-8",children:[i.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-card",children:[i.jsx("h2",{className:"text-2xl font-semibold mb-6",style:{color:"var(--claude-heading)"},children:"Phase 1 - Critical Icons (10/10) ✅"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-6",children:[i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(yn,{size:24,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Dashboard"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(Yi,{size:24,color:"primary"}),i.jsx("span",{className:"text-sm",children:"User"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx($a,{size:24,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Cards"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(pr,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Edit"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(Nb,{size:20,color:"error"}),i.jsx("span",{className:"text-sm",children:"Delete"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(La,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"View"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(V1,{size:24,color:"primary"}),i.jsx("span",{className:"text-sm",children:"AI/Bot"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(Cc,{size:20,color:"success"}),i.jsx("span",{className:"text-sm",children:"Success"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(kg,{size:20,color:"error"}),i.jsx("span",{className:"text-sm",children:"Error"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(L1,{size:20,color:"warning"}),i.jsx("span",{className:"text-sm",children:"Warning"})]})]})]}),i.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-card",children:[i.jsx("h2",{className:"text-2xl font-semibold mb-6",style:{color:"var(--claude-heading)"},children:"Phase 2 - Important Icons (10/10) ✅"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-6",children:[i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(I5,{size:20,color:"warning"}),i.jsx("span",{className:"text-sm",children:"Hint"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(C5,{size:20,color:"default"}),i.jsx("span",{className:"text-sm",children:"Proof"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(R5,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Brain"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(rl,{size:24,color:"success"}),i.jsx("span",{className:"text-sm",children:"Target"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(k5,{size:20,color:"default"}),i.jsx("span",{className:"text-sm",children:"Time"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(Tc,{size:20,color:"success"}),i.jsx("span",{className:"text-sm",children:"Progress"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(D5,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Refresh"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(F1,{size:20,color:"secondary"}),i.jsx("span",{className:"text-sm",children:"Tags"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(qd,{size:20,color:"default"}),i.jsx("span",{className:"text-sm",children:"Math"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(P5,{size:20,color:"default"}),i.jsx("span",{className:"text-sm",children:"Mobile"})]})]})]}),i.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-card",children:[i.jsx("h2",{className:"text-2xl font-semibold mb-6",style:{color:"var(--claude-heading)"},children:"Phase 3 - Nice to Have Icons (7/7) ✅"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(M5,{size:20,color:"default"}),i.jsx("span",{className:"text-sm",children:"Desktop"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(O5,{size:20,color:"warning"}),i.jsx("span",{className:"text-sm",children:"Pause"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(rh,{size:16,color:"error"}),i.jsx("span",{className:"text-sm",children:"Heart"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(V5,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Support"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(Gx,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Save"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(L5,{size:24,color:"default"}),i.jsx("span",{className:"text-sm",children:"Map"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(F5,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Click"})]})]})]}),i.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-card",children:[i.jsx("h2",{className:"text-2xl font-semibold mb-6",style:{color:"var(--claude-heading)"},children:"Phase 3+ Extension - Comprehensive Icons (11/11) ✅"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-6",children:[i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(Qm,{size:20,color:"warning"}),i.jsx("span",{className:"text-sm",children:"Fast"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(Pr,{size:20,color:"warning"}),i.jsx("span",{className:"text-sm",children:"Trophy"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(U5,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Palette"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(Fa,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Search"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(B5,{size:20,color:"default"}),i.jsx("span",{className:"text-sm",children:"Calculator"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(q5,{size:20,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Microscope"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(z5,{size:20,color:"success"}),i.jsx("span",{className:"text-sm",children:"Graduation"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(Ja,{size:20,color:"default"}),i.jsx("span",{className:"text-sm",children:"Book"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx(U1,{size:24,color:"success"}),i.jsx("span",{className:"text-sm",children:"Analytics"})]}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx($x,{size:24,color:"primary"}),i.jsx("span",{className:"text-sm",children:"Social"})]})]})]}),i.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-2xl",children:[i.jsx("h2",{className:"text-2xl font-semibold mb-4",style:{color:"var(--claude-heading)"},children:"🎉 ULTIMATE ICON SYSTEM - 38 ICONS COMPLETE!"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),i.jsx("span",{children:"38 Professional Icons - ✅ Complete"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),i.jsx("span",{children:"110+ SVG Assets - ✅ Created"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),i.jsx("span",{children:"All React Components - ✅ Ready"})]})]}),i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-4 gap-4 text-sm bg-white/50 rounded-lg p-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-green-600",children:"10"}),i.jsx("div",{className:"text-gray-600",children:"Critical Icons"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-blue-600",children:"10"}),i.jsx("div",{className:"text-gray-600",children:"Important Icons"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-purple-600",children:"8"}),i.jsx("div",{className:"text-gray-600",children:"Nice-to-Have Icons"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-orange-600",children:"11"}),i.jsx("div",{className:"text-gray-600",children:"Extension Icons"})]})]}),i.jsx("p",{className:"mt-4 text-gray-700",children:"Your comprehensive professional icon system is now complete with 39 icons covering every use case! Each icon is scalable, consistent, and matches your Claude theme perfectly. From critical UI elements to specialized features like learning analytics, scientific tools, and social community features - you have everything you need to replace emojis throughout your React application."})]})]})]})});class Rr{static ADMIN_EMAILS=["three.dash.sided@gmail.com"];static isAdmin(e){return!e||!e.email?!1:this.ADMIN_EMAILS.includes(e.email)}static async getAdminStatus(e){try{const n=(await vt(be(te,"users",e))).data();return{isAdmin:n?.isAdmin||!1,adminLevel:n?.adminLevel||"none",permissions:n?.adminPermissions||[]}}catch(t){return console.error("Error getting admin status:",t),{isAdmin:!1,adminLevel:"none",permissions:[]}}}static async verifyAdminAccess(e){return!e||!this.isAdmin(e)?!1:(await this.getAdminStatus(e.uid)).isAdmin}static async getAllUsers(e=100){try{const t=Le(Ce(te,"users"),Jt("createdAt","desc"),Zt(e)),n=await Ke(t),a=[];for(const l of n.docs){const u=l.data();let h={};try{const m=await vt(l(te,"profiles",l.id));m.exists()&&(h=m.data())}catch{console.warn("Could not load profile for user:",l.id)}a.push({id:l.id,...u,profile:h,displayName:h.displayName||u.displayName||u.email?.split("@")[0]||"Unknown",joinDate:u.createdAt?.toDate?.()||new Date,lastSeen:u.lastLogin?.toDate?.()||u.createdAt?.toDate?.()||new Date})}return a}catch(t){throw console.error("Error getting all users:",t),t}}static async updateUserPremium(e,t){try{return await $t(be(te,"users",e),{isPremium:t,premiumUpdatedAt:new Date,premiumUpdatedBy:"admin"}),!0}catch(n){throw console.error("Error updating user premium status:",n),n}}static async updateUserAdmin(e,t,n="admin"){try{const a={isAdmin:t,adminUpdatedAt:new Date,adminUpdatedBy:"super_admin"};return t?(a.adminLevel=n,a.adminPermissions=this.getDefaultPermissions(n)):(a.adminLevel="none",a.adminPermissions=[]),await $t(be(te,"users",e),a),!0}catch(a){throw console.error("Error updating user admin status:",a),a}}static getDefaultPermissions(e){switch(e){case"super":return["user_management","content_moderation","system_settings","analytics_access","data_export","admin_management"];case"admin":return["user_management","content_moderation","analytics_access"];case"moderator":return["content_moderation"];default:return[]}}static async getPublicCardsForModeration(e=50){try{const t=Le(Ce(te,"publicCards"),Jt("createdAt","desc"),Zt(e)),n=await Ke(t),a=[];for(const l of n.docs){const u=l.data();let h={};try{if(u.userId){const m=await vt(l(te,"users",u.userId));if(m.exists()){const p=m.data();h={email:p.email,displayName:p.displayName||p.email?.split("@")[0]}}}}catch{console.warn("Could not load author info for card:",l.id)}a.push({id:l.id,...u,author:h,createdDate:u.createdAt?.toDate?.()||new Date})}return a}catch(t){throw console.error("Error getting public cards:",t),t}}static async moderateCard(e,t,n=""){try{const a={moderatedAt:new Date,moderatedBy:"admin",moderationAction:t,moderationReason:n};return t==="hide"?a.isHidden=!0:t==="remove"&&(a.isRemoved=!0),await $t(be(te,"publicCards",e),a),!0}catch(a){throw console.error("Error moderating card:",a),a}}static async getSystemStats(){try{const[e,t,n]=await Promise.all([Ke(Ce(te,"users")),Ke(Ce(te,"cards")),Ke(Ce(te,"publicCards"))]),a=e.docs.map(R=>R.data()),l=a.length,u=a.filter(R=>R.isPremium).length,h=a.filter(R=>R.isAdmin).length,m=new Date(Date.now()-10080*60*1e3),p=a.filter(R=>R.createdAt?.toDate?.()>m||R.lastLogin?.toDate?.()>m).length,x=t.size,w=n.size,E=n.docs.map(R=>R.data()).filter(R=>R.createdAt?.toDate?.()>m).length;return{users:{total:l,premium:u,admin:h,recentlyActive:p,conversionRate:l>0?(u/l*100).toFixed(1):0},content:{totalPrivateCards:x,totalPublicCards:w,totalCards:x+w,recentPublicCards:E,avgCardsPerUser:l>0?((x+w)/l).toFixed(1):0},system:{lastUpdated:new Date,status:"operational"}}}catch(e){throw console.error("Error getting system stats:",e),e}}static async logAdminAction(e,t,n={}){try{await Ys(Ce(te,"adminLogs"),{adminUserId:e,action:t,details:n,timestamp:new Date,userAgent:navigator.userAgent,ip:null})}catch(a){console.error("Error logging admin action:",a)}}static async getAdminActivity(e=50){try{const t=Le(Ce(te,"adminLogs"),Jt("timestamp","desc"),Zt(e)),n=await Ke(t),a=[];for(const l of n.docs){const u=l.data();let h={};try{const m=await vt(l(te,"users",u.adminUserId));if(m.exists()){const p=m.data();h={email:p.email,displayName:p.displayName||p.email?.split("@")[0]}}}catch{console.warn("Could not load admin info for log:",l.id)}a.push({id:l.id,...u,admin:h,timestamp:u.timestamp?.toDate?.()||new Date})}return a}catch(t){throw console.error("Error getting admin activity:",t),t}}}const AO=()=>{const[s,e]=M.useState([]),[t,n]=M.useState(!1),[a,l]=M.useState(0),[u,h]=M.useState(new Set),m=async()=>{n(!0);try{const R=(await zi(Ha,"findBrokenCards")()).data;e(R.brokenCards||[]),l(R.totalCards||0)}catch(b){console.error("Error finding broken cards:",b),alert(`❌ Failed to find broken cards: ${b.message}`)}finally{n(!1)}},p=async(b,E)=>{if(confirm(`Are you sure you want to delete this card?

ID: ${b}
Slug: ${E||"MISSING"}

This action cannot be undone.`)){h(R=>new Set(R).add(b));try{await zi(Ha,"deleteCard")({cardId:b,cardSlug:E}),e(k=>k.filter(U=>U.id!==b))}catch(R){console.error("Error deleting card:",R),alert(`❌ Failed to delete card: ${R.message}`)}finally{h(R=>{const k=new Set(R);return k.delete(b),k})}}},x=b=>{if(!b)return"Unknown";try{const E=b.toDate?b.toDate():new Date(b);return E.toLocaleDateString()+" "+E.toLocaleTimeString()}catch{return"Invalid date"}},w=async()=>{if(s.length===0||!confirm(`⚠️ DANGER: Delete ALL ${s.length} broken cards?

This will permanently delete all cards with missing/broken slugs.

This action cannot be undone. Are you absolutely sure?`))return;n(!0);let b=0,E=0;for(const R of s)try{await zi(Ha,"deleteCard")({cardId:R.id,cardSlug:R.slug}),b++}catch(k){console.error(`Failed to delete card ${R.id}:`,k),E++}e([]),n(!1),alert(`✅ Bulk delete completed!

✅ Deleted: ${b}
❌ Failed: ${E}`)};return M.useEffect(()=>{m()},[]),i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"🔍 Broken Cards Review"}),i.jsx("button",{onClick:m,disabled:t,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:t?"Searching...":"🔄 Refresh"})]}),i.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a}),i.jsx("div",{className:"text-sm text-gray-600",children:"Total Cards"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.length}),i.jsx("div",{className:"text-sm text-gray-600",children:"Broken Cards"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:a-s.length}),i.jsx("div",{className:"text-sm text-gray-600",children:"Healthy Cards"})]})]})}),s.length>0&&i.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium text-yellow-800",children:["⚠️ Found ",s.length," broken cards"]}),i.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:'These cards have missing or invalid slugs and show as "undefined" when users try to view them.'})]}),i.jsx("button",{onClick:w,disabled:t,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:"🗑️ Delete All Broken"})]})}),t&&s.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Searching for broken cards..."})]}):s.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"text-4xl mb-2",children:"✅"}),i.jsx("h4",{className:"text-lg font-medium text-green-600 mb-1",children:"No broken cards found!"}),i.jsx("p",{className:"text-gray-600",children:"All cards have valid slugs and are working properly."})]}):i.jsx("div",{className:"space-y-4",children:s.map(b=>i.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-white",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("span",{className:"text-sm font-mono bg-gray-100 px-2 py-1 rounded text-red-600",children:["ID: ",b.id]}),i.jsxs("span",{className:"text-sm font-mono bg-red-100 px-2 py-1 rounded text-red-700",children:["Slug: ",b.slug||"MISSING"]}),b.isBotPost&&i.jsx("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded",children:"🤖 Bot Post"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("strong",{className:"text-sm text-gray-700",children:"Statement:"}),i.jsx("p",{className:"text-sm text-gray-900 mt-1 bg-gray-50 p-2 rounded",children:b.statement.length>200?b.statement.substring(0,200)+"...":b.statement})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-xs text-gray-600",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Views:"})," ",b.viewCount]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Likes:"})," ",b.likeCount]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Author:"})," ",b.authorId?.substring(0,8)||"Unknown","..."]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Created:"})," ",x(b.createdAt)]})]})]})]}),i.jsx("button",{onClick:()=>p(b.id,b.slug),disabled:u.has(b.id),className:"ml-4 bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 flex items-center gap-1",children:u.has(b.id)?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),"Deleting..."]}):i.jsx(i.Fragment,{children:"🗑️ Delete"})})]})},b.id))})]})})},jO=()=>{const[s,e]=M.useState([]),[t,n]=M.useState(!0),[a,l]=M.useState(!0);M.useEffect(()=>{if(!a)return;const b=Le(Ce(te,"automationLogs"),Jt("timestamp","desc"),Zt(50)),E=qm(b,R=>{const k=R.docs.map(U=>({id:U.id,...U.data(),timestamp:U.data().timestamp?.toDate()}));e(k),n(!1)},R=>{console.error("Error listening to automation logs:",R),n(!1)});return()=>E()},[a]);const u=b=>b?b.toLocaleString():"Unknown",h=b=>{switch(b){case"started":return"🚀";case"step_success":return"✅";case"step_failed":return"❌";case"success":return"🎉";case"failed":return"💥";case"skipped":return"⏸️";case"retry_scheduled":return"⏰";case"retrying":return"🔄";default:return"📝"}},m=b=>{switch(b){case"started":return"text-blue-600 bg-blue-50 border-blue-200";case"step_success":return"text-green-600 bg-green-50 border-green-200";case"step_failed":return"text-red-600 bg-red-50 border-red-200";case"success":return"text-green-700 bg-green-100 border-green-300";case"failed":return"text-red-700 bg-red-100 border-red-300";case"skipped":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"retry_scheduled":return"text-orange-600 bg-orange-50 border-orange-200";case"retrying":return"text-blue-700 bg-blue-100 border-blue-300";default:return"text-gray-600 bg-gray-50 border-gray-200"}},p=b=>{const E=s.filter(B=>B.details?.runId===b);if(E.length===0)return{total:0,completed:0,status:"unknown"};const R=E.some(B=>B.status==="started"),k=E.some(B=>B.status==="success"),U=E.some(B=>B.status==="failed"),z=E.filter(B=>B.status==="step_success").length;return{total:R?6:0,completed:z,status:U?"failed":k?"success":R?"running":"unknown"}},x=s.reduce((b,E)=>{const R=E.details?.runId||"unknown";return b[R]||(b[R]=[]),b[R].push(E),b},{}),w=Object.entries(x).sort((b,E)=>{const R=Math.max(...b[1].map(U=>U.timestamp?.getTime()||0));return Math.max(...E[1].map(U=>U.timestamp?.getTime()||0))-R});return t?i.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Loading Automation Monitor..."})]})}):i.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"📊 Automation Monitor"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`h-2 w-2 rounded-full ${a?"bg-green-500 animate-pulse":"bg-gray-400"}`}),i.jsx("span",{className:"text-sm text-gray-600",children:a?"Live":"Paused"}),i.jsx("button",{onClick:()=>l(!a),className:`px-3 py-1 rounded text-xs font-medium transition-colors ${a?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:a?"Pause":"Resume"})]})]}),s.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"text-4xl mb-2",children:"📭"}),i.jsx("h4",{className:"text-lg font-medium text-gray-600 mb-1",children:"No automation logs yet"}),i.jsx("p",{className:"text-gray-500",children:"Logs will appear here when the automation runs"})]}):i.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:w.slice(0,10).map(([b,E])=>{const R=p(b),k=E[0],U=k.timestamp&&Date.now()-k.timestamp.getTime()<300*1e3;return i.jsxs("div",{className:`border rounded-lg p-4 ${U?"ring-2 ring-blue-200 border-blue-300":"border-gray-200"}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-sm font-mono bg-gray-100 px-2 py-1 rounded",children:[b.substring(0,12),"..."]}),i.jsxs("span",{className:`text-xs px-2 py-1 rounded border ${m(R.status)}`,children:[h(R.status)," ",R.status.toUpperCase()]}),R.total>0&&i.jsxs("span",{className:"text-xs text-gray-500",children:[R.completed,"/",R.total," steps"]})]}),i.jsx("span",{className:"text-xs text-gray-500",children:u(k.timestamp)})]}),R.total>0&&i.jsx("div",{className:"mb-3",children:i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${R.status==="failed"?"bg-red-500":R.status==="success"?"bg-green-500":"bg-blue-500"}`,style:{width:`${R.completed/R.total*100}%`}})})}),i.jsxs("div",{className:"space-y-1",children:[E.slice(0,3).map((z,B)=>i.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[i.jsx("span",{className:"text-xs",children:h(z.status)}),i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:"text-gray-700",children:z.details?.message||"No message"}),z.details?.error&&i.jsxs("div",{className:"text-red-600 text-xs mt-1",children:["Error: ",z.details.error]}),z.details?.step&&i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["[",z.details.step,"]"]})]}),i.jsx("span",{className:"text-xs text-gray-400",children:u(z.timestamp)})]},z.id)),E.length>3&&i.jsxs("div",{className:"text-xs text-gray-500 pl-4",children:["+",E.length-3," more logs..."]})]})]},b)})}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[i.jsx("span",{children:"Showing last 50 automation logs"}),i.jsx("span",{children:"Updates automatically every few seconds"})]})})]})};class Ui{static async getBotAccounts(){try{const e=Ce(te,"botAccounts");return(await Ke(e)).docs.map(n=>({id:n.id,...n.data()}))}catch(e){throw console.error("Error getting bot accounts:",e),e}}static async getAutomationSettings(){try{const e=be(te,"automation","settings"),t=await vt(e);return t.exists()?t.data():{enabled:!1,interval:24,maxPostsPerDay:5,tags:["math","mathematics"],subjects:["mathematics"]}}catch(e){throw console.error("Error getting automation settings:",e),e}}static async updateAutomationSettings(e){try{const t=be(te,"automation","settings");await Rs(t,{...e,updatedAt:Me()})}catch(t){throw console.error("Error updating automation settings:",t),t}}static async createBotAccount(e){try{const t=be(Ce(te,"botAccounts"));return await Rs(t,{...e,createdAt:Me(),isActive:!0}),t.id}catch(t){throw console.error("Error creating bot account:",t),t}}static async deleteBotAccount(e){try{const t=be(te,"botAccounts",e);await nl(t)}catch(t){throw console.error("Error deleting bot account:",t),t}}}/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:B1,setPrototypeOf:iE,isFrozen:IO,getPrototypeOf:CO,getOwnPropertyDescriptor:RO}=Object;let{freeze:ps,seal:br,create:q1}=Object,{apply:Qx,construct:Yx}=typeof Reflect<"u"&&Reflect;ps||(ps=function(e){return e});br||(br=function(e){return e});Qx||(Qx=function(e,t,n){return e.apply(t,n)});Yx||(Yx=function(e,t){return new e(...t)});const Wf=ys(Array.prototype.forEach),kO=ys(Array.prototype.lastIndexOf),oE=ys(Array.prototype.pop),bd=ys(Array.prototype.push),DO=ys(Array.prototype.splice),ym=ys(String.prototype.toLowerCase),tx=ys(String.prototype.toString),lE=ys(String.prototype.match),wd=ys(String.prototype.replace),PO=ys(String.prototype.indexOf),MO=ys(String.prototype.trim),kr=ys(Object.prototype.hasOwnProperty),gs=ys(RegExp.prototype.test),_d=OO(TypeError);function ys(s){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return Qx(s,e,n)}}function OO(s){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Yx(s,t)}}function at(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ym;iE&&iE(s,null);let n=e.length;for(;n--;){let a=e[n];if(typeof a=="string"){const l=t(a);l!==a&&(IO(e)||(e[n]=l),a=l)}s[a]=!0}return s}function VO(s){for(let e=0;e<s.length;e++)kr(s,e)||(s[e]=null);return s}function Oa(s){const e=q1(null);for(const[t,n]of B1(s))kr(s,t)&&(Array.isArray(n)?e[t]=VO(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=Oa(n):e[t]=n);return e}function Nd(s,e){for(;s!==null;){const n=RO(s,e);if(n){if(n.get)return ys(n.get);if(typeof n.value=="function")return ys(n.value)}s=CO(s)}function t(){return null}return t}const cE=ps(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),nx=ps(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),sx=ps(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),LO=ps(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),rx=ps(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),FO=ps(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),uE=ps(["#text"]),dE=ps(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ax=ps(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),hE=ps(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Jf=ps(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),UO=br(/\{\{[\w\W]*|[\w\W]*\}\}/gm),BO=br(/<%[\w\W]*|[\w\W]*%>/gm),qO=br(/\$\{[\w\W]*/gm),zO=br(/^data-[\-\w.\u00B7-\uFFFF]+$/),HO=br(/^aria-[\-\w]+$/),z1=br(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),GO=br(/^(?:\w+script|data):/i),$O=br(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),H1=br(/^html$/i),KO=br(/^[a-z][.\w]*(-[.\w]+)+$/i);var fE=Object.freeze({__proto__:null,ARIA_ATTR:HO,ATTR_WHITESPACE:$O,CUSTOM_ELEMENT:KO,DATA_ATTR:zO,DOCTYPE_NAME:H1,ERB_EXPR:BO,IS_ALLOWED_URI:z1,IS_SCRIPT_OR_DATA:GO,MUSTACHE_EXPR:UO,TMPLIT_EXPR:qO});const Td={element:1,text:3,progressingInstruction:7,comment:8,document:9},QO=function(){return typeof window>"u"?null:window},YO=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const a="data-tt-policy-suffix";t&&t.hasAttribute(a)&&(n=t.getAttribute(a));const l="dompurify"+(n?"#"+n:"");try{return e.createPolicy(l,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+l+" could not be created."),null}},mE=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function G1(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:QO();const e=Pe=>G1(Pe);if(e.version="3.2.6",e.removed=[],!s||!s.document||s.document.nodeType!==Td.document||!s.Element)return e.isSupported=!1,e;let{document:t}=s;const n=t,a=n.currentScript,{DocumentFragment:l,HTMLTemplateElement:u,Node:h,Element:m,NodeFilter:p,NamedNodeMap:x=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:w,DOMParser:b,trustedTypes:E}=s,R=m.prototype,k=Nd(R,"cloneNode"),U=Nd(R,"remove"),z=Nd(R,"nextSibling"),B=Nd(R,"childNodes"),q=Nd(R,"parentNode");if(typeof u=="function"){const Pe=t.createElement("template");Pe.content&&Pe.content.ownerDocument&&(t=Pe.content.ownerDocument)}let G,Y="";const{implementation:L,createNodeIterator:P,createDocumentFragment:T,getElementsByTagName:A}=t,{importNode:F}=n;let j=mE();e.isSupported=typeof B1=="function"&&typeof q=="function"&&L&&L.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:V,ERB_EXPR:D,TMPLIT_EXPR:De,DATA_ATTR:Z,ARIA_ATTR:O,IS_SCRIPT_OR_DATA:oe,ATTR_WHITESPACE:$,CUSTOM_ELEMENT:ge}=fE;let{IS_ALLOWED_URI:C}=fE,ne=null;const ve=at({},[...cE,...nx,...sx,...rx,...uE]);let ue=null;const Ie=at({},[...dE,...ax,...hE,...Jf]);let ye=Object.seal(q1(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Se=null,ce=null,we=!0,Ee=!0,Fe=!1,Ze=!0,Ge=!1,lt=!0,ze=!1,Qe=!1,gt=!1,ct=!1,It=!1,Gn=!1,an=!0,$n=!1;const _r="user-content-";let Ds=!0,Ps=!1,Ms={},_t=null;const pt=at({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let es=null;const _n=at({},["audio","video","img","source","image","track"]);let ri=null;const Nl=at({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Zs="http://www.w3.org/1998/Math/MathML",er="http://www.w3.org/2000/svg",Kn="http://www.w3.org/1999/xhtml";let kn=Kn,Br=!1,Nr=null;const fo=at({},[Zs,er,Kn],tx);let qr=at({},["mi","mo","mn","ms","mtext"]),zr=at({},["annotation-xml"]);const Tr=at({},["title","style","font","a","script"]);let us=null;const mo=["application/xhtml+xml","text/html"],tr="text/html";let qt=null,ds=null;const ai=t.createElement("form"),Er=function(Q){return Q instanceof RegExp||Q instanceof Function},ii=function(){let Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ds&&ds===Q)){if((!Q||typeof Q!="object")&&(Q={}),Q=Oa(Q),us=mo.indexOf(Q.PARSER_MEDIA_TYPE)===-1?tr:Q.PARSER_MEDIA_TYPE,qt=us==="application/xhtml+xml"?tx:ym,ne=kr(Q,"ALLOWED_TAGS")?at({},Q.ALLOWED_TAGS,qt):ve,ue=kr(Q,"ALLOWED_ATTR")?at({},Q.ALLOWED_ATTR,qt):Ie,Nr=kr(Q,"ALLOWED_NAMESPACES")?at({},Q.ALLOWED_NAMESPACES,tx):fo,ri=kr(Q,"ADD_URI_SAFE_ATTR")?at(Oa(Nl),Q.ADD_URI_SAFE_ATTR,qt):Nl,es=kr(Q,"ADD_DATA_URI_TAGS")?at(Oa(_n),Q.ADD_DATA_URI_TAGS,qt):_n,_t=kr(Q,"FORBID_CONTENTS")?at({},Q.FORBID_CONTENTS,qt):pt,Se=kr(Q,"FORBID_TAGS")?at({},Q.FORBID_TAGS,qt):Oa({}),ce=kr(Q,"FORBID_ATTR")?at({},Q.FORBID_ATTR,qt):Oa({}),Ms=kr(Q,"USE_PROFILES")?Q.USE_PROFILES:!1,we=Q.ALLOW_ARIA_ATTR!==!1,Ee=Q.ALLOW_DATA_ATTR!==!1,Fe=Q.ALLOW_UNKNOWN_PROTOCOLS||!1,Ze=Q.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ge=Q.SAFE_FOR_TEMPLATES||!1,lt=Q.SAFE_FOR_XML!==!1,ze=Q.WHOLE_DOCUMENT||!1,ct=Q.RETURN_DOM||!1,It=Q.RETURN_DOM_FRAGMENT||!1,Gn=Q.RETURN_TRUSTED_TYPE||!1,gt=Q.FORCE_BODY||!1,an=Q.SANITIZE_DOM!==!1,$n=Q.SANITIZE_NAMED_PROPS||!1,Ds=Q.KEEP_CONTENT!==!1,Ps=Q.IN_PLACE||!1,C=Q.ALLOWED_URI_REGEXP||z1,kn=Q.NAMESPACE||Kn,qr=Q.MATHML_TEXT_INTEGRATION_POINTS||qr,zr=Q.HTML_INTEGRATION_POINTS||zr,ye=Q.CUSTOM_ELEMENT_HANDLING||{},Q.CUSTOM_ELEMENT_HANDLING&&Er(Q.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ye.tagNameCheck=Q.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Q.CUSTOM_ELEMENT_HANDLING&&Er(Q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ye.attributeNameCheck=Q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Q.CUSTOM_ELEMENT_HANDLING&&typeof Q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ye.allowCustomizedBuiltInElements=Q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ge&&(Ee=!1),It&&(ct=!0),Ms&&(ne=at({},uE),ue=[],Ms.html===!0&&(at(ne,cE),at(ue,dE)),Ms.svg===!0&&(at(ne,nx),at(ue,ax),at(ue,Jf)),Ms.svgFilters===!0&&(at(ne,sx),at(ue,ax),at(ue,Jf)),Ms.mathMl===!0&&(at(ne,rx),at(ue,hE),at(ue,Jf))),Q.ADD_TAGS&&(ne===ve&&(ne=Oa(ne)),at(ne,Q.ADD_TAGS,qt)),Q.ADD_ATTR&&(ue===Ie&&(ue=Oa(ue)),at(ue,Q.ADD_ATTR,qt)),Q.ADD_URI_SAFE_ATTR&&at(ri,Q.ADD_URI_SAFE_ATTR,qt),Q.FORBID_CONTENTS&&(_t===pt&&(_t=Oa(_t)),at(_t,Q.FORBID_CONTENTS,qt)),Ds&&(ne["#text"]=!0),ze&&at(ne,["html","head","body"]),ne.table&&(at(ne,["tbody"]),delete Se.tbody),Q.TRUSTED_TYPES_POLICY){if(typeof Q.TRUSTED_TYPES_POLICY.createHTML!="function")throw _d('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Q.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw _d('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');G=Q.TRUSTED_TYPES_POLICY,Y=G.createHTML("")}else G===void 0&&(G=YO(E,a)),G!==null&&typeof Y=="string"&&(Y=G.createHTML(""));ps&&ps(Q),ds=Q}},Mt=at({},[...nx,...sx,...LO]),tn=at({},[...rx,...FO]),nn=function(Q){let xe=q(Q);(!xe||!xe.tagName)&&(xe={namespaceURI:kn,tagName:"template"});const je=ym(Q.tagName),Nt=ym(xe.tagName);return Nr[Q.namespaceURI]?Q.namespaceURI===er?xe.namespaceURI===Kn?je==="svg":xe.namespaceURI===Zs?je==="svg"&&(Nt==="annotation-xml"||qr[Nt]):!!Mt[je]:Q.namespaceURI===Zs?xe.namespaceURI===Kn?je==="math":xe.namespaceURI===er?je==="math"&&zr[Nt]:!!tn[je]:Q.namespaceURI===Kn?xe.namespaceURI===er&&!zr[Nt]||xe.namespaceURI===Zs&&!qr[Nt]?!1:!tn[je]&&(Tr[je]||!Mt[je]):!!(us==="application/xhtml+xml"&&Nr[Q.namespaceURI]):!1},Yt=function(Q){bd(e.removed,{element:Q});try{q(Q).removeChild(Q)}catch{U(Q)}},nr=function(Q,xe){try{bd(e.removed,{attribute:xe.getAttributeNode(Q),from:xe})}catch{bd(e.removed,{attribute:null,from:xe})}if(xe.removeAttribute(Q),Q==="is")if(ct||It)try{Yt(xe)}catch{}else try{xe.setAttribute(Q,"")}catch{}},Tl=function(Q){let xe=null,je=null;if(gt)Q="<remove></remove>"+Q;else{const Ot=lE(Q,/^[\r\n\t ]+/);je=Ot&&Ot[0]}us==="application/xhtml+xml"&&kn===Kn&&(Q='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Q+"</body></html>");const Nt=G?G.createHTML(Q):Q;if(kn===Kn)try{xe=new b().parseFromString(Nt,us)}catch{}if(!xe||!xe.documentElement){xe=L.createDocument(kn,"template",null);try{xe.documentElement.innerHTML=Br?Y:Nt}catch{}}const on=xe.body||xe.documentElement;return Q&&je&&on.insertBefore(t.createTextNode(je),on.childNodes[0]||null),kn===Kn?A.call(xe,ze?"html":"body")[0]:ze?xe.documentElement:on},Sr=function(Q){return P.call(Q.ownerDocument||Q,Q,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},oi=function(Q){return Q instanceof w&&(typeof Q.nodeName!="string"||typeof Q.textContent!="string"||typeof Q.removeChild!="function"||!(Q.attributes instanceof x)||typeof Q.removeAttribute!="function"||typeof Q.setAttribute!="function"||typeof Q.namespaceURI!="string"||typeof Q.insertBefore!="function"||typeof Q.hasChildNodes!="function")},Hr=function(Q){return typeof h=="function"&&Q instanceof h};function Dn(Pe,Q,xe){Wf(Pe,je=>{je.call(e,Q,xe,ds)})}const sr=function(Q){let xe=null;if(Dn(j.beforeSanitizeElements,Q,null),oi(Q))return Yt(Q),!0;const je=qt(Q.nodeName);if(Dn(j.uponSanitizeElement,Q,{tagName:je,allowedTags:ne}),lt&&Q.hasChildNodes()&&!Hr(Q.firstElementChild)&&gs(/<[/\w!]/g,Q.innerHTML)&&gs(/<[/\w!]/g,Q.textContent)||Q.nodeType===Td.progressingInstruction||lt&&Q.nodeType===Td.comment&&gs(/<[/\w]/g,Q.data))return Yt(Q),!0;if(!ne[je]||Se[je]){if(!Se[je]&&Vs(je)&&(ye.tagNameCheck instanceof RegExp&&gs(ye.tagNameCheck,je)||ye.tagNameCheck instanceof Function&&ye.tagNameCheck(je)))return!1;if(Ds&&!_t[je]){const Nt=q(Q)||Q.parentNode,on=B(Q)||Q.childNodes;if(on&&Nt){const Ot=on.length;for(let Nn=Ot-1;Nn>=0;--Nn){const Mn=k(on[Nn],!0);Mn.__removalCount=(Q.__removalCount||0)+1,Nt.insertBefore(Mn,z(Q))}}}return Yt(Q),!0}return Q instanceof m&&!nn(Q)||(je==="noscript"||je==="noembed"||je==="noframes")&&gs(/<\/no(script|embed|frames)/i,Q.innerHTML)?(Yt(Q),!0):(Ge&&Q.nodeType===Td.text&&(xe=Q.textContent,Wf([V,D,De],Nt=>{xe=wd(xe,Nt," ")}),Q.textContent!==xe&&(bd(e.removed,{element:Q.cloneNode()}),Q.textContent=xe)),Dn(j.afterSanitizeElements,Q,null),!1)},Os=function(Q,xe,je){if(an&&(xe==="id"||xe==="name")&&(je in t||je in ai))return!1;if(!(Ee&&!ce[xe]&&gs(Z,xe))){if(!(we&&gs(O,xe))){if(!ue[xe]||ce[xe]){if(!(Vs(Q)&&(ye.tagNameCheck instanceof RegExp&&gs(ye.tagNameCheck,Q)||ye.tagNameCheck instanceof Function&&ye.tagNameCheck(Q))&&(ye.attributeNameCheck instanceof RegExp&&gs(ye.attributeNameCheck,xe)||ye.attributeNameCheck instanceof Function&&ye.attributeNameCheck(xe))||xe==="is"&&ye.allowCustomizedBuiltInElements&&(ye.tagNameCheck instanceof RegExp&&gs(ye.tagNameCheck,je)||ye.tagNameCheck instanceof Function&&ye.tagNameCheck(je))))return!1}else if(!ri[xe]){if(!gs(C,wd(je,$,""))){if(!((xe==="src"||xe==="xlink:href"||xe==="href")&&Q!=="script"&&PO(je,"data:")===0&&es[Q])){if(!(Fe&&!gs(oe,wd(je,$,"")))){if(je)return!1}}}}}}return!0},Vs=function(Q){return Q!=="annotation-xml"&&lE(Q,ge)},Pn=function(Q){Dn(j.beforeSanitizeAttributes,Q,null);const{attributes:xe}=Q;if(!xe||oi(Q))return;const je={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ue,forceKeepAttr:void 0};let Nt=xe.length;for(;Nt--;){const on=xe[Nt],{name:Ot,namespaceURI:Nn,value:Mn}=on,ts=qt(Ot),ln=Mn;let zt=Ot==="value"?ln:MO(ln);if(je.attrName=ts,je.attrValue=zt,je.keepAttr=!0,je.forceKeepAttr=void 0,Dn(j.uponSanitizeAttribute,Q,je),zt=je.attrValue,$n&&(ts==="id"||ts==="name")&&(nr(Ot,Q),zt=_r+zt),lt&&gs(/((--!?|])>)|<\/(style|title)/i,zt)){nr(Ot,Q);continue}if(je.forceKeepAttr)continue;if(!je.keepAttr){nr(Ot,Q);continue}if(!Ze&&gs(/\/>/i,zt)){nr(Ot,Q);continue}Ge&&Wf([V,D,De],rr=>{zt=wd(zt,rr," ")});const go=qt(Q.nodeName);if(!Os(go,ts,zt)){nr(Ot,Q);continue}if(G&&typeof E=="object"&&typeof E.getAttributeType=="function"&&!Nn)switch(E.getAttributeType(go,ts)){case"TrustedHTML":{zt=G.createHTML(zt);break}case"TrustedScriptURL":{zt=G.createScriptURL(zt);break}}if(zt!==ln)try{Nn?Q.setAttributeNS(Nn,Ot,zt):Q.setAttribute(Ot,zt),oi(Q)?Yt(Q):oE(e.removed)}catch{nr(Ot,Q)}}Dn(j.afterSanitizeAttributes,Q,null)},Xt=function Pe(Q){let xe=null;const je=Sr(Q);for(Dn(j.beforeSanitizeShadowDOM,Q,null);xe=je.nextNode();)Dn(j.uponSanitizeShadowNode,xe,null),sr(xe),Pn(xe),xe.content instanceof l&&Pe(xe.content);Dn(j.afterSanitizeShadowDOM,Q,null)};return e.sanitize=function(Pe){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},xe=null,je=null,Nt=null,on=null;if(Br=!Pe,Br&&(Pe="<!-->"),typeof Pe!="string"&&!Hr(Pe))if(typeof Pe.toString=="function"){if(Pe=Pe.toString(),typeof Pe!="string")throw _d("dirty is not a string, aborting")}else throw _d("toString is not a function");if(!e.isSupported)return Pe;if(Qe||ii(Q),e.removed=[],typeof Pe=="string"&&(Ps=!1),Ps){if(Pe.nodeName){const Mn=qt(Pe.nodeName);if(!ne[Mn]||Se[Mn])throw _d("root node is forbidden and cannot be sanitized in-place")}}else if(Pe instanceof h)xe=Tl("<!---->"),je=xe.ownerDocument.importNode(Pe,!0),je.nodeType===Td.element&&je.nodeName==="BODY"||je.nodeName==="HTML"?xe=je:xe.appendChild(je);else{if(!ct&&!Ge&&!ze&&Pe.indexOf("<")===-1)return G&&Gn?G.createHTML(Pe):Pe;if(xe=Tl(Pe),!xe)return ct?null:Gn?Y:""}xe&&gt&&Yt(xe.firstChild);const Ot=Sr(Ps?Pe:xe);for(;Nt=Ot.nextNode();)sr(Nt),Pn(Nt),Nt.content instanceof l&&Xt(Nt.content);if(Ps)return Pe;if(ct){if(It)for(on=T.call(xe.ownerDocument);xe.firstChild;)on.appendChild(xe.firstChild);else on=xe;return(ue.shadowroot||ue.shadowrootmode)&&(on=F.call(n,on,!0)),on}let Nn=ze?xe.outerHTML:xe.innerHTML;return ze&&ne["!doctype"]&&xe.ownerDocument&&xe.ownerDocument.doctype&&xe.ownerDocument.doctype.name&&gs(H1,xe.ownerDocument.doctype.name)&&(Nn="<!DOCTYPE "+xe.ownerDocument.doctype.name+`>
`+Nn),Ge&&Wf([V,D,De],Mn=>{Nn=wd(Nn,Mn," ")}),G&&Gn?G.createHTML(Nn):Nn},e.setConfig=function(){let Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ii(Pe),Qe=!0},e.clearConfig=function(){ds=null,Qe=!1},e.isValidAttribute=function(Pe,Q,xe){ds||ii({});const je=qt(Pe),Nt=qt(Q);return Os(je,Nt,xe)},e.addHook=function(Pe,Q){typeof Q=="function"&&bd(j[Pe],Q)},e.removeHook=function(Pe,Q){if(Q!==void 0){const xe=kO(j[Pe],Q);return xe===-1?void 0:DO(j[Pe],xe,1)[0]}return oE(j[Pe])},e.removeHooks=function(Pe){j[Pe]=[]},e.removeAllHooks=function(){j=mE()},e}var ix=G1();const XO=()=>{const{user:s}=wn(),[e,t]=M.useState(""),[n,a]=M.useState(!1),[l,u]=M.useState(null),[h,m]=M.useState(!1),[p,x]=M.useState([]),[w,b]=M.useState(!1),[E,R]=M.useState(""),[k,U]=M.useState({enabled:!1,interval:24,lastRun:null,nextRun:null});M.useEffect(()=>{z(),B()},[]);const z=async()=>{try{const j=await Ui.getBotAccounts();x(j)}catch(j){console.error("Error loading bots:",j)}},B=async()=>{try{const j=await Ui.getAutomationSettings();U(j)}catch(j){console.error("Error loading automation settings:",j)}},q=async()=>{a(!0);try{const D=(await zi(Ha,"getRandomMathPost")()).data;t(D.url),confirm(`Found: "${D.question.title}" (${D.question.score} votes)

Auto-convert to flashcard?`)&&await G(D.url)}catch(j){console.error("Error getting random post:",j),alert("Failed to get random math post: "+j.message)}finally{a(!1)}},G=async(j=null)=>{const V=j||e;if(!V){alert("Please enter a Stack Exchange URL");return}a(!0);try{const De=await zi(Ha,"convertStackExchangePost")({url:V});u(De.data),m(!1)}catch(D){console.error("Error converting post:",D),alert("Failed to convert post: "+D.message)}finally{a(!1)}},Y=(j,V)=>{u(D=>({...D,[j]:V}))},L=async()=>{if(!E){alert("Please select a bot account");return}if(!l){alert("No conversion data available");return}a(!0);try{const V=await zi(Ha,"publishStackExchangeFlashcard")({conversion:l,botId:E});alert("Flashcard published successfully!"),u(null),t(""),R("")}catch(j){console.error("Error publishing flashcard:",j),alert("Failed to publish flashcard: "+j.message)}finally{a(!1)}},P=async()=>{try{const j={...k,enabled:!k.enabled};await Ui.updateAutomationSettings(j),U(j)}catch(j){console.error("Error updating automation:",j),alert("Failed to update automation settings")}},T=async j=>{try{const V={...k,interval:parseInt(j)};await Ui.updateAutomationSettings(V),U(V)}catch(V){console.error("Error updating automation interval:",V),alert("Failed to update automation interval")}},A=async()=>{if(p.length===0){alert(`❌ No bots available!

You need to create at least one bot account before triggering automation.

Go to the "Bots" tab to create a bot first.`);return}const j=p.filter(V=>V.isActive);if(j.length===0){alert(`❌ No active bots!

You have bots, but none are currently active.

Activate at least one bot in the "Bots" tab before triggering automation.`);return}if(confirm(`This will trigger the full automation pipeline:

1. Select random bot (from ${j.length} active bots)
2. Get random StackExchange post
3. Convert to flashcard with DeepSeek AI
4. Publish as bot
5. Bot likes own post

Continue?`)){a(!0);try{const De=(await zi(Ha,"triggerAutomation")()).data;alert(`✅ Automation completed successfully!

Bot: ${De.botName}
Post ID: ${De.postId}
Card URL: ${De.cardUrl||"Not available"}
Source: ${De.stackExchangeUrl}

Check the Cloud Functions logs for detailed execution info.`),z(),B()}catch(V){console.error("Error triggering automation:",V);let D=V.message;D.includes("Failed to get random math post")?D="StackExchange API issue - likely rate limited. Try again in a few minutes.":D.includes("No active bot accounts")?D="No active bots found. Create and activate a bot first.":D.includes("DeepSeek")&&(D="AI conversion failed. Check DeepSeek API key and credits."),alert(`❌ Automation failed: ${D}

Check the browser console and Cloud Functions logs for more details.`)}finally{a(!1)}}},F=async()=>{if(confirm("Are you sure you want to stop the automation? This will disable all scheduled automated posting."))try{const j={...k,enabled:!1,lastStopped:new Date().toISOString()};await Ui.updateAutomationSettings(j),U(j),alert("🛑 Automation has been stopped. No more automated posts will be created.")}catch(j){console.error("Error stopping automation:",j),alert("Failed to stop automation: "+j.message)}};return i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"🔄 StackExchange to Flashcard Converter"}),i.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200 mb-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"🤖 Automation Settings"}),i.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${k.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${k.enabled?"bg-green-500":"bg-gray-400"}`}),k.enabled?"ACTIVE":"STOPPED"]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Automated Posting Control:"}),i.jsx("div",{className:"flex gap-2",children:k.enabled?i.jsx("button",{onClick:F,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2",children:"🛑 Stop Automation"}):i.jsxs("button",{onClick:P,disabled:n||p.length===0||p.filter(j=>j.isActive).length===0,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[i.jsx("span",{className:"animate-pulse",children:"🚀"}),"Start Automation"]})})]}),p.length===0&&i.jsx("span",{className:"text-xs text-red-600 bg-red-100 px-2 py-1 rounded",children:"⚠️ Create bots first"}),p.length>0&&p.filter(j=>j.isActive).length===0&&i.jsx("span",{className:"text-xs text-orange-600 bg-orange-100 px-2 py-1 rounded",children:"⚠️ Activate bots first"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Post every:"}),i.jsxs("select",{value:k.interval,onChange:j=>T(j.target.value),disabled:!k.enabled,className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50",children:[i.jsx("option",{value:15,children:"15 minutes"}),i.jsx("option",{value:30,children:"30 minutes"}),i.jsx("option",{value:60,children:"1 hour"}),i.jsx("option",{value:180,children:"3 hours"}),i.jsx("option",{value:360,children:"6 hours"}),i.jsx("option",{value:720,children:"12 hours"}),i.jsx("option",{value:1440,children:"24 hours"})]})]}),k.lastRun&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Last run: ",new Date(k.lastRun).toLocaleString()]}),k.nextRun&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Next run: ",new Date(k.nextRun).toLocaleString()]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"📝 Manual Conversion"}),i.jsxs("div",{className:"flex gap-3 mb-4",children:[i.jsx("input",{type:"url",value:e,onChange:j=>t(j.target.value),placeholder:"https://math.stackexchange.com/questions/...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsx("button",{onClick:()=>G(),disabled:n||!e,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:n?"Converting...":"Convert to Flashcard"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:q,disabled:n,className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:"🎲 Test: Get Random Math Post"}),i.jsxs("button",{onClick:()=>b(!w),disabled:n,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:[w?"🔼 Hide":"🔍 Review"," Broken Cards"]})]}),i.jsxs("div",{className:"border-t pt-3",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Manual Testing:"}),p.length===0&&i.jsx("span",{className:"text-xs text-red-600 bg-red-100 px-2 py-1 rounded",children:"⚠️ Create bots first"}),p.length>0&&p.filter(j=>j.isActive).length===0&&i.jsx("span",{className:"text-xs text-orange-600 bg-orange-100 px-2 py-1 rounded",children:"⚠️ Activate bots first"})]}),i.jsx("button",{onClick:A,disabled:n||p.length===0||p.filter(j=>j.isActive).length===0,className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"🚀 Test Full Pipeline Once"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This runs the entire automation once for testing. The scheduled automation above runs automatically."})]})]})]}),l&&i.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"🎯 Conversion Result"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statement:"}),h?i.jsx("textarea",{value:l.statement,onChange:j=>Y("statement",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4}):i.jsx("div",{className:"p-4 bg-white border border-gray-200 rounded-lg prose max-w-none",dangerouslySetInnerHTML:{__html:ix.sanitize(l.statement)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hints:"}),h?i.jsx("textarea",{value:l.hints,onChange:j=>Y("hints",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3}):i.jsx("div",{className:"p-4 bg-white border border-gray-200 rounded-lg prose max-w-none",dangerouslySetInnerHTML:{__html:ix.sanitize(l.hints)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proof:"}),h?i.jsx("textarea",{value:l.proof,onChange:j=>Y("proof",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4}):i.jsx("div",{className:"p-4 bg-white border border-gray-200 rounded-lg prose max-w-none",dangerouslySetInnerHTML:{__html:ix.sanitize(l.proof)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags:"}),h?i.jsx("input",{type:"text",value:l.tags?.join(", ")||"",onChange:j=>Y("tags",j.target.value.split(",").map(V=>V.trim())),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tag1, tag2, tag3"}):i.jsx("div",{className:"flex flex-wrap gap-2",children:l.tags?.map(j=>i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:["#",j]},j))})]})]}),i.jsxs("div",{className:"flex gap-3 mt-6",children:[i.jsx("button",{onClick:()=>m(!h),className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:h?"Preview":"Edit"}),i.jsx("button",{onClick:()=>G(),className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Regenerate"})]})]}),l&&i.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"🚀 Publish Flashcard"}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Bot Account:"}),i.jsxs("select",{value:E,onChange:j=>R(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Choose a bot..."}),p.map(j=>i.jsxs("option",{value:j.id,children:[j.displayName," (",j.email,")"]},j.id))]})]}),i.jsx("button",{onClick:L,disabled:n||!E,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:n?"Publishing...":"Publish Flashcard"})]}),w&&i.jsx(AO,{}),i.jsx(jO,{})]})},WO=()=>{const[s,e]=M.useState([]),[t,n]=M.useState(!1),[a,l]=M.useState({displayName:"",email:"",password:"",bio:"",avatar:""}),[u,h]=M.useState(!1);M.useEffect(()=>{m()},[]);const m=async()=>{n(!0);try{const b=await Ui.getBotAccounts();e(b)}catch(b){console.error("Error loading bots:",b),alert("Failed to load bot accounts")}finally{n(!1)}},p=async()=>{if(!a.displayName||!a.email||!a.password){alert("Please fill in all required fields");return}n(!0);try{const b=await Ui.createBotAccount(a);alert("Bot account created successfully!"),l({displayName:"",email:"",password:"",bio:"",avatar:""}),h(!1),m()}catch(b){console.error("Error creating bot:",b),alert("Failed to create bot account: "+b.message)}finally{n(!1)}},x=async b=>{if(confirm("Are you sure you want to delete this bot account? This action cannot be undone.")){n(!0);try{await Ui.deleteBotAccount(b),alert("Bot account deleted successfully!"),m()}catch(E){console.error("Error deleting bot:",E),alert("Failed to delete bot account: "+E.message)}finally{n(!1)}}},w=async(b,E)=>{n(!0);try{await zi(Ha,"updateBotStatus")({botId:b,isActive:!E}),m()}catch(R){console.error("Error updating bot status:",R),alert("Failed to update bot status: "+R.message)}finally{n(!1)}};return i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"🤖 Bot Account Management"}),i.jsxs("div",{className:"flex gap-4 mb-6",children:[i.jsx("button",{onClick:()=>h(!u),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:u?"Cancel":"+ Create New Bot"}),i.jsx("button",{onClick:m,disabled:t,className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:t?"Loading...":"Refresh"})]}),u&&i.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create New Bot Account"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Name:"}),i.jsx("input",{type:"text",value:a.displayName,onChange:b=>l({...a,displayName:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., MathBot Pro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email:"}),i.jsx("input",{type:"email",value:a.email,onChange:b=>l({...a,email:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., mathbot1@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password:"}),i.jsx("input",{type:"password",value:a.password,onChange:b=>l({...a,password:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Strong password"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Avatar URL (optional):"}),i.jsx("input",{type:"url",value:a.avatar,onChange:b=>l({...a,avatar:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/avatar.jpg"})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio:"}),i.jsx("textarea",{value:a.bio,onChange:b=>l({...a,bio:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Brief description of this bot..."})]}),a.avatar&&i.jsxs("div",{className:"mt-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Avatar Preview:"}),i.jsx("img",{src:a.avatar,alt:"Avatar preview",className:"w-16 h-16 rounded-full object-cover border border-gray-300",onError:b=>{b.target.style.display="none"}})]}),i.jsxs("div",{className:"flex gap-3 mt-6",children:[i.jsx("button",{onClick:p,disabled:t,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:t?"Creating...":"Create Bot"}),i.jsx("button",{onClick:()=>h(!1),className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Cancel"})]})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Bot Accounts (",s.length,")"]}),t&&i.jsx("div",{className:"text-gray-600 py-4",children:"Loading bot accounts..."}),s.length===0&&!t&&i.jsx("div",{className:"text-gray-600 py-8 text-center",children:i.jsx("p",{children:"No bot accounts found. Create your first bot to get started!"})}),i.jsx("div",{className:"grid gap-4",children:s.map(b=>i.jsx("div",{className:`p-4 rounded-lg border ${b.isActive?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:b.displayName}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:b.isActive?"Active":"Inactive"})]}),i.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Email:"})," ",b.email]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Bio:"})," ",b.bio||"No bio set"]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Created:"})," ",b.createdAt?b.createdAt.toDate?b.createdAt.toDate().toLocaleDateString():new Date(b.createdAt).toLocaleDateString():"Unknown"]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Posts:"})," ",b.postCount||0]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Last Active:"})," ",b.lastActive?new Date(b.lastActive).toLocaleString():"Never"]})]})]}),i.jsxs("div",{className:"flex gap-2 ml-4",children:[i.jsx("button",{onClick:()=>w(b.id,b.isActive),disabled:t,className:`px-3 py-1 rounded text-sm font-medium transition-colors ${b.isActive?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:b.isActive?"Deactivate":"Activate"}),i.jsx("button",{onClick:()=>x(b.id),disabled:t,className:"px-3 py-1 rounded text-sm font-medium bg-red-100 text-red-700 hover:bg-red-200 transition-colors",children:"Delete"})]})]})},b.id))})]})]})},JO=({onClose:s})=>{const{user:e}=wn(),[t,n]=M.useState(null),[a,l]=M.useState(!0),[u,h]=M.useState("overview"),[m,p]=M.useState(null),[x,w]=M.useState([]),[b,E]=M.useState([]),[R,k]=M.useState([]);M.useEffect(()=>{e&&U()},[e]);const U=async()=>{try{if(l(!0),!await Rr.verifyAdminAccess(e)){console.log("❌ No admin access, closing dashboard"),s&&s();return}const A=await Rr.getAdminStatus(e.uid);n(A),await z()}catch(T){console.error("❌ Error checking admin access:",T),s&&s()}finally{l(!1)}},z=async()=>{try{const T=await Rr.getSystemStats();p(T)}catch(T){console.error("Error loading system stats:",T)}},B=async()=>{try{const T=await Rr.getAllUsers(100);w(T)}catch(T){console.error("Error loading users:",T)}},q=async()=>{try{const T=await Rr.getPublicCardsForModeration(50);E(T)}catch(T){console.error("Error loading public cards:",T)}},G=async()=>{try{const T=await Rr.getAdminActivity(30);k(T)}catch(T){console.error("Error loading admin activity:",T)}},Y=async T=>{switch(h(T),T){case"users":await B();break;case"content":await q();break;case"activity":await G();break}},L=async(T,A)=>{try{await Rr.updateUserPremium(T,A),await Rr.logAdminAction(e.uid,"user_premium_update",{targetUserId:T,newStatus:A}),await B()}catch(F){console.error("Error updating user premium:",F),alert("Failed to update user premium status")}},P=async(T,A,F="")=>{try{await Rr.moderateCard(T,A,F),await Rr.logAdminAction(e.uid,"content_moderation",{cardId:T,action:A,reason:F}),await q()}catch(j){console.error("Error moderating card:",j),alert("Failed to moderate content")}};return a?i.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"claude-card p-8 text-center",children:[i.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-red-500 rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"claude-text-secondary",children:"Verifying admin access..."})]})}):t?.isAdmin?i.jsx("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-4xl font-extrabold mb-2 text-red-600",children:"🔧 Admin Dashboard"}),i.jsx("p",{className:"claude-text-secondary",children:"System management and content moderation"}),i.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[i.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800",children:[t.adminLevel.toUpperCase()," ADMIN"]}),i.jsxs("span",{className:"text-sm claude-text-muted",children:["Logged in as: ",e.email]})]})]}),i.jsxs("div",{className:"flex items-center gap-4 mt-4 md:mt-0",children:[i.jsx("button",{onClick:z,className:"claude-button-secondary",children:"🔄 Refresh Data"}),s&&i.jsx("button",{onClick:s,className:"claude-button-secondary",children:"✕ Close Admin"})]})]}),i.jsx("div",{className:"mb-8 claude-card p-4 bg-gradient-to-r from-red-50 to-orange-50 border-red-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-2xl",children:"⚠️"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-red-800",children:"Administrator Mode Active"}),i.jsx("div",{className:"text-sm text-red-600",children:"All actions are logged. Use admin privileges responsibly."})]})]})}),i.jsx("div",{className:"flex space-x-1 mb-8 claude-card p-1 rounded-2xl",children:[{id:"overview",label:"📊 Overview",icon:"📊"},{id:"users",label:"👥 Users",icon:"👥"},{id:"content",label:"📝 Content",icon:"📝"},{id:"activity",label:"📋 Activity",icon:"📋"},{id:"stackexchange",label:"🔄 StackExchange",icon:"🔄"},{id:"bots",label:"🤖 Bots",icon:"🤖"}].map(T=>i.jsxs("button",{onClick:()=>Y(T.id),className:`flex-1 px-4 py-3 rounded-xl font-medium transition-all duration-200 ${u===T.id?"bg-blue-500 text-white shadow-lg":"claude-text-secondary hover:bg-gray-100"}`,children:[i.jsx("span",{className:"mr-2",children:T.icon}),i.jsx("span",{className:"hidden sm:inline",children:T.label.replace(/^.+\s/,"")})]},T.id))}),u==="overview"&&i.jsx(ZO,{systemStats:m}),u==="users"&&i.jsx(eV,{users:x,onPremiumToggle:L}),u==="content"&&i.jsx(tV,{publicCards:b,onModerate:P}),u==="stackexchange"&&i.jsxs("div",{className:"admin-section",children:[i.jsx("h3",{children:"🔄 StackExchange Integration"}),i.jsx(XO,{})]}),u==="bots"&&i.jsxs("div",{className:"admin-section",children:[i.jsx("h3",{children:"🤖 Bot Management"}),i.jsx(WO,{})]}),u==="activity"&&i.jsx(nV,{adminActivity:R})]})}):i.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",style:{backgroundColor:"var(--claude-background)"},children:i.jsxs("div",{className:"claude-card p-8 text-center max-w-md",children:[i.jsx("div",{className:"text-6xl mb-4",children:"🚫"}),i.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Access Denied"}),i.jsx("p",{className:"claude-text-secondary mb-6",children:"You don't have administrator privileges to access this dashboard."}),i.jsx("button",{onClick:s,className:"claude-button-primary",children:"Return to App"})]})})},ZO=({systemStats:s})=>i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(Zf,{title:"Total Users",value:s?.users?.total||0,icon:"👥",color:"blue",subtitle:`${s?.users?.recentlyActive||0} active this week`}),i.jsx(Zf,{title:"Premium Users",value:s?.users?.premium||0,icon:"⭐",color:"gold",subtitle:`${s?.users?.conversionRate||0}% conversion rate`}),i.jsx(Zf,{title:"Total Content",value:s?.content?.totalCards||0,icon:"📚",color:"green",subtitle:`${s?.content?.totalPublicCards||0} public cards`}),i.jsx(Zf,{title:"Recent Activity",value:s?.content?.recentPublicCards||0,icon:"📈",color:"purple",subtitle:"New public cards this week"})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[i.jsx("span",{className:"text-green-500",children:"🟢"}),"System Status"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Database"}),i.jsx("span",{className:"text-green-600 font-medium",children:"Operational"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Authentication"}),i.jsx("span",{className:"text-green-600 font-medium",children:"Operational"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"File Storage"}),i.jsx("span",{className:"text-green-600 font-medium",children:"Operational"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Analytics"}),i.jsx("span",{className:"text-green-600 font-medium",children:"Operational"})]})]})]}),i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"📊 Usage Statistics"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Avg Cards per User"}),i.jsx("span",{className:"font-medium",children:s?.content?.avgCardsPerUser||0})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Admin Users"}),i.jsx("span",{className:"font-medium",children:s?.users?.admin||0})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Public vs Private"}),i.jsxs("span",{className:"font-medium",children:[s?.content?.totalPublicCards||0," / ",s?.content?.totalPrivateCards||0]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Last Updated"}),i.jsx("span",{className:"font-medium text-sm",children:s?.system?.lastUpdated?new Date(s.system.lastUpdated).toLocaleTimeString():"Never"})]})]})]})]})]}),eV=({users:s,onPremiumToggle:e})=>i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold",children:"User Management"}),i.jsxs("div",{className:"text-sm claude-text-muted",children:[s.length," users loaded"]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(t=>i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold",children:t.displayName}),i.jsx("p",{className:"text-sm claude-text-muted",children:t.email}),i.jsxs("p",{className:"text-xs claude-text-muted",children:["Joined: ",t.joinDate.toLocaleDateString()]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[t.isPremium&&i.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:"Premium"}),t.isAdmin&&i.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Admin"})]})]}),i.jsxs("div",{className:"space-y-2 mb-4 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Profile:"}),i.jsx("span",{children:t.profile?.displayName?"Complete":"Incomplete"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Last Seen:"}),i.jsx("span",{children:t.lastSeen.toLocaleDateString()})]})]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:()=>e(t.id,!t.isPremium),className:`w-full px-3 py-2 rounded text-sm font-medium transition-colors ${t.isPremium?"bg-yellow-100 text-yellow-800 hover:bg-yellow-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:t.isPremium?"❌ Remove Premium":"⭐ Grant Premium"})})]},t.id))})]}),tV=({publicCards:s,onModerate:e})=>i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Content Moderation"}),i.jsxs("div",{className:"text-sm claude-text-muted",children:[s.length," public cards"]})]}),i.jsxs("div",{className:"space-y-4",children:[s.map(t=>i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("h4",{className:"font-bold mb-2",children:[t.statement?.substring(0,100),"..."]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm claude-text-muted",children:[i.jsxs("span",{children:["By: ",t.author?.displayName||t.author?.email||"Unknown"]}),i.jsxs("span",{children:["Created: ",t.createdDate.toLocaleDateString()]}),i.jsxs("span",{children:["Likes: ",t.likeCount||0]}),i.jsxs("span",{children:["Views: ",t.viewCount||0]})]})]}),i.jsxs("div",{className:"flex gap-2 ml-4",children:[i.jsx("button",{onClick:()=>e(t.id,"hide","Hidden by admin"),className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-sm hover:bg-yellow-200",children:"👁️ Hide"}),i.jsx("button",{onClick:()=>e(t.id,"remove","Removed by admin"),className:"px-3 py-1 bg-red-100 text-red-800 rounded text-sm hover:bg-red-200",children:"🗑️ Remove"})]})]}),t.isHidden&&i.jsx("div",{className:"p-2 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800",children:"⚠️ This card is currently hidden from public view"}),t.isRemoved&&i.jsx("div",{className:"p-2 bg-red-50 border border-red-200 rounded text-sm text-red-800",children:"🚫 This card has been removed"})]},t.id)),s.length===0&&i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"No public cards found"})]})]}),nV=({adminActivity:s})=>i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Admin Activity Log"}),i.jsxs("div",{className:"text-sm claude-text-muted",children:["Recent ",s.length," actions"]})]}),i.jsxs("div",{className:"space-y-3",children:[s.map(e=>i.jsx("div",{className:"claude-card p-4 rounded-xl",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:e.action.replace(/_/g," ").toUpperCase()}),i.jsxs("div",{className:"text-sm claude-text-muted",children:["By: ",e.admin?.displayName||e.admin?.email||"Unknown"]}),e.details&&Object.keys(e.details).length>0&&i.jsxs("div",{className:"text-xs claude-text-muted mt-1",children:["Details: ",JSON.stringify(e.details,null,2)]})]}),i.jsx("div",{className:"text-xs claude-text-muted",children:e.timestamp.toLocaleString()})]})},e.id)),s.length===0&&i.jsx("div",{className:"text-center py-8 claude-text-muted",children:"No admin activity recorded"})]})]}),Zf=({title:s,value:e,icon:t,color:n,subtitle:a})=>i.jsxs("div",{className:"claude-card p-6 rounded-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("div",{className:"text-2xl",children:t}),i.jsx("div",{className:`w-3 h-3 rounded-full bg-${n}-500`})]}),i.jsx("div",{className:`text-2xl font-bold mb-1 text-${n}-600`,children:e}),i.jsx("div",{className:"text-sm font-medium mb-1",children:s}),a&&i.jsx("div",{className:"text-xs claude-text-muted",children:a})]});function sV(){const[s,e]=M.useState("home"),[t,n]=M.useState(null),[a,l]=M.useState(null),[u,h]=M.useState(null),[m,p]=M.useState({hasProfile:!1,hasCards:!1}),[x,w]=M.useState(!1),[b,E]=M.useState(!1),[R,k]=M.useState(!1),[U,z]=M.useState(!1),[B,q]=M.useState(0),[G,Y]=M.useState(!1),{user:L,signInWithGoogle:P,logout:T,authError:A,getFreshIdToken:F,sessionWarning:j,dismissSessionWarning:V}=wn();M.useEffect(()=>{L&&De()},[L]),M.useEffect(()=>{Bn.initializeAutoTracking(L?.uid),Bn.trackFeatureUsage("app","loaded",{userLoggedIn:!!L},L?.uid)},[]),M.useEffect(()=>{if(s){Bn.trackPageView(`/new/${s}`,null,L?.uid),Bn.trackUserFlow(localStorage.getItem("lastMode")||"home",s,"navigation",L?.uid),localStorage.setItem("lastMode",s);const ye=new URL(window.location);ye.searchParams.set("mode",s),window.history.replaceState({mode:s},"",ye.toString())}},[s]),M.useEffect(()=>{const ye=we=>{const Fe=new URLSearchParams(window.location.search).get("mode")||we.state?.mode||"home";e(Fe)};window.addEventListener("popstate",ye);const ce=new URLSearchParams(window.location.search).get("mode");return ce&&e(ce),()=>window.removeEventListener("popstate",ye)},[]),M.useEffect(()=>{L?(Bn.trackConversion("user_login",1,L.uid),Bn.trackFeatureUsage("auth","login_success",{},L.uid),D()):Y(!1)},[L]);const D=async()=>{try{const ye=await Rr.verifyAdminAccess(L);Y(ye)}catch(ye){console.error("Error checking admin status:",ye),Y(!1)}},De=async()=>{try{const ye=await gm.checkOnboardingStatus(L.uid),Se=await As.hasProfile(L.uid);try{const ce=await gm.autoMigrateUserDecks(L.uid);ce.success&&ce.migrationResult&&console.log("✅ Deck migration completed:",ce.message)}catch(ce){console.warn("Deck migration failed:",ce)}p({...ye,hasProfile:ye.hasProfile||Se})}catch(ye){console.error("Error checking onboarding status:",ye)}},Z=async()=>{try{await P()}catch(ye){console.error("Error signing in:",ye)}},O=async()=>{try{await T()}catch(ye){console.error("Error signing out:",ye)}},oe=async()=>{if(!L){await Z();return}try{const ye=await gm.getUserProfile(L.uid);e(ye?"dashboard":"create-profile")}catch(ye){console.error("Error checking profile:",ye),e("create-profile")}},$=async ye=>{if(!L){await Z();return}ye==="profile"&&!m.hasProfile&&e("create-profile")},ge=async()=>{await De(),e("home")},C=ye=>{n(ye),e("profile")},ne=()=>{q(ye=>ye+1),L&&De()},ve=()=>{switch(s){case"create":return i.jsx(H5,{onCardCreated:ne,onClose:()=>e("home")});case"study":return i.jsx($5,{},B);case"search":return i.jsx(K5,{});case"decks":return i.jsx(fO,{onCreateDeck:()=>e("create-deck"),onEditDeck:ye=>{l(ye),e("edit-deck")},onSelectDeck:ye=>{h(ye),e("study")}});case"create-deck":return i.jsx(rE,{onDeckCreated:()=>e("decks"),onClose:()=>e("decks")});case"edit-deck":return i.jsx(rE,{editingDeck:a,onDeckCreated:()=>{l(null),e("decks")},onClose:()=>{l(null),e("decks")}});case"analytics":return i.jsx(gO,{onClose:()=>e("home")});case"admin-analytics":return i.jsx(bO,{onClose:()=>e("home")});case"admin-dashboard":return i.jsx(JO,{onClose:()=>e("home")});case"leaderboard":return i.jsx(Y5,{});case"dashboard":return i.jsx(J5,{});case"icon-test":return i.jsx(SO,{});case"create-profile":return i.jsx(cO,{onProfileCreated:ge,onClose:()=>e("home")});case"social":return i.jsx(uO,{onViewProfile:C});case"profile":return i.jsx(hO,{profileSlug:t,onClose:()=>e("home")});default:return Ie()}},ue=()=>{const[ye,Se]=M.useState(!1),[ce,we]=M.useState(!1),[Ee,Fe]=M.useState(!1),[Ze,Ge]=M.useState(!1);return i.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 backdrop-blur-md border-b",style:{backgroundColor:"rgba(246, 245, 236, 0.8)",borderBottomColor:"var(--border-light)"},children:[i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3 group cursor-pointer",onClick:()=>e("home"),children:[i.jsxs("div",{className:"relative",children:[i.jsx("img",{src:"/files/three-sided_logo.png",alt:"Three-Sided",width:"40",height:"40",className:"rounded-xl shadow-lg group-hover:shadow-blue-500/25 transition-all duration-300 group-hover:scale-105"}),i.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500 to-purple-500 opacity-0 group-hover:opacity-20 transition-opacity duration-300"})]}),i.jsx("span",{className:"text-xl md:text-2xl font-extrabold tracking-tight",style:{color:"var(--claude-heading)"},children:"Three‑Sided"})]}),s==="home"&&L&&i.jsxs("div",{className:"hidden lg:flex items-center gap-3",children:[i.jsxs("button",{className:"claude-button-secondary flex items-center gap-2",onClick:()=>e("search"),children:[i.jsx(Fa,{size:16,color:"default"}),"Search"]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{className:"claude-button-secondary flex items-center gap-1",onClick:()=>we(!ce),onBlur:()=>setTimeout(()=>we(!1),200),children:[i.jsx($a,{size:16,color:"default"}),"Study ▾"]}),ce&&i.jsxs("div",{className:"absolute top-full mt-1 left-0 bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-48 z-60",children:[i.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors",onClick:()=>{e("decks"),we(!1)},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx($a,{size:16,color:"default"}),"My Decks"]})}),i.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors",onClick:()=>{e("study"),we(!1)},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(rl,{size:16,color:"default"}),"Study Mode"]})}),i.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors",onClick:()=>{e("create"),we(!1)},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(pr,{size:16,color:"default"}),"Create Flashcard"]})})]})]}),i.jsxs("button",{className:"claude-button-secondary flex items-center gap-2",onClick:()=>e("social"),children:[i.jsx($x,{size:16,color:"default"}),"Social"]}),i.jsxs("button",{className:"claude-button-secondary flex items-center gap-2",onClick:()=>e("leaderboard"),children:[i.jsx(Pr,{size:16,color:"default"}),"Leaderboard"]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{className:"claude-button-secondary flex items-center gap-1",onClick:()=>Fe(!Ee),onBlur:()=>setTimeout(()=>Fe(!1),200),children:[i.jsx(Yi,{size:16,color:"default"}),"Account ▾"]}),Ee&&i.jsxs("div",{className:"absolute top-full mt-1 right-0 bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-48 z-60",children:[i.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors",onClick:()=>{e("dashboard"),Fe(!1)},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(yn,{size:16,color:"default"}),"My Dashboard"]})}),i.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors flex items-center gap-2",onClick:()=>{oe(),Fe(!1)},children:[i.jsx(Yi,{size:16,color:"default"}),"My Profile"]}),i.jsx("div",{className:"border-t border-gray-200 my-1"}),i.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors",onClick:()=>{e("analytics"),Fe(!1),Bn.trackClick("button",{text:"Analytics",action:"view_analytics"},L?.uid)},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(U1,{size:16,color:"default"}),"Learning Analytics"]})})]})]}),G&&i.jsxs("div",{className:"relative",children:[i.jsx("button",{className:"claude-button-secondary bg-red-50 text-red-700 hover:bg-red-100 border-red-200 flex items-center gap-1",onClick:()=>Ge(!Ze),onBlur:()=>setTimeout(()=>Ge(!1),200),children:"🔧 Admin ▾"}),Ze&&i.jsxs("div",{className:"absolute top-full mt-1 right-0 bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-48 z-60",children:[i.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors",onClick:()=>{e("admin-analytics"),Ge(!1),Bn.trackClick("button",{text:"Website Analytics",action:"view_admin_analytics"},L?.uid)},children:"🚀 Website Analytics"}),i.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors text-red-600",onClick:()=>{e("admin-dashboard"),Ge(!1),Bn.trackClick("button",{text:"Admin Dashboard",action:"view_admin_dashboard"},L?.uid)},children:"🔧 Admin Dashboard"})]})]})]}),s!=="home"&&i.jsx("div",{className:"hidden md:block",children:i.jsxs("span",{className:"text-lg font-bold",style:{color:"var(--claude-heading)"},children:[s==="create"&&"✏️ Create Flashcard",s==="study"&&"📚 Study Mode",s==="search"&&"Search & Discovery",s==="decks"&&"📚 My Decks",s==="create-deck"&&"➕ Create Deck",s==="edit-deck"&&"✏️ Edit Deck",s==="analytics"&&"📊 Learning Analytics",s==="admin-analytics"&&"🚀 Website Analytics",s==="admin-dashboard"&&"🔧 Admin Dashboard",s==="leaderboard"&&"🏆 Leaderboard & Stats",s==="dashboard"&&"🎯 My Dashboard",t&&"👤 Profile",!t&&s==="social"&&"👥 Social Hub",!t&&s==="create-profile"&&"👤 Create Profile"]})}),i.jsxs("div",{className:"flex items-center gap-3",children:[L&&i.jsx("button",{className:"lg:hidden claude-button-secondary",onClick:()=>Se(!ye),children:"☰"}),L?i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-3 py-2 rounded-xl",style:{backgroundColor:"rgba(91, 200, 162, 0.15)",border:"1px solid var(--success)",color:"var(--success)"},children:[i.jsx("div",{className:"w-2 h-2 rounded-full animate-pulse",style:{backgroundColor:"var(--success)"}}),i.jsx("span",{className:"text-sm font-medium",children:L.displayName?.split(" ")[0]||"User"})]}),i.jsx("button",{className:"claude-button-secondary",style:{borderColor:"var(--error)",color:"var(--error)"},onClick:O,children:"Sign Out"})]}):i.jsxs("div",{className:"flex flex-col items-end gap-2",children:[A&&i.jsx("div",{className:"text-xs text-red-600 bg-red-50 px-2 py-1 rounded border border-red-200 max-w-xs text-right",children:A}),i.jsx("button",{className:"claude-button-primary transform hover:scale-105 transition-all duration-200",onClick:Z,style:{background:"linear-gradient(135deg, #D4A574 0%, #C19A6B 100%)"},children:"Sign In"})]})]})]}),L&&ye&&i.jsx("div",{className:"lg:hidden bg-white border-t border-gray-200 shadow-lg",children:i.jsxs("div",{className:"px-4 py-3 space-y-2",children:[i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{e("search"),Se(!1)},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Fa,{size:16,color:"default"}),"Search"]})}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{e("decks"),Se(!1)},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx($a,{size:16,color:"default"}),"My Decks"]})}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{e("study"),Se(!1)},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(rl,{size:16,color:"default"}),"Study Mode"]})}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{e("create"),Se(!1)},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(pr,{size:16,color:"default"}),"Create Flashcard"]})}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{e("social"),Se(!1)},children:"👥 Social"}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{e("leaderboard"),Se(!1)},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Pr,{size:16,color:"default"}),"Leaderboard"]})}),i.jsx("div",{className:"border-t border-gray-200 my-2"}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{e("dashboard"),Se(!1)},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(yn,{size:16,color:"default"}),"My Dashboard"]})}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{oe(),Se(!1)},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Yi,{size:16,color:"default"}),"My Profile"]})}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{e("analytics"),Se(!1),Bn.trackClick("button",{text:"Analytics",action:"view_analytics"},L?.uid)},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(yn,{size:16,color:"default"}),"Learning Analytics"]})}),G&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"border-t border-red-200 my-2"}),i.jsx("div",{className:"px-3 py-1 text-xs font-semibold text-red-600 bg-red-50 rounded-lg mb-2",children:"🔧 ADMIN CONTROLS"}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-red-50 transition-colors text-red-600 font-medium",onClick:()=>{e("admin-analytics"),Se(!1),Bn.trackClick("button",{text:"Website Analytics",action:"view_admin_analytics"},L?.uid)},children:"🚀 Website Analytics"}),i.jsx("button",{className:"w-full text-left py-2 px-3 rounded-lg hover:bg-red-50 transition-colors text-red-600 font-medium",onClick:()=>{e("admin-dashboard"),Se(!1),Bn.trackClick("button",{text:"Admin Dashboard",action:"view_admin_dashboard"},L?.uid)},children:"🔧 Admin Dashboard"})]})]})})]})},Ie=()=>i.jsxs("div",{className:"min-h-screen pt-20",style:{backgroundColor:"var(--claude-background)"},children:[!L&&i.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, var(--claude-background) 0%, var(--claude-subtle) 50%, var(--claude-surface) 100%)"},children:[i.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%234B284E' fill-opacity='0.05'%3E%3Cpath d='m36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),i.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 rounded-full blur-3xl animate-pulse",style:{backgroundColor:"rgba(99, 91, 255, 0.08)"}}),i.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 rounded-full blur-3xl animate-pulse",style:{backgroundColor:"rgba(68, 90, 255, 0.08)",animationDelay:"1s"}}),i.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 rounded-full blur-2xl animate-pulse",style:{backgroundColor:"rgba(91, 194, 162, 0.08)",animationDelay:"2s"}})]}),i.jsxs("div",{className:"max-w-7xl mx-auto px-4 relative z-10 text-center py-16",children:[i.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full mb-6",style:{backgroundColor:"rgba(91, 194, 162, 0.15)",border:"1px solid var(--claude-success)",color:"var(--claude-success)"},children:[i.jsx("div",{className:"w-2 h-2 rounded-full animate-pulse",style:{backgroundColor:"var(--claude-success)"}}),i.jsx("span",{className:"text-sm font-semibold",children:"New React Version - Live Now"})]}),i.jsxs("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-extrabold tracking-tight mb-8",style:{color:"var(--heading)"},children:["Master Any Subject",i.jsx("br",{}),i.jsx("span",{style:{color:"var(--accent-primary)"},children:"with Three‑Sided"})]}),i.jsxs("p",{className:"text-xl md:text-2xl max-w-4xl mx-auto mb-12 leading-relaxed claude-text-secondary",children:["Create, study, and share flashcards with ",i.jsx("span",{style:{color:"var(--claude-accent)",fontWeight:"600"},children:"AI assistance"}),". Learn faster with ",i.jsx("span",{style:{color:"var(--claude-accent-blue)",fontWeight:"600"},children:"spaced repetition"})," and a",i.jsx("span",{style:{color:"var(--claude-success)",fontWeight:"600"},children:" community library"}),"."]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[i.jsxs("button",{onClick:()=>e("search"),className:"claude-button-primary group relative min-w-[200px] transform hover:scale-105 transition-all duration-300",style:{background:"linear-gradient(135deg, #9B8B73 0%, #8A7A63 100%)",boxShadow:"0 8px 32px rgba(155, 139, 115, 0.25)"},children:[i.jsxs("span",{className:"relative z-10 flex items-center gap-3",children:[i.jsx(Fa,{size:20,color:"white"}),i.jsx("span",{children:"Search Flashcards"})]}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-white/10 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),i.jsx("button",{onClick:()=>e("leaderboard"),className:"claude-button-secondary group transform hover:scale-105 transition-all duration-300 min-w-[200px]",children:i.jsxs("span",{className:"flex items-center gap-3",children:[i.jsx(Pr,{size:20,color:"default"}),i.jsx("span",{children:"View Leaderboard"})]})})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-8 justify-center items-center mt-16",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold",style:{color:"var(--heading)"},children:"500+"}),i.jsx("div",{className:"claude-text-muted",children:"Flashcards"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold",style:{color:"var(--heading)"},children:"150+"}),i.jsx("div",{className:"claude-text-muted",children:"Students"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold",style:{color:"var(--heading)"},children:"250+"}),i.jsx("div",{className:"claude-text-muted",children:"Public"})]})]})]}),i.jsx("div",{className:"absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce",children:i.jsx("div",{className:"w-6 h-10 border-2 border-neutral-400 rounded-full flex justify-center",children:i.jsx("div",{className:"w-1 h-3 bg-neutral-400 rounded-full mt-2 animate-pulse"})})})]}),i.jsxs("div",{className:`max-w-7xl mx-auto px-4 ${L?"py-8":"py-16"}`,children:[L&&i.jsxs("div",{className:"relative p-8 mb-16 rounded-3xl bg-neutral-800/50 border border-neutral-700 backdrop-blur-sm shadow-2xl",children:[i.jsx("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-r from-blue-500/5 to-purple-500/5"}),i.jsxs("div",{className:"relative z-10",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h2",{className:"text-4xl font-extrabold mb-3",style:{color:"var(--claude-heading)"},children:"Quick Actions"}),i.jsx("p",{className:"text-neutral-300 text-lg",children:"Jump into your learning journey"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6",children:[i.jsxs("button",{onClick:()=>{e("create"),Bn.trackClick("homepage_action",{action:"create_flashcard",location:"quick_actions"},L?.uid),Bn.trackFeatureUsage("flashcard","create_started",{},L?.uid)},className:"claude-card group relative overflow-hidden p-6 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300",style:{background:"linear-gradient(135deg, #D4A574 0%, #C19A6B 100%)"},children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-2xl"}),i.jsxs("div",{className:"relative z-10 text-center text-white",children:[i.jsx("div",{className:"text-4xl mb-3",children:i.jsx(pr,{size:32,color:"white"})}),i.jsx("div",{className:"font-bold text-lg mb-1",children:"Create"}),i.jsx("div",{className:"text-white/90 text-sm",children:"New Flashcard"})]})]}),i.jsxs("button",{onClick:()=>{e("study"),Bn.trackClick("homepage_action",{action:"study_mode",location:"quick_actions"},L?.uid),Bn.trackFeatureUsage("study","session_started",{},L?.uid)},className:"claude-card group relative overflow-hidden p-6 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300",style:{background:"linear-gradient(135deg, #B8A082 0%, #A68B5B 100%)"},children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-2xl"}),i.jsxs("div",{className:"relative z-10 text-center text-white",children:[i.jsx("div",{className:"text-4xl mb-3",children:i.jsx(Ja,{size:32,color:"white"})}),i.jsx("div",{className:"font-bold text-lg mb-1",children:"Study"}),i.jsx("div",{className:"text-white/90 text-sm",children:"Practice Mode"})]})]}),i.jsxs("button",{onClick:()=>e("search"),className:"claude-card group relative overflow-hidden p-6 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300",style:{background:"linear-gradient(135deg, #9B8B73 0%, #8A7A63 100%)"},children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-2xl"}),i.jsxs("div",{className:"relative z-10 text-center text-white",children:[i.jsx("div",{className:"text-4xl mb-3",children:i.jsx(Fa,{size:32,color:"white"})}),i.jsx("div",{className:"font-bold text-lg mb-1",children:"Search"}),i.jsx("div",{className:"text-white/90 text-sm",children:"& Discover"})]})]}),i.jsxs("button",{onClick:()=>e("dashboard"),className:"claude-card group relative overflow-hidden p-6 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300",style:{background:"linear-gradient(135deg, #7E6B5A 0%, #6D5A4A 100%)"},children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-2xl"}),i.jsxs("div",{className:"relative z-10 text-center text-white",children:[i.jsx("div",{className:"text-4xl mb-3",children:i.jsx(rl,{size:32,color:"white"})}),i.jsx("div",{className:"font-bold text-lg mb-1",children:"Dashboard"}),i.jsx("div",{className:"text-white/90 text-sm",children:"My Progress"})]})]}),i.jsxs("button",{onClick:()=>e("decks"),className:"claude-card group relative overflow-hidden p-6 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300",style:{background:"linear-gradient(135deg, #6B5B4A 0%, #5A4A3A 100%)"},children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-2xl"}),i.jsxs("div",{className:"relative z-10 text-center text-white",children:[i.jsx("div",{className:"text-4xl mb-3",children:i.jsx($a,{size:32,color:"white"})}),i.jsx("div",{className:"font-bold text-lg mb-1",children:"Decks"}),i.jsx("div",{className:"text-white/90 text-sm",children:"Organize Cards"})]})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-8 mb-16 lg:grid-cols-3",children:[i.jsxs("div",{className:"claude-card group relative overflow-hidden p-8 transition-all duration-500 hover:scale-105",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 rounded-2xl"}),i.jsxs("div",{className:"relative z-10 text-center",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-[#D4A574] to-[#C19A6B] rounded-2xl mb-6 text-4xl shadow-lg group-hover:shadow-xl transition-all duration-300",children:i.jsx($x,{size:32,color:"white"})}),i.jsx("h3",{className:"text-2xl font-bold mb-4",style:{color:"var(--heading)"},children:"Community‑Driven"}),i.jsx("p",{className:"claude-text-secondary leading-relaxed",children:"Discover and share flashcards with students worldwide. Learn from the community's collective knowledge and contribute your own."})]})]}),i.jsxs("div",{className:"claude-card group relative overflow-hidden p-8 transition-all duration-500 hover:scale-105",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 rounded-2xl"}),i.jsxs("div",{className:"relative z-10 text-center",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-[#B8A082] to-[#A68B5B] rounded-2xl mb-6 text-4xl shadow-lg group-hover:shadow-xl transition-all duration-300",children:i.jsx(V1,{size:32,color:"white"})}),i.jsx("h3",{className:"text-2xl font-bold mb-4",style:{color:"var(--heading)"},children:"AI‑Powered Assistance"}),i.jsx("p",{className:"claude-text-secondary leading-relaxed",children:"Get AI‑generated hints, proofs, and suggestions to help you create better flashcards faster and study more effectively."})]})]}),i.jsxs("div",{className:"claude-card group relative overflow-hidden p-8 transition-all duration-500 hover:scale-105",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 rounded-2xl"}),i.jsxs("div",{className:"relative z-10 text-center",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-[#9B8B73] to-[#8A7A63] rounded-2xl mb-6 text-4xl shadow-lg group-hover:shadow-xl transition-all duration-300",children:i.jsx(qd,{size:32,color:"white"})}),i.jsx("h3",{className:"text-2xl font-bold mb-4",style:{color:"var(--heading)"},children:"LaTeX Support"}),i.jsxs("p",{className:"claude-text-secondary leading-relaxed",children:["Beautiful mathematical notation with full LaTeX rendering. Use ",i.jsx("code",{children:"$...$"})," for inline math and ",i.jsx("code",{children:"$$...$$"})," for display blocks."]})]})]})]}),i.jsxs("div",{className:"claude-card relative p-8 mb-16 backdrop-blur-sm shadow-2xl",children:[i.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-success-500/5 to-accent-500/5"}),i.jsxs("div",{className:"relative z-10",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h2",{className:"text-4xl font-extrabold mb-3",style:{color:"var(--heading)"},children:"Get Started"}),i.jsx("p",{className:"claude-text-secondary text-lg",children:"Complete these quick steps to join our community"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx("div",{className:`group relative overflow-hidden p-6 rounded-2xl border-2 transition-all duration-300 cursor-pointer ${L?"bg-gradient-to-br from-success-500/20 to-success-600/30 border-success-400/40 shadow-lg":"bg-white/5 border-white/20 hover:border-white/40 hover:bg-white/10"}`,onClick:()=>$("login"),children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center font-bold text-lg ${L?"bg-success-500 text-white":"bg-primary-500"}`,children:L?i.jsx(Cc,{size:16,color:"success"}):"1"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-bold text-lg mb-1",style:{color:"var(--heading)"},children:L?"Signed In":"Sign In"}),i.jsx("div",{className:"claude-text-secondary text-sm",children:L?`Welcome, ${L.displayName?.split(" ")[0]||"User"}!`:"Use Google to get started"})]})]})}),i.jsx("div",{className:`group relative overflow-hidden p-6 rounded-2xl border-2 transition-all duration-300 ${m.hasProfile?"bg-gradient-to-br from-success-500/20 to-success-600/30 border-success-400/40 shadow-lg":L?"bg-white/5 border-white/20 hover:border-white/40 hover:bg-white/10 cursor-pointer":"bg-white/5 border-white/10 opacity-50"}`,onClick:L&&!m.hasProfile?()=>$("profile"):void 0,children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center font-bold text-lg ${m.hasProfile?"bg-success-500 text-white":"bg-primary-500"}`,children:m.hasProfile?i.jsx(Cc,{size:16,color:"success"}):"2"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-bold text-lg mb-1",style:{color:"var(--heading)"},children:m.hasProfile?"Profile Created":"Create Profile"}),i.jsx("div",{className:"claude-text-secondary text-sm",children:m.hasProfile?"Profile is ready!":"Set display name & avatar"})]})]})}),i.jsx("div",{className:`group relative overflow-hidden p-6 rounded-2xl border-2 transition-all duration-300 ${m.hasCards?"bg-gradient-to-br from-success-500/20 to-success-600/30 border-success-400/40 shadow-lg":L?"bg-white/5 border-white/20":"bg-white/5 border-white/10 opacity-50"}`,children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center font-bold text-lg ${m.hasCards?"bg-success-500 text-white":"bg-primary-500"}`,children:m.hasCards?i.jsx(Cc,{size:16,color:"success"}):"3"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-bold text-lg mb-1",style:{color:"var(--heading)"},children:m.hasCards?"First Card Published":"Publish First Card"}),i.jsx("div",{className:"claude-text-secondary text-sm",children:m.hasCards?"Nice work!":"Share with the community"})]})]})})]}),L&&!m.hasCards&&i.jsx("div",{className:"text-center mt-8",children:i.jsxs("button",{onClick:()=>e("create"),className:"claude-button-primary px-8 py-4 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300",style:{background:"linear-gradient(135deg, #D4A574 0%, #C19A6B 100%)"},children:[i.jsx(pr,{size:20,color:"white"}),"Create Your First Card"]})})]})]}),i.jsxs("div",{className:"relative overflow-hidden p-16 mb-16 rounded-3xl bg-gradient-to-br from-accent-500/20 via-primary-500/20 to-secondary-500/20 border border-white/20 text-center group hover:scale-105 transition-all duration-500",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-accent-500/10 to-primary-500/10"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),i.jsxs("div",{className:"relative z-10",children:[i.jsx("h2",{className:"text-4xl md:text-5xl font-extrabold mb-6",style:{color:"var(--heading)"},children:"Looking for something specific?"}),i.jsxs("p",{className:"text-xl claude-text-secondary max-w-3xl mx-auto mb-8 leading-relaxed",children:["Search our community database of ",i.jsx("span",{style:{color:"var(--accent-primary)",fontWeight:"600"},children:"250+ flashcards"})," from",i.jsx("span",{style:{color:"var(--accent-secondary)",fontWeight:"600"},children:" students worldwide"}),". Find exactly what you need to ace your studies."]}),i.jsxs("button",{onClick:()=>e("search"),className:"claude-button-primary group/btn relative overflow-hidden px-12 py-6 font-semibold text-lg shadow-2xl transform hover:scale-105 transition-all duration-300",style:{background:"linear-gradient(135deg, #9B8B73 0%, #8A7A63 100%)"},children:[i.jsxs("span",{className:"relative z-10 flex items-center gap-3",children:[i.jsx(Fa,{size:20,color:"white"}),i.jsx("span",{children:"Search Community Flashcards"})]}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-white/10 opacity-0 group-hover/btn:opacity-100 transition-opacity duration-300"})]})]})]}),i.jsx("footer",{className:"claude-card relative overflow-hidden mt-24 py-16",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[i.jsxs("div",{className:"text-center mb-12",children:[i.jsxs("div",{className:"inline-flex items-center gap-3 mb-4",children:[i.jsx("img",{src:"/files/three-sided_logo.png",alt:"Three-Sided",width:"48",height:"48",className:"rounded-xl shadow-lg"}),i.jsx("span",{className:"text-3xl font-extrabold",style:{color:"var(--heading)"},children:"Three‑Sided"})]}),i.jsx("p",{className:"claude-text-secondary text-lg max-w-2xl mx-auto",children:"Empowering students worldwide with AI-enhanced flashcards and collaborative learning."})]}),i.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8 pt-8",style:{borderTop:"1px solid var(--border-light)"},children:[i.jsxs("div",{className:"claude-text-muted",children:["© ",new Date().getFullYear()," Three‑Sided. Made with ",i.jsx(rh,{size:16,color:"error"})," for students."]}),i.jsxs("div",{className:"flex items-center gap-8",children:[i.jsx("a",{href:"mailto:amirbattye@gmail.com",className:"hover:opacity-70 transition-colors duration-200 font-medium",style:{color:"var(--accent-primary)"},children:"Contact"}),i.jsx("a",{href:"/latex_guide.html",target:"_blank",rel:"noreferrer",className:"hover:opacity-70 transition-colors duration-200 font-medium",style:{color:"var(--accent-secondary)"},children:"LaTeX Guide"}),i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 rounded-full text-sm",style:{backgroundColor:"rgba(91, 200, 162, 0.1)",color:"var(--success)"},children:[i.jsx("div",{className:"w-2 h-2 rounded-full animate-pulse",style:{backgroundColor:"var(--success)"}}),i.jsx("span",{className:"font-medium",children:"Beta"})]})]})]})]})})]})]});return i.jsxs("div",{className:"min-h-screen",children:[i.jsx(ue,{}),ve(),i.jsx(tO,{isVisible:x,onClose:()=>w(!1),selectedTags:[],onTagsChange:()=>{}}),i.jsx(rO,{isVisible:b,onClose:()=>E(!1)}),i.jsx(iO,{isVisible:R,onClose:()=>k(!1)}),i.jsx(lO,{isVisible:U,onClose:()=>z(!1)}),j&&i.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4 shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("span",{className:"text-2xl",children:"⏰"}),i.jsx("h3",{className:"text-lg font-bold text-orange-600",children:"Session Timeout Warning"})]}),i.jsx("p",{className:"text-gray-700 mb-6",children:`Your session will expire soon due to inactivity. Click "Stay Active" to continue, or you'll be signed out automatically.`}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:()=>{V(),T()},className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Sign Out"}),i.jsx("button",{onClick:V,className:"px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:"Stay Active"})]})]})})]})}const rV=()=>i.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--background-main)"},children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 border-4 border-t-4 border-gray-200 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-lg font-medium",style:{color:"var(--text-main)"},children:"Loading Three-Sided..."})]})});EI.createRoot(document.getElementById("root")).render(i.jsx(M.StrictMode,{children:i.jsx(N5,{fallback:i.jsx(rV,{}),children:i.jsx(sV,{})})}));
